self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[395],{10124:function(e,t,n){"use strict";var r=n(115),a=n(2129),o=n(3594),i=n(961);function c(e,t,n,r){if(1!=e.length)return{rowKeys:e};var a=e[0];return{uniqueSenders:i.b.getUniqueSenders(a,t),lastSenderMailbox:i.b.getLastSenderMailbox(a,t),folderId:r,rowKeys:[a]}}n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var u=new r.c((function(){return Promise.all([n.e(46),n.e(606)]).then(n.bind(null,15656))}));function s(){Object(r.f)(a.d,u,(function(e){return e.postTriagePatternsOrchestrator})),Object(r.f)(a.d,u,(function(e){return e.showSuggestionOnTriageAction})),Object(r.f)(o.a,u,(function(e){return e.postTriagePatternsOnSearch}))}},1038:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(296),a=n(1004),o=n(76);function i(){var e;return(e={})[a.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[a.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[a.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddClassicAttachment","InsertLink","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[a.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[a.a.Confetti]={confettiEnabled:!0},e[a.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[a.a.GdprAdsPrefs]={feature:a.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[a.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[a.a.ExternalImages]={externalImagesSelectedOption:0},e[a.a.EventCapture]={autoCollectionEnabled:!1},e[a.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[a.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,roamingTimeZoneTeachingMomentDisplayed:!1,bannedRoamingTimeZone:null,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[a.a.AmpDeveloper]={enabled:Object(o.h)("rp-ampDefault"),allowedSender:[]},e[a.a.CalendarHelp]={calendarHelpEnabled:!1},e[a.a.LinkedInViewProfile]={dismissed:!1},e[a.a.Bohemia]={bohemiaEnabled:Object(o.h)("cmp-prague")},e[a.a.GdprAdsV2]={feature:a.a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[a.a.GdprAdsV3]={feature:a.a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[a.a.Proofing]={feature:a.a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[a.a.ActiveProxyAddress]={feature:a.a.ActiveProxyAddress,activeProxyAddresses:[]},e[a.a.OutlookSpaces]={feature:a.a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[a.a.SxS]={feature:a.a.SxS,hideReadingPane:!1},e}},1070:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},1085:function(e,t,n){"use strict";var r,a,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External"}(a||(a={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},1089:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},1264:function(e,t,n){"use strict";n.d(t,"n",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"p",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"u",(function(){return b})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"l",(function(){return I})),n.d(t,"k",(function(){return j})),n.d(t,"c",(function(){return h})),n.d(t,"o",(function(){return w})),n.d(t,"s",(function(){return S})),n.d(t,"b",(function(){return C})),n.d(t,"m",(function(){return P})),n.d(t,"h",(function(){return A})),n.d(t,"t",(function(){return E}));var r=n(115),a=n(1425);n.d(t,"v",(function(){return a.a}));var o=n(1426);n.d(t,"w",(function(){return o.a}));n(1070),n(1089);var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(141)]).then(n.bind(null,2676))})),c=new r.a(i,(function(e){return e.initializeAttachments})),u=new r.a(i,(function(e){return e.reinitializeAttachments})),s=new r.a(i,(function(e){return e.setInlineAttachmentStatus})),d=new r.a(i,(function(e){return e.addAttachmentIntoWellBeforeUpload})),l=new r.b(i,(function(e){return e.refreshSharingTipsAttachmentWell})),f=new r.b(i,(function(e){return e.createAttachmentsViaQueueManager})),b=new r.b(i,(function(e){return e.createAttachmentsFromRecentAttachments})),m=new r.a(i,(function(e){return e.deleteAttachmentViaQueueManager})),v=new r.b(i,(function(e){return e.createAttachmentFullViewStateAndStoreBackingModel})),O=new r.b(i,(function(e){return e.createAttachmentFullViewState})),p=new r.b(i,(function(e){return e.getAttachmentWellInitialValue})),g=new r.b(i,(function(e){return e.getAttachmentWellForCompose})),I=new r.b(i,(function(e){return e.getConversationAttachmentWellInitialValue})),j=(new r.b(i,(function(e){return e.getMaxClassicAttachmentsSize})),new r.b(i,(function(e){return e.getAvailableLocalAttachmentSize}))),h=new r.b(i,(function(e){return e.createAttachmentFileFromExistingMailboxAttachment})),w=new r.a(i,(function(e){return e.mergeToConversationAttachmentWell})),S=new r.a(i,(function(e){return e.sortConversationAttachmentWell})),C=new r.a(i,(function(e){return e.convertImageViewAttachmentToInlineAttachment})),P=new r.b(i,(function(e){return e.getLastCloudyAttachmentsSharingIssueForBlockOnSend})),A=new r.b(i,(function(e){return e.getAllValidAttachments})),E=new r.b(i,(function(e){return e.uploadLocalFile}))},12674:function(e){e.exports=JSON.parse('{"a":"rkd"}')},1281:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),a=n(1038),o=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(a.a)()),{defaultOptions:e}}))},1298:function(e,t,n){"use strict";function r(e){var t=e.AttachmentPolicy;return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}n.d(t,"a",(function(){return r}))},1299:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(314);function a(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1326:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return b}));var r=n(254),a="WebPushSetup";function o(e){v("vipMailEnabled",e)}function i(e){v("mailOption",e)}function c(e){v("reminderOption",e)}function u(e){v("enabled",e)}function s(e,t){v("disabled",e),v("allClients",t)}function d(e){(window.webPushOptics.enabled||window.webPushOptics.disabled)&&(v("result",e),m())}function l(){v("lightning","ignored"),m()}function f(e){v("permission",e)}function b(e){v("roaming",e)}function m(){Object(r.o)(a,window.webPushOptics,{isCore:!0}),window.webPushOptics={}}function v(e,t){window.webPushOptics[e]=t}window.webPushOptics={}},1425:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ATTACHMENT_CREATED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1426:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ATTACHMENT_DELETED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1454:function(e,t,n){"use strict";var r=n(0),a=n(1990),o=n(284),i=Object(o.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=Object(r.__spread)(e.infoBarIds);var o=e.infoBarHostKey;n&&(a.b[o]||(a.b[o]={}),a.b[o][t]=n)}}));t.a=i},1485:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(1760),a=n(1298),o=n(26),i=n(1299);function c(){var e=Object(o.a)();return Object(a.a)(e)}function u(e){var t=Object(o.a)();return(e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!function(e){return e.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t}))}(e)?Object(a.a)(t):[]).map(i.a)}},1523:function(e,t,n){"use strict";var r=n(115),a=[0,1],o=n(1931),i=n(1901),c=n(10),u=n(314),s=n(1085);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(i.a),messageParts:[Object(c.b)(i.a),l()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(o.b),messageParts:[Object(c.b)(o.b),l()],color:s.a.Red};default:return Object(u.a)(e)}}function l(){return{text:Object(c.b)(o.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(1485),b=n(1299),m=(n(1298),n(0)),v=n(76),O=n(26);function p(){var e=Object(O.a)();if(Object(v.h)("fwk-devTools")){if(Object(v.h)("doc-attachment-CA-readOnlyAccessIssues"))return Object(m.__assign)(Object(m.__assign)({},e),{AttachmentPolicy:Object(m.__assign)(Object(m.__assign)({},e.AttachmentPolicy),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0})});if(Object(v.h)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(m.__assign)(Object(m.__assign)({},e),{AttachmentPolicy:Object(m.__assign)(Object(m.__assign)({},e.AttachmentPolicy),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})})}return e}function g(){var e=p().AttachmentPolicy;return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return j})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"d",(function(){return b.a})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return p}));var I=new r.c((function(){return n.e(1199).then(n.bind(null,15416))})),j=new r.b(I,(function(e){return e.getAccessIssuesForAttachments}))},15565:function(e,t,n){"use strict";n.r(t);var r=n(964),a=n(3185),o=n(961);function i(e){return Object(o.P)(Object(r.a)("inbox"))}var c=n(1003);function u(e){var t=Object(r.a)("inbox");return Object(o.P)(t)&&!Object(c.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}var s=n(573),d=n(10),l=n(12674);var f=n(10063),b=n(2645),m=n(76),v=n(1457),O=n(4),p=n(9303);Object(O.orchestrator)(p.a,(function(){v.f.importAndExecute("mail","attachments")}));var g=n(9301);Object(O.orchestrator)(g.a,(function(){v.f.importAndExecute("general","timeAndLanguage")}));var I=n(2474),j=n(9302),h=n(9306),w=n(3739);Object(O.orchestrator)(j.a,(function(e){I.c.importAndExecute("GetStarted",void 0,void 0,e.taskSendEmailSubject,e.taskSendEmailBody)})),Object(O.orchestrator)(w.a,(function(e){1==e.event&&Object(h.a)()}));var S=n(9304),C=n(9307),P=n(115),A=new P.c((function(){return Promise.all([n.e(64),n.e(464)]).then(n.bind(null,15720))})),E=new P.a(A,(function(e){return e.showPersonalizationCard}));Object(O.orchestrator)(S.a,(function(){E.importAndExecute(C.a)}));var R=n(6787),x=n(4850),y=new P.c((function(){return n.e(128).then(n.bind(null,15923))})),M=new P.a(y,(function(e){return e.loadSenders})),N=n(10203),T=n(2399),_=n(1779),k=n(438),L=n(1609),D=n(978),V=n(1766),U=n(245);function F(){var e=Object(_.a)({FolderShape:Object(L.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(D.a)({FieldURI:"TotalCount"}),Object(D.a)({FieldURI:"UnreadCount"})]}),Paging:null,ParentFolderIds:[Object(k.a)({Id:Object(r.a)("msgfolderroot")})],ReturnParentFolder:!0,ShapeName:null,Traversal:"Deep"});return Object(V.a)({Header:Object(U.a)(),Body:e}).then((function(e){var t,n,r;return null===(r=null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items)||void 0===r?void 0:r[0]}))}var B=n(2749),W=n(1075),K=n(75),z=n(1620),q=n(2677);function H(e){switch(e.EventType){case"Reload":case"QueryResultChanged":F().then((function(e){"Success"==(null==e?void 0:e.ResponseClass)?e.RootFolder.Folders.forEach((function(e){Object(B.a)(e.UnreadCount,e.TotalCount,e.FolderId.Id,!1)})):K.g.warn(G+"ResponseNotSuccess")})).catch((function(e){K.g.warn(G+":"+e.message)}));break;case"RowAdded":case"RowModified":var t=e;Object(B.a)(t.unreadCount,t.itemCount,t.folderId,!1),"RowAdded"===e.EventType&&q.f.importAndExecute(t.folderId,t.parentFolderId,t.displayName),z.h.import().then((function(t){t(e)}));break;default:return}}var G="UpdateFolderCountsAction:";var $=new P.c((function(){return n.e(292).then(n.bind(null,15851))}));Object(P.f)(T.a,$,(function(e){return e.getFolderDataOrchestrator}));var Y=n(23),J=n(982),Q=n(2373);function Z(e,t){var n=function(e){var t={},n=J.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){K.d("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(Q.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(d.f)(n.parentInternetMessageId))break;n=J.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new Y.ObservableMap({});return t.forEach((function(t){var r=J.a.conversationNodes.get(t),a=t===e?o.a.CheckMark:o.a.None;n.set(r.internetMessageId,a)})),n}(e,t);for(var r=new Y.ObservableMap({}),a=!1,i=!1,c=0,u=0;u<t.length;u++){var s=J.a.conversationNodes.get(t[u]);s&&(n[s.internetMessageId]?(a?c+1===Object.keys(n).length?(r.set(s.internetMessageId,o.a.BusEnd),i=!0):r.set(s.internetMessageId,o.a.BusStop):(r.set(s.internetMessageId,o.a.BusStart),a=!0),c++):!a||i?r.set(s.internetMessageId,o.a.None):r.set(s.internetMessageId,o.a.NoStop))}return r}var X=n(1199),ee=Object(O.action)("FOCUS_ITEM_PART",(function(e,t){return{nodeId:e,mailListItemSelectionSource:t}})),te=n(986),ne=n(8014),re=n(977);function ae(){var e=te.a.expandedConversationViewState;e.expandedRowKey=null,e.focusedNodeId=null,e.selectedNodeIds=[],e.allNodeIds=[],e.shouldBeExpanded=!1,e.busStopStateMap=new Y.ObservableMap({})}Object(O.mutator)(X.t,(function(e){var t=e.nodeId,n=te.a.expandedConversationViewState,r=n.selectedNodeIds,a=n.allNodeIds;te.a.expandedConversationViewState.focusedNodeId=t,r.indexOf(t)>-1?r.splice(r.indexOf(t),1):r.push(t),1===r.length&&(te.a.expandedConversationViewState.busStopStateMap=Z(r[0],a))})),Object(O.mutator)(X.h,(function(e){te.a.expandedConversationViewState.busStopStateMap=new Y.ObservableMap({})})),Object(O.mutator)(ee,(function(e){te.a.expandedConversationViewState.focusedNodeId=e.nodeId})),Object(O.mutator)(X.q,(function(e){var t=e.rowKey,n=e.nodeIdToSelect,r=e.allNodeIds,a=te.a.expandedConversationViewState;a.selectedNodeIds=[n],a.busStopStateMap=Z(n,r),a.expandedRowKey=t,a.focusedNodeId=n,a.allNodeIds=r})),Object(O.mutator)(X.u,(function(e){e.mailListItemSelectionSource===re.b.MailListItemCheckbox&&ae()})),Object(O.mutator)(X.p,(function(e){ae()})),Object(O.mutator)(X.i,(function(e){ae()})),Object(O.mutator)(X.k,(function(e){ae()})),Object(O.mutator)(X.r,(function(e){var t=te.a.expandedConversationViewState;e.mailListItemSelectionSource==re.b.MailListItemTwisty&&t.expandedRowKey!=e.rowKey&&(t.expandedRowKey=e.rowKey,t.shouldBeExpanded=!0)})),Object(O.mutator)(X.o,(function(e){te.a.expandedConversationViewState.shouldBeExpanded=e.shouldBeExpanded})),Object(O.mutator)(ne.a,(function(e){if(1===te.a.expandedConversationViewState.selectedNodeIds.length){var t=te.a.expandedConversationViewState.selectedNodeIds[0],n=re.w.conversations.get(e.conversationId).conversationNodeIds;te.a.expandedConversationViewState.busStopStateMap=Z(t,n)}}));var oe,ie=n(0),ce=n(8472),ue=n(2679),se=n(1659),de=n(1088),le=n(6373);Object(O.orchestrator)(X.b,(function(e){me(e.itemId,e.tableView,e.nodeId,e.allNodeIds,e.mailListItemSelectionSource)}));Object(O.orchestrator)(X.e,(function(e){if(e.mailListItemSelectionSource==re.b.MailListItemTwisty){if(1==e.listViewType)throw new Error("Toggle expansion action cannot be called from message view");var t,n;Object(ce.a)(e.rowKey)?Oe():(t=e.rowKey,n=e.tableView,X.o(!1),Object(le.a)(n,!1),ve(t,n))}})),Object(O.orchestrator)(X.c,(function(e){Object(ce.a)(e.rowKey)&&Oe()})),Object(O.orchestrator)(X.m,(function(e){for(var t=o.b.getConversationId(e.rowKey,e.tableView),n=re.w.conversations.get(t),r=null,a=null,i=n.conversationNodeIds.indexOf(o.T.expandedConversationViewState.selectedNodeIds[0])+1;i<n.conversationNodeIds.length;i++){var c=n.conversationNodeIds[i],u=Object(Q.b)(c);if(u){a=u.ItemId.Id,r=c;break}}r?me(a,e.tableView,r,n.conversationNodeIds,re.b.RowRemoval):ve(e.rowKey,e.tableView)}));var fe=0,be=!0;function me(e,t,n,r,a){if(oe&&(clearTimeout(oe),oe=null),Object(ue.d)(t,!0,a,void 0),a!==re.b.KeyboardUpDown||Object(de.c)()){var i=o.b.getRowClientItemId(o.T.expandedConversationViewState.expandedRowKey,t);se.r.importAndExecute(null==i?void 0:i.Id,e,!0)}else{var c=Date.now(),u=c-fe;fe=c,(be||u<=500)&&(be=!1,oe=setTimeout((function(){oe=null,be=!0;var n=o.b.getRowClientItemId(o.T.expandedConversationViewState.expandedRowKey,t);se.r.importAndExecute(null==n?void 0:n.Id,e,!0)}),250))}X.q(o.T.expandedConversationViewState.expandedRowKey,n,r,t.id)}function ve(e,t){var n,r,a=o.b.getConversationId(e,t),i=re.w.conversations.get(a);try{for(var c=Object(ie.__values)(i.conversationNodeIds),u=c.next();!u.done;u=c.next()){var s=u.value,d=Object(Q.b)(s);if(d){me(d.ItemId.Id,t,s,i.conversationNodeIds,re.b.RowRemoval);break}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}function Oe(){X.i()}var pe=n(7343),ge=n(7400),Ie=(Object(O.orchestrator)(ge.a,(function(e){Object(pe.a)(),1===Object(o.F)().expandedConversationViewState.selectedNodeIds.length&&X.h()})),n(9171)),je=n(1391),he=(Object(O.orchestrator)(Ie.a,(function(e){if(o.T.expandedConversationViewState.expandedRowKey){var t=re.w.conversations.get(e.conversationId);X.q(o.T.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(je.a)())}})),n(8068)),we=n(5046),Se=n(6495),Ce=n(2036),Pe=Object(O.action)("FOCUS_ROW_IN_DIRECTION",(function(e,t,n){return{tableView:e,selectionDirection:t,mailListItemSelectionSource:n}}));function Ae(e,t,n){return Object(Ce.a)()?1===e&&n===o.d.Next||0===e&&n===o.d.Previous:e===t-1&&n===o.d.Next||e===t-2&&n===o.d.Previous}Object(O.orchestrator)(he.a,(function(e){var t=e.selectionDirection,n=e.tableView,r=e.mailListItemSelectionSource,a=e.shouldSelect,i=Object(ie.__read)(function(e,t){var n=o.T.expandedConversationViewState,r=n.focusedNodeId,a=n.allNodeIds;if(!r)return[null,null];var i,c,u=a.indexOf(r);e===o.d.Next?(i=a.length-1,c=1):(i=0,c=-1);var s=Object(o.G)(t.focusedRowKey,t.id).id,d=o.T.conversationItems.get(s);for(;u!==i;){if(u+=c,Object(we.a)(d.id)&&Ae(u,a.length,e))return Object(Se.a)(d.clientId),["loading",null];var l=a[u],f=Object(Q.b)(l);if(f)return[l,f]}return[null,null]}(t,n),2),c=i[0],u=i[1];"loading"!==c&&(c?a?X.b(c,u.ItemId.Id,o.T.expandedConversationViewState.allNodeIds,n,r):ee(c,r):o.T.expandedConversationViewState.expandedRowKey&&t===o.d.Previous?X.c(o.T.expandedConversationViewState.expandedRowKey):a?X.n(n,t,r):Pe(n,t,r))}));var Ee=n(10185),Re=n(5688),xe=n(5307),ye=n(5306),Me=(Object(O.orchestrator)(Pe,(function(e){var t=e.tableView,n=e.selectionDirection,r=Object(Ee.a)(t,n);if(null!==r){var a=t.rowKeys[r];Object(Re.a)(t,a),Object(ye.a)(t,a),Object(xe.a)(t,null),X.i()}})),n(8069));Object(O.orchestrator)(Me.a,(function(e){var t=e.tableView,n=e.mailListItemSelectionSource,r=o.T.expandedConversationViewState.focusedNodeId;r?X.t(r):X.u(t,t.focusedRowKey,!0,n)}));var Ne=n(1378),Te=n(8070);Object(O.orchestrator)(Te.a,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys,a=e.mailListItemSelectionSource;if(n.length>0&&a===Ne.a.KeyboardEnter){if(1!==n.length)return;X.b(n[0],Object(Q.b)(n[0]).ItemId.Id,o.T.expandedConversationViewState.allNodeIds,t,a)}else{if(1!==r.length)return;X.r(t,r[0],!0,a)}}));var _e=n(10124),ke=n(25);var Le=n(296),De=n(2819),Ve=n(4863),Ue=n(2433),Fe=n(4276),Be=n(6723),We=n(3115),Ke=n(2534),ze=n(2146),qe=n(4007),He=n(6320),Ge=new P.c((function(){return n.e(460).then(n.bind(null,15612))})),$e=new P.a(Ge,(function(e){return e.evaluatePlaywrightMailActions})),Ye=n(26);function Je(){var e;Object(Ye.a)().IsMonitoring&&$e.importAndExecute(),Object(f.a)(!0),Object(m.h)("fwk-mailtoProtocolHandler")&&(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)&&window.navigator.registerProtocolHandler("mailto",""+Object(s.m)()+Object(s.k)()+"deeplink/compose?mailtouri=%s",Object(d.b)(l.a)),Object(m.h)("tri-triagePattern")&&Object(_e.b)(),ze.b.importAndExecute({condition:Object(m.h)("fwk-devTools")||Object(m.h)("sea-contextFeedback"),task:function(){return N.b.importAndExecute()}},Qe,{condition:Object(De.a)(),task:function(){return De.e.importAndExecute()}},(function(){return Fe.a.importAndExecute()}),{condition:Object(Le.a)(),task:function(){return M.importAndExecute()}},(function(){return Be.b.importAndExecute()}),(function(){return Be.a.importAndExecute()}),{condition:Object(We.j)(),task:function(){return We.d.importAndExecute()}},(function(){return We.e.importAndExecute()}),{task:function(){return R.c.importAndExecute()},idle:!0},{condition:Object(m.h)("mc-personalization"),task:function(){Ve.b.importAndExecute()},idle:!0},{task:function(){return Ue.c.importAndExecute()},idle:!0},{condition:Object(se.f)(),task:function(){return x.a.importAndExecute()},idle:!0},{task:function(){return b.d.importAndExecute()},idle:!0},{condition:Object(Ke.e)(window),task:function(){return Ke.j.importAndExecute(window)},idle:!0},{condition:Object(m.h)("tri-mailboxCleanup"),task:function(){return qe.a.importAndExecute()},idle:!0},{condition:Object(c.isNewsEnabled)(),task:function(){return He.e.importAndExecute()}},{condition:Object(m.h)("auth-activityFeed")&&Object(m.h)("auth-activityFeedWeveSignal"),task:function(){return b.e.importAndExecute()},idle:!0}).then((function(){ze.a.importAndExecute()}))}function Qe(){var e,t;W.f.importAndExecute({subscriptionId:"HierarchyNotification",requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:"HierarchyNotification"}},H),Object(a.g)(u),Object(a.f)(i),e={isOWALogon:!0},Object(ke.a)("ConnectedAccountsNotification",e,t)}var Ze=n(1121),Xe=n(1715);Object(O.orchestrator)(a.c,(function(e){return Object(ie.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a,i,c;return Object(ie.__generator)(this,(function(u){switch(u.label){case 0:return t=e.notification,Object(o.L)(Object(o.C)())?(n=Object(re.i)().conversations.get(t.conversationId),r={Id:t.conversationId,mailboxInfo:Object(Ze.b)()},n?[3,2]:[4,Xe.d.importAndExecute(r,"LoadLikedConversation")]):[3,3];case 1:u.sent(),u.label=2;case 2:return et(r,t.subject),[3,6];case 3:return a=Object(re.i)().items.get(t.itemId),i={Id:t.itemId,mailboxInfo:Object(Ze.b)()},(null==a?void 0:a.NormalizedBody)?(et(i,t.subject),[3,6]):[3,4];case 4:return c={Id:t.itemId,mailboxInfo:Object(Ze.b)()},[4,Xe.e.importAndExecute(c,"LoadLikedItem")];case 5:u.sent(),et(c,t.subject),u.label=6;case 6:return[2]}}))}))}));function et(e,t){se.o.importAndExecute(e,t,[],!0,null)}var tt=n(9324),nt=n(94);Object(O.orchestrator)(a.d,(function(e){var t=e.notification,n=1===Object(nt.i)().UserOptions.GlobalListViewTypeReact?t.ItemId:t.ConversationId;Object(tt.a)("inbox",n)}));n.d(t,"setupMailModulePostRender",(function(){return Je}))},1612:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r,a=n(4),o=Object(a.createStore)("webPushStore",{currentView:0,webPushPermission:null===(r=window.Notification)||void 0===r?void 0:r.permission})(),i=Object(a.createStore)("localWebPushUserSettingStore",{userPreferenceIdentifier:null,lastSessionDate:null,uniqueDaysSessionCount:0,enabled:null,mailEnabled:null,reminderEnabled:null,vipMailEnabled:null,lastCheckboxUnchecked:null,promptCount:0,lastPromptDate:null})();function c(){return i}},1642:function(e,t,n){"use strict";var r=n(1283),a=n(1341),o=n(4),i=Object(o.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),c=Object(o.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),u=Object(o.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),s=Object(o.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),d=Object(o.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),l=n(1437);n.d(t,"n",(function(){return r.a})),n.d(t,"m",(function(){return a.a})),n.d(t,"l",(function(){return i})),n.d(t,"j",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return l.g})),n.d(t,"c",(function(){return l.c})),n.d(t,"d",(function(){return l.d})),n.d(t,"a",(function(){return l.a})),n.d(t,"e",(function(){return l.e})),n.d(t,"f",(function(){return l.f})),n.d(t,"i",(function(){return l.i})),n.d(t,"b",(function(){return l.b})),n.d(t,"h",(function(){return l.h}))},1677:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d}));var r=n(1612),a=n(2346),o=n(284),i=n(1681),c=Object(o.select)({store:function(){return r.b}})((function(e){return null!=e.store&&null==e.store.enabled&&e.store.uniqueDaysSessionCount>=i.b&&e.store.lastPromptDate!=Object(a.a)().toDateString()&&e.store.promptCount<=i.a})),u=Object(o.select)({store:function(){return r.b}})((function(e){return e.store.mailEnabled||e.store.reminderEnabled})),s=Object(o.select)({store:function(){return r.b}})((function(e){var t;return{newMail:e.store.mailEnabled,reminder:e.store.reminderEnabled,vipMailOnly:null!==(t=e.store.vipMailEnabled)&&void 0!==t&&t}})),d=Object(o.select)({store:function(){return r.b}})((function(e){return e.store.reminderEnabled&&e.store.enabled}))},1681:function(e,t,n){"use strict";var r=n(1612),a=n(2346),o=n(284),i=n(9),c="WebPushUserSettings",u=5;function s(e,t){for(var n=d(e),r=-1,a=0;a<n.length;++a)if(n[a].userPreferenceIdentifier==t.userPreferenceIdentifier){r=a;break}if(r>=0)n[r]=t;else{if(r=n.length,n.length>=u){r=0;var o=new Date(n[0].lastSessionDate);for(a=1;a<n.length;++a){var s=new Date(n[a].lastSessionDate);s.getTime()<o.getTime()&&(o=s,r=a)}}n[r]=t}!function(e,t){if(t.length>0){var n=JSON.stringify(t);Object(i.d)(e,c,n)}else Object(i.c)(e,c)}(e,n)}function d(e){var t=Object(i.a)(e,c),n=new Array;try{var r=JSON.parse(t);null!=r&&(n=r)}catch(t){Object(i.c)(e,c)}return n}var l=n(1677),f=n(76);n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return m})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return O})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return g})),n.d(t,"c",(function(){return I})),n.d(t,"f",(function(){return j})),n.d(t,"i",(function(){return h}));var b=4,m=3,v=Object(o.select)({store:function(){return r.b}})(Object(o.action)("loadLocalWebPushUserSetting")((function(e,t,n){var r=function(e,t){for(var n=d(e),r=null,a=0;a<n.length;++a)if(n[a].userPreferenceIdentifier==t){r=n[a];break}return r}(e,t);if(null!=r)Object.keys(r).forEach((function(e){n.store[e]=r[e]})),h(e);else{var a=function(e,t){for(var n=d(e),r=null,a=0;a<n.length;++a)n[a].userPreferenceIdentifier<t&&(r?n[a].userPreferenceIdentifier>r.userPreferenceIdentifier&&(r=n[a]):r=n[a]);return r}(e,t);a&&(n.store.lastCheckboxUnchecked=a.lastCheckboxUnchecked,n.store.mailEnabled=a.mailEnabled,n.store.reminderEnabled=a.reminderEnabled,n.store.vipMailEnabled=a.vipMailEnabled),n.store.userPreferenceIdentifier=t,s(e,n.store)}}))),O=Object(o.select)({store:function(){return r.b}})(Object(o.action)("incrementUniqueDaysSessionCount")((function(e,t){var n=Object(a.a)().toDateString();t.store.lastSessionDate!=n&&(t.store.lastSessionDate=n,t.store.uniqueDaysSessionCount<b&&t.store.uniqueDaysSessionCount++,s(e,t.store))}))),p=Object(o.select)({store:function(){return r.b}})(Object(o.action)("resetLocalWebpushUserSetting")((function(e,t,n){n.store.userPreferenceIdentifier=t,n.store.enabled=!1,n.store.promptCount=0,n.store.lastPromptDate=null,n.store.uniqueDaysSessionCount=0,s(e,n.store)}))),g=Object(o.select)({store:function(){return r.b}})(Object(o.action)("updateLocalWebPushEnabledStatus")((function(e,t,n,r){r.store.enabled=t,r.store.userPreferenceIdentifier=n,t&&h(e),s(e,r.store)}))),I=Object(o.select)({store:function(){return r.b}})(Object(o.action)("incrementLocalWebPushPromptCount")((function(e,t){t.store.promptCount++,t.store.lastPromptDate=Object(a.a)().toDateString(),s(e,t.store)}))),j=Object(o.select)({store:function(){return r.b}})(Object(o.action)("resetLocalWebPushPromptCount")((function(e,t){t.store.promptCount=0,t.store.lastPromptDate=null,s(e,t.store)}))),h=Object(o.select)({store:function(){return r.b}})(Object(o.action)("validateAndUpdateCheckboxOptions")((function(e,t){if(t.store.enabled&&!Object(l.b)())if(t.store.lastCheckboxUnchecked){switch(t.store.lastCheckboxUnchecked){case"NewMail":t.store.mailEnabled=!0;break;case"Reminder":t.store.reminderEnabled=!0}t.store.lastCheckboxUnchecked=null}else t.store.mailEnabled=!0,t.store.reminderEnabled=!0;Object(f.h)("auth-scheduleTimerForReminderWebPush")||Object(f.h)("auth-sendReminderWebPush")||(t.store.reminderEnabled=!1,t.store.lastCheckboxUnchecked=null),s(e,t.store)})))},1760:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1821:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("saveSigningCertificate",(function(e,t){return{smimeViewState:e,signingCertRawData:t}}))},1874:function(e,t,n){"use strict";n.d(t,"m",(function(){return o})),n.d(t,"l",(function(){return i})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return v})),n.d(t,"r",(function(){return O})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"j",(function(){return I})),n.d(t,"f",(function(){return j})),n.d(t,"i",(function(){return h})),n.d(t,"a",(function(){return w}));var r=n(115),a=(n(1821),new r.c((function(){return Promise.all([n.e(12),n.e(763),n.e(4),n.e(16),n.e(685)]).then(n.bind(null,3636))}))),o=new r.a(a,(function(e){return e.onSmimeItemAttachmentOpened})),i=new r.a(a,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(a,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(a,(function(e){return e.setSmimePropertiesInDraftMessage}))),u=new r.b(a,(function(e){return e.trySetSmimeProperties})),s=new r.b(a,(function(e){return e.tryAddSmimeProperties})),d=new r.b(a,(function(e){return e.createMailResponseBodyContent})),l=new r.b(a,(function(e){return e.downloadSmimeAttachment})),f=new r.b(a,(function(e){return e.getMergedSmimeViewState})),b=new r.b(a,(function(e){return e.getMergedSmimeViewStateForDraft})),m=new r.b(a,(function(e){return e.isSmimeItemDecoding})),v=new r.b(a,(function(e){return e.previewSmimeAttachment})),O=new r.b(a,(function(e){return e.updateSmimeAttachmentIds})),p=new r.b(a,(function(e){return e.createSmimeAttachmentsFromFiles})),g=new r.b(a,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),I=new r.b(a,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),j=new r.b(a,(function(e){return e.getAttachmentsForSmimeResponse})),h=new r.b(a,(function(e){return e.getSmimeAttachmentsForRequest})),w=Object(r.d)(a,(function(e){return e.SignatureDetails}))},1901:function(e){e.exports=JSON.parse('{"a":"Cia"}')},1931:function(e){e.exports=JSON.parse('{"a":"Aia","b":"Bia"}')},1973:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},1990:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r={};function a(e,t){var n,a=e.infoBarHostKey;return null===(n=r[a])||void 0===n?void 0:n[t]}},2014:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(4),a=n(2304),o={installationStatus:0,isBrowserSupportActiveX:Object(a.a)(),version:""},i=Object(r.createStore)("SmimeStore",o),c=i();t.a=c},2036:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(26);function a(){var e=Object(r.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},2129:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(115),a=n(1973);n.d(t,"d",(function(){return a.a}));var o=new r.c((function(){return n.e(378).then(n.bind(null,4205))})),i=new r.a(o,(function(e){return e.onKeyboardUpDown})),c=new r.a(o,(function(e){return e.onOpenEmail})),u=new r.a(o,(function(e){return e.onKeyboardToggleSelect}))},2163:function(e,t,n){"use strict";n.d(t,"n",(function(){return s})),n.d(t,"m",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return b})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return O})),n.d(t,"g",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"h",(function(){return I})),n.d(t,"e",(function(){return h})),n.d(t,"l",(function(){return w})),n.d(t,"b",(function(){return S}));var r=n(2652),a=n(2304),o=n(49),i=n(1305),c=n(1611),u=n(26);function s(){return Object(o.e)()||Object(o.f)()}function d(e){return function(e){if(e.length<2)return!1;var t=e[0]-parseInt(i.b),n=e[1]-parseInt(i.c);return 0==t&&n>=0}("string"==typeof e?e.split(".").map((function(e){return parseInt(e)})):[])}function l(e){var t="string"==typeof e?e.split("."):[];return t.length&&t[0]!=i.b}function f(){return Object(o.p)()&&(Object(o.i)()&&Object(o.b)()[0]==i.i&&Object(a.a)()||Object(r.a)())}function b(e){return 0!==e}function m(e){var t=[];t.push(e.UserEmailAddress),t.push(e.LogonEmailAddress),t.push(e.UserPrincipalName),t.push(e.UserLegacyExchangeDN);var n=e.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t}function v(e){var t=65001;return e.UseGB18030?t=54936:e.UseISO885915&&(t=28605),t}function O(e){return{AllowUserChoiceOfSigningCertificate:e.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:e.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:e.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:e.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:e.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:e.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:e.CopyRecipientHeaders,OnlyUseSmartCard:e.OnlyUseSmartCard,EncryptionAlgorithms:e.EncryptionAlgorithms,SigningAlgorithms:e.SigningAlgorithms}}function p(e,t){var n=Object(u.a)().SmimeAdminSettings.ClearSign;return t||e&&!n?c.a:i.e}function g(e){return btoa(unescape(encodeURIComponent(e)))}function I(e,t){var n=Object(u.a)().SmimeAdminSettings;return e&&t?n.TripleWrapSignedEncryptedMail?14:12:e?n.ClearSign?11:10:6}function j(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function h(){return i.m+j()+j()+j()+j()}function w(e,t){return t.IsInline&&-1===e.indexOf(t.ContentId)}function S(){return i.d+j()+"@"+j()+"."+j()}},2175:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var r=n(23),a=n(4),o={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},i=Object(a.createStore)("protection",o),c=i()},2223:function(e,t,n){"use strict";function r(e,t){return e+"_"+(null!=t.enabledTimeInUTCMs?t.enabledTimeInUTCMs:"")}n.d(t,"a",(function(){return r}))},2304:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(49);function a(){if(Object(r.i)())try{return new ActiveXObject("htmlfile"),!0}catch(e){return!1}return!1}},2307:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(76),a=n(49),o=n(26),i=n(1037),c=function(e){return!(!Object(r.h)("fwk-webPushNotification")&&!Object(r.h)("fwk-webPushNotificationV2"))&&(!(!e.navigator||null==e.navigator.serviceWorker||null==e.PushManager)&&((Object(a.e)()||Object(a.h)()||Object(r.h)("fwk-webPushNotificationExtended")&&(Object(a.f)()||Object(a.j)()))&&!Object(o.a)().SessionSettings.IsUserCultureRightToLeft&&(1==Object(i.b)()||2==Object(i.b)())))}},2346:function(e,t,n){"use strict";function r(){return new Date}n.d(t,"a",(function(){return r}))},2373:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(0),a=n(982),o=n(1652),i=n(1140),c=n(26),u=n(1311);function s(e){var t,n,c=(null==e?void 0:e.itemIds)?e.itemIds.length:0;if(0==c)return[null,!1,!1];var s=null,d=2==Object(i.c)().type||!Object(i.b)();if(1==c){if(!(s=a.a.items.get(e.itemIds[0])))return[null,!1,!1];d=d||s.ParentFolderId&&s.ParentFolderId.Id==Object(i.b)()}else{var l=null;try{for(var f=Object(r.__values)(e.itemIds),b=f.next();!b.done;b=f.next()){var m=b.value,v=a.a.items.get(m);if(!v)return[null,!1,!1];if(v.ParentFolderId&&v.ParentFolderId.Id==Object(i.b)()){s=v,d=!0;break}Object(u.a)(v.ParentFolderId.Id,"sentitems")&&(l=v)}}catch(e){t={error:e}}finally{try{b&&!b.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}s||(s=l||a.a.items.get(e.itemIds[0]))}return[s,d,Object(o.a)(s.ParentFolderId.Id)]}function d(e,t,n){var r=Object(c.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||r)&&t&&!n)}function l(e){var t=a.a.conversationNodes.get(e),n=Object(r.__read)(s(t),3),o=n[0],i=n[1];return d(o,n[2],i)?o:null}},2404:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2014);function a(){var e=Object(r.b)();return 9==e.installationStatus||6==e.installationStatus}},2452:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(3351),a=n(2828);function o(e){return Math.min(Math.floor(e/2),24)}t.a={RPPerfLoadConversationReadingPane:{name:"RPPerfLoadConversationReadingPane"},RPPerfLoadItemReadingPane:{name:"RPPerfLoadItemReadingPane"},RPCountExpCollQuotedText:{name:"RPCountExpCollQuotedText",customData:function(e,t,n){return[n?1:0,!e.isExpanded]}},RPCountExpCollItemPart:{name:"RPCountExpCollItemPart",customData:function(e,t,n){return[t||n?e.isExpanded?"EC":"CE":e==Object(r.b)()?"SC":e.isExpanded?"ES":"CS",t]}},RPCountLoadMore:{name:"RPCountLoadMore"},RPCountExpCollItemsRollUp:{name:"RPCountExpCollItemsRollUp",customData:function(e,t){return[o(Object(a.a)(e)),t]}},RPCountExpCollAllItemParts:{name:"RPCountExpCollAllItemParts",customData:function(e,t,n){return[t,n]}},PrintItem:{name:"PrintItem",actionSource:function(e,t){return t}},ReplyByMeeting:{name:"ReplyByMeeting",actionSource:function(e,t,n,r){return r}}}},2453:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(115),a=new r.c((function(){return Promise.all([n.e(764),n.e(686)]).then(n.bind(null,4844))})),o=new r.b(a,(function(e){return e.SmimeAdapter}))},2534:function(e,t,n){"use strict";var r=n(1326);n.d(t,"m",(function(){return r.b})),n.d(t,"l",(function(){return r.a})),n.d(t,"q",(function(){return r.i})),n.d(t,"n",(function(){return r.d})),n.d(t,"p",(function(){return r.g})),n.d(t,"o",(function(){return r.f}));var a=n(2223);n.d(t,"b",(function(){return a.a}));var o=n(1612);n.d(t,"a",(function(){return o.a}));var i=n(1681);n.d(t,"k",(function(){return i.e})),n.d(t,"r",(function(){return i.i}));var c=n(1677);n.d(t,"c",(function(){return c.b})),n.d(t,"d",(function(){return c.c}));var u=n(2307);n.d(t,"e",(function(){return u.a}));var s=n(1213);n.d(t,"j",(function(){return s.f})),n.d(t,"i",(function(){return s.e})),n.d(t,"h",(function(){return s.d})),n.d(t,"g",(function(){return s.c})),n.d(t,"f",(function(){return s.b}))},2652:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(49),a=n(1305);function o(){return Object(r.e)()&&Object(r.n)([a.f])||Object(r.g)()&&Object(r.n)([a.h])||Object(r.f)()&&Object(r.n)([a.g])}},2700:function(e,t,n){"use strict";t.a=function(e){var t;return null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.isDecoded}},2701:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.GlobalReply=3]="GlobalReply",e[e.SeeMore=4]="SeeMore"}(r||(r={}))},2828:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(982);function a(e){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&e.conversationNodeIdsInCollapsedItemsRollUp.length>0}function o(e){var t=r.a.conversations.get(e.conversationId.Id);return a(e)||(null==t?void 0:t.canLoadMore)}function i(e,t){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&t&&e.conversationNodeIdsInCollapsedItemsRollUp.includes(t.conversationNodeId)}function c(e){if(!a(e))return 0;var t=e.conversationNodeIdsInCollapsedItemsRollUp,n=e.itemPartsMap,r=t.length;return t.forEach((function(e){var t=n.get(e);t.oofRollUpViewState.oofReplyNodeIds&&(r+=t.oofRollUpViewState.oofReplyNodeIds.length)})),r}},2829:function(e,t,n){"use strict";function r(e,t){return{infoBarIds:t||[],infoBarHostKey:e||"0"}}n.d(t,"a",(function(){return r}))},2830:function(e,t,n){"use strict";function r(e,t,n,r){var o=a(e,t,n,r);return o?o.Value:null}function a(e,t,n,r){if(!e||!e.ExtendedProperty)return null;for(var a=0;a<e.ExtendedProperty.length;a++){var o=e.ExtendedProperty[a],i=null,c=null,u=null;if((null==o?void 0:o.ExtendedFieldURI)&&(i=o.ExtendedFieldURI.PropertyTag,c=o.ExtendedFieldURI.PropertyName,u=o.ExtendedFieldURI.PropertyId),t&&i==t)return o;if(n&&c==n)return o;if(r&&u==r)return o}return null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},2904:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r=n(115),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(493)]).then(n.bind(null,5253))})),o=new r.a(a,(function(e){return e.loadCLPUserLabels})),i=new r.b(a,(function(e){return e.showJustificationModal})),c=new r.a(a,(function(e){return e.loadItemCLPInfo})),u=new r.b(a,(function(e){return e.updateItemCLPInfo})),s=new r.b(a,(function(e){return e.logReadCLPLabel})),d=new r.b(a,(function(e){return e.triggerCLPAutoLabeling})),l=Object(r.d)(a,(function(e){return e.CLPSubjectHeaderLabel})),f=Object(r.d)(a,(function(e){return e.CLPMandatoryLabelModal}))},3170:function(e,t,n){"use strict";var r=n(76),a=n(2175),o=n(296);t.a=function(){var e=a.b.clpLabels;return Object(r.h)("cmp-clp")&&e.length>0&&e.some((function(e){return e.isLabelEnabled}))&&!Object(o.a)()}},3171:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.TXP=0]="TXP",e[e.CalendarCard=1]="CalendarCard",e[e.MeetingPoll=2]="MeetingPoll",e[e.Voting=3]="Voting",e[e.Reschedule=4]="Reschedule",e[e.Yammer=5]="Yammer"}(r||(r={}))},3246:function(e,t,n){"use strict";t.a=function(e,t){void 0===t&&(t=!0);var n=t?23:24;return e>=n?n:e}},3327:function(e,t,n){"use strict";var r=n(0),a=n(2301),o=n(3684),i=n(3443),c=n(2452),u=n(4139),s=n(3444),d=n(4140),l=n(4141),f=n(3685),b=n(118),m=n(76),v=n(2829),O=n(4142),p=n(1140),g=n(2904),I=n(4721),j=n(2830),h=n(964),w="x-ms-exchange-organization-ome-messagestate";function S(e){if(!Object(m.h)("rp-omeRevocation")||(null==e?void 0:e.ParentFolderId)&&e.ParentFolderId.Id!==Object(h.a)("sentitems"))return null;var t=Object(j.a)(e,null,w);return Object(I.a)(t)}var C=n(1715),P=n(982),A=n(1874),E=n(2453),R=n(2014),x=n(3599),y=n(2404),M=n(4683),N=n(3686),T=function(e){var t;return(null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.ErrorState)||0},_=n(3830),k=n(2700),L=n(1393),D=n(75),V=n(254),U=function(e,t){D.g.info("S/MIME: processing S/MIME message. isSmimeAdapterAlreadyUsable: "+Object(y.a)());var n=new V.a("RPProcessSmimeItem",{isCore:!0});return A.q.import().then((function(t){return t(e)})).then((function(){K(e,n,t)})).catch((function(){K(e,n,t)}))};function F(e,t,n,i,c,s){if(e.itemId==t.Id){var b=(null==t?void 0:t.Id)&&Object(P.b)().items.get(t.Id);e.itemViewState=function(e,t){return Object(r.__assign)(Object(r.__assign)({},Object(v.a)(e.Id,Object(u.a)())),{itemId:e.Id,isConversationItemPart:!1,attachmentWell:null,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,smartPillViewState:{smartPillBlockVisible:!1},hideSmartReplyFeedbackDialog:!0,ampViewState:Object(O.a)(t),hasMeetingPoll:Object(l.a)(t),omeMessageState:S(t)})}(t,b),e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!b,e.instrumentationContext=n,b&&(i.addCustomData(Object(d.b)(b,s,c)),g.h.import().then((function(e){e(b)})),Object(f.d)(b)?e.isUnsupportedItem=!0:(Object(o.a)(e.itemViewState,!1,{item:b}),Object(a.a)(e,b)))}}var B=function(e,t,n,r,a){return r?r(e):C.e.importAndExecute(e,n?"LoadItemPreviewPane":"LoadItemReadingPane",t,Object(y.a)(),a)},W=function(e,t,n,r,a){var o;return Object(L.a)(n)?E.a.import().then((function(){return Object(y.a)()&&Object(M.a)(n)?(o=!0,B(e,t,r,a)):n})).then((function(){return U(e,o)})):Promise.resolve()};function K(e,t,n){var r=Object(P.b)().items.get(null==e?void 0:e.Id);t.addCustomData({smimeInstallationStatus:R.a.installationStatus,smimeType:Object(_.a)(r),numAttachments:z(r),wasReloaded:n}),Object(k.a)(r)?t.end():t.endWithError("ClientError",new Error(T(r).toString()))}function z(e){var t;return null===(t=null==e?void 0:e.Attachments)||void 0===t?void 0:t.length}t.a=Object(b.d)("loadItemReadingPane",c.a.RPPerfLoadItemReadingPane)((function(e,t,n,r,a,o,u){var d=function(e,t){return{itemId:e.Id,itemViewState:null,isPrint:t,loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(p.b)(),isUnsupportedItem:!1,instrumentationContext:null,extendedCardViewState:null}}(e,r);Object(s.c)(),Object(i.a)(d),n&&n(d);var l=Object(V.q)((function(e){return e.eventName==c.a.RPPerfLoadItemReadingPane.name})),f=Object(P.b)().items.get(e.Id);!Object(m.h)("ring-dogfood")||r||a||Object(V.o)("RPMailStoreItemsCount",{count:Object(P.b)().items.size});var b=Object(M.a)(f),v=Object(L.a)(f);return v&&f.Smime&&!Object(k.a)(f)&&(f.Smime.ErrorState=0),f&&(f.NormalizedBody&&!b||Object(N.a)(f))?v&&!Object(k.a)(f)?(new V.a("RPProcessSmimeItem").addCustomData({wasItemReloaded:!1}),U(e,!1).then((function(){var n,o;return null===(o=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===o||o.call(n,"LIRP_SMIME"),F(d,e,t,l,r,a)}))):(F(d,e,t,l,r,a),Promise.resolve()):new Promise((function(e){return v&&b&&!Object(x.a)()?E.a.import().then(e):e()})).then((function(){var n,i;return null===(i=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===i||i.call(n,"LIRP_THEN"),function(e,t,n,r,a,o,i,c){return B(t,r,o,c,i).then((function(e){var a,i;return null===(i=null===(a=null==n?void 0:n.dp)||void 0===a?void 0:a.addCheckpoint)||void 0===i||i.call(a,"LI_THEN"),W(t,r,e,o,c)})).then((function(){var i,c;return null===(c=null===(i=null==n?void 0:n.dp)||void 0===i?void 0:i.addCheckpoint)||void 0===c||c.call(i,"LI_SMIME_THEN"),F(e,t,n,r,a,o)})).catch((function(t){return e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!0,Promise.reject(t)}))}(d,e,t,l,r,a,o,u)}))}))},3351:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s}));var r=n(2701),a=n(1214),o=n(284),i=Object(o.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.itemPart:null})),c=Object(o.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null})),u=Object(o.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.initiallySelectedItemPart)?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null})),s=Object(o.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e,t){var n=i(t),a=c(t);return n==e&&a==r.a.Item}))},3352:function(e,t,n){"use strict";var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.None=0]="None",e[e.Revocable=1]="Revocable",e[e.Expirable=2]="Expirable"}(r||(r={})),function(e){e[e.None=0]="None",e[e.SuccessOrNoChange=1]="SuccessOrNoChange",e[e.FailedOrMessageNotFound=2]="FailedOrMessageNotFound",e[e.PartialFailed=3]="PartialFailed"}(a||(a={}))},3443:function(e,t,n){"use strict";var r=n(3444),a=n(1110),o=n(76),i=n(284);t.a=Object(i.action)("setItemReadingPaneViewState")((function(e){Object(o.h)("rp-persistedReadingPaneTabs")?Object(r.a)(e):a.a.itemReadingPaneViewState=e}))},3444:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(1110),a=n(4),o=n(76),i=n(1101),c=n(2161),u=Object(a.mutatorAction)("addLoadedItemReadingPaneViewState",(function(e){if(Object(o.h)("rp-persistedReadingPaneTabs")){var t=e.itemId,n=Object(r.b)().loadedItemReadingPaneViewStates;n.has(t)||n.set(t,e)}})),s=Object(a.mutatorAction)("releaseOrphanedLoadedItemViewStates",(function(){if(Object(o.h)("rp-persistedReadingPaneTabs")){var e=Object(r.b)().loadedItemReadingPaneViewStates;e.forEach((function(t,n){Object(i.n)(n)||n==Object(c.a)()||e.delete(n)}))}})),d=Object(a.mutatorAction)("releaseLoadedItemViewState",(function(e){Object(o.h)("rp-persistedReadingPaneTabs")&&Object(r.b)().loadedItemReadingPaneViewStates.delete(e)}))},349:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(376),a=n(4),o=n(428),i=n(3),c={state:r.a.NotStarted,isPopoutV2:Object(i.a)(o.a)==o.b},u=Object(a.createStore)("popoutChild",c);u()},3599:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2014),a=n(2163);function o(){var e=Object(r.b)();return Object(a.k)(e.installationStatus)}},3652:function(e,t,n){"use strict";var r=n(0),a=n(6302),o=n(2452),i=n(4139),c=n(6035),u=n(1110),s=n(4140),d=n(4141),l=n(4795),f=n(6489),b=n(23),m=n(254),v=n(118),O=n(76),p=n(2829),g=n(4142),I=n(986),j=n(982);function h(e){var t=I.a.conversationItems.get(e);if(t){var n=function(e){var t,n,a,o,i={unreadItemCount:0,totalItemCount:0},c=j.a.conversations.get(e);try{for(var u=Object(r.__values)(c.conversationNodeIds),s=u.next();!s.done;s=u.next()){var d=s.value,l=j.a.conversationNodes.get(d);if(!l){i.totalItemCount=0;break}i.totalItemCount+=l.itemIds.length;try{for(var f=(a=void 0,Object(r.__values)(l.itemIds)),b=f.next();!b.done;b=f.next()){var m=b.value,v=j.a.items.get(m);if(!v){i.totalItemCount=0;break}i.unreadItemCount+=v.IsRead?0:1}}catch(e){a={error:e}}finally{try{b&&!b.done&&(o=f.return)&&o.call(f)}finally{if(a)throw a.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return i}(e);return t.globalItemIds.length!=n.totalItemCount||t.globalUnreadCount!=n.unreadItemCount}return!1}var w=n(1140),S=n(977),C=n(1715),P=n(284),A=n(2373);n.d(t,"a",(function(){return R}));var E=[];var R=Object(P.select)({conversationNodes:function(){return S.w.conversationNodes}})((function(e,t,n){var a;if(!t||!t.Id)return[null,null];var o=n.conversationNodes.get(t.Id),c=(a=Object(r.__read)(Object(A.a)(o),3))[0],u=a[1],s=a[2];if(!Object(A.c)(c,s,u))return[null,null];var l={isExpanded:!1,loadingState:{isLoading:!1,hasLoadFailed:!1}},b=function(e,t,n){return!e.IsRead&&t||e.IsDraft&&!n}(c,u,s),m={mailboxInfo:t.mailboxInfo,Id:c.ItemId.Id};return[Object(r.__assign)(Object(r.__assign)({},Object(p.a)(m.Id,Object(i.a)())),{conversationNodeId:t.Id,itemId:m.Id,isConversationItemPart:!0,isExpanded:b,isLocal:u,isDeleted:s,attachmentWell:null,quotedBodyViewState:l,isFossilizedTextExpanded:b,hideSmartReplyFeedbackDialog:!0,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,oofRollUpViewState:Object(f.b)(c.ItemClass),isInRollUp:!1,smartPillViewState:{smartPillBlockVisible:!1},ampViewState:Object(g.a)(c),hasMeetingPoll:Object(d.a)(c),omeMessageState:null}),c]}));t.b=Object(P.select)({readingPaneStore:function(){return u.a},conversationNodes:function(){return S.w.conversationNodes},conversations:function(){return S.d}})(Object(v.d)("loadConversationReadingPane",o.a.RPPerfLoadConversationReadingPane)((function(e,t,n,r,i,u){var d,f=Promise.resolve(),v=function(e,t,n,r,a){return{conversationId:e,conversationSubject:t,conversationCategories:n,initiallySelectedItemPart:null,itemIdToScrollTo:a,itemPartsMap:new b.ObservableMap({}),loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(w.b)(),unsupportedItemId:null,instrumentationContext:r,attachmentWell:null,calendarInlineComposeViewState:null,focusedItemPart:null,conversationNodeIdsInCollapsedItemsRollUp:[],nodeIdBundledWithSeeMoreMessages:null,extendedCardViewState:null}}(e,n,r,t,i);Object(O.h)("rp-persistedReadingPaneTabs")||(u.readingPaneStore.conversationReadingPaneViewState=v);var p=Object(S.s)(e.Id),g=Object(m.q)((function(e){return e.eventName==o.a.RPPerfLoadConversationReadingPane.name}));if(Object(O.h)("ring-dogfood")){var I=!1;E.includes(e.Id)?I=!0:E.push(e.Id),Object(m.o)("RPCacheStatus",{hasValidConversationCache:p,hasOpened:I,OpenedCount:E.length})}return Object(c.c)(),p&&(d="Valid",u.conversations.getAndTouch(e.Id),Object(l.a)(e.Id)||(Object(c.a)(v),Object(a.a)(e.Id))),p&&!h(e.Id)||(Object(c.a)(v),d=p?"Stale":"Not",f=C.d.importAndExecute(e,"LoadConversationReadingPane",g)),f.then((function(){var n,r;null===(r=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===r||r.call(n,"LCRP_POST"),g&&g.addCustomData(Object(s.a)(e.Id,d))}))})))},3684:function(e,t,n){"use strict";var r=n(0),a=n(4234),o=n(982),i=n(1556),c=n(284);t.a=Object(c.select)({item:function(e){return o.a.items.get(e.itemId)}})(Object(c.action)("initializeExtendedStateForItemViewState")((function(e,t,n){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(a.a)(e,n.item,t)];case 1:return r.sent(),n.item&&Object(i.q)(n.item.ItemClass)&&i.t.importAndExecute(e),[2]}}))}))})))},3685:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return p}));var r=n(962),a=n(982),o=n(964),i="IPM.Appointment",c="IPM.Contact",u="IPM.DistList",s="IPM.Task",d="calendar",l="contacts",f="tasks",b="inbox";function m(e){return e&&(g(e.ItemClass)||I(e.ItemClass)||j(e.ItemClass)||h(e.ItemClass))}function v(e){var t=a.a.conversations.get(e),n=a.a.conversationNodes.get(t&&t.conversationNodeIds[0]);if(n){var r=n.itemIds[0];if(m(a.a.items.get(r)))return r}return null}function O(e){var t=a.a.items.get(e);return g(t.ItemClass)?Object(o.a)(d):I(t.ItemClass)||j(t.ItemClass)?Object(o.a)(l):h(t.ItemClass)?Object(o.a)(f):Object(o.a)(b)}function p(e){var t="",n=r.d.folderTable.get(e);return n&&(t=Object(r.i)(n)),t}function g(e){return 0==e.indexOf(i)}function I(e){return 0==e.indexOf(c)}function j(e){return 0==e.indexOf(u)}function h(e){return 0==e.indexOf(s)}},3686:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1305);function a(e){return(null==e?void 0:e.ItemId)&&0===e.ItemId.Id.indexOf(r.m)}},3739:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("OnComposeLifecycleEvent",(function(e,t){return{viewState:e,event:t}}));t.a=a},376:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},3831:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(975),a=n(76),o=n(296);function i(){var e=Object(r.d)(r.a.AmpDeveloper);return Object(o.a)()&&Object(a.h)("rp-amp")&&e.enabled}},3924:function(e,t,n){"use strict";function r(e,t){return(null==e?void 0:e.extendedCardViewState)&&e.extendedCardViewState.cardType==t}function a(e){var t;return null===(t=null==e?void 0:e.extendedCardViewState)||void 0===t?void 0:t.coverOriginalContent}function o(e,t){return r(e,t)?e.extendedCardViewState.cardViewState:null}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},4139:function(e,t,n){"use strict";function r(){return["unsubscribeInfoBar","safetyBar","infoImportance","infoSensitivity","infoFlagStatus","irmInfoBar","infoMessageSubmitted","agendaMailFeedback","unauthenticatedSender","infoDelegate","infoMeetingAttendeeDoNotForward","infoSMIME","infoSmimeDecodeError","infoSmimeSigned","infoItemPartLoadFailure","infoLastUserAction","infoReadReceiptRequested","translateInfoBar","infoResend","infoPolicyTag","infoMessageApprovalAndVoting","nudged","nudgeFeedback","infoMessageClassification","infoCLPLabel","infoRevocation","externalMessage"]}n.d(t,"a",(function(){return r}))},4140:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var r=n(2036),a=n(1214),o=n(982),i=n(3246),c=n(1556),u=n(26),s=n(1393),d="Meeting",l="Message";function f(e,t){var n=0,u=0,s=0,d=0,l=0,f=Object(a.a)(e);if(f){var b=f.itemPartsMap;b.forEach((function(e){e.isExpanded&&d++;var t=o.a.items.get(e.itemId);t&&(t.IsRead||n++,t.IsDraft&&u++,Object(c.m)(t)&&s++)})),l=b.size}return{owa_1:v(),owa_2:Object(r.a)(),owa_3:Object(i.a)(l),owa_4:Object(i.a)(d),owa_5:Object(i.a)(n),owa_6:Object(i.a)(s),owa_7:Object(i.a)(u),owa_8:t}}function b(e,t,n){return{owa_1:v(),owa_2:m(e),owa_3:t,owa_4:n,owa_5:Object(s.a)(e)}}function m(e){return Object(c.m)(e)?d:l}function v(){return Object(u.a)().UserOptions.GlobalReadingPanePositionReact}},4141:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(10),a=n(76),o="findtime/vote?getrequesturl=";function i(e){if(!Object(a.h)("cal-mf-meetingPollCard")||!e)return!1;var t=null;return e.UniqueBody?t=e.UniqueBody.Value:e.NormalizedBody&&(t=e.NormalizedBody.Value),!Object(r.f)(t)&&t.indexOf(o)>-1}},4142:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4856);function a(e){return{preferAmp:!0,ampAvailability:Object(r.a)(e)}}},4143:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.None="none",e.AmpDisabled="ampDisabled",e.MessageUnsafe="messageUnsafe",e.SenderNotAllowed="sendNotAllowed",e.BrowserNotSupported="browserNotSupported",e.AmpNotValidated="ampNotValidated",e.AmpValidationFailed="ampValidationFailed",e.AmpValidated="ampValidated"}(r||(r={}))},4234:function(e,t,n){"use strict";var r=n(0),a=n(1523),o=n(1264),i=n(2451),c=n(2700),u=n(1393),s=n(284),d=n(1214),l=n(982),f=n(4301);function b(e,t){var n,r=l.a.items.get(t);if(r){var a=r.InternetMessageId,o=null===(n=Object(d.a)(e))||void 0===n?void 0:n.itemPartsMap.get(a);return o?o.attachmentWell:null}return null}var m=n(1454);t.a=Object(s.action)("initializeAttachmentsForItem")((function(e,t,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return!t||Object(u.a)(t)&&!function(e,t){if(!Object(i.a)(t))return!0;if(!e.isConversationItemPart&&Object(c.a)(t))return!0;return!1}(e,t)||!t.Attachments?[2]:e.attachmentWell?[3,2]:[4,o.j.import()];case 1:s=r.sent(),e.attachmentWell=s(!0,!1,""),r.label=2;case 2:return f.a.register(b),n?[4,o.q.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0)]:[3,4];case 3:return r.sent(),[3,6];case 4:return[4,o.n.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,!1,null,null,!!t.RightsManagementLicenseData,Object(u.a)(t))];case 5:r.sent(),r.label=6;case 6:return[4,a.g.import()];case 7:return d=r.sent(),d(t.Attachments).forEach((function(t){return Object(m.a)(e,t)})),[2]}}))}))}))},4276:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(115),a=new r.c((function(){return n.e(628).then(n.bind(null,6660))})),o=new r.a(a,(function(e){return e.loadWorkloadScenarioSettings}))},428:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o}));var r="popoutv2",a="1",o="_owa_projection_root"},4301:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(75),a=null,o={register:function(e){a=e},available:function(){return!!a},run:function(e,t){return a?a(e,t):(r.d("getAttachmentWellViewStateByItemIdHelper is not registered."),null)}}},452:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c}));var r,a=2,o=[window.location.origin];function i(e,t,n){var r={version:a,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function c(e){if(o.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&a==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow"}(r||(r={}))},4683:function(e,t,n){"use strict";var r=n(2451),a=n(2700),o=n(1393),i=n(3599),c=n(2404),u=function(){return!!Object(i.a)()&&!Object(c.a)()};t.a=function(e){return!Object(a.a)(e)&&!u()&&Object(o.a)(e)&&!Object(r.a)(e)}},4719:function(e,t,n){"use strict";function r(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.EmailAddress:null}n.d(t,"a",(function(){return r}))},4720:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("ampstore",{allowedSenders:[]});t.a=a()},4721:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3352),a=n(7);function o(e){if(e){var t={permissions:r.b.None,revoked:!1,expired:!1,revocationDate:null,revokedBy:null,responseState:r.a.None};try{var n=JSON.parse(e);if(1==n.Permissions&&(t.permissions=r.b.Revocable),2==n.Permissions&&(t.permissions=r.b.Expirable),t.revoked=n.IsRevoked,t.expired=n.IsExpired,n.RevocationDate){var o=Object(a.Rb)("UTC",n.RevocationDate);t.revocationDate=new Date(Object(a.Ab)(o))}t.revokedBy=n.RevokedBy}catch(e){return null}return t}return null}},4795:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1110),a=n(76);function o(e){return!(!Object(a.h)("rp-persistedReadingPaneTabs")||!e)&&Object(r.b)().loadedConversationReadingPaneViewStates.has(e)}},4856:function(e,t,n){"use strict";var r=n(10);var a=n(4719),o=n(3831),i=n(61),c=n(4143),u=n(4720),s=n(975);function d(e){if(!function(e){return e&&!Object(r.f)(e.AmpHtmlBody)}(e))return c.a.None;if(!Object(o.a)())return c.a.AmpDisabled;if(!function(e){return e&&!e.BlockStatus&&(!e.MessageSafety||!e.MessageSafety.MessageSafetyLevel||e.MessageSafety.MessageSafetyLevel<=2)}(e))return c.a.MessageUnsafe;var t=Object(a.a)(e);return null==t||!function(e){var t=Object(s.d)(s.a.AmpDeveloper);return t.enabled&&t.allowedSender.some((function(t){return l(t,e)}))}(t)&&!function(e){return u.a.allowedSenders&&u.a.allowedSenders.some((function(t){return l(t,e)}))}(t)?c.a.SenderNotAllowed:Object(i.e)()||Object(i.g)()?c.a.BrowserNotSupported:c.a.AmpNotValidated}function l(e,t){return e.toLowerCase()==t.toLowerCase()}n.d(t,"a",(function(){return d}))},4863:function(e,t,n){"use strict";var r=n(115),a=n(5524);function o(e){var t;return null===(t=a.a.usageSuggestions)||void 0===t?void 0:t.get(e)}n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o}));var i=new r.c((function(){return n.e(463).then(n.bind(null,15657))})),c=new r.a(i,(function(e){return e.initializePersonalizationSuggestions})),u=new r.a(i,(function(e){return e.postPersonalizationSuggestionFeedback})),s=new r.a(i,(function(e){return e.postPersonalizationUsageSignals}))},4894:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1601);function a(e){e?Object(r.r)(e,"Route"):Object(r.p)("Route")}},491:function(e,t,n){"use strict";var r=n(115),a=n(601),o=n(495),i=n(42),c=n(1),u=n(494),s=n(349),d=n(76),l=n(376),f=n(919),b=n(724),m=Object(i.a)((function(e){c.useEffect((function(){Object(d.h)("rp-popoutsDebug")||v()}),[]);return c.createElement("div",{className:b.view},Object(s.a)().state==l.a.Loading?c.createElement("span",null,c.createElement(f.a,null),e.loadingString):c.createElement("button",{onClick:v},"Get Data"))}));function v(){Object(u.a)()}var O=n(106);function p(e,t,n,r){var a="";if(r)a="readimid/",a+=encodeURIComponent(btoa(r));else{if(a=n?"readconv/":"read/",e&&e.type==O.a.GroupMailbox){a+="group/";var o=e.mailboxSmtpAddress.split("@");a+=o[1]+"/"+o[0]+"/"}a+=encodeURIComponent(n||t)}return a}n.d(t,"g",(function(){return I})),n.d(t,"c",(function(){return a.a})),n.d(t,"h",(function(){return o.a})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return s.a})),n.d(t,"d",(function(){return u.b})),n.d(t,"e",(function(){return p}));var g=new r.c((function(){return n.e(484).then(n.bind(null,15626))})),I=new r.b(g,(function(e){return e.bootPopout}))},494:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r,a=n(0),o=n(495),i=n(452),c=n(376),u=n(349),s=!1;function d(){Object(o.a)(c.a.Loading),r?r():s=!0}function l(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return s?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(u.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var a=Object(i.b)(n);if(a&&a.type==i.a.SetData){window.removeEventListener("message",r);var o=void 0;try{o=e?e(a.serializedData):JSON.parse(a.serializedData)}catch(e){}t(o)}};window.addEventListener("message",r);try{var a=window.opener;Object(i.c)(a,i.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},495:function(e,t,n){"use strict";var r=n(349),a=n(4);t.a=Object(a.mutatorAction)("setPopoutChildState",(function(e){Object(r.a)().state=e}))},5046:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(982);function a(e){var t=r.a.conversations.get(e);return null==t?void 0:t.canLoadMore}},5506:function(e,t,n){"use strict";var r=n(2452),a=n(118);t.a=Object(a.d)("expandCollapsedItemsRollUp",r.a.RPCountExpCollItemsRollUp)((function(e,t){void 0===t&&(t=!1),e.conversationNodeIdsInCollapsedItemsRollUp=[]}))},5524:function(e,t,n){"use strict";var r=n(23),a=n(4),o={usageSuggestions:new r.ObservableMap},i=Object(a.createStore)("personalization",o)();t.a=i},601:function(e,t,n){"use strict";var r=n(0),a=n(49),o=600,i=800,c=8,u=25,s={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},d=-1;function l(e,t,n){try{t=function(e){var t=u*(1+(d=(d+1)%c)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),o),width:Math.max(8*Math.pow(window.innerWidth,2/3),i)};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s),n),e)}(t);var l=(n||window).open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(a.e)()||Object(a.f)())&&l.moveTo(t.left,t.top),l}catch(e){return null}}var f=n(2),b=n(573),m=n(428),v="version";var O=n(118),p=n(491);t.a=Object(O.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,a,o){return[(t||"").split("/")[0],o]}})((function(e,t,n,r,o,i,c){var u=function(e){var t=null,n=void 0,r=null,o=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,(Object(a.e)()||Object(a.h)()||Object(a.f)())&&(t=e.projectionTabId||null),r=e.projectionTargetWindow,o=e.projectionParentWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r,projectionParentWindow:o}}(n),s=u.deeplinkCallback,d=u.projectionTabId,O=u.projectionTargetWindow,g=u.projectionParentWindow,I=d?"about:blank":function(e,t,n,r){var a;void 0===r&&(r={});var o=((a={})[v]=Object(f.l)(),a[m.a]=m.b,a);return Object.keys(r).map((function(e){o[e]=r[e]})),Object(b.q)(e,t,n,o)}(e,t,o,c),j=O||l(I,r,g);j&&p.g.import().then((function(t){return t(e,j,d,s)}))}))},6032:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("initializeExtendedCardForConversationReadingPane",(function(e,t){return{conversationViewState:e,loadedItemParts:t}}))},6033:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("tryInitializeShouldShowCLPLabel",(function(e){return{conversationViewState:e}}))},6034:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6488);function a(e,t){var n=t?t.Value:"",a=Object(r.a)(e);return a||n}},6035:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(1110),a=n(4),o=n(76),i=n(1101),c=n(2161),u=Object(a.mutatorAction)("addLoadedConversationReadingPaneViewState",(function(e){if(Object(o.h)("rp-persistedReadingPaneTabs")){var t=e.conversationId.Id,n=Object(r.b)().loadedConversationReadingPaneViewStates;n.has(t)||n.set(t,e)}})),s=Object(a.mutatorAction)("releaseOrphanedLoadedConversationViewStates",(function(){if(Object(o.h)("rp-persistedReadingPaneTabs")){var e=Object(r.b)().loadedConversationReadingPaneViewStates;e.forEach((function(t,n){Object(i.n)(n)||n==Object(c.a)()||e.delete(n)}))}})),d=Object(a.mutatorAction)("releaseLoadedConversationViewState",(function(e){Object(o.h)("rp-persistedReadingPaneTabs")&&Object(r.b)().loadedConversationReadingPaneViewStates.delete(e)}))},6055:function(e){e.exports=JSON.parse('{"e":"m$a","a":"n$a","k":"p$a","l":"q$a","p":"s$a","m":"t$a","j":"u$a","h":"v$a","o":"w$a","n":"x$a","g":"y$a","i":"z$a","f":"A$a","d":"B$a","b":"C$a","c":"D$a"}')},6302:function(e,t,n){"use strict";var r=n(0),a=n(6667),o=n(6032),i=n(3684),c=n(3652),u=n(2452),s=n(2828),d=n(2036),l=n(254),f=n(284),b=n(982),m=n(1556),v=n(3924),O=n(3171),p=5,g=3,I=Object(f.action)("markConversationCollapsedItemsRollUp")((function(e,t,n){Object(v.b)(e,O.a.CalendarCard)?function(e,t){for(var n=t.length,r=[],a=Object(d.a)()?0:n-1,o=Object(d.a)()?1:-1,i=a;i<=n-1&&i>=0&&!t[i].isExpanded;i+=o)j(t[i])&&r.push(t[i].conversationNodeId);r.length>1&&(e.conversationNodeIdsInCollapsedItemsRollUp=r)}(e,t):function(e,t,n){var r=t.length;if(r<p)return;var a=[],o=Object(d.a)()?1:r-2,i=Object(d.a)()?1:-1;n&&(o-=i);for(var c=o;c<=r-1&&c>=0&&!t[c].isExpanded;c+=i)a.push(t[c].conversationNodeId);if(a.length>=g){if(a.pop(),e.conversationNodeIdsInCollapsedItemsRollUp=a,!n){var f=Object(d.a)()?0:r-1;e.nodeIdBundledWithSeeMoreMessages=t[f].conversationNodeId}Object(l.o)("RPCountRenderCollItemsRollUp",[Object(u.b)(Object(s.a)(e))])}}(e,t,n)}));function j(e){var t=b.a.items.get(e.itemId);return!(!t||!Object(m.m)(t))&&t.IsOutOfDate}var h=n(6486),w=n(6033),S=n(2701),C=n(1214),P=n(6034),A=n(961);var E=n(10);var R=n(3685),x=n(1552),y=n(3170),M=n(2373);function N(e,t,n,a){var u=[],s=t.itemPartsMap,d=t.itemIdToScrollTo,l=null;if(e.conversationNodeIds){e.conversationNodeIds.forEach((function(n){var a=Object(r.__read)(Object(c.a)(t.conversationId.Id,{mailboxInfo:e.conversationId.mailboxInfo,Id:n}),1)[0];a&&s.set(n,a)})),Object(y.a)()&&Object(w.a)(t),Object(h.a)(s,n,e.conversationNodeIds,!1);var f=!1;e.conversationNodeIds.forEach((function(e){var t=s.get(e);if(t&&!t.isInRollUp){u.push(t);var n=a.get(t.itemId);(function(e){var t=Object(A.C)();if(null==t?void 0:t.highlightTerms){var n=Object(P.a)(e.RightsManagementLicenseData,e.UniqueBody),r=document.createElement("div");return r.innerHTML=n,t.highlightTerms.some((function(e){return r.innerText.toLowerCase().indexOf(e)>=0}))}return!1})(n)&&(t.isExpanded=!0),f=f||t.isExpanded&&!n.IsDraft}}));var p="ChronologicalNewestOnBottom"==e.conversationSortOrder;if(function(e,t,n,r){var a=n.length;if(0!=a&&!t){for(var o=null,i=e?a-1:0,c=i,u=e?-1:1,s=function(e){var t=r.get(e);return Object(M.a)(t)[1]};c>=0&&c<a;){var d=n[c],l=d.oofRollUpViewState.oofReplyNodeIds.some(s);if(!d.isExpanded&&(d.isLocal||l)){o=d;break}c+=u}o||(o=n[i]),o.isExpanded=!0,o.isFossilizedTextExpanded=!0}}(p,f,u,n),l=function(e,t){for(var n=e.length,r=0;r<n;r++){var a=e[r],o=a.itemId;if(t){if(o==t)return a.isExpanded=!0,{itemPart:a,focusedItemArea:S.a.Item}}else{if(a.isExpanded)return{itemPart:a,focusedItemArea:S.a.Item};if(a.oofRollUpViewState.isOofRollUpExpanded)return{itemPart:a,focusedItemArea:S.a.Oof}}}return null}(u,d),u.forEach((function(e){e.isExpanded&&Object(i.a)(e)})),Object(o.a)(t,u),Object(v.b)(t,O.a.CalendarCard)&&function(e){var t,n=e.length;if(0!=n)for(var r=0;r<n;r++){var a=e[r],o=a?a.itemId:null,i=b.a.items.get(o),c=Object(A.C)();if(i&&Object(m.m)(i)&&(null==c||!c.highlightTerms))if(i.IsRead||i.IsOutOfDate)a.isExpanded=!1,a.isFossilizedTextExpanded=!1;else if(Object(m.q)(i.ItemClass)){var u=i;"NewMeetingRequest"==u.MeetingRequestType&&!Object(E.f)(u.Preview)||(null===(t=u.ChangeHighlights)||void 0===t?void 0:t.HasBodyChanged)?a.isExpanded=!0:(a.isExpanded=!1,a.isFossilizedTextExpanded=!1)}else!Object(m.r)(i.ItemClass)&&!Object(m.l)(i.ItemClass)||Object(E.f)(i.Preview)?(a.isExpanded=!1,a.isFossilizedTextExpanded=!1):a.isExpanded=!0}}(u),u.length){var g=p?0:e.conversationNodeIds.length-1,j=e.conversationNodeIds[g],C=s.has(j);e.canLoadMore&&(t.nodeIdBundledWithSeeMoreMessages=j),Object(x.a)(t.conversationId.Id)||I(t,u,e.canLoadMore&&!C)}}return l}t.a=Object(f.select)({loadedConversation:function(e){return b.a.conversations.get(e)},conversationNodes:function(){return b.a.conversationNodes},conversationReadingPaneState:function(e){return Object(C.a)(e)},items:function(){return b.a.items}})(Object(f.action)("firstLoadConversationReadingPane")((function(e,t){if(t.conversationReadingPaneState.conversationId.Id==e){var n=t.conversationReadingPaneState;if(n.loadingState.isLoading=!1,n.loadingState.hasLoadFailed=t.loadedConversation.loadingState.hasLoadFailed,!n.loadingState.hasLoadFailed){var r=Object(R.c)(e);if(n.unsupportedItemId=r,!r){var o=N(t.loadedConversation,n,t.conversationNodes,t.items);n.initiallySelectedItemPart=n.focusedItemPart=o,Object(a.a)(n)}}}})))},6486:function(e,t,n){"use strict";var r=n(6487),a=n(284);t.a=Object(a.action)("tryAddOofNodesInRollUp")((function(e,t,n,a){a&&e.forEach((function(e){e.oofRollUpViewState.oofReplyNodeIds=[]})),n.forEach((function(n){var a=e.get(n);if(a&&a.oofRollUpViewState.isOofItem){a.isInRollUp=!1;var o=Object(r.a)(n,e,t);o&&!o.isInRollUp&&(a.isInRollUp=!0,o.oofRollUpViewState.oofReplyNodeIds.push(n))}}))}))},6487:function(e,t,n){"use strict";function r(e,t,n){var r=n.get(e);return r?t.get(r.parentInternetMessageId):null}n.d(t,"a",(function(){return r}))},6488:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(7344),a=n(10);function o(e){var t;if((null==e?void 0:e.RightsManagedMessageDecryptionStatus)&&0!=e.RightsManagedMessageDecryptionStatus)switch(e.RightsManagedMessageDecryptionStatus){case-2147160052:case-2147160012:case-2147160011:t=Object(a.c)(Object(a.b)(r.d),i());break;case-2147160010:t=Object(a.b)(r.a);break;case-2147168507:t=Object(a.c)(Object(a.b)(r.l),i());break;case-2147160014:t=Object(a.b)(r.j);break;case-2147160054:case-2147160055:t=Object(a.b)(r.h);break;case-2147160064:case-2147160013:t=Object(a.b)(r.g);break;case-2147160051:t=Object(a.b)(r.c);break;case-2147160060:t=Object(a.b)(r.k);break;case-2147160009:default:t=Object(a.c)(Object(a.b)(r.i),e.RightsManagedMessageDecryptionStatus)}return t}function i(){var e=Object(a.c)('<a href="{0}" target="_blank">{1}</a>',Object(a.b)(r.f),Object(a.b)(r.e));return Object(a.c)(Object(a.b)(r.b),e)}},6489:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r=/ipm.note.rules.ooftemplate.microsoft/i;function a(e){return{isOofItem:r.test(e),oofReplyNodeIds:[],isOofRollUpExpanded:!1}}},6495:function(e,t,n){"use strict";var r=n(5506),a=n(2452),o=n(1214),i=n(2828),c=n(254),u=n(118),s=n(1715),d=n(982),l=n(3246),f=n(284);t.a=Object(u.d)("loadMore",a.a.RPCountLoadMore)(Object(f.select)({conversations:function(){return d.a.conversations},conversationReadingPaneViewState:function(e){return Object(o.a)(e.Id)}})((function(e,t){if(e&&t.conversations.has(e.Id)){var n=t.conversations.get(e.Id);n.isLoadMoreInProgress=!0,n.maxItemsToReturn=n.maxItemsToReturn+s.a,n.syncState="";var a=Object(c.q)();return a&&a.addCustomData([(o=n.maxItemsToReturn,u=Math.ceil((o-20)/10),Object(l.a)(u))]),Object(i.b)(t.conversationReadingPaneViewState)&&Object(r.a)(t.conversationReadingPaneViewState,!0),s.d.importAndExecute(e,"LoadMore")}var o,u;return Promise.resolve()})))},6517:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1199),a=n(961),o=n(1186),i=n(1378);function c(e){var t=Object(o.a)(),n=Object(a.A)([e],t)[0];t.rowKeys.includes(n)&&Object(r.r)(t,n,!0,i.a.RouteHandler)}},6667:function(e,t,n){"use strict";var r=n(0),a=n(4234),o=n(982);function i(e,t){if(e.itemPartsMap.size<=1)return!1;if(function(e){if(!e)return!1;var t=o.a.conversations.get(e.conversationId.Id);return null==t?void 0:t.canLoadMore}(e))return!0;for(var n=Object(r.__spread)(e.itemPartsMap.keys()),a=0;a<n.length;a++){var i=e.itemPartsMap.get(n[a]);if(i){var c=t.get(i.itemId);if(c&&c.Attachments)return!0}}return!1}var c=n(2036),u=n(1264),s=n(1914),d=n(284);t.a=Object(d.action)("initializeAttachmentsForConversationWell")(Object(d.select)({mailStoreItems:function(){return o.a.items}})((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,d,l,f,b,m,v,O;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return i(e,t.mailStoreItems)?e.attachmentWell?[3,4]:[4,s.c.importAndExecute(e.conversationId)]:[3,11];case 1:return n=r.__read.apply(void 0,[p.sent(),3]),o=n[0],d=n[1],l=n[2],[4,u.l.import()];case 2:return f=p.sent(),e.attachmentWell=f(d,l),[4,u.n.importAndExecute(o,e.conversationId.mailboxInfo,e.attachmentWell,!0,!1)];case 3:p.sent(),p.label=4;case 4:b=Object(r.__spread)(e.itemPartsMap.keys()),m=0,p.label=5;case 5:return m<b.length?(v=e.itemPartsMap.get(b[m]))&&(O=t.mailStoreItems.get(v.itemId))?[4,Object(a.a)(v,O,!1)]:[3,8]:[3,9];case 6:return p.sent(),[4,u.o.importAndExecute(v.attachmentWell,e.attachmentWell,Object(r.__assign)(Object(r.__assign)({},O.ItemId),{mailboxInfo:O.MailboxInfo}),O.DateTimeReceived)];case 7:p.sent(),p.label=8;case 8:return m++,[3,5];case 9:return[4,u.s.importAndExecute(e.attachmentWell,Object(c.a)())];case 10:p.sent(),p.label=11;case 11:return[2]}}))}))})))},6723:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(115),a=new r.c((function(){return Promise.all([n.e(0),n.e(717),n.e(362)]).then(n.bind(null,8286))})),o=new r.a(a,(function(e){return e.subscribeToBulkActionNotification})),i=new r.a(a,(function(e){return e.findBulkActionItemAction}))},724:function(e,t,n){var r=n(725),a=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},725:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},7343:function(e,t,n){"use strict";var r=n(0),a=n(3652),o=n(3327),i=n(3443),c=n(1332),u=n(1157),s=n(2008),d=n(284),l=n(961);t.a=Object(d.select)({composeViewState:function(){return u.a.viewStates.get(u.a.primaryComposeId)},conversationItems:function(){return l.T.conversationItems}})(Object(d.action)("reloadReadingPane")((function(e){var t,n,u=Object(l.C)(),d=u?Object(r.__spread)(u.selectedRowKeys.keys()):[];if(1==d.length){var f=l.b.getRowClientItemId(d[0],u),b=Object(s.a)(d,u)[0];switch(u.tableQuery.listViewType){case 0:var m=e.conversationItems.get(f.Id);(null===(t=e.composeViewState)||void 0===t?void 0:t.isInlineCompose)?c.r.importAndExecute(e.composeViewState).then((function(){Object(a.b)(f,b,m.subject)})):Object(a.b)(f,b,m.subject);break;case 1:(null===(n=e.composeViewState)||void 0===n?void 0:n.isInlineCompose)?c.r.importAndExecute(e.composeViewState).then((function(){Object(o.a)(f,b,i.a)})):Object(o.a)(f,b,i.a)}}})))},7344:function(e){e.exports=JSON.parse('{"d":"P5b","a":"Q5b","l":"R5b","j":"S5b","h":"T5b","g":"U5b","c":"V5b","k":"W5b","i":"X5b","f":"Y5b","e":"Z5b","b":"_5b"}')},7400:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("ON_CONVERSATION_OPTION_SAVED");t.a=a},8014:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",(function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}}))},8068:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{selectionDirection:e,tableView:t,mailListItemSelectionSource:n,shouldSelect:r}}))},8069:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_KEYBOARD_TOGGLE_SELECT",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}}))},8070:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n,mailListItemSelectionSource:r}}))},9171:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ITEM_PART_SELECTED",(function(e,t){return{conversationNodeId:e,conversationId:t}}))},9301:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("CONFIRM_TIMEZONE")},9302:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(4),a=n(6055),o=n(10),i=n(26),c=Object(r.action)("SEND_AN_EMAIL",(function(){return{taskSendEmailSubject:Object(o.c)(Object(o.b)(a.o),Object(i.a)().SessionSettings.UserEmailAddress),taskSendEmailBody:Object(o.c)(Object(o.b)(a.n),Object(i.a)().SessionSettings.UserEmailAddress)}}))},9303:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("ADD_STORAGE_ACCOUNT")},9304:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("SHOW_PERSONALIZATION_MODAL")},9306:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("COMPLETE_SEND_AN_EMAIL")},9307:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("COMPLETE_PERSONALIZATION")},9324:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4894),a=n(6517);function o(e,t){Object(r.a)(e),Object(a.a)(t)}},975:function(e,t,n){"use strict";var r=n(115),a=n(1281),o=n(1004),i=n(4),c=[o.a.SurfaceActions];Object(i.orchestrator)(a.a,(function(e){var t=e.defaultOptions;c.forEach((function(e){t[e]&&Object(o.f)(Number(e),t[e])}))}));var u=n(1038);n.d(t,"e",(function(){return d})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return b})),n.d(t,"c",(function(){return u.a})),n.d(t,"d",(function(){return o.d})),n.d(t,"b",(function(){return o.b})),n.d(t,"a",(function(){return o.a}));var s=new r.c((function(){return n.e(448).then(n.bind(null,15677))})),d=new r.a(s,(function(e){return e.createOrUpdateOptionsForFeature})),l=new r.a(s,(function(e){return e.updateAddinPinStatus})),f=new r.b(s,(function(e){return e.getServerOptionsForFeature})),b=new r.a(s,(function(e){return e.loadOptions}))}}]);
//# sourceMappingURL=owa.MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFunctionalBoot.js'] = (new Date()).getTime();