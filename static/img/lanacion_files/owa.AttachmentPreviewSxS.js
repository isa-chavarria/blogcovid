self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentPreviewSxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[138],{1005:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1148);function a(e){return Object(r.a)().attachments.get(e.Id)}},1011:function(e,t,n){"use strict";function r(e){return t=e||"",(n=i.exec(t))&&n.length>1&&a[n[1].toLowerCase()];var t,n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},i=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){var t="";return Object.entries(a).forEach((function(n){n[1]===e&&(t=n[0])})),t}},1029:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},e)}},1034:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return c}));var r="POST",a="cors",i="GET",o="PUT",c="PATCH"},1075:function(e,t,n){"use strict";var r=n(115),a=n(1142),i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return i}));var o=new r.c((function(){return Promise.all([n.e(726),n.e(433)]).then(n.bind(null,15578))})),c=new r.a(o,(function(e){return e.subscribe})),u=new r.a(o,(function(e){return e.unsubscribe})),s=new r.b(o,(function(e){return e.getChannelId})),d=(new r.b(o,(function(e){return e.getChannelReady})),new r.a(o,(function(e){return e.setup}))),l=new r.a(o,(function(e){return e.initializeNotificationManager})),f=new r.b(o,(function(e){return e.getNotificationEmitter}));a.a},1084:function(e,t,n){"use strict";var r=n(994),a=n(980);function i(e){return e.map((function(e){return{fileType:r.a.Uri,name:e.name,type:Object(a.b)(e.url)||"",size:0,uri:e.url}}))}var o=n(75);function c(e,t,n){if(e.length!=t.length)return o.d("The sizes of subjects and latestItemIds are different"),null;for(var a=[],i=0;i<e.length;i++){var c={fileType:r.a.MailItem,name:e[i],size:(null==n?void 0:n[i])||0,itemId:t[i]};a.push(c)}return a}function u(e,t,n){var a=[],i={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return a.push(i),a}function s(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var a=e[n],i={fileType:r.a.Local,name:a.name,size:a.size,type:a.type,fileObject:a};t.push(i)}return t}function d(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],a={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(a)}return t}function l(e){var t,n;return null===e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function f(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var v={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function b(e){switch(e?e.toLowerCase():null){case v.ONE_DRIVE_PRO.toLowerCase():return 0;case v.GDRIVE.toLowerCase():return 5;case v.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case v.DROPBOX.toLowerCase():return 2;case v.BOX.toLowerCase():return 3;case v.WOPI_BOX.toLowerCase():return 7;case v.WOPI_EGNYTE.toLowerCase():return 8;case v.MAILBOX.toLowerCase():return 4;case v.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return r.a}))},1093:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(979),a=n(1011),i=n(61),o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function u(e,t,n){return void 0===n&&(n=!0),s(Object(r.a)(e)||Object(a.a)(t),n)}function s(e,t){return void 0===t&&(t=!0),!!e&&(o.indexOf(e.toLowerCase())>=0||t&&c.indexOf(e.toLowerCase())>=0&&(Object(i.e)()||Object(i.d)()||Object(i.h)()||Object(i.g)()&&!Object(i.l)()))}},1110:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(0),a=n(23),i=n(76),o=n(1390),c=n(4),u={conversationReadingPaneViewState:null,loadedItemReadingPaneViewStates:new a.ObservableMap({}),loadedConversationReadingPaneViewStates:new a.ObservableMap({}),itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsId:null},s=Object(c.createStore)("readingpane",u),d=s();o.a.registerReference((function(){var e,t;return Object(i.h)("rp-persistedReadingPaneTabs")?Object(r.__spread)(d.loadedConversationReadingPaneViewStates.keys()):null===(t=null===(e=d.conversationReadingPaneViewState)||void 0===e?void 0:e.conversationId)||void 0===t?void 0:t.Id})),t.a=d},1129:function(e,t,n){"use strict";var r=n(2313),a=n(1747),i=n(2423),o=n(284);t.a=Object(o.action)("setOngoingActionAndActionMessage")((function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(i.a)(e)?Object(a.a)(e,!0):Object(a.a)(e,!1)}))},1181:function(e,t,n){"use strict";var r=n(1034),a=n(1371);function i(e){var t;try{t=btoa(e)}catch(n){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}n.d(t,"d",(function(){return r.d})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"e",(function(){return r.e})),n.d(t,"c",(function(){return r.c})),n.d(t,"f",(function(){return a.a})),n.d(t,"g",(function(){return i}))},1214:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1110),a=n(76),i=n(2056);function o(e){return Object(a.h)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedConversationReadingPaneViewStates.get(e||(Object(r.b)().sxsId?Object(r.b)().sxsId:Object(i.a)())):Object(r.b)().conversationReadingPaneViewState}},1272:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1241);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},1278:function(e,t,n){var r=n(1394),a=36e5,i=6e4,o=2,c=/[T ]/,u=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],v=/^-(\d{2})$/,b=/^-?(\d{3})$/,p=/^-?(\d{2})-?(\d{2})$/,m=/^-?W(\d{2})$/,h=/^-?W(\d{2})-?(\d{1})$/,w=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/([Z+-].*)$/,j=/^(Z)$/,S=/^([+-])(\d{2})$/,_=/^([+-])(\d{2}):?(\d{2})$/;function C(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var P=function(e){var t,n={},r=e.split(c);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var a=I.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),T=function(e,t){var n,r=d[t],a=f[t];if(n=l.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=s.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(P.date,n),y=T.year,x=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=v.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=b.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=p.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=m.exec(e))return i=parseInt(n[1],10)-1,C(t,i);if(n=h.exec(e)){i=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return C(t,i,u)}return null}(T.restDateString,y);if(x){var A,E=x.getTime(),R=0;return P.time&&(R=function(e){var t,n,r;if(t=w.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=O.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=g.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(P.time)),P.timezone?A=function(e){var t,n;if(t=j.exec(e))return 0;if(t=S.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=_.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(P.timezone):(A=new Date(E+R).getTimezoneOffset(),A=new Date(E+R+A*i).getTimezoneOffset()),new Date(E+R+A*i)}return new Date(e)}},1288:function(e,t,n){"use strict";var r=n(0),a=n(1791),i=n.n(a),o=n(10),c=n(296),u=n(715),s=n(289),d=n(25);function l(e){return Object(r.__assign)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=l(e)),Object(d.a)("GetAccessTokenforDataProvider",e,t)}function v(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=l({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),i=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(o=new Headers).append("X-OWA-ActionName",i),[4,f(a,{headers:o,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(c=r.sent()).json()];case 2:return[2,{token:r.sent(),response:c}]}}))}))}var b="onedrive_implicit.access",p="Bearer ",m=n(76),h=function(e,t,n){return Object(r.__assign)({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},w=function(e){return"TokenRetrievalError"===e._typeSpec},O=[],g={},I=1,j=30,S="",_="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function C(e){g[e]=null}function P(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,v(e,t,n)];case 1:return a=r.sent(),function(e,t,n){O=O.filter((function(e){return e!==t}));var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var a="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,i=n.response.headers.get("x-tokenresult"),o=null!=i&&i.indexOf(_)>0;throw h(new Error(a),r.TokenResultCode,o)}var c=g[e]||{};c[t]=r,g[e]=c}(e,t,a),[2,a.token]}}))}))}function T(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(r.__generator)(this,(function(r){return a=S,0===e&&n&&(i=Object(s.parse)(n),a=Object(o.c)("{0}//{1}/",i.protocol,i.hostname)),Object(m.h)("doc-attachment-testAuthFallback")?[2,""]:[2,x(e,a,t,null)]}))}))}function y(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return[2,x(0,e,t,n)]}))}))}function x(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n||!function(e,t){var n=g[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var a=new Date(r.AccessTokenExpiry),o=i()(new Date(Date.now()),I);return null!=a&&o<a}(e,t)?[3,1]:(o=g[e],c=o[t],i()(new Date(Date.now()),j)>new Date(c.AccessTokenExpiry)&&-1===O.indexOf(t)&&(O.push(t),P(e,t,a)),[2,c.AccessToken]);case 1:return[4,P(e,t,a)];case 2:return[2,(c=r.sent()).AccessToken]}}))}))}function A(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(c.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(b)]:[3,2];case 1:return a=r.sent(),[3,4];case 2:return[4,T(e,t,n)];case 3:a=r.sent(),r.label=4;case 4:return[2,p+a]}}))}))}n.d(t,"d",(function(){return A})),n.d(t,"c",(function(){return T})),n.d(t,"e",(function(){return y})),n.d(t,"b",(function(){return C})),n.d(t,"f",(function(){return w})),n.d(t,"a",(function(){return p}))},1301:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u}));var r=600,a=600,i=650,o=1/2.89*100,c=420,u=420/1300*100},1342:function(e){e.exports=JSON.parse('{"b":"Yia","d":"Zia","c":"_ia","a":"$ia"}')},1344:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},1346:function(e,t,n){"use strict";var r=n(0),a=n(1937),i=n(1764),o=n(1129),c={},u=function(){function e(e,t,n){var r=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var e=r.getActionCompletePercent();e<=r.maxPercent?(r.updatePropertyHandler(e),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout((function(){return e.updatePropertyHandler(1.1)}),500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function s(e,t){var n=c[e.Id];n&&(t?n.complete():n.abort(),delete c[e.Id])}function d(e,t,n,r){var a=new u(e,t,n);c[r.Id]=a,a.start()}var l=n(2873),f=n(4);Object(f.orchestrator)(a.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:a=e.attachment,Object(o.a)(a,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.a)(null,null,e.attachment.attachmentId.Id)];case 2:return t=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=t&&"Success"===t.ResponseClass?14:15,function(e,t,n,r,a){s(e,!0),Object(i.a)(n,a),Object(o.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7),[2]}var a}))}))}));var v=n(1089),b=n(2204);function p(e){return Object(r.__assign)({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}var m=n(25);function h(e,t,n,r,a){var i,o,c=function(e,t,n,r,a){return p({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:a})}(e,t,n,r,a);return void 0===(i={requestObject:c}).requestObject||i.requestObject.__type||(i.requestObject=p(i.requestObject)),Object(m.a)("ConvertLocalToRefAttachment",i,o)}var w=n(254),O=n(1005),g=n(1623),I=n(1075),j=n(284),S={},_=Object(j.action)("convertClassicToCloudy")((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=new w.a("AttachmentConvertClassicToCloudy"),function(e){Object(o.a)(e,5,8)}(e),i=function(t){if(P(e,t.ResultCode),T(a,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(t){P(e,1),n(!1,null),T(a,e.attachmentId,1,t)},[4,C(e.attachmentId,t,i,c)];case 1:return r.sent(),[2]}}))}))}));function C(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,c,u,s,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return[4,Object(g.a)(n)];case 1:i=r.__read.apply(void 0,[l.sent(),4]),o=i[0],c=i[1],u=i[2],s=i[3],S[e.Id]=o,l.label=2;case 2:return l.trys.push([2,4,,5]),[4,h(e.Id,t,o,s,o)];case 3:return l.sent(),[3,5];case 4:return d=l.sent(),a(d.message),I.g.importAndExecute(c,u),[3,5];case 5:return[2]}}))}))}function P(e,t){switch(t){case 0:break;case 11:Object(o.a)(e,0,0);break;default:Object(o.a)(e,0,9)}delete S[e.attachmentId.Id]}function T(e,t,n,r){var a=Object(O.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}var y={name:"CancelConvertClassicToCloudy"},x={name:"CancelConvertCloudyToClassic"};function A(e){return Object(r.__assign)({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}function E(e){var t,n,r=function(e){return A({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=A(t)),Object(m.a)("CancelConvertLocalToRefAttachment",t,n)}var R=n(118),D=Object(R.d)("cancelConvertClassicToCloudy",y)((function(e){var t,n=(t=e.attachmentId.Id,S[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(o.a)(e,5,10),E(n)})),k=n(1508),M=Object(j.action)("setActionCompletePercent")((function(e,t){e.actionCompletePercent=t})),N=n(2201),L=n(1830),U=(n(1747),n(1443)),F=n(1882),W=n(1077),V=n(2103),B=n(2556),G=n(2863),H=n(1272),z=Object(j.action)("updateAttachment")((function(e,t,n,a,i){Object(B.a)(e.attachmentId);var c=Object(r.__assign)(Object(r.__assign)({},a.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=c,a.Name&&(n.Name=a.Name),a.Size&&(n.Size=a.Size),a.ContentType&&(n.ContentType=a.ContentType),a.__type&&(n.__type=a.__type),n.IsInline&&(n.ContentId=a.ContentId),Object(H.b)(a)){var u=n;u.AttachLongPathName=a.AttachLongPathName,u.PermissionType=a.PermissionType,u.ProviderType=a.ProviderType,u.AttachmentThumbnailUrl=a.AttachmentThumbnailUrl,u.AttachmentPreviewUrl=a.AttachmentPreviewUrl}if(Object(V.a)([{attachmentId:c,attachment:n,permissionInfo:i}],!1),e.attachmentId=c,Object(F.a)(e))Object(L.a)(e,1);else{Object(W.g)(e,!1),setTimeout((function(){M(e,1.1)}),500),Object(o.a)(e,0,0);var s=Object(O.a)(c);Object(U.a)(e,s,!1,e.strategy.supportedMenuActions),s.download.url||Object(G.a)(c,e.isReadOnly,!0)}}));function q(e){return Object(r.__assign)({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}function J(e,t,n,r,a,i,o,c){var u,s,d=function(e,t,n,r,a,i,o,c){return q({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:a,fullPathLocation:i,attachmentDataProviderId:c,PermissionLevel:o})}(e,t,n,r,a,i,o,c);return void 0===(u={requestObject:d}).requestObject||u.requestObject.__type||(u.requestObject=q(u.requestObject)),Object(m.a)("ConvertRefToLocalAttachment",u,s)}function $(e){return Z(Object(O.a)(e).model.Size)}function X(e){return 2856+.00145*e}function Y(e){return 4*Z(e)}function K(e){return 4*Z(e)}function Q(e){return 2*Z(e)}function Z(e){return Math.round(e/256)}var ee=n(2595),te={},ne=Object(f.action)("convertCloudyToClassic",(function(e,t,n,r,a,i){return{attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:a,source:i}})),re=ne;function ae(e,t,n,a,i,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s,d,l,f;return Object(r.__generator)(this,(function(v){switch(v.label){case 0:return[4,Object(g.a)(i)];case 1:c=r.__read.apply(void 0,[v.sent(),4]),u=c[0],s=c[1],d=c[2],l=c[3],te[e.Id]=u,v.label=2;case 2:return v.trys.push([2,4,,5]),[4,J(e.Id,t,u,l,u,n,a)];case 3:return v.sent(),[3,5];case 4:return f=v.sent(),o(f.message),I.g.importAndExecute(s,d),[3,5];case 5:return[2]}}))}))}function ie(e,t){switch(t){case 0:break;case 11:Object(o.a)(e,0,0);break;default:Object(o.a)(e,0,12)}delete te[e.attachmentId.Id]}function oe(e,t,n,r,a){var i,o=Object(O.a)(t);e.addCosmosOnlyData(JSON.stringify({size:o.model.Size,attachmentId:null===(i=o.model.AttachmentId)||void 0===i?void 0:i.Id})),e.addCustomData([n,a]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}function ce(e){return Object(r.__assign)({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}function ue(e){var t,n,r=function(e){return ce({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=ce(t)),Object(m.a)("CancelConvertRefToLocalAttachment",t,n)}Object(f.orchestrator)(ne,(function(e){var t=e.attachment;!function(e,t,n,a,i,c){Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=new w.a("AttachmentConvertCloudyToClassic"),function(e){Object(o.a)(e,6,11)}(e),s=function(t){if(ie(e,t.ResultCode),oe(u,e.attachmentId,t.ResultCode,t.Exception,c),0===t.ResultCode){var n=Object(ee.a)({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});i(!0,n)}else i(!1,null);return!0},d=function(t){ie(e,1),i(!1,null),oe(u,e.attachmentId,1,t,c)},[4,ae(e.attachmentId,t,n,a,s,d)];case 1:return r.sent(),[2]}}))}))}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,(function(n,r){n?e.replaceAttachmentHandler(t,r,!1,!0):s(t.attachmentId,n)}),e.source),d($(t.attachmentId),.1,(function(e){M(t,e)}),t.attachmentId)}));var se=Object(f.action)("cancel_ConvertCloudyToClassic",(function(e){return Object(R.c)(x,{attachmentViewState:e})})),de=se;Object(f.orchestrator)(se,(function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,te[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(o.a)(e.attachmentViewState,6,10),ue(n)}));var le=n(1049),fe=n(1137),ve=n(2067),be=n(1487);function pe(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,be.h.import()];case 1:return n.sent()(e.model.AttachLongPathName,ve.a.OneDrivePro).then((function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&0===n.ResultCode?[2]:(t=Object(fe.b)(e.model,!0),[4,le.h.importAndExecute(t,e.attachmentClass,e.model,!0,e.model.ProviderType,n)]);case 1:return a=r.sent(),le.m.importAndExecute(e.id,a),Object(le.p)(e.id),[2]}}))}))})),[2]}}))}))}var me=n(76),he=n(980);function we(e,t,n){if(e&&t===le.a.providers.ONE_DRIVE_PRO&&(Object(me.h)("doc-SxS-jsApi-ODB-Base")||Object(me.h)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(me.h)("doc-SxS-jsApi-ODB-Readonly"))){var r=n&&n.substring(n.lastIndexOf("."));switch(Object(he.f)(r)){case he.a.Word:return Object(me.h)("doc-SxS-jsApi-ODB-Word");case he.a.Excel:return Object(me.h)("doc-SxS-jsApi-ODB-Excel");case he.a.PowerPoint:return!Object(me.h)("doc-SxS-jsApi-ODB-Readonly")&&Object(me.h)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var Oe=n(1883),ge=n(1084);function Ie(e,t,n,r,a){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===a&&(a=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:ge.a.Inline,skipProcessInlineImage:a}}function je(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}var Se=n(1792);n(1909);n.d(t,"a",(function(){return v.a})),n.d(t,"h",(function(){return b.a})),n.d(t,"c",(function(){return D})),n.d(t,"e",(function(){return _})),n.d(t,"u",(function(){return k.a})),n.d(t,"w",(function(){return k.c})),n.d(t,"v",(function(){return k.b})),n.d(t,"D",(function(){return k.d})),n.d(t,"x",(function(){return M})),n.d(t,"y",(function(){return N.a})),n.d(t,"z",(function(){return L.a})),n.d(t,"A",(function(){return o.a})),n.d(t,"E",(function(){return z})),n.d(t,"r",(function(){return U.a})),n.d(t,"o",(function(){return U.b})),n.d(t,"d",(function(){return de})),n.d(t,"f",(function(){return re})),n.d(t,"m",(function(){return pe})),n.d(t,"b",(function(){return we})),n.d(t,"B",(function(){return d})),n.d(t,"C",(function(){return s})),n.d(t,"k",(function(){return X})),n.d(t,"l",(function(){return K})),n.d(t,"q",(function(){return Y})),n.d(t,"j",(function(){return Q})),n.d(t,"g",(function(){return Oe.a})),n.d(t,"i",(function(){return Ie})),n.d(t,"p",(function(){return $})),n.d(t,"t",(function(){return je})),n.d(t,"s",(function(){return F.a})),n.d(t,"n",(function(){return Se.a}))},1371:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),a=n(254),i=n(1288),o=n(280),c=n(1344),u=n(1640),s=n(75),d=n(1034);function l(e,t,n,o,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(i.d)(e,!1,n)];case 1:return u=r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return u&&u.split(i.a)[1]?(Object(a.o)("fetchServiceViaDataProvider",[e]),s.g.info("fetchServiceViaDataProvider"),[4,f(t,u,o,c)]):[3,5];case 4:return[2,r.sent()];case 5:Object(a.o)("fetchServiceFailedToGetToken",[e]),r.label=6;case 6:return 0!==e?[3,8]:(Object(a.o)("fetchServiceViaOWAServer"),s.g.info("fetchServiceViaOWAServer"),[4,v(e,t,o,c)]);case 7:return[2,r.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function f(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s;return Object(r.__generator)(this,(function(r){return c=n.datapointNamePrefix+"DataProvider",u=new a.a(c),s={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},i&&Object.keys(i).forEach((function(e){s[e]=i[e]})),[2,fetch(e,{method:n.method,mode:n.mode,headers:s,body:n.body}).then((function(e){if(Object(o.a)(e.status))return u.end(),e.json();var t=new Error(c+" : Response status = "+e.status+", body = "+e.body);u.endWithError("ServerError",t);var n={datapointName:c,responseStatus:e.status,responseBody:e.body};throw JSON.stringify(n)})).then((function(e){return JSON.stringify(e)}))]}))}))}function v(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l,f,v,b,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=n.datapointNamePrefix+"OWA",l=new a.a(s),f=Object(c.a)({ProviderType:e,Url:t,Method:n.method,Body:n.body?n.body:JSON.stringify({}),Headers:JSON.stringify(i),IsJsonPost:n.method===d.d}),[4,Object(u.a)(f)];case 1:if(v=r.sent(),Object(o.a)(v.Status))return l.end(),[2,v.Body];throw b=new Error(s+" : Response status = "+v.Status+", ServerTraceLog = "+v.ServerTraceLog),l.endWithError("ServerError",b),p={datapointName:s,responseStatus:v.Status,responseServerTraceLog:v.ServerTraceLog},JSON.stringify(p)}}))}))}},1394:function(e,t){e.exports=function(e){return e instanceof Date}},1395:function(e,t,n){"use strict";var r=n(239),a=n(0),i={};function o(e){return i[e]}function c(e,t){var n=i[e];i[e]=Object(a.__assign)(Object(a.__assign)({},n),t)}var u=n(94),s=n(25);var d=n(254),l=n(75),f=n(528),v=n(427),b=n(353);function p(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return(t={}).headers=new Headers,[4,Object(v.a)(e)];case 1:return n=r.sent(),Object(b.b)(t.headers,n),[2,t]}}))}))}var m=Object(f.b)({timeBetweenRetryInMS:function(){return 3e4}});function h(e,t){t=t<1?1:t,setInterval((function(){!function(e){Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,f,v,b=this;return Object(a.__generator)(this,(function(h){switch(h.label){case 0:if(t=function(){return Object(a.__awaiter)(b,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t={},Object(r.p)(e.userIdentity)?[4,p(e.userIdentity)]:[3,2];case 1:t=a.sent(),a.label=2;case 2:return[2,(i=t,Object(s.a)("GetAttachmentDownloadToken",{},i))];case 3:throw n=a.sent(),l.g.warn("Unable to get the download token "+n),n.networkError=!0,n;case 4:return[2]}var i}))}))},null==(n=o(e.userIdentity))?void 0:n.isRefreshingDownloadToken)return[3,4];c(e.userIdentity,{isRefreshingDownloadToken:!0}),i=0,u=m((function(){return Object(a.__awaiter)(b,void 0,void 0,(function(){var n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return i++,[4,t()];case 1:return n=r.sent(),l.g.info("update new token"),c(e.userIdentity,{downloadToken:n,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,f=new d.b("AttachmentRefreshDownloadToken"),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,u()];case 2:return h.sent(),f.addCustomData([i]),f.end(),[3,4];case 3:return v=h.sent(),l.g.warn("Retry to refresh token failed: "+v),f.addCustomData([i]),f.endWithError("ServerError",v),c(e.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(e)}),6e4*t)}var w=n(314);function O(e){var t=Object(r.g)(null==e?void 0:e.userIdentity),n=o(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Outlook":!function(e){var t=Object(r.p)(e.userIdentity)?Object(u.j)(e.userIdentity):Object(u.i)(),n=null==t?void 0:t.ApplicationSettings;if(n){var a=n.DownloadUrlBase;c(e.userIdentity,{downloadUrlBase:a,downloadToken:n.FirstDownloadToken}),a&&h(e,n.DownloadTokenRefreshMinutes)}}(e);break;case"Google":case"ICloud":break;default:Object(w.a)(t)}var a=o(e.userIdentity);return a||(Object(d.o)("FilesUrlDataNotFound",{accountProviderType:t}),l.g.warn("Unable to get the url data")),a}function g(e){if(!e)return null;var t=O(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return g}))},14129:function(e){e.exports=JSON.parse('{"a":"f8b"}')},1427:function(e,t,n){"use strict";var r;function a(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1441:function(e,t,n){"use strict";n.d(t,"u",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return b})),n.d(t,"l",(function(){return p})),n.d(t,"m",(function(){return m})),n.d(t,"n",(function(){return h})),n.d(t,"o",(function(){return w})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return g})),n.d(t,"r",(function(){return I})),n.d(t,"s",(function(){return j})),n.d(t,"t",(function(){return S})),n.d(t,"v",(function(){return _})),n.d(t,"h",(function(){return C}));var r=n(115),a=n(2465);n.d(t,"a",(function(){return a.a}));var i=n(1301);n.d(t,"b",(function(){return i.a})),n.d(t,"e",(function(){return i.d}));var o=n(1703);n.d(t,"f",(function(){return o.a}));var c=n(1729);n.d(t,"d",(function(){return c.a}));var u=n(2466);n.d(t,"c",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(571)]).then(n.bind(null,4843))})),d=new r.b(s,(function(e){return e})),l=new r.b(s,(function(e){return e.resetPreviewPane})),f=(new r.b(s,(function(e){return e.setAudioPreviewState})),new r.b(s,(function(e){return e.setBlankPreviewState})),new r.b(s,(function(e){return e.setCustomPreviewState})),new r.b(s,(function(e){return e.setIframePreviewState}))),v=(new r.b(s,(function(e){return e.setImageGalleryItems})),new r.b(s,(function(e){return e.setImagePreviewLoaded}))),b=new r.b(s,(function(e){return e.setImagePreviewState})),p=new r.b(s,(function(e){return e.setImagePreviewStateFromImageGalleryItem})),m=(new r.b(s,(function(e){return e.setNativePdfPreviewState})),new r.b(s,(function(e){return e.setPanesSize}))),h=(new r.b(s,(function(e){return e.setPdfJsPreviewState})),new r.b(s,(function(e){return e.setPdfJsPreviewStateByData})),new r.b(s,(function(e){return e.setPreviewError}))),w=new r.b(s,(function(e){return e.setPreviewLoading})),O=new r.b(s,(function(e){return e.setRightPaneDisplayAndUpdateSize})),g=new r.b(s,(function(e){return e.setSaveStatusText})),I=new r.b(s,(function(e){return e.setTextPreviewState})),j=(new r.b(s,(function(e){return e.setVideoPreviewState})),new r.b(s,(function(e){return e.setWacPreviewState}))),S=new r.b(s,(function(e){return e.setWacReadOnly})),_=new r.b(s,(function(e){return e.updatePanesSize})),C=new r.b(s,(function(e){return e.saveHideReadingPaneOption}))},1443:function(e,t,n){"use strict";var r=n(2050),a=n(10),i=n(1764),o=n(1129);var c=n(1089),u=n(1272),s=n(1137),d=n(1049),l=n(284);n.d(t,"b",(function(){return v}));var f=null;function v(){return f||(f=Object.keys(c.a).reduce((function(e,t){var n=c.a[t];return Number.isInteger(n)&&e.push(n),e}),[])),f}t.a=Object(l.action)("initializeAttachmentFullViewState")((function(e,t,n,l,f){var b;l&&0!==l.length||(b=t.model,l=Object(d.e)(b)?function(e){return 2===Object(d.c)(e)?[c.a.Preview,c.a.Download]:[c.a.Download]}(b):v());var p=Object(s.b)(t.model,!0),m=Object(s.e)(),h=Object(u.a)(t),w=Object(r.a)(m,p,t.attachmentClass,t.model,h?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,l,e.isReadOnly,n,f);e.strategy=w,function(e,t,n){n&&!Object(a.f)(t.model.AttachmentOriginalUrl)&&(Object(i.a)(e,2),Object(o.a)(e,0,2))}(e,t,e.strategy.isSaveToCloudSupported)}))},1469:function(e,t,n){"use strict";function r(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},1470:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return b})),n.d(t,"n",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"p",(function(){return h})),n.d(t,"h",(function(){return w}));var r=100,a=1,i="PublicDL",o="PrivateDL",c="GroupMailbox",u="RecommendedGroup",s="InternalMailbox",d="ExternalMailbox",l="Mailbox",f="OneOff",v="Contact",b="ImplicitContact",p="PublicFolder",m="Other",h="Room",w="LinkedIn"},1487:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return v})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"l",(function(){return h}));var r=n(115),a=n(1789);n.d(t,"n",(function(){return a.a}));var i=n(1742);n.d(t,"a",(function(){return i.a}));n(1470);var o=n(1427);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(1790);n.d(t,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(4),n.e(16),n.e(45),n.e(553)]).then(n.bind(null,3556))})),s=new r.b(u,(function(e){return e.getSharingInformation})),d=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),l=new r.b(u,(function(e){return e.getInfoBarCreator})),f=new r.b(u,(function(e){return e.hasLargeDLRecipient})),v=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),b=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),p=new r.b(u,(function(e){return e.getInvididualRecipients})),m=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),h=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},1508:function(e,t,n){"use strict";var r=n(0),a=n(254),i=n(2862),o=n(1005),c=n(2269),u=n(2563),s=n(76),d=n(2375),l=n(284),f=n(1909),v=n(1764),b=n(2050),p=n(1129),m=Object(l.action)("updateIsViewingInProviderSupported")((function(e,t){e.strategy.isViewingInProviderSupported=t}));n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return I}));t.a=Object(l.action)("saveToCloud")((function(e,t,n,a,i){var o=Object(r.__read)(w(e,t,n,a,!1,i),2),c=o[0],s=o[1];Object(u.b)(e.attachmentId,null,c,s)}));function h(e,t,n,a,i,o){var c=Object(r.__read)(w(e,t,n,a,!0,o),2),s=c[0],d=c[1];Object(u.c)(e.attachmentId,s,d,i)}function w(e,t,n,r,i,o,c){var u=new a.a("AttachmentSaveToCloud");f.a.run(2,e.attachmentId,c),g(e,i);return[function(a){var i=0===a.ResultCode;return I(e,i,i?a.Item.Location:null,c),t(i),O(u,e.attachmentId,a.ResultCode,"ServerError",a.Exception,n,r,o),!0},function(a,i,c,s){I(e,!1,null,s),t(!1),O(u,e.attachmentId,i,c,a,n,r,o)}]}function O(e,t,n,r,i,u,l,f){var v=Object(o.a)(t);e.addCustomData({entryPoint:u,result:n});var b=Object(c.a)(v);e.addCosmosOnlyData(JSON.stringify({size:v.model.Size,fileType:b})),0===n?e.end():e.endWithError(r,new Error(i)),Object(s.h)("doc-attachment-sigs")&&Object(d.a)(null==l?void 0:l.Id).then((function(e){a.l.importAndExecute("SavedAttachment",{itemId:e,customProperties:{FileId:t.Id,FileType:b,Destination:"Cloud",Sender:f}})}))}function g(e,t){void 0===t&&(t=!1);var n=t?18:1;Object(p.a)(e,2,n)}function I(e,t,n,r){if(t){Object(v.a)(e,2),Object(i.a)(e.attachmentId,n),f.a.run(3,e.attachmentId,r);var a=Object(b.b)(!1,!1,n);m(e,a)}else f.a.run(4,e.attachmentId,r);Object(p.a)(e,0,t?3:4)}},1621:function(e,t,n){"use strict";var r=n(314),a=n(10),i=n(37),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",l="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",v="pdfprint.aspx?id={0}&location={1}",b=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var p=n(296),m=n(49),h=n(2),w=n(22),O=n(1395),g=n(106),I=n(239);function j(e,t,n,c,s,l,f,p,m){var h;switch(void 0===s&&(s=0),void 0===l&&(l=0),void 0===f&&(f=!0),void 0===p&&(p=null),void 0===m&&(m=null),n){case 0:h=u;break;case 3:h=v;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&b.indexOf(t.toLowerCase())>=0}(p))return null;h=d;break;default:Object(r.a)(n)}var O=c?l:s;!O&&s&&(O=s);var g=Object(a.c)("{0}{1}{2}&permissionLevel={3}",o,m,Object(a.c)(h,encodeURIComponent(e.Id),encodeURIComponent(t)),O);f&&(g=g+"&X-OWA-CANARY="+Object(i.a)());return Object(w.a)(g)}function S(e,t,n,u,d){var v;switch(void 0===u&&(u=!1),void 0===d&&(d=!0),n){case 0:v=c;break;case 1:v=s;break;case 2:v=l;break;case 3:v=f;break;default:return Object(r.a)(n)}if(!Object(a.f)(v)){var b=function(e,t,n,r,c){if(void 0===c&&(c=!1),!t||!t.Id||!t.mailboxInfo)return null;var u=t.mailboxInfo.userIdentity,s=u&&Object(I.p)(u),d=t.mailboxInfo.type===g.a.GroupMailbox,l=s&&!d?Object(g.c)(t.mailboxInfo.mailboxSmtpAddress)+u:e,f=Object(O.b)(t.mailboxInfo),v=null==f?void 0:f.downloadUrlBase,b=Object(a.c)(n,encodeURIComponent(t.Id));if(!v||c&&"Firefox"===Object(m.a)().browser){var j=o+b+"&X-OWA-CANARY="+Object(i.a)();return Object(w.a)(j)}var S="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(p.a)()&&(S+="&isc=1");var _=Object(a.c)(S,v,l,b,window.location.hostname,Object(h.l)()||"unofficial");return r&&(_+="&X-OWA-CANARY="+Object(i.a)(),_+="&token="+(null==f?void 0:f.downloadToken)),_}(e,t,v,d,3===n);return Object(a.c)("{0}{1}{2}",b,u?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return S}))},1623:function(e,t,n){"use strict";var r=n(0),a=n(435),i=n(1075);function o(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=t||Object(a.a)(),o={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null,noSubscriptionFailureReload:!0},c=function(t){e(t)&&i.g.importAndExecute(o,c)},[4,i.f.import()];case 1:return r.sent()(o,c),[4,i.b.import()];case 2:return u=r.sent()(),[2,[n,o,c,u]]}}))}))}n.d(t,"a",(function(){return o}))},1640:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25),a=n(1344);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},1656:function(e,t,n){"use strict";var r=n(1621);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var a=n(1395);n.d(t,"c",(function(){return a.a}))},1659:function(e,t,n){"use strict";var r=n(115),a=n(2446),i=n(1871),o=n(1685),c=n(1899),u=n(2116),s=n(2117),d=n(2217),l=n(2301),f=n(2341),v=n(1110),b=n(76),p=n(982);function m(e,t){return!!e&&(1!==t&&!!p.a.conversations.get(e))}function h(e,t){return 2!=t&&(Object(b.h)("rp-persistedReadingPaneTabs")?v.a.loadedItemReadingPaneViewStates.has(e):v.a.itemReadingPaneViewState&&v.a.itemReadingPaneViewState.itemId==e)}var w=n(1953),O=n(1954),g=n(1845),I=n(1214);n.d(t,"k",(function(){return S})),n.d(t,"o",(function(){return _})),n.d(t,"l",(function(){return C})),n.d(t,"p",(function(){return P})),n.d(t,"r",(function(){return T})),n.d(t,"m",(function(){return y})),n.d(t,"n",(function(){return x})),n.d(t,"h",(function(){return A})),n.d(t,"i",(function(){return E})),n.d(t,"j",(function(){return R})),n.d(t,"g",(function(){return D})),n.d(t,"q",(function(){return k})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return w.a})),n.d(t,"a",(function(){return O.a})),n.d(t,"s",(function(){return v.a})),n.d(t,"c",(function(){return g.a})),n.d(t,"b",(function(){return I.a}));var j=new r.c((function(){return Promise.all([n.e(7),n.e(10),n.e(15),n.e(19),n.e(509)]).then(n.bind(null,15549))})),S=new r.a(j,(function(e){return e.loadConversationReadingPane})),_=(new r.a(j,(function(e){return e.reloadReadingPane})),new r.a(j,(function(e){return e.moveReadingPaneToTab}))),C=new r.a(j,(function(e){return e.loadConversationReadingPaneForSingleMailItemSelected})),P=new r.a(j,(function(e){return e.print})),T=new r.a(j,(function(e){return e.setItemIdToScrollTo})),y=new r.a(j,(function(e){return e.loadItemReadingPane})),x=new r.a(j,(function(e){return e.loadItemReadingPaneForSingleMailItemSelected})),A=new r.a(j,(function(e){return e.expandCollapseAllItemParts}));Object(r.f)(o.a,j,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(u.a,j,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(s.a,j,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(c.a,j,(function(e){return e.markAllAsReadOrchestrator})),Object(r.f)(a.a,j,(function(e){return e.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(i.a,j,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(f.a,j,(function(e){return e.conversationReadyToLoadOrchestrator})),Object(r.f)(f.b,j,(function(e){return e.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(d.a,j,(function(e){return e.updateInternetMessageIdOrchestrator})),Object(r.f)(l.a,j,(function(e){return e.initializeExtendedCardForItemReadingPaneOrchestrator}));new r.b(j,(function(e){return e.getLastestNonDraftItemId}));var E=new r.b(j,(function(e){return e.getLatestNonDraftItemIdFromConversation})),R=new r.b(j,(function(e){return e.isUnsupportedItem})),D=new r.a(j,(function(e){return e.clearReadingPaneStore})),k=new r.a(j,(function(e){return e.replyByMeeting}))},1679:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(25);function a(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},1685:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",(function(e,t,n){return{itemContexts:e,parentFolderId:t,actionType:n}}))},1692:function(e,t,n){"use strict";var r=n(314),a=n(106),i=n(1656),o=n(37),c=n(1469);function u(e,t,n,o,u){var s;void 0===u&&(u=!0);var d=t,l=d.AttachmentId,f=d.Name,v=d.OriginalPermissionType,b=d.PermissionType,p=Object(c.a)(t),m=(null===(s=null==e?void 0:e.mailboxInfo)||void 0===s?void 0:s.type)===a.a.GroupMailbox?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(l,p,n,o,b,v,u,f,m);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:i.b(l,p,1,o,b,v,u,f,m);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function s(e,t,n,r){var a;return void 0===n&&(n=!1),void 0===r&&(r=!0),i.a(null===(a=e.mailboxInfo)||void 0===a?void 0:a.routingKey,e,t,n,r)}function d(e,t,n,r,a){void 0===a&&(a=!1);var c=n?u(e,t,1,r,!1):s(e,1,a,!1);if(n)return{url:c,init:{credentials:"include"}};var d=Object(i.c)(e.mailboxInfo),l=new Headers;return l.set("X-Token",d),l.set("X-OWA-CANARY",Object(o.a)()),{url:c,init:{headers:l}}}function l(e,t,n,r,a,i){return void 0===i&&(i=!1),r?u(e,t,n,a):s(e,n,i)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d}))},1742:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1746:function(e,t,n){var r=n(1278);e.exports=function(e,t){var n=r(e).getTime(),a=Number(t);return new Date(n+a)}},1747:function(e,t,n){"use strict";var r=n(284);t.a=Object(r.action)("setShouldShowImageOverlay")((function(e,t){e.shouldShowImageOverlay=t}))},1764:function(e,t,n){"use strict";var r=n(284);t.a=Object(r.action)("addCompletedAction")((function(e,t){e.completedActions.push(t)}))},1789:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1790:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1791:function(e,t,n){var r=n(1746),a=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*a)}},1792:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(0),a=n(314),i=n(1875),o=n(296);var c=Object(i.a)((function(e){switch(e){case 0:return t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},Object(r.__assign)(Object(r.__assign)({},t),{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return function(){var e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object(r.__assign)(Object(r.__assign)({},e),{supportConvertCloudyToClassic:Object(o.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(a.a)(e)}var t})),u=c.getDataProviderInfo,s=c.getDefaultDataProviderInfo;t.a=u},1821:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("saveSigningCertificate",(function(e,t){return{smimeViewState:e,signingCertRawData:t}}))},1830:function(e,t,n){"use strict";var r=n(284);t.a=Object(r.action)("setInlineAttachmentStatus")((function(e,t){e.status=t}))},1845:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1110),a=n(76),i=n(2056);function o(e){return Object(a.h)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedItemReadingPaneViewStates.get(e||(Object(r.b)().sxsId?Object(r.b)().sxsId:Object(i.a)())):Object(r.b)().itemReadingPaneViewState}},1871:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("DELETE_CONVERSATION_STORE_UPDATE",(function(e,t,n){return{conversationIds:e,tableView:t,actionType:n}}))},1874:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return v})),n.d(t,"k",(function(){return b})),n.d(t,"n",(function(){return p})),n.d(t,"r",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return w})),n.d(t,"j",(function(){return O})),n.d(t,"f",(function(){return g})),n.d(t,"i",(function(){return I})),n.d(t,"a",(function(){return j}));var r=n(115),a=(n(1821),new r.c((function(){return Promise.all([n.e(12),n.e(763),n.e(4),n.e(16),n.e(685)]).then(n.bind(null,3636))}))),i=new r.a(a,(function(e){return e.onSmimeItemAttachmentOpened})),o=new r.a(a,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(a,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(a,(function(e){return e.setSmimePropertiesInDraftMessage}))),u=new r.b(a,(function(e){return e.trySetSmimeProperties})),s=new r.b(a,(function(e){return e.tryAddSmimeProperties})),d=new r.b(a,(function(e){return e.createMailResponseBodyContent})),l=new r.b(a,(function(e){return e.downloadSmimeAttachment})),f=new r.b(a,(function(e){return e.getMergedSmimeViewState})),v=new r.b(a,(function(e){return e.getMergedSmimeViewStateForDraft})),b=new r.b(a,(function(e){return e.isSmimeItemDecoding})),p=new r.b(a,(function(e){return e.previewSmimeAttachment})),m=new r.b(a,(function(e){return e.updateSmimeAttachmentIds})),h=new r.b(a,(function(e){return e.createSmimeAttachmentsFromFiles})),w=new r.b(a,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),O=new r.b(a,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),g=new r.b(a,(function(e){return e.getAttachmentsForSmimeResponse})),I=new r.b(a,(function(e){return e.getSmimeAttachmentsForRequest})),j=Object(r.d)(a,(function(e){return e.SignatureDetails}))},1882:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},1883:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(1077),i=n(1084);function o(e,t,n,o,c,u,s){void 0===c&&(c=i.a.Unknown),void 0===u&&(u=!1),void 0===s&&(s=null);var d=Object(a.c)(e,t,o,u,c,s),l=d.strategy;return Object(r.__assign)(Object(r.__assign)({},d),{attachmentType:0,strategy:Object(r.__assign)(Object(r.__assign)({},l),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},1899:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(function(e,t,n){return{tableView:e,markAsRead:t,rowIdsToExclude:n}}))},1909:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=null,a={register:function(e){r=e},run:function(e,t,n){r&&r(e,t,n)}}},1937:function(e,t,n){"use strict";var r=n(4),a=n(118),i=Object(r.action)("addCalendarEventsAttachment",(function(e,t){return Object(a.c)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e})}));t.a=i},1953:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(76);function a(){return Object(r.h)("rp-linkedInViewProfile")||Object(r.h)("rp-linkedInViewProfileV1_1")}},1954:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="displaylinkedindataprebind"},2024:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},2050:function(e,t,n){"use strict";var r=n(0),a=n(10),i=n(1137),o=n(1089),c=n(314),u=n(1077);function s(e){switch(e){case o.a.Download:return u.a.Download;case o.a.OpenInNewTab:return u.a.OpenInNewTab;case o.a.Preview:return u.a.Preview;case o.a.ImportCalendarEventAttachment:case o.a.ChangePermissions:case o.a.CopyLink:case o.a.SaveToCloud:case o.a.ViewInProvider:case o.a.ConvertClassicToCloudy:case o.a.ConvertCloudyToClassic:case o.a.MoveAttachmentToInline:case o.a.RefreshLink:case o.a.IgnoreExpiration:return null;default:return Object(c.a)(e)}}function d(e){switch(e){case u.a.Download:return o.a.Download;case u.a.OpenInNewTab:return o.a.OpenInNewTab;case u.a.Preview:return o.a.Preview;case u.a.NoAction:return null;default:return Object(c.a)(e)}}var l=n(1792);var f=n(1049),v=n(296),b=n(1523);function p(e,t,n,a,o,c,v,p,h,w,O){var g=Object(u.d)(t,n,a,w);!function(e,t){var n=Object(b.c)();0===n?e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download})):1===n&&(e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download&&e!==u.a.Preview})));var r=function(e,t,n){void 0===n&&(n=!1);var r=e.filter((function(e){return-1!==t.indexOf(e)}));return n&&(r=r.filter((function(e,t,n){return n.indexOf(e)===t}))),r}(e.supportedOpenActions.map(d).filter((function(e){return!!e})),t);e.supportedOpenActions=r.map(s)}(g,p);var I,j=function(e){return e.__type===f.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(a),S=w&&function(e){return e.__type===f.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(a),_=Object(i.d)(a,j||S,h,O),C=j,P=m(j,S,c),T=function(e,t,n){return e.convertClassicToCloudyEnabled&&!t&&!n}(e,j||S,h),y=function(e,t,n,r,a){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){var i=Object(l.a)(a);return(null==i?void 0:i.supportConvertCloudyToClassic)||!1}return!1}(e,j,h,v,o),x=function(e,t,n,r){return 2===e&&!t&&!n&&!r}(n,j,S,h);switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:I=function(e,t,n,a,i,o,c,u){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isOpeningByLinkSupported:n,isOpeningInProviderSupported:a,isViewingInProviderSupported:i,isConvertClassicToCloudySupported:o,isConvertCloudyToClassicSupported:c,isMoveAttachmentToInlineSupported:u,showActionsMenu:!0,supportedMenuActions:[]})}(g,_,j||S,C,P,T,y,x);break;case 1:I=function(e){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(g);break;default:I=j?function(e,t,n,a){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:t,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:a,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(g,C,P,y):function(e,t,n,a){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:a,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(g,_,P,T)}return I.supportedMenuActions=p,I}function m(e,t,n){if(e||t)return!1;var r=Object(v.a)(),i=Object(l.b)(r);return!Object(a.f)(n)&&(r||(null==i?void 0:i.supportViewInProvider))}n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}))},2056:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1101),a=n(2161);function i(){var e=Object(r.d)();switch(e.type){case r.a.SecondaryReadingPane:return e.data.id.Id;case r.a.Primary:default:return Object(a.a)()}}},2067:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l}));var r=n(115),a=n(2024);n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return Promise.all([n.e(45),n.e(276)]).then(n.bind(null,4106))})),o=new r.b(i,(function(e){return e.createGetSharingInfoResponse})),c=new r.b(i,(function(e){return e.checkSharingLinkUrlDomain})),u=new r.b(i,(function(e){return e.getLinkProviderType})),s=new r.b(i,(function(e){return e.isOneDriveProRelatedLink})),d=new r.b(i,(function(e){return e.convertToAttachmentDataProviderType})),l=new r.b(i,(function(e){return e.convertToLinkProviderType}))},2116:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",(function(e,t,n,r){return{conversationIds:e,tableViewId:t,isReadValue:n,isExplicit:r}}))},2117:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",(function(e,t,n,r){return{itemIds:e,isReadValue:t,isExplicit:n,tableViewId:r}}))},2161:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1110),a=n(573);function i(){var e,t;return Object(a.v)()?null===(e=Object(r.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(r.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},2183:function(e,t,n){"use strict";var r=n(25),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetAttachmentTextPreviewRequest:#Exchange"},n)),Object(r.a)("GetAttachmentTextPreview",e,t)}n.d(t,"a",(function(){return i}))},2201:function(e,t,n){"use strict";var r=n(284);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(e,t){e.shouldShowContextMenu=t}))},2204:function(e,t,n){"use strict";var r=n(1443),a=n(0),i=n(1290),o=n(1070);var c=n(2771);function u(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return e.strategy.previewMethod!==o.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||(r=e.strategy).previewMethod===o.a.Wac&&(r.previewMethod=o.a.Unsupported,r.supportedOpenActions=r.supportedOpenActions.filter((function(e){return e!==i.a.Preview}))),n.label=2;case 2:return[2]}var r}))}))}var s=n(1883),d=n(1084),l=n(1346),f=n(2103),v=n(1005);function b(e,t,n,a,i,o,c,b,p){void 0===c&&(c=null),void 0===p&&(p=!1),Object(f.a)([{attachmentId:e,attachment:t}],n,i);var m=Object(v.a)(e),h=Object(s.a)(e,n,a,1===m.type,d.a.Unknown,!1,c);if(Object(r.a)(h,m,!1,b,o),p){var w=m.model.ProviderType;Object(l.b)(h.isCloudy,w,m.model.Name)||u(h)}return h}n.d(t,"a",(function(){return b}))},2217:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("updateInternetMessageId",(function(e,t,n){return{conversationId:e,itemId:t,internetMessageId:n}}))},2268:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function a(e){return e&&void 0!==e.fetchErrorType}function i(e,t){e.addCustomProperty("ErrorInformation",t)}function o(e,t){i(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o}))},2269:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(980);function a(e){var t="";return(null==e?void 0:e.model)&&(t=Object(r.c)(e.model.Name||"")||e.model.ContentType||""),t}},2301:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("initializeExtendedCardForItemReadingPane",(function(e,t){return{itemReadingPaneViewState:e,loadedItem:t}}))},2313:function(e,t,n){"use strict";var r=n(284);t.a=Object(r.action)("setOngoingAction")((function(e,t){e.ongoingAction=t}))},2341:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(4),a=Object(r.action)("CONVERSATION_READY_TO_LOAD",(function(e,t){return{conversationId:e,nodeIdCollectionChange:t}})),i=Object(r.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(function(e,t){return{conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:t}}))},2375:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(0),a=n(298),i=n(645),o=n(569),c=n(492),u=n(646),s=n(245),d=n(75),l="0xe0b",f=Object(a.a)({PropertyTag:l,PropertyType:"Binary"});function v(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i,o,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=null,a=Object(c.a)({BaseShape:"IdOnly",AdditionalProperties:[f]}),[4,b([e],a)];case 1:return i=r.sent(),"Success"===(null===(t=null==i?void 0:i[0])||void 0===t?void 0:t.ResponseClass)&&(o=i[0],u=o.Items[0],n=function(e,t){var n;if(e){var r=e.ExtendedProperty;if(r)for(var a=r.length,i=0;i<a;i++){var o=r[i];if((null===(n=o.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===t)return o}}return null}(u,l)),n?[2,n.Value]:(d.g.info("[getImmutableEntryId] extendedProperty could not be retrieved"),[2,null])}}))}))}function b(e,t){var n=Object(s.a)(),r=e.map((function(e){return Object(o.a)({Id:e})}));return Object(u.a)({Header:n,Body:Object(i.a)({ItemShape:t,ItemIds:r})}).then((function(e){var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items})).catch((function(e){return d.g.warn("GetItem:"+e.message),null}))}},240:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,a=!1;function i(t){r--,delete e[t]}this.put=function(t,n,a,o){if(void 0!==a&&("number"!=typeof a||isNaN(a)||a<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var u={value:n,expire:a+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){i(t),o&&o(t,n)}.bind(this),a)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),a&&(t=0,n=0)},this.get=function(i){var o=e[i];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return a&&t++,o.value;a&&n++,r--,delete e[i]}else a&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){a=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),a=Date.now(),i=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(i)if(e[o])continue;var c=r[o],u=c.expire-a;if(u<=0){this.del(o);continue}u=u>0?u:void 0,this.put(o,c.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},2423:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",(function(){return r}))},2446:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(function(e,t,n){return{conversationIds:e,flagType:t,tableViewId:n}}))},2465:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="autoHideEmail"},2466:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.NeedPassword=1]="NeedPassword",e[e.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},2472:function(e,t,n){"use strict";var r=n(0);function a(e,t,n,a,i,o,c,u,s,d){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:t,searchScope:n,pillSuggestions:Object(r.__spread)(a.values()),includeAttachments:o,fromDate:c,toDate:u,scenarioType:"mail",lastIndexFetched:0,searchProvider:s,viewFilter:d||"All"}}function i(e){var t=e;return 1==e.type?t.scenarioType:void 0}var o=n(968),c=n(977),u=n(964),s=n(997);function d(e){var t=e;return Object(c.o)(t.folderId)?Object(s.e)(t.searchScope,Object(s.c)({folderId:Object(u.a)(o.b),kind:"ArchiveMailbox"})):Object(s.e)(t.searchScope,Object(s.E)({folderId:Object(u.a)(o.g),kind:"PrimaryMailbox"}))}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return d}))},2556:function(e,t,n){"use strict";var r=n(1148),a=n(284);t.a=Object(a.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},2563:function(e,t,n){"use strict";var r=n(0),a=n(1049),i=n(254),o={},c=5e3,u=12;function s(e,t,n,s,l){var f=new i.a("SaveToCloudProgressManager"),v=setInterval((function(){!function(e,t,n,i,o,c,u){Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(s=u[e])?(s.counter++,s.counter>c?(d(e,u),s.datapoint.addCustomData({operationId:e,counter:s.counter}),s.datapoint.endWithError("Timeout"),o&&o(),[2]):[4,a.g.import()]):[2];case 1:return r.sent()(t,n,e,0,(function(e){i&&i(e.NotificationPayloads)})),[2]}}))}))}(n,e,t,s,l,u,o)}),c);o[n]={timer:v,counter:0,datapoint:f}}function d(e,t){void 0===t&&(t=null),t||(t=o);var n=t[e];if(n){clearInterval(n.timer);var r=n.datapoint;r.addCustomData({operationId:e,counter:n.counter}),r.end(),delete t[e]}}var l=n(4),f=Object(l.action)("cancelSaveAttachmentsToCloud",(function(e){return{operationId:e}}));Object(l.orchestrator)(f,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return d(e.operationId),[2]}))}))}));var v=Object(l.action)("saveAttachmentsToCloud",(function(e,t,n,r,a,i,o,c,u){return{attachmentId:e,itemId:t,notificationHandler:n,serviceCallFailureCallback:r,operationCreatedCallback:a,folderId:i,attachmentIds:o,showProgressBar:c,subscriptionId:u}})),b=n(106);function p(e){return Object(r.__assign)({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}var m=n(25);function h(e,t,n,r,a,i,o){var c,u,s=function(e,t,n,r,a,i,o){return p({ewsAttachmentId:e,itemId:t,subscriptionId:n,groupSmtpAddress:a,channelId:r,folderItemId:i,attachmentIds:o})}(e,t,n,r,(null==a?void 0:a.type)===b.a.GroupMailbox?a.mailboxSmtpAddress:null,i,o);return c={requestObject:s},u=null==a?void 0:a.requestOptions,void 0===c.requestObject||c.requestObject.__type||(c.requestObject=p(c.requestObject)),Object(m.a)("SaveAttachmentsToCloud",c,u)}var w=n(1623),O=n(1075);Object(l.orchestrator)(v,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o,c,u,l,f;return Object(r.__generator)(this,(function(v){switch(v.label){case 0:return t=!1!==e.showProgressBar,!(n=e.attachmentId||e.itemId)&&e.attachmentIds.length>0&&(n=e.attachmentIds[0]),a=function(r){if(!r||"Reload"===r.EventType)return!1;if(23===r.ResultCode)return!1;var a=e.notificationHandler(r);return t&&a&&(d(n.Id),t=!1),a},i=e.subscriptionId,[4,Object(w.a)(a,i)];case 1:return o=r.__read.apply(void 0,[v.sent(),4]),c=o[0],u=o[1],l=o[2],f=o[3],function(e,t,n,a,i,o,c,u,s){Object(r.__awaiter)(this,void 0,void 0,(function(){var d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,h(e?e.Id:null,t?t.Id:null,n,o,g(t,e,s),u,s?s.map((function(e){return e.Id})):null)];case 1:return[2,r.sent()];case 2:return d=r.sent(),c(d,1,"ServerError"),O.g.importAndExecute(a,i),[2,null];case 3:return[2]}}))}))}(e.attachmentId,e.itemId,c,u,l,f,e.serviceCallFailureCallback,e.folderId,e.attachmentIds),t&&s(e.attachmentId,e.itemId,n.Id,(function(e){e.forEach((function(e){a(e)}))}),(function(){e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout")})),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,u,l),[2]}}))}))}));function g(e,t,n){return e?e.mailboxInfo:t?t.mailboxInfo:n[0].mailboxInfo}function I(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=function(n){if(!n||"Reload"===n.EventType)return!1;if(23===n.ResultCode)return!1;var r=t(n);return r&&d(e.Id),r},[4,Object(w.a)(i,a)];case 1:return r.sent(),s(e,null,e.Id,(function(e){e.forEach((function(e){i(e)}))}),(function(){n("Progress manager timeout. OperationId = "+e.Id,3,"Timeout")})),[2]}}))}))}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return I}))},2595:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FileAttachment:#Exchange"},e)}},2771:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),a=n(254),i=n(2268),o=n(2861),c={},u={},s=[],d=0,l=2;function f(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(r.__generator)(this,(function(u){return o=new a.a("InitializeWacUrl"),n&&o.addCustomProperty("actionSource",n),(c=b(e,t,o))?[2,c]:[2,new Promise((function(a,c){var u={attachmentId:e,isEdit:t,actionSource:n,datapoint:o,resolve:a,reject:c};i?v(u):(s.push(u),function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:if(!s.length)return[2];if(d>=l)return[2];t=s.shift(),d++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,v(t)];case 2:return n.sent(),[3,4];case 3:return d--,e(),[7];case 4:return[2]}}))}))}())}))]}))}))}function v(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,s,d,l,f,v,p,m,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(a=e.attachmentId,s=e.isEdit,d=e.actionSource,l=e.datapoint,f=e.resolve,v=e.reject,p=b(a,s,l))return f(p),[2];l.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(a.Id,s,null,null===(t=a.mailboxInfo)||void 0===t?void 0:t.requestOptions,d)];case 2:return 0===(m=r.sent()).Status&&((s?u:c)[a.Id]={expireTime:(new Date).getTime()+36e5,value:m}),m.WacUrl||l.addCustomProperty("WacUrlIsEmpty",!0),l.addCustomProperty("WacAttachmentResponseStatus",null===(n=m.Status)||void 0===n?void 0:n.toString()),l.end(),f(m),[3,4];case 3:return h=r.sent(),Object(i.a)(h)&&Object(i.c)(l,h.response),Object(i.d)(l,h.toString()),l.endWithError("ServerError"),v(h),[3,4];case 4:return[2]}}))}))}function b(e,t,n){var r=t?u:c,a=r[e.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[e.Id]}return null}},280:function(e,t,n){"use strict";var r=n(576);n.d(t,"a",(function(){return r.a}))},2861:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1679);function a(e,t,n,a,i){if(i){var o="getWacAttachmentInfo"+i;(a=a||{}).headers=a.headers||new Headers,a.headers.set("X-OWA-ActionName",o)}return Object(r.a)({attachmentId:e,isEdit:t,draftId:n,appId:null},a)}},2862:function(e,t,n){"use strict";var r=n(1005),a=n(284);t.a=Object(a.action)("setAttachmentOriginalUrl")((function(e,t){Object(r.a)(e).model.AttachmentOriginalUrl=t}))},2873:function(e,t,n){"use strict";var r=n(0),a=n(438),i=n(25);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ImportCalendarEventJsonRequest:#Exchange"},n)),Object(i.a)("ImportCalendarEvent",e,t)}var c=n(1029),u=n(245),s=n(315);function d(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return i?[4,Object(s.e)(i)]:[3,2];case 1:l=f.sent(),d={headers:l.headers,authNeededOnUnAuthorized:l.authNeededOnUnAuthorized},f.label=2;case 2:return[2,o({Header:Object(u.a)(),Body:(v={Content:e,ImportedItemFolderId:Object(c.a)({BaseFolderId:Object(a.a)({Id:t})}),AttachmentId:n},Object(r.__assign)({__type:"ImportCalendarEventRequest:#Exchange"},v))},Object(r.__assign)({datapoint:{jsonCustomData:function(e){return{status:e.ResponseClass,numberOfEventsImported:e.NumberOfEventsImported}}}},d)).then((function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")}))]}var v}))}))}n.d(t,"a",(function(){return d}))},288:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return d}));var r=n(115),a=(n(489),new r.c((function(){return Promise.all([n.e(49),n.e(4),n.e(470)]).then(n.bind(null,915))}))),i=(new r.a(a,(function(e){return e.makeOwsPrimeRequest})).importAndExecute,new r.a(a,(function(e){return e.makePostRequest})).importAndExecute),o=new r.a(a,(function(e){return e.makePatchRequest})).importAndExecute,c=new r.a(a,(function(e){return e.makePutRequest})).importAndExecute,u=new r.a(a,(function(e){return e.makeGetRequest})).importAndExecute,s=new r.a(a,(function(e){return e.makeDeleteRequest})).importAndExecute,d=new r.a(a,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},3004:function(e){e.exports=JSON.parse('{"a":"U1b"}')},3622:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(254),i=n(1344),o=n(1640),c=n(75);function u(e,t,n,u,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l,f,v,b,p,m,h,w,O,g,I,j,S;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:d=new a.a("getWacInfoForOneDriveJsApi",{isCore:!0}),u&&d.addCustomData({redeemSharingLinkIfNecessary:u}),r.label=1;case 1:return r.trys.push([1,3,,4]),l=btoa(t),f="u!"+l.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),v=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0],b=v+"_api/v2.0/shares/"+f+"/root?select=openWith/wac,officeBundle,@content.downloadUrl,name,size,currentUserRole&action="+(n?"Open":"View"),p=new Object,u&&(p.prefer="redeemSharingLinkIfNecessary"),m=Object(i.a)({ProviderType:e,Url:b,Headers:JSON.stringify(p)}),h=(new Date).getTime(),[4,Object(o.a)(m)];case 2:if(200===(w=r.sent()).Status&&w.Body)return O=(new Date).getTime(),(g=JSON.parse(w.Body)).fetchStartTime=h,g.responseStartTime=O,!g.openWith.wac&&s||(g.openWith.wac.fileGetUrl=g["@content.downloadUrl"],g.openWith.wac.accessTokenExpiry&&(g.openWith.wac.accessTokenExpiry=new Date(Number(g.openWith.wac.accessTokenExpiry))),!n&&g.currentUserRole&&(g.currentUserRole.readOnly=!0)),d.end(),[2,g];throw d.addCustomData({StatusCode:w.Status}),(I=w.Headers)&&(j=JSON.parse(I))&&d.addCustomData({SharePointError:j.SharePointError,SPClientServiceRequestDuration:j.SPClientServiceRequestDuration,SPRequestGuid:j.SPRequestGuid}),new Error("Result status is: "+w.Status+" or empty response body.");case 3:return S=r.sent(),d.endWithError("ServerError",S),c.g.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+S),[3,4];case 4:return[2,null]}}))}))}},4314:function(e){e.exports=JSON.parse('{"a":"m5b"}')},4495:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return r}))},4840:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(4),i=Object(a.action)("initializeReadingPaneInSxS",(function(e,t,n,r,a,i){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:r,sxsId:a,isProjectionPopout:i}})),o=Object(a.action)("initializeConversationReadingPaneInSxS",(function(e,t,n,r,a){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:r,sxsId:a}})),c=Object(a.action)("initializeItemReadingPaneInSxS",(function(e,t,n){return{readingPaneStrategy:e,instrumentationContext:t,sxsId:n}})),u=Object(a.action)("initializeReadingPaneInSxSByCopyingMailReadingPane",(function(e,t,n,r,a){return{previewPaneSelectionSource:e,parentItemId:t,instrumentationContext:n,sxsId:r,isProjectionPopout:a}})),s=n(314),d=n(1659),l=n(1156);Object(a.orchestrator)(o,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,o=e.sxsId,t&&t.conversationId?(c=Object(l.j)(o)).readingPaneState&&c.readingPaneState.mode===l.g.ConversationReadingPane&&c.readingPaneState.conversationId&&c.readingPaneState.conversationId.Id===t.conversationId.Id?(a&&function(e){switch(e){case l.c.MailList:case l.c.ConversationAttachmentWell:return!0;case l.c.ReadingPane:case l.c.FilesHub:case l.c.PhotoHub:case l.c.GroupFilesHub:case l.c.ConsumerGroupFilesHub:case l.c.Deeplink:case l.c.FileSuggestion:case l.c.LinkSuggestion:case l.c.ComposeDocLink:case l.c.ReadingPaneDocLink:case l.c.FolderTree:return!1;default:return Object(s.a)(e)}}(n)&&d.r.importAndExecute(t.conversationId.Id,a.Id),[2]):(Object(l.H)(t.conversationId.Id),[4,d.k.importAndExecute(t.conversationId,i,t.conversationSubject,t.conversationCategories,t.itemIdToScrollTo)]):[2];case 1:return r.sent(),Object(l.M)({mode:l.g.ConversationReadingPane,conversationId:t.conversationId,conversationCategories:t.conversationCategories,conversationSubject:t.conversationSubject},o),a&&d.r.importAndExecute(t.conversationId.Id,a.Id),[2]}}))}))})),Object(a.orchestrator)(c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.instrumentationContext,a=e.sxsId,t&&t.itemId?(i=Object(l.j)(a)).readingPaneState&&i.readingPaneState.mode===l.g.ItemReadingPane&&i.readingPaneState.itemId&&i.readingPaneState.itemId.Id===t.itemId.Id?[2]:(Object(l.H)(t.itemId.Id),(o=Object(d.c)())&&o.itemId==t.itemId.Id?(Object(l.M)({mode:l.g.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:o},a),[3,4]):[3,1]):[2];case 1:return[4,d.m.import()];case 2:return[4,r.sent()(t.itemId,n,(function(e){Object(l.M)({mode:l.g.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:e},a)}))];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}));var f=n(2314),v=n(1157),b=n(2472),p=n(1110),m=n(1214),h=n(1101),w=n(573),O=n(1332),g=n(7836),I=n(1552),j=n(961);Object(a.orchestrator)(u,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,u,s,d,S,_,C,P,T,y,x,A,E,R,D,k;return Object(r.__generator)(this,(function(M){switch(M.label){case 0:return e.isProjectionPopout?[2]:(t=Object(l.j)(e.sxsId)).shouldShow&&(t.readingPaneState||t.composeId)?[2]:(n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,u=null===(k=j.T.tableViews.get(j.T.selectedTableViewId))||void 0===k?void 0:k.tableQuery,s=u&&(Object(j.M)(u)||Object(b.c)(u)),d=Object(h.d)(),(S=Object(g.a)())?Object(w.v)()&&window.opener?[2]:S.composeId!==v.a.primaryComposeId?[3,2]:[4,O.k.import()]:[3,5]);case 1:M.sent()(S,!0,!0),d=Object(h.d)(),M.label=2;case 2:return[4,h.k.importAndExecute(d,!1)];case 3:return M.sent(),[4,l.C.import()];case 4:return M.sent()(S.composeId,e.sxsId),[2];case 5:if(_=p.a.deeplinkId,C=Object(m.a)(),_)c({method:f.a.LoadItemReadingPane,itemId:{mailboxInfo:_.mailboxInfo,Id:_.id}},i,e.sxsId);else if(d&&d.type===h.a.SecondaryReadingPane)switch((P=d.data).listViewType){case 0:o({method:f.a.LoadConversationReadingPane,conversationId:P.id,conversationSubject:P.subject,conversationCategories:P.categories},n,a,i,e.sxsId);break;case 1:c({method:f.a.LoadItemReadingPane,itemId:P.id},i,e.sxsId)}else if(C&&Object(I.a)(C.conversationId.Id))o({method:f.a.LoadConversationReadingPane,conversationId:C.conversationId,conversationSubject:C.conversationSubject,conversationCategories:C.conversationCategories},n,a,i,e.sxsId);else if(T=Object(j.C)(),y=T&&Object(r.__spread)(T.selectedRowKeys.keys()),x=null==T?void 0:T.isInVirtualSelectAllMode,A=j.T.expandedConversationViewState.selectedNodeIds.length,1==y.length&&A<=1&&!x&&!s)switch(E=j.b.getRowClientItemId(y[0],T),T&&T.tableQuery.listViewType){case 0:R=j.b.getSubject(y[0],T),D=j.b.getCategories(y[0],T),o({method:f.a.LoadConversationReadingPane,conversationId:E,conversationSubject:R,conversationCategories:D},n,a,i,e.sxsId);break;case 1:c({method:f.a.LoadItemReadingPane,itemId:E},i,e.sxsId)}return[2]}}))}))})),Object(a.orchestrator)(i,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,s,d;return Object(r.__generator)(this,(function(r){if(t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,s=e.sxsId,d=e.isProjectionPopout,!t)return[2];switch(t.method){case f.a.NoOp:return[2];case f.a.AlwaysHidden:return Object(l.M)(null,s),[2];case f.a.CopyMailReadingPaneContainer:return u(n,a,i,s,d),[2];case f.a.LoadConversationReadingPane:return o(t,n,a,i,s),[2];case f.a.LoadItemReadingPane:return c(t,i,s),[2];default:return[2]}return[2]}))}))}));var S=n(254),_=n(1077),C=n(1346),P=n(1049),T=n(1522),y=n(3005),x="download",A="open";function E(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(y.a)(e.AttachLongPathName),[4,Object(T.l)(n)];case 1:return a=r.sent(),[2,(null===(t=a.result)||void 0===t?void 0:t.webContentLink)&&(i=a.result.webContentLink,i.lastIndexOf(x,i.length-x.length)>-1)?R(a.result.webContentLink):null]}var i}))}))}function R(e){return e.slice(0,-x.length)+A}var D=n(1272),k=n(1137),M=n(9368),N=n(1692),L=n(3622),U=n(8081),F=n(106),W=n(76),V=n(980),B=n(4495),G=n(435),H=n(10),z=n(3004),q=n(5509),J=n(4314),$=n(977),X=n(8154),Y=n(3),K=n(1441),Q=n(75);function Z(e){switch(e){case _.b.Unsupported:return"Unsupported";case _.b.Image:return"Image";case _.b.MailItem:return"MailItem";case _.b.CalendarEvent:return"CalendarEvent";case _.b.Wac:return"Wac";case _.b.SuiteExtensions:return"SuiteExtensions";case _.b.Audio:return"Audio";case _.b.Text:return"Text";case _.b.NativeView:return"NativeView";case _.b.GoogleDoc:return"GoogleDoc";case _.b.PdfJs:return"PdfJs";case _.b.ItemAttachment:return"ItemAttachment";case _.b.Video:return"Video";default:return Object(s.a)(e)}}var ee="/owa/{0}/service.svc/s/GetAttachmentPdfPreview?id={1}";function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(H.c)(ee,e,encodeURIComponent(t)),[4,fetch(n,{credentials:"same-origin"})];case 1:return[2,r.sent()]}}))}))}function ne(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i,o,c,u,s,d,l,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,te(null===(t=e.mailboxInfo)||void 0===t?void 0:t.routingKey,e.Id)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:for(a=r.sent(),i=a.replace(/\s/gi,""),o=atob(i),c=o.length,u=new Uint8Array(new ArrayBuffer(c)),s=0;s<c;s++)u[s]=o.charCodeAt(s);return d=n.headers.get("PrintAllowed"),l=n.headers.get("CopyAllowed"),f=n.headers.get("ExportAllowed"),[2,{data:u,printAllowed:!d||"true"===d.toLowerCase(),copyAllowed:!l||"true"===l.toLowerCase(),exportAllowed:!f||"true"===f.toLowerCase()}];case 3:throw n.statusText}}))}))}var re=n(2);function ae(e,t){var n=Object(re.D)()?"OWA-PWA":"OWA-WEB",r=t?"SXS-EDIT":"SXS-VIEW",a="";switch(e){case l.c.MailList:a="ML";break;case l.c.ConversationAttachmentWell:a="CAW";break;case l.c.ReadingPane:a="RP";break;case l.c.FilesHub:a="FH";break;case l.c.PhotoHub:a="PH";break;case l.c.GroupFilesHub:a="GFH";break;case l.c.ConsumerGroupFilesHub:a="CGF";break;case l.c.Deeplink:a="DL";break;case l.c.FileSuggestion:a="FS";break;case l.c.LinkSuggestion:a="LS";break;case l.c.ComposeDocLink:a="CDL";break;case l.c.ReadingPaneDocLink:a="RPDL";break;case l.c.FolderTree:a="FT";break;default:a="UNKNOWN"}return n+"."+a+"."+r}var ie=n(2374);function oe(e){var t=new Error(e);throw t.isUserError=!0,t}function ce(e){if(null!=e&&e.isUserError)return!0;return!1}var ue=n(14129),se=n(2464),de=[".odp",".pot",".potm",".potx",".pps",".ppsm",".ppsx",".ppt",".pptm",".pptx"];function le(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,O.j.import()];case 1:return t.sent()(e.Id,3,!1),[2]}}))}))}function fe(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return t=e.mailboxInfo,n=t&&t.type==F.a.GroupMailbox?t.mailboxSmtpAddress:null,[4,O.d.import()];case 1:return[4,i.sent()(e.Id,!0,n,!1)];case 2:return a=i.sent(),[2,Object(r.__assign)(Object(r.__assign)({},a.ItemId),{mailboxInfo:e.mailboxInfo})]}}))}))}function ve(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=Object(I.a)(e))?[4,O.r.import()]:[3,3];case 1:return[4,n.sent()(t)];case 2:return n.sent(),[2,t.itemId];case 3:return[2,null]}}))}))}function be(e,t,n,a,o,c,u,s,d,f,v){var m,w;return void 0===v&&(v=l.e.Mail),Object(r.__awaiter)(this,void 0,void 0,(function(){function O(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c?[3,1]:(n=null,[3,3]);case 1:return[4,c()];case 2:n=r.sent(),r.label=3;case 3:return t=n,te(),Oe.setImagePreviewState(je,_e.previewImage.url,t,ye,!ye&&!Object(k.e)().printWithoutDownloadEnabled,Ee),[4,P.k.import()];case 4:return[4,r.sent()(e.attachmentId,e.isReadOnly)];case 5:return r.sent(),te(),Oe.setImagePreviewState(je,Se(e.attachmentId).previewImage.url,t,ye,!ye&&!Object(k.e)().printWithoutDownloadEnabled,Ee),[2]}}))}))}function T(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=_e.model.ProviderType,Object(C.b)(e.isCloudy,t,_e.model.Name)&&t===P.a.providers.ONE_DRIVE_PRO?[4,x()]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,y()];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))}function y(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,i,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=!1,[4,Object(U.a)(e.attachmentId,t,l.c[o])];case 1:return n=r.sent(),_e.model.Name&&(a=_e.model.Name.lastIndexOf("."))>=0&&(i=_e.model.Name.substr(a).toLowerCase(),Ee.useHighContrastCommandBar=de.indexOf(i)>=0),te(),Oe.setWacPreviewState(je,n.wacUrl,null,n.accessToken,n.accessTokenTtl,n.additionalParameters,n.deprecatedTokenAndParameters,re.getTime(),!t,Ee),[3,3];case 2:if(c=r.sent(),null==(u=c)?void 0:u.errorMessage)throw Q.g.warn("Something went wrong while getting the attachment state: "+u),Oe.setPreviewError(je,u.errorMessage),u.error;throw c;case 3:return[2]}}))}))}function x(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a,i,c,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),Ne.addCustomData({useJsApi:"true"}),e=_e,null==(t=Object(W.h)("doc-unwrap-safelinks")?e.originalUrl:e.openUrl))throw new Error("openUrl is null");return n=_e.model.Name,a=n&&n.substring(n.lastIndexOf(".")),d=a,i=!Object(W.h)("doc-SxS-jsApi-ODB-Readonly")&&".xls"!==d,[4,Object(L.a)(0,t,i,!0)];case 1:if(!(c=r.sent()))throw new Error("Vroom API call failed");return te(),u=Object(G.a)(),Oe.setWacPreviewState(je,c.openWith.wac.applicationUrl,{bootScriptUrl:c.openWith.wac.bootstrapperUrl,wopiSrcUrl:c.openWith.wac.wopiSrc,accessToken:c.openWith.wac.accessToken,accessTokenExpiry:c.openWith.wac.accessTokenExpiry,fileSize:_e.model.Size,fileGetUrl:c.openWith.wac.fileGetUrl,bundleInfo:c.officeBundle,fetchStartTime:c.fetchStartTime,responseStartTime:c.responseStartTime,openUrl:t,owaSessionId:u,userId:c.openWith.wac.userId,sessionOrigin:ae(o,i),clientThrottlingProtection:c.openWith.wac.clientThrottlingProtection,requestedCallThrottling:c.openWith.wac.requestedCallThrottling},null,null,null,null,re.getTime(),c.currentUserRole.readOnly,Ee),Ne.addCustomData({owaSessionId:u}),[3,3];case 2:throw s=r.sent(),Q.g.warn("Something went wrong while getting the attachment state: "+s.message),Oe.setPreviewError(je,Object(H.b)(z.a)),s;case 3:return[2]}var d}))}))}function A(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Object(D.b)(_e.model)&&_e.model.ProviderType===P.a.providers.GDRIVE?[4,R()]:[3,2];case 1:return n.sent(),[3,3];case 2:t=Object(N.a)(e.attachmentId,_e.model,3,Object(D.b)(_e.model),e.isReadOnly),Oe.setNativePdfPreviewState(je,_e.download.url+"&isDocumentPreview=True#toolbar=0",t,"application/pdf",Ee),n.label=3;case 3:return[2]}}))}))}function R(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,E(_e.model)];case 2:return(t=r.sent())?(te(),Oe.setNativePdfPreviewState(je,t,null,"application/pdf",Ee),[2]):[3,4];case 3:return n=r.sent(),e=n,[3,4];case 4:throw te(),Oe.setPreviewError(je,Object(H.b)(q.a)),e||new Error("Unexpected error in handleNativeViewPreviewForGDrive")}}))}))}function F(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(k.c)(_e.model,!0),ye&&t.directFileAccessEnabled&&!De?(Oe.setPdfJsPreviewState(je,_e.download.url+"&isDocumentPreview=True",!1,Ee),[3,3]):[3,1];case 1:return[4,ne(e.attachmentId)];case 2:n=r.sent(),te(),Oe.setPdfJsPreviewStateByData(je,n.data,!ye&&!Object(k.e)().printWithoutDownloadEnabled||!n.printAllowed,n.copyAllowed,n.exportAllowed,Ee),r.label=3;case 3:return[2]}}))}))}function V(){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(M.a)(e.attachmentId.Id,null===(t=e.attachmentId.mailboxInfo)||void 0===t?void 0:t.requestOptions,0,l.c[o])];case 1:return n=r.sent(),te(),Oe.setTextPreviewState(je,n,ye,Ee),[3,3];case 2:if(a=r.sent(),null==(i=a)?void 0:i.errorMessage)throw te(),Oe.setPreviewError(je,i.errorMessage),i.error;throw a;case 3:return[2]}}))}))}function ee(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t={calendarItem:null,isIcsAttachmentLoading:!0,icsCalendarEventType:X.a.UNKNOWN,attachmentId:e.attachmentId,addToCalendarStatus:1,errorMessage:null},[4,X.d.import()];case 1:return n=r.sent(),a=null,[4,n({attachmentId:e.attachmentId,size:_e.model.Size,showSizeLimitExceedsError:function(){a=Object(H.b)(ue.a)},errorCallback:function(){a=Object(H.b)(J.a)},state:t})];case 2:if(r.sent(),te(),a)throw Oe.setPreviewError(je,a),new Error(a);return be.onShowCustomPreview(t,f),Oe.setCustomPreviewState(je,Ee),[2]}}))}))}function te(){Object(l.j)(f).pendingPreviewOperation&&Fe.id===Object(l.j)(f).pendingPreviewOperation.id||oe("Preview changed before loading finished")}var re,be,we,Oe,ge,Ie,je,Se,_e,Ce,Pe,Te,ye,xe,Ae,Ee,Re,De,ke,Me,Ne,Le,Ue,Fe,We,Ve,Be,Ge,He,ze,qe;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return re=new Date,[4,l.F.import()];case 1:return be=c.sent(),ie.a.available()?(d=d||window,we=d!==window,ie.a.run(d,f),[4,K.u.import()]):(be.openSxSInANewWindow(t,e.attachmentId.Id,null),[2]);case 2:return Oe=c.sent(),ge=be.onPreviewOperationStart,Ie=be.onPreviewOperationFinished,je=Object(l.j)(f).viewState,[4,P.i.import()];case 3:Se=c.sent(),_e=Se(e.attachmentId),Ce=e.strategy,Pe=-1!==Ce.supportedOpenActions.indexOf(_.a.Download),Te=Pe&&(null==_e?void 0:_e.download)?_e.download.url:null,ye=_e.info.allowDownload,xe=Ce.isSaveToCloudSupported&&Object(H.f)(_e.model.AttachmentOriginalUrl),Ae=xe?1:0,Ee={downloadUrl:Te,downloadShouldOpenNewTab:!1,fileName:_e.model.Name,useHighContrastCommandBar:!1,id:e.attachmentId,isCloudy:e.isCloudy},Re=Ce.previewMethod,De=!1,Ce.previewMethod!==_.b.NativeView&&Ce.previewMethod!==_.b.PdfJs||(ke=$.w.items.get(t.Id))&&ke.RightsManagementLicenseData&&(Re=_.b.PdfJs,De=!0),Me=function(e,t,n,r,a,i,o,c){var u,s,d=he(e),f=new S.a("PreviewAttachmentInSxSE2E",{timeout:pe}),v=Date.now(),b=!1;c&&(b=!!me&&me===c,me=c);var p={previewMethod:Z(t),isCloudy:n?"cloudy":"classic",isChangingFromEditing:r?"changingFromEdit":"",officeFileType:Object(B.a)(d),actionSource:l.c[a],attachmentFileType:i,isRepeat:o,downloadAllowed:!!e.download.url,fromSameReadingPane:b},m="";Object(W.h)("doc-SxS-jsApi-ODB-Base")&&(m+="doc-SxS-jsApi-ODB-Base;");Object(W.h)("doc-SxS-jsApi-ODB-BaseNoEditString")&&(m+="doc-SxS-jsApi-ODB-BaseNoEditString;");Object(W.h)("doc-SxS-jsApi-ODB-Readonly")&&(m+="doc-SxS-jsApi-ODB-Readonly;");Object(W.h)("doc-SxS-jsApi-ODB-Basecf")&&(m+="doc-SxS-jsApi-ODB-Basecf;");p.associatedFlights=m,p.hostName=window.location.hostname,Object(W.h)("doc-SxS-stickyHideEmail")&&(p.hideEmailOption=null===(u=K.u.tryImportForRender())||void 0===u?void 0:u.getHideReadingPaneOption());return f.addCustomData(p),f.addCosmosOnlyData(JSON.stringify({attachmentId:null===(s=null==e?void 0:e.id)||void 0===s?void 0:s.Id,fileType:(null==d?void 0:d.substring(0,4))||"",fileSize:e.model.Size})),Object(S.o)("PreviewAttachmentInSxSUsage",p),{perfDatapoint:f,perfDatapointCreatedTime:v}}(_e,Re,e.isCloudy,Object(l.j)(f).editState.mode!==l.b.View,o,e.fileType,be.repeatTracker.contains(e.attachmentId.Id),!Object(l.j)(f).shouldShow&&function(){var e,t,n,a,i,o=null===(e=j.T.tableViews.get(j.T.selectedTableViewId))||void 0===e?void 0:e.tableQuery,c=o&&(Object(j.M)(o)||Object(b.c)(o)),u=Object(h.d)(),s=Object(g.a)(),d=null===(t=null==s?void 0:s.itemId)||void 0===t?void 0:t.Id;if(d)return d;var l=Object(p.b)(),f=l.conversationReadingPaneViewState,v=l.deeplinkId;if(v)return v.id;if(u&&u.type===h.a.SecondaryReadingPane){var m=u.data;return null===(n=null==m?void 0:m.id)||void 0===n?void 0:n.Id}if(f&&Object(I.a)(f.conversationId.Id))return f.conversationId.Id;var w=Object(j.C)(),O=w&&Object(r.__spread)(w.selectedRowKeys.keys()),S=null==w?void 0:w.isInVirtualSelectAllMode,_=null===(i=null===(a=j.T.expandedConversationViewState)||void 0===a?void 0:a.selectedNodeIds)||void 0===i?void 0:i.length;return 1===(null==O?void 0:O.length)&&_<=1&&!S&&!c?j.b.getRowClientItemId(O[0],w).Id:null}()),Ne=Me.perfDatapoint,Le=Me.perfDatapointCreatedTime,Ue=function(){Ne.addCustomData({autoHide:!0})},je.eventManager.on(K.a,Ue),Fe={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.attachmentId},ge(Fe,f),c.label=4;case 4:return c.trys.push([4,30,31,32]),[4,be.canCloseSxS(f)];case 5:if(c.sent()||Ne.addCustomData({exitEditMode:"notSaved"}),te(),a&&!n||i(u,o,t,s,f,we),We=null==t?void 0:t.Id,Ve=We&&Object($.x)(We),Oe.setPreviewLoading(je,"",Ee),be.showSxS(Object(l.j)(f).shouldShow?null:v,{previewMode:Re,attachmentId:e.attachmentId,selectionSource:o,isCloudy:e.isCloudy,saveToCloudStatus:Ae,textPreviewReadMode:0},{editAllowed:Ce.allowEdit&&!(Object(Y.d)("sxsHideEdit")&&(Object(l.j)(f).shouldShow?Object(l.j)(f).customization:v)===l.e.DeepLink),itemId:t,isDraft:n},null,{itemId:We,fileId:e.attachmentId.Id,fileType:he(_e),sender:null===(w=null===(m=(null==Ve?void 0:Ve.From)||(null==Ve?void 0:Ve.Sender))||void 0===m?void 0:m.Mailbox)||void 0===w?void 0:w.EmailAddress,startTime:(new Date).getTime()},f,d==window?1:2),Object(l.L)(null),Be=void 0,a)return[3,25];switch(Re){case _.b.Image:return[3,6];case _.b.Wac:return[3,8];case _.b.GoogleDoc:return[3,10];case _.b.NativeView:return[3,11];case _.b.PdfJs:return[3,13];case _.b.Audio:return[3,15];case _.b.Video:return[3,16];case _.b.Text:return[3,17];case _.b.ItemAttachment:return[3,19];case _.b.CalendarEvent:return[3,20]}return[3,22];case 6:return[4,O()];case 7:return c.sent(),[3,23];case 8:return[4,T()];case 9:return c.sent(),[3,23];case 10:return Oe.setIframePreviewState(je,_e.model.AttachLongPathName,Ee),[3,23];case 11:return[4,A()];case 12:return c.sent(),[3,23];case 13:return[4,F()];case 14:return c.sent(),[3,23];case 15:return Oe.setAudioPreviewState(je,_e.download.url,Ee),[3,23];case 16:return Oe.setVideoPreviewState(je,_e.download.url,Ee),[3,23];case 17:return[4,V()];case 18:return c.sent(),[3,23];case 19:return Object(se.a)(e.attachmentId,null),Oe.setCustomPreviewState(je,Ee),[3,23];case 20:return[4,ee()];case 21:return c.sent(),[3,23];case 22:throw new Error("Unsupported preview method");case 23:return[4,be.waitForPreviewLoadOrThrowError(f)];case 24:Be=c.sent(),c.label=25;case 25:return te(),Ie(f),a?n?[4,l.u.import()]:[3,27]:[3,29];case 26:return c.sent()(le,f),[3,29];case 27:return[4,l.t.import()];case 28:c.sent()(le,fe,ve,f),c.label=29;case 29:return Ge=null==Be?void 0:Be.errorObject,He=null==Be?void 0:Be.loadedTime,Ge&&Ne.addCustomData({errorObject:Ge}),He?(ze=He-Le,Ne.end(ze)):Ne.end(),be.repeatTracker.add(e.attachmentId.Id),[3,32];case 30:return qe=c.sent(),Ne.endWithError(ce(qe)?"UserError":"ServerError",qe),[3,32];case 31:return je.eventManager.off(K.a,Ue),[7];case 32:return[2]}}))}))}var pe=18e4,me=null;function he(e){return 8!==e.attachmentClass&&9!==e.attachmentClass&&Object(V.c)(e.model.Name||"")||e.model.ContentType||""}var we=n(1005),Oe=n(1874);function ge(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.viewState&&Object(we.a)(e.viewState.attachmentId))&&Object(P.e)(t.model)?[4,Oe.n.import()]:[3,2];case 1:return n.sent()(t.model,e.parentItemId),[2];case 2:return e.onBeforePreview&&e.onBeforePreview(),[4,be(e.viewState,e.parentItemId,e.isDraft,e.isEdit,e.previewPaneSelectionSource,e.createImageGallery,{method:f.a.CopyMailReadingPaneContainer},e.instrumentationContext,e.targetWindow,e.sxsId)];case 3:return n.sent(),[2]}}))}))}var Ie=n(7522);function je(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=null,Object(W.h)("rp-projectionPopout")&&Object(W.h)("doc-SxS-multipleViews")?"IMG"!==(null===(n=null===(t=e)||void 0===t?void 0:t.tagName)||void 0===n?void 0:n.toUpperCase())?[3,2]:[4,Ie.b.import()]:[3,4];case 1:return i=r.sent(),a=i(e),[3,3];case 2:a=e,r.label=3;case 3:return[3,7];case 4:return e instanceof HTMLElement?[4,Ie.b.import()]:[3,6];case 5:return i=r.sent(),a=i(e),[3,7];case 6:a=e,r.label=7;case 7:return[2,a]}}))}))}function Se(e,t,n,a){var o,c,u;return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,d,v,b,p,m,w,O,g,I,j,S,C;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=(null===(c=null===(o=a)||void 0===o?void 0:o.ownerDocument)||void 0===c?void 0:c.defaultView)||window,d=s===window?"primaryTab":Object(h.f)(s),v=s!==window,ie.a.run(s,d),b=Object(l.j)(d),[4,l.B.import()];case 1:return p=r.sent(),[4,l.A.import()];case 2:return m=r.sent(),[4,je(a)];case 3:(w=r.sent())||(w=b.viewState),O={downloadUrl:e.downloadUrl,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:e.id},g={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.id},p(g,d),r.label=4;case 4:return r.trys.push([4,8,,9]),[4,l.E.import()];case 5:return I=r.sent(),[4,K.k.import()];case 6:return j=r.sent(),[4,P.i.import()];case 7:return S=r.sent(),C=null===(u=S(e.id))||void 0===u?void 0:u.info.allowDownload,b.pendingPreviewOperation&&g.id===b.pendingPreviewOperation.id||oe("Preview changed before loading finished"),i({method:f.a.CopyMailReadingPaneContainer},l.c.ReadingPane,null,null,d,v),j(w,e.previewUrl,t,C,!C&&!Object(k.e)().printWithoutDownloadEnabled,O),I(b.shouldShow?null:l.e.Mail,{previewMode:_.b.Image,attachmentId:e.id,selectionSource:l.c.ReadingPane,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:n,isDraft:!1},null,null,d,1),Object(l.L)(null),m(d),[3,9];case 8:return r.sent(),[3,9];case 9:return[2]}}))}))}function _e(e,t,n,a,o,c,u,s,d,f){return void 0===f&&(f=l.e.Mail),Object(r.__awaiter)(this,void 0,void 0,(function(){function v(){g.pendingPreviewOperation&&T.id===g.pendingPreviewOperation.id||oe("Preview changed before loading finished")}var b,p,m,h,w,O,g,I,j,C,P,T,y,x,A,E,R,D;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=s||window,b=s!==window,ie.a.run(s,d),p=e(),[4,K.u.import()];case 1:return m=r.sent(),[4,l.F.import()];case 2:h=r.sent(),w=h.onPreviewOperationStart,O=h.onPreviewOperationFinished,g=Object(l.j)(d),I=g.viewState,j={downloadUrl:null,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:null,fileName:null},C=function(e,t){var n=new S.a("PreviewLinkInSxSE2E");return n.addCustomData({previewMethod:Z(e),actionSource:l.c[t]}),n}(_.b.Wac,n),P=function(){C.addCustomData({autoHide:!0})},I.eventManager.on(K.a,P),T={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:null},w(T,d),r.label=3;case 3:return r.trys.push([3,10,11,12]),[4,h.canCloseSxS(d)];case 4:r.sent(),v(),i(a,n,t,o,d,b),m.setPreviewLoading(I,"",j),h.showSxS(g.shouldShow?null:f,{previewMode:_.b.Wac,attachmentId:null,selectionSource:n,isCloudy:!0,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:t,isDraft:!1},c,null,d,b?2:1),Object(l.L)(c,u),r.label=5;case 5:return r.trys.push([5,7,,8]),[4,p];case 6:return y=r.sent(),v(),y.jsApiInfo&&(x=Object(G.a)(),y.jsApiInfo.owaSessionId=x,A=ae(n,!0),y.jsApiInfo.sessionOrigin=A,j.fileName=y.jsApiInfo.fileName,function(e,t,n){var r=Object(V.c)(t.fileName);e.addCustomData({useJsApi:"true",officeFileType:Object(B.a)(r),owaSessionId:t.owaSessionId,extraInfo:n}),e.addCosmosOnlyData(JSON.stringify({fileType:(null==r?void 0:r.substring(0,4))||""}))}(C,y.jsApiInfo,y.extraInfo)),m.setWacPreviewState(I,y.wacUrl,y.jsApiInfo,y.accessToken,y.accessTokenTtl,y.additionalParameters,y.deprecatedTokenAndParameters,(new Date).getTime(),u,j),[3,8];case 7:throw E=r.sent(),(null==(R=E)?void 0:R.errorMessage)?(m.setPreviewError(I,R.errorMessage),R.error):(m.setPreviewError(I,E.message||""+E),E);case 8:return[4,h.waitForPreviewLoadOrThrowError(d)];case 9:return r.sent(),v(),O(d),C.end(),[3,12];case 10:return D=r.sent(),C.endWithError(ce(D)?"UserError":"ServerError",D),[3,12];case 11:return I.eventManager.off(K.a,P),[7];case 12:return[2]}}))}))}n.d(t,"previewAttachment",(function(){return ge})),n.d(t,"previewAttachmentInSxS",(function(){return be})),n.d(t,"previewImageInSxS",(function(){return Se})),n.d(t,"previewLinkInSxS",(function(){return _e}))},489:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r="owsserver",a="owsapi"},490:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},5048:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5509),a=n(6041),i=n(3004),o=n(10);function c(e){switch(e){case 2:return Object(o.b)(a.d);case 3:return Object(o.b)(a.e);case 5:return Object(o.b)(a.c);case 6:return Object(o.b)(r.a);case 7:return Object(o.b)(a.g);case 4:return Object(o.b)(a.f);case 10:return Object(o.b)(a.a);case 11:return Object(o.b)(a.b);default:return Object(o.b)(i.a)}}},5212:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SINGLE_EVENT_ICS=1]="SINGLE_EVENT_ICS",e[e.MULTIPLE_EVENT_ICS=2]="MULTIPLE_EVENT_ICS"}(r||(r={}))},528:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(o,c){a?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return o(e)})).catch((function(e){t&&r>=t?c(e):setTimeout((function(){return i(o,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return i(e,t)}))},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},5509:function(e){e.exports=JSON.parse('{"a":"T1b"}')},576:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},6041:function(e){e.exports=JSON.parse('{"d":"V1b","e":"W1b","c":"X1b","g":"Y1b","f":"Z1b","a":"_1b","b":"$1b"}')},613:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},632:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25),a=n(613);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FindItem",e,t)}},633:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},7522:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(115),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(571)]).then(n.bind(null,10145))})),i=new r.b(a,(function(e){return e.getSxSViewStateFromElement})),o=Object(r.d)(a,(function(e){return e.SxSLayerView}));Object(r.d)(a,(function(e){return e.SxSView}))},7836:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1157),a=n(1101);function i(){var e=Object(a.d)(),t=Object(r.b)(),n=e?function(e,t){switch(e.type){case a.a.Primary:return t.primaryComposeId;case a.a.Compose:return e.data;default:return null}}(e,t):t.primaryComposeId,i=n?t.viewStates.get(n):null;return i&&!i.isInlineCompose?i:null}},8081:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(3004),i=n(10),o=n(5048),c=n(2771);function u(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(c.a)(e,t,n,!0)];case 1:return u=r.sent(),[3,3];case 2:throw s=r.sent(),{errorMessage:Object(i.b)(a.a),error:s};case 3:if(0===u.Status)return[2,{wacUrl:u.WacUrl,bootScriptUrl:u.BootScriptUrl,wopiSrcUrl:u.WopiSrcUrl,accessToken:u.AccessToken,accessTokenTtl:u.AccessTokenTtl,additionalParameters:u.AdditionalParameters,deprecatedTokenAndParameters:u.Token}];throw{errorMessage:Object(o.a)(u.Status),error:new Error("GetWacAttachmentInfo failed with status: "+u.Status)}}}))}))}},8154:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(115),a=n(5212);n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return Promise.all([n.e(5),n.e(7),n.e(10),n.e(715),n.e(342)]).then(n.bind(null,11041))})),o=new r.b(i,(function(e){return e.addToCalendar})),c=(new r.b(i,(function(e){return e.getIcsCalendarItem})),new r.b(i,(function(e){return e.getIcsCalendarItemOrchestrator}))),u=Object(r.d)(i,(function(e){return e.IcsPreview}))},9368:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(2183),i=n(75);function o(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s,d,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:c={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."},r.label=1;case 1:return r.trys.push([1,3,,4]),o&&(u="getAttachmentTextPreview"+o,(t=t||{}).headers=t.headers||new Headers,t.headers.set("X-OWA-ActionName",u)),[4,Object(a.a)({AttachmentId:e,ReadMode:n},t)];case 2:if((s=r.sent())&&0===s.Status)return[2,s.Content];switch(d=(null==s?void 0:s.Status)||1){case 2:c.errorMessage="The attachment has been moved or deleted.";break;case 3:c.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:c.errorMessage="Something went wrong while the document preview was being created. Please try again later."}return c.error=new Error("getAttachmentTextPreview failed with status: "+d),[3,4];case 3:return l=r.sent(),i.g.warn("getAttachmentTextPreview failed with error: "+l),c.error=l,[3,4];case 4:throw c}}))}))}},979:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function a(e){var t=r(e);return t?t.replace(".",""):null}function i(e){var t;return(null===(t=a(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}))},980:function(e,t,n){"use strict";var r=n(979),a=n(1342),i=n(10);function o(e){var t;return e>=1073741824?(e/=1073741824,t=Object(i.b)(a.b)):e>=1048576?(e/=1048576,t=Object(i.b)(a.d)):e>=1024?(e/=1024,t=Object(i.b)(a.c)):t=Object(i.b)(a.a),Object(i.c)(t,Math.round(e))}var c,u=n(1093),s=n(76),d=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function l(e){if(!Object(s.h)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&d.indexOf(t.toLowerCase())>=0}function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return c.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return c.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return c.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(c||(c={}));var v=n(1011);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return v.b})),n.d(t,"a",(function(){return c}))},994:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))}}]);
//# sourceMappingURL=owa.AttachmentPreviewSxS.js.map
self.scriptsLoaded['owa.AttachmentPreviewSxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentPreviewSxS.js'] = (new Date()).getTime();