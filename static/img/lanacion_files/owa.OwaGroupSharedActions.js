self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OwaGroupSharedActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[454],{1021:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(4),u=r(23),o=Object(n.createStore)("groupsStore",{groups:new u.ObservableMap})},1040:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(1021);function u(t){var e=Object(n.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},1045:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(0);function u(t){return Object(n.__assign)({__type:"IndexedPageView:#Exchange"},t)}},1050:function(t,e,r){"use strict";var n;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(n||(n={})),e.a=n},1062:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(4),u=r(1104),o=Object(n.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:u.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1067:function(t,e,r){"use strict";r(1314),r(1258);var n=r(1315);r.o(n,"getAccessTypeString")&&r.d(e,"getAccessTypeString",(function(){return n.getAccessTypeString})),r.o(n,"getAccessTypeTooltip")&&r.d(e,"getAccessTypeTooltip",(function(){return n.getAccessTypeTooltip})),r.o(n,"getGroupResource")&&r.d(e,"getGroupResource",(function(){return n.getGroupResource})),r.o(n,"getGroupResourceUrl")&&r.d(e,"getGroupResourceUrl",(function(){return n.getGroupResourceUrl})),r.o(n,"getGroupSiteStatus")&&r.d(e,"getGroupSiteStatus",(function(){return n.getGroupSiteStatus})),r.o(n,"getMembersButtonText")&&r.d(e,"getMembersButtonText",(function(){return n.getMembersButtonText})),r.o(n,"setGroupSiteStatus")&&r.d(e,"setGroupSiteStatus",(function(){return n.setGroupSiteStatus})),r.o(n,"updateGroupSiteAndDocumentUrl")&&r.d(e,"updateGroupSiteAndDocumentUrl",(function(){return n.updateGroupSiteAndDocumentUrl}));var u=r(1316);r.o(u,"getAccessTypeString")&&r.d(e,"getAccessTypeString",(function(){return u.getAccessTypeString})),r.o(u,"getAccessTypeTooltip")&&r.d(e,"getAccessTypeTooltip",(function(){return u.getAccessTypeTooltip})),r.o(u,"getGroupResource")&&r.d(e,"getGroupResource",(function(){return u.getGroupResource})),r.o(u,"getGroupResourceUrl")&&r.d(e,"getGroupResourceUrl",(function(){return u.getGroupResourceUrl})),r.o(u,"getGroupSiteStatus")&&r.d(e,"getGroupSiteStatus",(function(){return u.getGroupSiteStatus})),r.o(u,"getMembersButtonText")&&r.d(e,"getMembersButtonText",(function(){return u.getMembersButtonText})),r.o(u,"setGroupSiteStatus")&&r.d(e,"setGroupSiteStatus",(function(){return u.setGroupSiteStatus})),r.o(u,"updateGroupSiteAndDocumentUrl")&&r.d(e,"updateGroupSiteAndDocumentUrl",(function(){return u.updateGroupSiteAndDocumentUrl}));r(1104);var o=r(1021);r.d(e,"getGroupsStore",(function(){return o.a}));var i=r(1062);r.d(e,"getUnifiedGroupsSettingsStore",(function(){return i.a}));var c=r(1040);r.d(e,"getGroupDetails",(function(){return c.a}));var s=r(1317);r.d(e,"isGroupDetailsValid",(function(){return s.a}));var a=r(1124);r.d(e,"getGroupResource",(function(){return a.a})),r.d(e,"getGroupResourceUrl",(function(){return a.b}));var p=r(1318);r.d(e,"getCurrentGroupSmtpAddress",(function(){return p.a}));var f=r(1090);r.d(e,"getGroupSiteStatusStore",(function(){return f.a}));var d=r(1319);r.d(e,"updateGroupSiteAndDocumentUrl",(function(){return d.a}));var l=r(1232);r.d(e,"setGroupSiteStatus",(function(){return l.b}));var g=r(1320);r.d(e,"getGroupSiteStatus",(function(){return g.a}));var b=r(1321);r.d(e,"getGroupMailboxExternalId",(function(){return b.a}));r(1050),r(1228),r(1202),r(1233),r(1222);var S=r(1324);r.d(e,"getAccessTypeString",(function(){return S.a})),r.d(e,"getAccessTypeTooltip",(function(){return S.b})),r.d(e,"getMembersButtonText",(function(){return S.c}))},1090:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(4),u=r(23),o=Object(n.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new u.ObservableMap})},1104:function(t,e,r){"use strict";var n;r.d(e,"a",(function(){return n})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(n||(n={}))},1124:function(t,e,r){"use strict";r.d(e,"a",(function(){return u})),r.d(e,"b",(function(){return o}));var n=r(1040),u=function(t,e){var r="string"==typeof t?Object(n.a)(t):t;if(!r||!r.GroupResources)return null;var u=r.GroupResources.filter((function(t){return t.Name===e}));return!u||u.length<1?null:u},o=function(t,e){var r=u(t,e);return r&&0!=r.length?r[0].Url:null}},1126:function(t,e,r){"use strict";var n,u,o,i,c,s,a,p,f,d,l,g,b,S,v;var O;r(10);function G(t,e){e,O=t}function j(){return O}r.d(e,"o",(function(){return n})),r.d(e,"n",(function(){return u})),r.d(e,"c",(function(){return o})),r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return c})),r.d(e,"g",(function(){return s})),r.d(e,"d",(function(){return a})),r.d(e,"f",(function(){return p})),r.d(e,"l",(function(){return f})),r.d(e,"m",(function(){return d})),r.d(e,"q",(function(){return l})),r.d(e,"r",(function(){return g})),r.d(e,"h",(function(){return b})),r.d(e,"j",(function(){return S})),r.d(e,"e",(function(){return v})),r.d(e,"p",(function(){})),r.d(e,"k",(function(){return G})),r.d(e,"i",(function(){return j}))},1202:function(t,e,r){"use strict";var n=r(4),u=r(1323),o=Object(n.mutatorAction)("setJoinButtonState",(function(t,e){u.a.groupActionState.set(t.toLowerCase(),e)}));e.a=o},1217:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(0);function u(t){return Object(n.__assign)({__type:"BodyContentType:#Exchange"},t)}},1222:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(1050),u=r(1323);function o(t){t=t.toLowerCase();var e=u.a.groupActionState;return e.has(t)?e.get(t):n.a.None}},1228:function(t,e,r){"use strict";var n=r(4),u=r(1322),o=Object(n.mutatorAction)("setFollowButtonState",(function(t,e){u.a.groupActionState.set(t.toLowerCase(),e)}));e.a=o},1232:function(t,e,r){"use strict";r.d(e,"b",(function(){return o}));var n=r(4),u=r(1090),o=Object(n.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(u.a)().groupSiteStatus.has(t)&&e==Object(u.a)().groupSiteStatus.get(t)||Object(u.a)().groupSiteStatus.set(t,e)}));e.a=o},1233:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(1050),u=r(1322);function o(t){t=t.toLowerCase();var e=u.a.groupActionState;return e.has(t)?e.get(t):n.a.None}},1258:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(76),u=r(1062),o=r(94);function i(){return(Object(n.h)("grp-shareable-crud")||Object(u.a)().isSensitivityLabelsEnabled)&&!Object(o.u)()}},1284:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(4),u=Object(n.createStore)("currentGroupInformationStore",{smtpAddress:""})},1314:function(t,e,r){"use strict";var n=r(4),u=r(23);Object(n.createStore)("personaPhotoStore",{personaPhotoUrls:new u.ObservableMap})()},1315:function(t,e){},1316:function(t,e){},1317:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(1021);function u(t){var e=Object(n.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}},1318:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(1284),u=function(){return Object(n.a)().smtpAddress}},1319:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(4),u=r(1040),o=r(1124),i=Object(n.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,r,n){if(2==e){var i=Object(u.a)(t);Object(o.a)(i,"Site")[0].Url=r,Object(o.a)(i,"Files")[0].Url=n}}))},1320:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(1090);function u(t){return t=t.toLocaleLowerCase(),Object(n.a)().groupSiteStatus.has(t)?Object(n.a)().groupSiteStatus.get(t):0}},1321:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(1040),u=function(t){var e="string"==typeof t?Object(n.a)(t):t;return e?e.ExternalDirectoryObjectId:null}},1322:function(t,e,r){"use strict";var n=r(4),u=r(23);e.a=Object(n.createStore)("followButtonStore",{groupActionState:new u.ObservableMap})()},1323:function(t,e,r){"use strict";var n=r(4),u=r(23);e.a=Object(n.createStore)("joinButtonStore",{groupActionState:new u.ObservableMap})()},1324:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return p})),r.d(e,"c",(function(){return f}));var n=r(1589),u=r(1590),o=r(1636),i=r(1591),c=r(1592),s=r(10);function a(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(s.b)(i.a);if(3===e)return Object(s.b)(c.a)}return""}function p(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(s.b)(o.b);if(3===e)return Object(s.b)(o.c)}return""}function f(t){var e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(s.c)(Object(s.b)(u.a),e.toString()):Object(s.c)(Object(s.b)(n.a),e.toString()):Object(s.b)(o.a)}},1589:function(t){t.exports=JSON.parse('{"a":"bXb"}')},1590:function(t){t.exports=JSON.parse('{"a":"aXb"}')},1591:function(t){t.exports=JSON.parse('{"a":"xXb"}')},1592:function(t){t.exports=JSON.parse('{"a":"wXb"}')},1636:function(t){t.exports=JSON.parse('{"b":"yXb","c":"zXb","a":"AXb"}')},1853:function(t,e,r){"use strict";function n(t,e,r){var n,u,o,i,c,s=t.groups.get(e.toLowerCase());if(s||(r.unreadMessageCount=null,r.groupDetailsError=r.groupDetailsError||!1),!r.groupDetailsError||s&&s.basicInformation||(r.basicInformation={SmtpAddress:e,DisplayName:e}),r.groupDetails){var a=r.groupDetails;s&&s.basicInformation&&!s.groupDetailsError||(r.basicInformation={SmtpAddress:a.SmtpAddress,DisplayName:a.DisplayName,AccessType:a.AccessType,LegacyDN:a.LegacyDN,MailboxGuid:a.MailboxGuid}),r.groupDetails.UserGroupRelationship={SubscriptionType:(null===(n=a.UserGroupRelationship)||void 0===n?void 0:n.SubscriptionType)||0,IsSubscribed:(null===(u=a.UserGroupRelationship)||void 0===u?void 0:u.IsSubscribed)||!1,ShouldIgnoreReply:(null===(o=a.UserGroupRelationship)||void 0===o?void 0:o.ShouldIgnoreReply)||!1,IsMember:(null===(i=a.UserGroupRelationship)||void 0===i?void 0:i.IsMember)||!1,IsOwner:(null===(c=a.UserGroupRelationship)||void 0===c?void 0:c.IsOwner)||!1}}return r}var u=r(284),o=r(1284),i=Object(u.action)("addOrUpdateGroup")((function(t,e,r,u,i){var c;e=e.toLowerCase();var s=void 0!==u&&""!==u;if(s&&(u=u.toLowerCase(),e=r.groupDetails.SmtpAddress),r=n(t,s?u:e,r),t.groups.has(e)||s&&t.groups.has(u)){var a=t.groups.has(e)?t.groups.get(e):t.groups.get(u);r.basicInformation&&(a.basicInformation=r.basicInformation),r.groupDetails&&((null===(c=a.groupDetails)||void 0===c?void 0:c.MailboxSettings)&&!r.groupDetails.MailboxSettings&&(r.groupDetails.MailboxSettings=a.groupDetails.MailboxSettings),a.groupDetails=r.groupDetails),r.members&&(a.members=r.members),null!=r.groupDetailsError&&(a.groupDetailsError=r.groupDetailsError),s&&e!==u&&(void 0!==i&&i(e,u),t.groups.set(e,a),t.groups.delete(u),Object(o.a)().smtpAddress=e)}else t.groups.set(e,r)}));e.a=i},2603:function(t,e,r){"use strict";var n=r(284),u=r(1126),o=r(1204),i=r(1067),c=r(1853),s=r(1232),a=r(1124);var p=function(t,e){var r=Object(a.b)(e,"Site");r?!function(t){return-1==t.indexOf("_layouts/groupstatus.aspx")}(r)?Object(s.a)(t,1):Object(s.a)(t,2):Object(s.a)(t,0)},f=r(4),d=Object(f.action)("beforeGetGroupDetailsStartAction",(function(t){return{groupSmtpAddress:t}}));Object(f.orchestrator)(d,(function(t){3==Object(i.getGroupSiteStatus)(t.groupSmtpAddress)&&Object(i.setGroupSiteStatus)(t.groupSmtpAddress,1)}));var l=d,g=function(t,e){Object(c.a)(Object(i.getGroupsStore)(),t,{basicInformation:null,groupDetails:null,members:null,groupDetailsError:!0}),Object(i.setGroupSiteStatus)(t,0),e&&e()},b=Object(n.action)("getGroupDetailsAction")((function(t,e,r,n){l(t),(u.g||o.f)(t,e).then((function(e){return function(t,e,r,n){if(t&&t.Body&&Object(o.i)(t.Body)){var u=t.Body.GroupDetails;u?(Object(c.a)(Object(i.getGroupsStore)(),u.SmtpAddress,{basicInformation:null,groupDetails:u,members:null,groupDetailsError:!1}),p(e,u),r&&r()):g(e,n)}else g(e,n)}(e,t,r,n)})).catch((function(e){g(t,n)}))}));e.a=b},4061:function(t,e,r){"use strict";var n=r(352),u=r(1062);e.a=Object(n.mutatorAction)("updateUnifiedGroupSettings",(function(t){var e=Object(u.a)();Object.keys(t).forEach((function(r){e[r]=t[r]}))}))},6324:function(t,e,r){"use strict";r.r(e);var n=r(0),u=r(4061),o=r(1705),i=r(4),c=Object(i.action)("loadUnifiedGroupsSettings");Object(i.orchestrator)(c,(function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(o.b)()];case 1:return(null==(t=e.sent())?void 0:t.unifiedGroupSettings)&&t.responseCode===o.a.Success&&Object(u.a)(t.unifiedGroupSettings),[2]}}))}))}));var s=c,a=r(2603);r.d(e,"loadUnifiedGroupsSettings",(function(){return s})),r.d(e,"getGroupDetailsAction",(function(){return a.a}))}}]);
//# sourceMappingURL=owa.OwaGroupSharedActions.js.map
self.scriptsLoaded['owa.OwaGroupSharedActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OwaGroupSharedActions.js'] = (new Date()).getTime();