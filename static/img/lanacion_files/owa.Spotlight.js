self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Spotlight.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[565],{1029:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},e)}},1097:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange"}(r||(r={}));var i=r,o=n(4),u=Object(o.createStore)("OwaLayout",{browserWidthBucket:null});function a(){var e=u().browserWidthBucket;return e||void 0}var c=Object(o.mutatorAction)("setBrowserWidthBucket",(function(e){u().browserWidthBucket=e})),s=n(2);var d=Object(o.action)("onAvailableWidthBucketChanged",(function(e,t){return{availableWidthBucket:e,source:t}})),l=!1;function f(e){window.addEventListener("resize",b),l=e,m(i.Init)}function b(){m(i.WindowResize)}function m(e){var t,n,r,o=(t=e!=i.Init,n=l,r=Object(s.i)(t),n&&(r>1900?r-=305:r>990&&(r-=165)),r>=1600?1600:r>=1400?1599:r>=1366?1399:r>=1301?1365:r>=1239?1300:r>=1200?1238:r>=1080?1199:r>=1e3?1079:r>=919?999:r>=900?918:r>=866?899:r>=769?865:r>=692?768:r>=686?691:r>=580?685:r>=555?579:r>=542?554:r>=500?541:r>=419?499:418);u().browserWidthBucket!=o&&(c(o),o<=418?v():O(),d(o,e))}function v(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function O(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}var h=n(49);function g(){return p()}function p(){return Object(h.k)()||Object(h.d)()}n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return f})),n.d(t,"b",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return g})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return d}))},1102:function(e,t,n){"use strict";var r=n(115),i=n(961);function o(){return u(Object(i.C)())}function u(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function a(){var e=Object(i.C)();return e&&2==e.tableQuery.type}function c(e){return!!e&&(2==e.type||s(e))}function s(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function d(e){return 2==e.type?e.folderId:s(e)?e.searchScope.groupId:null}function l(){var e=Object(i.C)();return e&&c(e.tableQuery)}n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return m})),n.d(t,"m",(function(){return v})),n.d(t,"l",(function(){return O})),n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return g})),n.d(t,"k",(function(){return p})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return l}));var f=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(455)]).then(n.bind(null,15767))})),b=new r.b(f,(function(e){return e.getGroupDisplayName})),m=new r.b(f,(function(e){return e.getGroupDisplayNameFromTableView})),v=new r.b(f,(function(e){return e.isPrivateUnjoinedGroup})),O=new r.b(f,(function(e){return e.isJoinedGroup})),h=new r.b(f,(function(e){return e.getRetentionPolicyTagsForGroup})),g=new r.b(f,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),p=new r.b(f,(function(e){return e.isGroupOwner}))},1119:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n(115),i=n(1449);n.d(t,"a",(function(){return i.a}));var o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(434)]).then(n.bind(null,2868))})),u=Object(r.d)(o,(function(e){return e.NotificationBarHost})),a=new r.a(o,(function(e){return e.showNotification})),c=new r.a(o,(function(e){return e.dismissNotification})),s=new r.b(o,(function(e){return e.clearNotificationBar}))},1121:function(e,t,n){"use strict";var r=n(1513),i=n(961);function o(){return Object(r.a)(Object(i.C)())}var u=n(1397),a=n(2325);function c(e){var t=Object(u.a)(e);return Object(a.a)(t)}n.d(t,"c",(function(){return r.a})),n.d(t,"d",(function(){return r.c})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}))},1158:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,i=t%n;return(((e-=r)/n&(t-=i)/n)>>>0)*n+((r&i)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},1199:function(e,t,n){"use strict";n.d(t,"r",(function(){return d})),n.d(t,"u",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"o",(function(){return v})),n.d(t,"b",(function(){return O})),n.d(t,"m",(function(){return h})),n.d(t,"f",(function(){return g})),n.d(t,"q",(function(){return p})),n.d(t,"t",(function(){return I})),n.d(t,"s",(function(){return j})),n.d(t,"g",(function(){return w})),n.d(t,"j",(function(){return S})),n.d(t,"k",(function(){return y})),n.d(t,"n",(function(){return C})),n.d(t,"d",(function(){return T})),n.d(t,"c",(function(){return E})),n.d(t,"h",(function(){return _})),n.d(t,"l",(function(){return k})),n.d(t,"a",(function(){return A}));var r=n(0),i=n(118),o=n(961),u=n(977),a=n(4),c=n(1187),s=n(26),d=Object(a.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(R(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(a.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(R(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(a.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,i){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:i}})),b=Object(a.action)("SET_SELECTION_ON_ROW",(function(e,t,n){return{rowKey:e,tableViewId:t,shouldSelect:n}})),m=Object(a.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),v=Object(a.action)("SET_LIST_VIEW_EXPANSION_LOADING_STATE",(function(e){return{shouldBeExpanded:e}})),O=Object(a.action)("ITEM_PART_SELECTED",(function(e,t,n,r,i){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:i}})),h=Object(a.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),g=Object(a.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),p=Object(a.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r}})),I=Object(a.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),j=Object(a.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),w=Object(a.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),S=Object(a.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),y=Object(a.action)("RESET_SELECTION",(function(e){return{tableView:e}})),C=Object(a.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(i.c)(R(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),T=Object(a.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),E=Object(a.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),_=Object(a.action)("RESET_BUS_STOP_STATE_MAP"),k=Object(a.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}})),A=Object(a.action)("INIT_TABLE_SELECTION_ON_LOAD",(function(e){return{tableView:e}}));function R(e,t,n,i){return{name:function(e,t,n,i){return!(function(e){return e===u.b.MailListItemRichPreview||e===u.b.KeyboardShiftEnter||e===u.b.MailListItemBodyDoubleClick}(e)||Object(c.r)()&&!function(e){var t;return e===u.b.KeyboardEnter||e===u.b.MailListItemBody||e===u.b.RouteHandler||e===u.b.CommandBarArrows||e===u.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,i){if(Object(c.r)())return!1;if(e===u.b.KeyboardUpDown){var a=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==a&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return i===o.d.Next?s===a+1||s===t.rowKeys.length-1&&a===t.rowKeys.length-1:s===a-1||0===s&&0===a}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,i))}(e,t,n,i)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},12104:function(e){e.exports=JSON.parse('{"h":"h8b","g":"i8b","b":"j8b","c":"k8b","d":"l8b","e":"m8b","f":"n8b","j":"o8b","a":"p8b","i":"q8b","k":"r8b"}')},12105:function(e,t,n){var r=n(12106),i=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},12106:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'._3Gl1nIFWKInsb7wonvfXhi,._1oAgFr6qHig5bL-H2LObcz{color:"[theme:white, default:#ffffff]"!important}',""]),t.locals={buttonLinkClassName:"_3Gl1nIFWKInsb7wonvfXhi",ribbonMessage:"_1oAgFr6qHig5bL-H2LObcz"}},1283:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(315);function i(e){return{headers:Object(r.f)(e,"GroupMailbox")}}},1305:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return i})),n.d(t,"z",(function(){return o})),n.d(t,"x",(function(){return u})),n.d(t,"a",(function(){return a})),n.d(t,"r",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"e",(function(){return v})),n.d(t,"m",(function(){return O})),n.d(t,"d",(function(){return h})),n.d(t,"k",(function(){return g})),n.d(t,"w",(function(){return p})),n.d(t,"p",(function(){return I})),n.d(t,"y",(function(){return j})),n.d(t,"q",(function(){return w})),n.d(t,"u",(function(){return S})),n.d(t,"v",(function(){return y})),n.d(t,"n",(function(){return C})),n.d(t,"s",(function(){return T})),n.d(t,"t",(function(){return E})),n.d(t,"o",(function(){return _}));var r="multipart/signed",i="application/pkcs7-mime",o="application/x-pkcs7-mime",u=".p7m",a="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",c="CLASSID",s="4",d="0800",l=57,f=78,b=16,m=11,v="IPM.Note.SMIME.MultipartSigned",O="smime-",h="image",g="OwaToSmime",p="SmimeToOwa",I="en-US",j=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],w="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/owasmime.msi",S="OwaSmimeEdgeExtension.appxbundle",y="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/OwaSmimeEdgeExtension.appxbundle",C="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/SmimeOutlookWebChrome.msi",T="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/SmimeOutlookWebChrome.msi",E="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",_="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},1337:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",(function(){return s})),n.d(r,"remove",(function(){return d})),n.d(r,"removeAll",(function(){return l})),n.d(r,"getCount",(function(){return f})),n.d(r,"getTombstonedReasons",(function(){return b})),n.d(r,"clearMapForFolder",(function(){return m})),n.d(r,"removeRowsFromTombstone",(function(){return v}));var i=n(0),o=n(4),u=Object(o.createStore)("tombstone",{folderTombstoneMap:{}}),a=(u(),n(254)),c=n(284),s=Object(c.action)("tombstoneOperations.add")((function(e,t,n){if(1!=t.tableQuery.type&&"spotlight"!==t.tableQuery.scenarioType){var r=t.serverFolderId,i=u().folderTombstoneMap;r in i||(i[r]={});var o=i[r];e.forEach((function(e){var t=o[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):o[e]=[3]:o[e]=[n]}))}})),d=Object(c.action)("tombstoneOperations.remove")((function(e,t,n){var r=u().folderTombstoneMap;if(t in r){var i=r[t],o=i[e],a=o?o.indexOf(n):-1;if(-1==a)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");o.splice(a,1),0==o.length&&delete i[e],0==Object.keys(i).length&&delete r[t]}})),l=Object(c.action)("tombstoneOperations.removeAll")((function(){u().folderTombstoneMap={},Object(a.p)("TnS_RemoveAllFromTombstone")})),f=function(e,t){var n=u().folderTombstoneMap;if(!(e in n))return 0;var r=0,i=n[e];return Object.values(i).forEach((function(e){e==t&&r++})),r},b=function(e,t){var n=u().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},m=Object(c.action)("tombstoneOperations.clearMapForFolder")((function(e){var t=u().folderTombstoneMap;t[e]&&(Object(a.p)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),v=Object(c.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){var n,r,o=u().folderTombstoneMap;if(t in o){var a=o[t];try{for(var c=Object(i.__values)(e),s=c.next();!s.done;s=c.next()){var d=s.value;d in a&&delete a[d]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}0==Object.keys(a).length&&delete o[t]}}));t.a=r},1341:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1283),i=n(106),o={};function u(e){var t=e.toLocaleLowerCase();if(!o[t]){var n={type:i.a.GroupMailbox,userIdentity:Object(i.e)().userIdentity,mailboxSmtpAddress:e,routingKey:Object(i.c)()+e,requestOptions:Object(r.a)(e)};o[t]=n}return o[t]}},1393:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1930);function i(e){return e&&Object(r.b)(e.ItemClass)}},1397:function(e,t,n){"use strict";var r=n(4),i=n(106),o=n(962),u=n(23),a=Object(r.createStore)("mailboxInfoStore",new u.ObservableMap);function c(e,t){if(!e)return Object(i.e)();if(!a().has(e)){var n=Object(o.v)(e,t);s(e,n)}return a().get(e)}n.d(t,"a",(function(){return c}));var s=Object(r.mutatorAction)("addMailboxInfoToStore",(function(e,t){a().set(e,t)}))},1428:function(e,t,n){"use strict";var r=n(1584),i=n(76),o=n(999),u=n(602);function a(){return Object(i.h)("auth-cloudCache")&&(Object(o.b)()||Object(o.c)())&&Object(u.a)()||Object(r.a)()}n.d(t,"a",(function(){return a}))},1449:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.PrimaryActionClicked=0]="PrimaryActionClicked",e[e.SecondaryActionClicked=1]="SecondaryActionClicked",e[e.DismissClicked=2]="DismissClicked",e[e.AutoDismissed=3]="AutoDismissed",e[e.MouseLeaveAfterTimerCompleted=4]="MouseLeaveAfterTimerCompleted",e[e.NotificationBarUnmounted=5]="NotificationBarUnmounted"}(r||(r={}))},1468:function(e,t,n){"use strict";var r=n(23),i=n(4),o={folderTable:new r.ObservableMap,rootFolder:null},u=Object(i.createStore)("publicFolderFavoriteStore",o)();t.a=u},1494:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=1,i=16},1513:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(1397),i=n(106),o=n(962),u=n(1341),a=n(1102),c=n(2241);function s(e){return e?d(e.tableQuery):Object(i.e)()}function d(e,t){var n=Object(a.b)(e),r=null==e?void 0:e.folderId;return null!=n?Object(u.a)(n):l(r,t)}function l(e,t){return Object(o.H)(e)?Object(c.a)(e):Object(r.a)(e,t)}},1536:function(e,t,n){"use strict";function r(){return{isBeingDragged:!1}}n.d(t,"a",(function(){return r}))},1553:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=20,i=10},1556:function(e,t,n){"use strict";var r=n(115),i=n(1956),o=n(2010),u=n(1957),a=n(1820),c=n(1958),s=n(1900),d=n(2011);function l(e){var t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function f(e){return!!e.RecurrenceId}n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return v})),n.d(t,"w",(function(){return O})),n.d(t,"d",(function(){return h})),n.d(t,"g",(function(){return g})),n.d(t,"h",(function(){return p})),n.d(t,"b",(function(){return I})),n.d(t,"f",(function(){return j})),n.d(t,"e",(function(){return w})),n.d(t,"i",(function(){return S})),n.d(t,"j",(function(){return y})),n.d(t,"a",(function(){return C})),n.d(t,"c",(function(){return T})),n.d(t,"v",(function(){return E})),n.d(t,"u",(function(){return _})),n.d(t,"k",(function(){return i.a})),n.d(t,"x",(function(){return o.a})),n.d(t,"m",(function(){return u.a})),n.d(t,"q",(function(){return a.a})),n.d(t,"r",(function(){return c.a})),n.d(t,"l",(function(){return s.a})),n.d(t,"o",(function(){return d.a})),n.d(t,"p",(function(){return l})),n.d(t,"n",(function(){return f}));var b=new r.c((function(){return Promise.all([n.e(5),n.e(7),n.e(10),n.e(723),n.e(418)]).then(n.bind(null,15537))})),m=new r.a(b,(function(e){return e.addItemToCalendar})),v=new r.a(b,(function(e){return e.initializeMeetingRequestViewStateAction})),O=new r.a(b,(function(e){return e.removeCancelledMeetingFromCalendar})),h=Object(r.d)(b,(function(e){return e.MeetingMessageInfo})),g=(Object(r.d)(b,(function(e){return e.MeetingRequestActions})),Object(r.d)(b,(function(e){return e.MeetingCancellationAction})),Object(r.d)(b,(function(e){return e.MeetingActionButton})),Object(r.d)(b,(function(e){return e.MeetingDetailsTime})),Object(r.d)(b,(function(e){return e.MeetingDetailsLocation})),Object(r.d)(b,(function(e){return e.MeetingRequestInfo}))),p=Object(r.d)(b,(function(e){return e.MeetingRequestResponseEditor})),I=Object(r.d)(b,(function(e){return e.MeetingDetails})),j=Object(r.d)(b,(function(e){return e.MeetingRequestConflicts})),w=(Object(r.d)(b,(function(e){return e.EditEventLink})),Object(r.d)(b,(function(e){return e.MeetingMessageSummary}))),S=Object(r.d)(b,(function(e){return e.PreviewSummary})),y=Object(r.d)(b,(function(e){return e.SenderSummary})),C=Object(r.d)(b,(function(e){return e.CollapsedMeetingMessage})),T=Object(r.d)(b,(function(e){return e.MeetingIcon})),E=new r.a(b,(function(e){return e.logMeetingMessageActionForInvite})),_=new r.a(b,(function(e){return e.logMeetingMessageActionForEvent}))},1584:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(76),i=n(94);function o(){return Object(r.h)("mail-oneView")&&Object(i.t)()}},1611:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="IPM.Note.SMIME"},1686:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(315);function i(e){var t=new Headers;return Object(r.g)(e,t),{headers:t}}},1701:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1081);function i(){return Object(r.a)().showReadingPane}},1702:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(977),o=n(1818),u=n(2191),a=n(4);function c(e){var t,n,a,c;if(i.w.conversations.has(e)){var l=i.w.conversations.get(e);try{for(var f=Object(r.__values)(l.conversationNodeIds),b=f.next();!b.done;b=f.next()){var m=b.value,v=i.w.conversationNodes.get(m);if(v)try{for(var O=(a=void 0,Object(r.__values)(v.itemIds)),h=O.next();!h.done;h=O.next()){var g=h.value;Object(o.a)(g,1)}}catch(e){a={error:e}}finally{try{h&&!h.done&&(c=O.return)&&c.call(O)}finally{if(a)throw a.error}}s(m)}}catch(e){t={error:e}}finally{try{b&&!b.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}d(e)}Object(u.a)()}var s=Object(a.mutatorAction)("deleteConversationNode",(function(e){i.w.conversationNodes.delete(e)})),d=Object(a.mutatorAction)("deleteConversation",(function(e){i.w.conversations.delete(e)}))},1715:function(e,t,n){"use strict";var r=n(115),i=n(1702),o=n(977),u=n(284),a=Object(u.action)("setIsPendingDeleteConversationItemParts")(Object(u.select)({conversationItemParts:function(e){return o.w.conversations.get(e)}})((function(e,t,n){var r=n.conversationItemParts;r&&(r.isPendingDelete=t)}))),c=n(1553);n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return i.a})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return c.b}));var s=new r.c((function(){return n.e(413).then(n.bind(null,15601))})),d=new r.a(s,(function(e){return e.loadAllRecipientsForItem})),l=new r.a(s,(function(e){return e.loadItem})),f=new r.a(s,(function(e){return e.loadConversation}))},1818:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,t){return{itemIdToRemove:e,removeItemSource:t}}))},1820:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",(function(){return r}))},1900:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",(function(){return r}))},1914:function(e,t,n){"use strict";var r=n(115),i=n(961),o=n(1121),u=n(977),a=n(989),c=n(1611);var s=n(1393),d=n(284);function l(e,t){if(t.folderId&&"junkemail"==Object(a.a)(t.folderId))return!1;if(Object(s.a)(e))return!1;var n=u.w.items.get(e.ItemId.Id);return!(null==n||!n.shouldShowAttachmentPreviews)||!(!e.HasAttachments&&!e.HasProcessedSharepointLink)&&(v.importAndExecute(Object(o.d)(t),e.ConversationId,e.ItemId.Id),!0)}var f=Object(d.select)({listViewStore:function(){return i.T}})((function(e,t,n){var r,i,u,s=1==t.type,d=e.ConversationId,l=n.listViewStore.conversationItems.get(d.Id),f=e.HasProcessedSharepointLink;if(t.folderId&&"junkemail"==Object(a.a)(t.folderId))return!1;if((null==(r=e)?void 0:r.ItemClasses)&&r.ItemClasses.length>0&&r.ItemClasses.some((function(e){return 0===e.indexOf(c.a)})))return!1;if(s){if(l)return l.shouldShowAttachmentPreviews;i=u=!!e.HasAttachments}else{if(!e.HasAttachmentPreviews&&!f)return!1;l&&!f?(i=l.globalItemIds.length!=e.GlobalItemIds.length,u=l.shouldShowAttachmentPreviews):(i=!0,u=!0)}return i&&v.importAndExecute(Object(o.d)(t),e.ConversationId,null),u}));n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return l}));var b=new r.c((function(){return n.e(131).then(n.bind(null,15749))})),m=new r.a(b,(function(e){return e.getPreviews})),v=new r.a(b,(function(e){return e.add})),O=new r.a(b,(function(e){return e.getAttachmentsForConversationWell})),h=new r.a(b,(function(e){return e.removeAttachmentPreviewsForRow}))},1930:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(1305),i=n(1611);function o(e){return e&&0===e.indexOf(r.e)}function u(e){return e&&0===e.indexOf(i.a)&&!o(e)}function a(e){return e&&0===e.indexOf(i.a)}function c(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1951:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1088),i=n(1701);function o(){return Object(r.c)()&&Object(i.a)()}},1956:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("deleteMeetingMessage",(function(e,t){return{item:e,issueDeleteItemCall:t}}))},1957:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",(function(){return r}))},1958:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}n.d(t,"a",(function(){return r}))},1973:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},1983:function(e,t,n){"use strict";var r=n(4),i=n(23),o=n(962),u=n(2749),a=n(1140),c=(Object(r.mutator)(u.a,(function(e){var t=o.d.folderTable.get(e.folderId);t&&(e.isDeltaChange?(t.UnreadCount+=e.unreadCount,t.TotalCount+=e.totalCount):(t.UnreadCount=e.unreadCount,t.TotalCount=e.totalCount),t.pausedTotalCount&&Object(a.b)()===e.folderId&&(t.pausedTotalCount=t.TotalCount),t.UnreadCount=Math.max(t.UnreadCount,0),t.TotalCount=Math.max(t.TotalCount,0))})),{folderNodeViewStates:new i.ObservableMap({}),contextMenuState:null,folderTextFieldViewState:null,isDraggedOver:!1,withContextMenuFolderId:null,shouldShowMoveDialog:!1,moveToDestinationFolderId:null}),s=Object(r.createStore)("folderViewState",c)();t.a=s},2009:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2821),i=n(1983),o=n(1536),u=n(1025),a=n(961);function c(e){if(!i.a.folderNodeViewStates.has(e)){var t=a.c.getDefaultSortBy();Object(r.a)(e,{isExpanded:!1,sortColumn:t.sortColumn,sortOrder:t.sortDirection,drag:Object(o.a)(),drop:Object(u.a)()})}return i.a.folderNodeViewStates.get(e)}},2010:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(function(e,t){return{status:e,sxsId:t}}))},2011:function(e,t,n){"use strict";function r(e){var t=e;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}n.d(t,"a",(function(){return r}))},2104:function(e,t,n){"use strict";var r=n(26);function i(){var e=Object(r.a)().UserOptions;return e.IsFocusedInboxFeatureSupported&&e.IsFocusedInboxEnabled}n.d(t,"a",(function(){return i}))},2129:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(115),i=n(1973);n.d(t,"d",(function(){return i.a}));var o=new r.c((function(){return n.e(378).then(n.bind(null,4205))})),u=new r.a(o,(function(e){return e.onKeyboardUpDown})),a=new r.a(o,(function(e){return e.onOpenEmail})),c=new r.a(o,(function(e){return e.onKeyboardToggleSelect}))},2160:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1081);function i(){return Object(r.a)().showListPane}},2191:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(4),i=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),o=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},2221:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2320),i=n(961),o=n(1572),u=n(2402);function a(e){if(Object(u.a)()){var t=Object(r.c)()[e];if(t){var n=Object(o.getSupportedSortColumns)(e),a=t.SortColumn,c=t.SortOrder;if(n.includes(a))return{sortColumn:a,sortDirection:c}}}return i.c.getDefaultSortBy()}},2241:function(e,t,n){"use strict";var r=n(961),i=n(962);function o(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(i.H)(e.tableQuery.folderId)}function u(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(i.H)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var a=n(4),c=n(106),s=n(1686),d=n(1468),l=n(23),f=Object(a.createStore)("publicFolderUtilsStore",new l.ObservableMap),b=n(94);function m(e){if(!f().has(e)){var t=d.a.folderTable.get(e),n=null!=t.ReplicaList?t.ReplicaList[0]:Object(b.i)().SessionSettings.DefaultPublicFolderMailbox,r={type:c.a.PublicMailbox,userIdentity:Object(c.e)().userIdentity,mailboxSmtpAddress:n,routingKey:Object(c.c)()+n,requestOptions:Object(s.a)(n)};v(e,r)}return f().get(e)}var v=Object(a.mutatorAction)("addPublicFolderMailboxInfoToStore",(function(e,t){f().set(e,t)}));n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return m}))},2251:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return c}));var r=n(115),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(272)]).then(n.bind(null,3637))})),o=(Object(r.d)(i,(function(e){return e.FeedbackForm})),Object(r.d)(i,(function(e){return e.FeedbackRibbon}))),u=Object(r.d)(i,(function(e){return e.KnownIssuesFeedbackFormHeader})),a=Object(r.d)(i,(function(e){return e.KnownIssuesFeedbackForm})),c=new r.b(i,(function(e){return e.launchFeedbackDialogWithoutRibbon}))},2320:function(e,t,n){"use strict";var r=n(0),i=n(2009),o=n(299),u=n(328),a=n(331),c=n(332),s=n(317),d=n(285),l=n(329),f=n(245),b="OWA.ViewStateConfiguration",m="root",v=1e4,O=null;function h(e){var t=e.ViewStateConfiguration.FolderViewState;if(t){for(var n=[],r=0;r<t.length;r++)n.push(t[r]);O||(O=setTimeout((function(){var e,t,r,i;O=null,e=b,t={Type:"String",Value:["FolderViewState"]},r={Type:"StringArray",Value:n},i=Object(u.a)({UserConfigurationName:Object(l.a)({Name:e,BaseFolderId:Object(o.a)({Id:m})}),Dictionary:[Object(s.a)({DictionaryKey:Object(d.a)(t),DictionaryValue:Object(d.a)(r)})]}),Object(a.a)({Header:Object(f.a)(),Body:Object(c.a)({UserConfiguration:i})}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}),v))}}var g=n(961),p=n(26),I=n(284),j=n(962),w=n(2448),S=n(989),y=n(977);function C(e){var t=Object(S.a)(e);return Object(w.a)(e)||Object(j.H)(e)?_.DateViewOnly:"drafts"==t||"junkemail"==t||"outbox"==t||"notes"==t?_.DateViewOnly:"deleteditems"==t||Object(y.m)(e)?_.DateView:_.ConversationView}function T(e){return"inbox"!=Object(S.a)(e)||Object(w.a)(e)?E.SearchRefinerScopeCurrentFolder:E.SearchRefinerScopeAll}var E,_,k=n(1187);function A(e){return JSON.parse(e,(function(e,t){return"SortOrder"!==e||1!==t&&0!==t?t:1===t?g.c.DESCENDING_SORT_DIR:g.c.ASCENDING_SORT_DIR}))}function R(){for(var e=Object(p.a)().ViewStateConfiguration.FolderViewState||[],t={},n=0;n<e.length;n++){var r=A(e[n]);t[r.FolderId.Id]=r}return t}function x(e){return JSON.stringify(e,(function(e,t){return"SortOrder"!==e||t!==g.c.DESCENDING_SORT_DIR&&t!==g.c.ASCENDING_SORT_DIR?t:t===g.c.DESCENDING_SORT_DIR?1:0}))}n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return R})),n.d(t,"d",(function(){return M})),function(e){e[e.SearchRefinerScopeAll=0]="SearchRefinerScopeAll",e[e.SearchRefinerScopePrimaryMailbox=1]="SearchRefinerScopePrimaryMailbox",e[e.SearchRefinerScopeCurrentFolder=2]="SearchRefinerScopeCurrentFolder",e[e.SearchRefinerScopeCurrentFolderAndSubfolders=3]="SearchRefinerScopeCurrentFolderAndSubfolders"}(E||(E={})),function(e){e[e.ConversationView=1]="ConversationView",e[e.DateView=2]="DateView",e[e.DateViewOnly=3]="DateViewOnly",e[e.ItemGroupView=4]="ItemGroupView",e[e.BundledView=5]="BundledView"}(_||(_={}));var M=Object(I.action)("updateFolderViewState")((function(e){for(var t=Object(p.a)().ViewStateConfiguration.FolderViewState||[],n=!1,o=Object(i.a)(e),u=null,a=-1,c=0;c<t.length;c++){var s=A(t[c]);if(s.FolderId.Id===e){u=s,a=c;break}}var d=function(e,t,n){var i=n.sortOrder,o=n.sortColumn,u=n.isExpanded;if(t)return Object(r.__assign)(Object(r.__assign)({},t),{SortOrder:i,SortColumn:o,IsExpanded:u});var a=j.d.folderTable.get(e);return a?{FolderId:a.FolderId,View:C(a.FolderId.Id),Width:k.a,SortOrder:i,SortColumn:o,IsExpanded:u,ReadingPanePosition:Object(p.a)().UserOptions.GlobalReadingPanePositionReact,SearchScope:T(a.FolderId.Id)}:null}(e,u,o);d&&(-1!==a?(n=u!==d)&&(t[a]=x(d)):(n=!0,t.push(x(d))),n&&h(Object(p.a)()))}))},2325:function(e,t,n){"use strict";function r(e){return{mailboxType:e.type,userIdentity:e.userIdentity,mailboxSmtpAddress:e.mailboxSmtpAddress,routingKey:e.routingKey,mailboxGuid:e.mailboxGuid}}n.d(t,"a",(function(){return r}))},2342:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("REMOVE_ROWS_FROM_LISTVIEW_STORE",(function(e,t,n,r){return void 0===r&&(r=!0),{rowKeys:e,tableView:t,actionType:n,shouldRemoveFromAllTables:r}}))},2347:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(60),i=n(24),o=n(94),u=n(76);function a(){var e=Object(r.a)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.a)(t)}function c(){var e,t,n=(e="",(t=Object(i.a)().pathname.split("/").filter((function(e){return e.length}))).length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e);if(Object(u.h)("fwk-puidBasedRouting")&&0===n.length){var r=Object(o.i)();if(null==r?void 0:r.SessionSettings){var c=r.SessionSettings.ExternalDirectoryTenantGuid,s=r.SessionSettings.UserPuid;s&&c&&(n="PUID:"+s+"@"+c)}}return 0===n.length&&(n=a()),n}},240:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,u){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var a=e[t];a?clearTimeout(a.timeout):r++;var c={value:n,expire:i+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){o(t),u&&u(t,n)}.bind(this),i)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var u=e[o];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return i&&t++,u.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(o)if(e[u])continue;var a=r[u],c=a.expire-i;if(c<=0){this.del(u);continue}c=c>0?c:void 0,this.put(u,a.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},2402:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1445);function i(){var e=Object(r.a)();return e&&(e.MajorVersion>15||e.MinorVersion>20||e.MajorBuildNumber>=1807)}},2448:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(962),i=n(968);function o(e){return Object(r.D)(e,i.j)}},2749:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("UPDATE_FOLDER_COUNTS",(function(e,t,n,r){return{unreadCount:e,totalCount:t,folderId:n,isDeltaChange:r}}))},2821:function(e,t,n){"use strict";var r=n(1983),i=n(284);t.a=Object(i.action)("setFolderViewState")((function(e,t){r.a.folderNodeViewStates.set(e,t)}))},2900:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},3829:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2221),i=n(2072),o=n(961),u=n(1269),a=n(964);function c(e,t){var n=Object(a.a)("inbox"),c=Object(i.a)(n,Object(o.w)(n),"mail",e,null,null,Object(r.a)(n),t);return Object(u.c)(c)}},490:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},5600:function(e,t,n){"use strict";n.r(t);var r,i=n(4),o=Object(i.action)("onCacheUpdated",(function(e,t){return{interactionType:e,triageContext:t}})),u=Object(i.action)("onSpotlightDismissedFromLV",(function(e,t,n){return{rowKey:e,tableQuery:t,isConversationView:n}})),a=Object(i.action)("onSpotlightDismissedFromLVProcessed",(function(e){return{rowKey:e}})),c=Object(i.action)("onSpotlightItemsFetched",(function(e,t){return{spotlightItems:e,isConversationView:t}})),s=n(2899);!function(e){e[e.Unknown=0]="Unknown",e[e.Weak=1]="Weak",e[e.Strong=2]="Strong"}(r||(r={}));var d,l=function(e){switch(e){case"Categorize":case"CreateRule":case"Flag":case"Like":case"MarkAsRead":case"MarkAsReadImplicit":case"MarkAsUnread":case"Snooze":return r.Weak;case"Block":case"MarkAsJunk":case"Delete":case"FlagCleared":case"FlagComplete":case"Forward":case"Ignore":case"MarkAsPhishing":case"Move":case"Pin":case"Reply":case"ReplyAll":case"ReportAbuse":case"Unpin":return r.Strong;default:return r.Unknown}},f=n(2748),b=n(961),m=n(3),v=n(0),O=n(9);!function(e){e[e.Acknowledged=0]="Acknowledged",e[e.Dismissed=1]="Dismissed"}(d||(d={}));var h=function(e,t){var n,r,i=I(e);try{for(var o=Object(v.__values)(t),u=o.next();!u.done;u=o.next()){var a=u.value;i.push(a)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}Object(O.d)(window,j(e),JSON.stringify(i))},g=function(e){var t,n,r=e.spotlightCacheType,i=e.itemId,o=e.conversationId,u=e.rowKey,a=I(r);try{for(var c=Object(v.__values)(a),s=c.next();!s.done;s=c.next()){var d=s.value;if(i&&d.itemId===i||o&&d.conversationId===o||u&&d.rowKey===u)return!0}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return!1},p=function(e,t){var n,r,i,o,u=I(e),a=[];try{for(var c=Object(v.__values)(u),s=c.next();!s.done;s=c.next()){var d=s.value,l=d.itemId,f=d.conversationId,b=d.rowKey;try{for(var m=(i=void 0,Object(v.__values)(t)),h=m.next();!h.done;h=m.next()){var g=h.value,p=g.itemId,w=g.conversationId,S=g.rowKey;if(l&&l===p||f&&f===w||b&&b===S){a.push(g);break}}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}Object(O.d)(window,j(e),JSON.stringify(a))},I=function(e){var t=Object(O.a)(window,j(e));return t?JSON.parse(t):[]},j=function(e){return e===d.Acknowledged?"acknowledgedSpotlightItems":"dismissedSpotlightItems"};Object(i.mutator)(c,(function(e){var t=e.spotlightItems,n=e.isConversationView,r=S(),i=t.concat(r),o=[],u=i.concat(r).filter((function(e){var t=n?e.conversationId:e.itemId;return!(o.indexOf(t)>-1)&&(o.push(t),!0)}));!function(e){p(d.Acknowledged,e),p(d.Dismissed,e)}(u),Object(s.a)().spotlightItems=u.filter((function(e){return!e.isDismissed}))})),Object(i.mutator)(a,(function(e){for(var t=e.rowKey,n=Object(s.a)().spotlightItems,r=0;r<n.length;r++){if(n[r].rowKey===t){n.splice(r,1);break}}})),Object(i.mutator)(o,(function(e){if(Object(f.a)()){var t=e.triageContext,n=void 0===t?{}:t,i=e.interactionType,o=n.itemIds,u=void 0===o?[]:o,a=n.conversationIds,c=void 0===a?[]:a,s=n.rowKeys,d=void 0===s?[]:s;if(u=u.filter((function(e){return!!e})),c=c.filter((function(e){return!!e})),d=d.filter((function(e){return!!e})),0!==u.length||0!==c.length||0!==d.length)switch(l(i)){case r.Weak:w({itemIds:u,conversationIds:c,rowKeys:d,actionCategory:r.Weak});break;case r.Strong:w({itemIds:u,conversationIds:c,rowKeys:d,actionCategory:r.Strong});break;case r.Unknown:}}}));var w=function(e){var t=e.itemIds,n=e.conversationIds,i=e.rowKeys,o=e.actionCategory,u=Object(s.a)().spotlightItems;u.map((function(e,a){(t.indexOf(e.itemId)>-1||n.indexOf(e.conversationId)>-1||i.indexOf(e.rowKey)>-1)&&(o===r.Weak?e.isAcknowledged=!0:o===r.Strong&&u.splice(a,1))}))},S=function(){var e=[],t=Object(m.a)("testSpotlight");if(t)for(var n=Object(b.C)(),r=parseInt(t),i=0;i<r;i++){var o=n.rowKeys[i],u=b.b.getItemIds(o,n)[0],a=b.b.getConversationId(o,n);o&&e.push({rowKey:o,itemId:u,conversationId:a,isAcknowledged:g({spotlightCacheType:d.Acknowledged,itemId:u,conversationId:a,rowKey:o}),isDismissed:g({spotlightCacheType:d.Dismissed,itemId:u,conversationId:a,rowKey:o}),reason:0,senderName:b.b.getLastSenderMailbox(o,n).Name,referenceId:"00000000-0000-0000-0000-000000000000"})}return e},y=Object(i.action)("onSpotlightFilterLoaded",(function(e){return{actionSource:e}})),C=Object(i.action)("onSpotlightRollupDismissed");Object(i.mutator)(C,(function(){T(),E()})),Object(i.mutator)(y,(function(){T(),E()}));var T=function(){Object(s.a)().rollupDismissed||(Object(s.a)().rollupDismissed=!0)},E=function(){Object(s.a)().spotlightItems.map((function(e){return e.isAcknowledged=!0}))};function _(e){var t,n,r=Object(s.a)().spotlightItems;try{for(var i=Object(v.__values)(r),o=i.next();!o.done;o=i.next()){var u=o.value;if(u.rowKey===e)return u}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null}var k=n(106),A=n(2251),R=n(10),x=n(2342),M=n(1715),D=n(982),N=n(1269),F=n(1119),L=n(1),P=n(12104),V=n(12105);Object(i.orchestrator)(u,(function(e){return Object(v.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(v.__generator)(this,(function(i){switch(i.label){case 0:return t=e.rowKey,n=e.tableQuery,[4,K(t)];case 1:return r=i.sent(),F.e.importAndExecute("dismiss-spotlight-lv-notification","MailModuleNotificationBarHost","",{},(function(){var e=[{logString:"It's spam/junk.",uiString:Object(R.b)(P.b)},{logString:"I've already replied to this in Outlook.",uiString:Object(R.b)(P.c)},{logString:"I've already handled this elsewhere (a different app, in-person, etc.).",uiString:Object(R.b)(P.d)},{logString:"It doesn't need any action on my part.",uiString:Object(R.b)(P.e)},{logString:"Other",uiString:Object(R.b)(P.f)}],t={buttonText:Object(R.b)(P.a),categories:e,ghostText:Object(R.b)(P.j),invokeFeedbackDialog:!0,title:Object(R.b)(P.h),subTitle:Object(R.b)(P.g),donationText:Object(R.b)(P.i),donationJson:r};return L.createElement(A.a,{feature:"Spotlight",subFeature:"Spotlight",hideNoButton:!0,noFeedbackDialogParams:{hideButton:!0},ribbonMessage:Object(R.b)(P.k),ribbonMessageClassName:V.ribbonMessage,yesFeedbackDialogParams:t,buttonLinkClassName:V.buttonLinkClassName})})),h(d.Dismissed,[{rowKey:t}]),B(t,n),a(t),[2]}}))}))}));var K=function(e){return Object(v.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,o;return Object(v.__generator)(this,(function(u){switch(u.label){case 0:return(t=_(e))?(n=Object(D.b)().items.get(t.itemId))?[3,2]:(r={Id:t.itemId,mailboxInfo:Object(k.e)()},[4,M.e.importAndExecute(r,"LoadSpotlightItem")]):[2,null];case 1:n=u.sent(),u.label=2;case 2:return[2,JSON.stringify({messageBody:(null===(i=n.UniqueBody)||void 0===i?void 0:i.Value)||(null===(o=n.NormalizedBody)||void 0===o?void 0:o.Value)||"",itemId:n.ItemId.Id})]}}))}))},B=function(e,t){var n=Object(v.__assign)(Object(v.__assign)({},t),{scenarioType:"spotlight"});Object(x.a)([e],Object(N.c)(n),"Spotlight",!1)},U=n(2820),W=n(2129);Object(i.orchestrator)(W.d,(function(e){if(Object(f.a)()){var t=e.triageContext,n=void 0===t?{}:t,i=e.interactionType,u=n.itemIds,a=void 0===u?[]:u,c=n.conversationIds,s=void 0===c?[]:c,b=n.rowKeys,m=void 0===b?[]:b;if(a=a.filter((function(e){return!!e})),s=s.filter((function(e){return!!e})),m=m.filter((function(e){return!!e})),0!==a.length||0!==s.length||0!==m.length){var v=l(i)===r.Strong?d.Dismissed:d.Acknowledged;a.map((function(e){Object(U.a)({itemId:e})&&!g({spotlightCacheType:v,itemId:e})&&h(v,[{itemId:e}])})),s.map((function(e){Object(U.a)({conversationId:e})&&!g({spotlightCacheType:v,conversationId:e})&&h(v,[{conversationId:e}])})),m.map((function(e){Object(U.a)({rowKey:e})&&!g({spotlightCacheType:v,rowKey:e})&&h(v,[{rowKey:e}])})),o(i,n)}}})),Object(i.orchestrator)(C,(function(){G()})),Object(i.orchestrator)(y,(function(){G()}));var G=function(){var e=Object(s.a)().spotlightItems.map((function(e){return{itemId:e.itemId,conversationId:e.conversationId,rowKey:e.rowKey}}));h(d.Acknowledged,e)},z=n(254);function H(e,t){var n,r,i,o,u;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationTopic:e.Subject,FlagStatus:null===(n=e.Flag)||void 0===n?void 0:n.FlagStatus,FolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},GlobalItemIds:[{Id:e.ItemId.Id,ChangeKey:null}],GlobalMessageCount:1,GlobalUnreadCount:1,HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,HasIrm:null,Importance:e.Importance,ItemClasses:e.ItemClasses||["IPM.Note"],ItemIds:[{Id:e.ItemId.Id,ChangeKey:null}],LastDeliveryOrRenewTime:e.DateTimeReceived,LastDeliveryTime:e.DateTimeReceived,LastModifiedTime:e.DateTimeLastModified,MessageCount:1,ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,SenderSMTPAddress:null===(i=null===(r=e.Sender)||void 0===r?void 0:r.EmailAddress)||void 0===i?void 0:i.Address,UniqueSenders:[null===(u=null===(o=e.Sender)||void 0===o?void 0:o.EmailAddress)||void 0===u?void 0:u.Name],UnreadCount:1,InstanceKey:t}}function q(e,t){var n;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationIndex:e.ConversationIndex,DateTimeReceived:e.DateTimeReceived,DateTimeSent:e.DateTimeSent,LastModifiedTime:e.DateTimeLastModified,DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:e.Flag&&{FlagStatus:e.Flag.FlagStatus,CompleteDate:e.Flag.CompleteDate,DueDate:e.Flag.DueDate,StartDate:e.Flag.StartDate},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:{Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey},ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,Sender:e.Sender&&{Mailbox:{EmailAddress:e.Sender.EmailAddress.Address,Name:e.Sender.EmailAddress.Name,RoutingType:"SMTP"}},Sensitivity:e.Sensitivity,Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,InstanceKey:t}}Object(i.orchestrator)(C,(function(){Object(z.o)("Spotlight_RollupDismissed")})),Object(i.orchestrator)(y,(function(e){Object(z.o)("Spotlight_FilterLoaded",[e.actionSource])})),Object(i.orchestrator)(u,(function(e){var t=e.isConversationView,n=e.rowKey,r=e.tableQuery,i=_(n),o=i.conversationId,u=i.itemId;Object(z.o)("Spotlight_ItemDismissed",{isImportantFilter:"spotlight"===r.scenarioType,conversationId:t?o:null,itemId:t?null:u})}));var Q=n(275),J=n(1442),X=n(1357),Y=n(997);function $(e,t,n){var r,i,o,u,a,c,s,l,f;return Object(v.__awaiter)(this,void 0,void 0,(function(){var m,O,h,p,I,j,w,S,y,C,T,E,_,k,A;return Object(v.__generator)(this,(function(R){switch(R.label){case 0:return m=[],O=[],h=Object(b.L)(t),p=[],[4,e.json()];case 1:I=R.sent(),j=(null===(u=null===(o=null===(i=null===(r=null==I?void 0:I.EntitySets)||void 0===r?void 0:r[0])||void 0===i?void 0:i.ResultSets)||void 0===o?void 0:o[0])||void 0===u?void 0:u.Results)||[],X.k.importAndExecute(Y.a.ContextualInsights,null===(a=null==I?void 0:I.Instrumentation)||void 0===a?void 0:a.TraceId,n.getData(Q.a.e2eTimeElapsed),e.status);try{for(w=Object(v.__values)(j),S=w.next();!S.done;S=w.next())if(y=S.value,C=null===(c=y.Source.ConversationId)||void 0===c?void 0:c.Id,T=null===(s=y.Source.ItemId)||void 0===s?void 0:s.Id,E=Z(h?C:T,t)){if(h){if(p.indexOf(C)>-1)continue;p.push(C)}g({spotlightCacheType:d.Dismissed,itemId:T,conversationId:C,rowKey:E})||(h?O.push(H(y.Source,E)):O.push(q(y.Source,E))),m.push({conversationId:C,itemId:T,rowKey:E,isAcknowledged:g({spotlightCacheType:d.Acknowledged,itemId:T,conversationId:C,rowKey:E}),isDismissed:g({spotlightCacheType:d.Dismissed,itemId:T,conversationId:C,rowKey:E}),reason:0,senderName:null===(f=null===(l=y.Source.Sender)||void 0===l?void 0:l.EmailAddress)||void 0===f?void 0:f.Name,referenceId:y.ReferenceId})}}catch(e){k={error:e}}finally{try{S&&!S.done&&(A=w.return)&&A.call(w)}finally{if(k)throw k.error}}return _=Object(v.__assign)(Object(v.__assign)({},t.tableQuery),{scenarioType:"spotlight"}),Object(J.c)(Object(N.c)(_),O,O.length,"SpotlightLoad",null,null,!0),[2,m]}}))}))}var Z=function(e,t){var n=Object(b.A)([e],t);return n.length>0?n[0]:(Object(z.o)("No row key found for Spotlight item."),null)},ee=n(435),te=n(2347),ne=n(964),re=n(715),ie=function(){return Object(v.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(v.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(v.__read)(Object(re.getAccessTokenforResourceAsLazy)(window.location.origin),2),t=e[0],n=e[1],t?[3,2]:[4,n];case 1:t=r.sent(),r.label=2;case 2:return[2,t||""]}}))}))},oe=function(e,t,n){var r={method:"POST"};r.headers=new Headers,r.headers.set("Authorization","Bearer "+t),r.headers.set("Content-Type","application/json;charset=utf-8"),r.headers.set("X-Client-LocalTime",(new Date).toISOString()),r.headers.set("client-request-id",e);var i=Object(te.b)();i&&r.headers.append("X-AnchorMailbox",i);var o={EntityRequests:[{EntityType:"Message",Context:{EntityContext:[{"@type":"Microsoft.OutlookServices.MailFolder",id:Object(ne.a)("inbox")}]}}],Scenario:{Name:"ContextualInsights"}};return r.body=JSON.stringify(o),r},ue=function(e){return Object(v.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(v.__generator)(this,(function(r){switch(r.label){case 0:return[4,ie()];case 1:return t=r.sent(),n=oe(Object(ee.a)(),t,Object(b.L)(e)),[4,fetch("/search/api/v1/recommendations",n)];case 2:return[2,r.sent()]}}))}))},ae=n(3829);function ce(){return Object(v.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r;return Object(v.__generator)(this,(function(i){switch(i.label){case 0:return e=Object(ae.a)(),t=new z.a("SpotlightService",{sessionSampleRate:20}),[4,ue(e)];case 1:return n=i.sent(),t.end(),[4,$(n,e,t)];case 2:return r=i.sent(),c(r,Object(b.L)(e)),[2]}}))}))}var se=2;function de(e,t,n){var r=Object(s.a)().spotlightItems.map((function(e){return e.isAcknowledged?null:e.senderName})).filter((function(e){return null!==e}));return function(e,t,n,r){return!Object(s.a)().rollupDismissed&&(!(e<se)&&(!(n!==Object(ne.a)("inbox"))&&"All"===r))}(r.length,0,t,n)?{unseenCount:r.length,senderNames:le(r)}:null}var le=function(e){for(var t=[],n=0;n<e.length&&t.length<=2;n++){var r=e[n];-1===t.indexOf(r)&&t.push(r)}switch(t.length){case 1:return t[0];case 2:return t[0]+", "+t[1];default:return t[0]+", "+t[1]+" + "+(t.length-2)}};function fe(){return Object(s.a)().spotlightItems.filter((function(e){return!e.isAcknowledged})).length}function be(e,t,n){return Object(v.__awaiter)(this,void 0,void 0,(function(){return Object(v.__generator)(this,(function(r){return t(e,!0,"200",!1),y(n),[2]}))}))}var me=n(26),ve=function(e){var t=Object(me.a)().SessionSettings,n=t.UserPuid,r=t.ExternalDirectoryTenantGuid;X.q.importAndExecute(Y.a.ContextualInsights,n,r,Object(s.a)().logicalId,null,_(e).referenceId,"EntityClicked"),Object(z.o)("Spotlight_ItemClicked")};n.d(t,"initializeSpotlight",(function(){return ce})),n.d(t,"onSpotlightDismissedFromLV",(function(){return u})),n.d(t,"onSpotlightRollupDismissed",(function(){return C})),n.d(t,"getSpotlightRollupData",(function(){return de})),n.d(t,"getUnacknowledgedSpotlightCount",(function(){return fe})),n.d(t,"loadImportantTable",(function(){return be})),n.d(t,"logSpotlightItemClicked",(function(){return ve}))},999:function(e,t,n){"use strict";n.d(t,"l",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return v})),n.d(t,"h",(function(){return O})),n.d(t,"f",(function(){return h})),n.d(t,"j",(function(){return g})),n.d(t,"k",(function(){return p})),n.d(t,"g",(function(){return I}));var r,i,o=n(3),u=n(60),a=n(26),c=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],s=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],d={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function l(){return Object(a.a)().SessionSettings.IsPremiumConsumerMailbox}function f(){return Object(a.a)().IsConsumerChild}function b(){return Object(a.a)().SessionSettings.IsShadowMailbox}function m(){return void 0!==i?i:i=function(){if(Object(o.d)("ormarket"))return Object(o.a)("ormarket");var e=Object(a.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return c.indexOf(n)>-1?n:d[n.split("-")[1]]||n}()}function v(e){return null!=e?e.toUpperCase().split("-"):[]}function O(e){return v(e)[1]||"US"}function h(){return Object(u.a)("ANON")}function g(){return Object(u.a)("MUID")}function p(){return!!Object(u.a)("TOptOut")}function I(){return r||(r=Object(o.a)("anjs")||"https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}}}]);
//# sourceMappingURL=owa.Spotlight.js.map
self.scriptsLoaded['owa.Spotlight.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Spotlight.js'] = (new Date()).getTime();