self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.UpNextV2.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[614,54],{1017:function(e,t,n){"use strict";function r(e){var t;if(null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id){var n=e.ClientSeriesId;return!!n&&(e.IsRecurring?n==e.InstanceKey:n==e.ItemId.Id)}return!0}var a=n(0),i=n(569),o=n(435);function c(e,t){var n=Object(o.a)();e.forEach((function(e){var r=Object(o.a)();d(e,n,r,t),e.IsRecurring=!0,e.InstanceKey=e.InstanceKey&&!t?e.InstanceKey:n}))}function u(e){var t=Object(o.a)();d(e,t,t,!1)}function d(e,t,n,r){e.ItemId=Object(a.__assign)(Object(a.__assign)({},Object(i.a)({Id:n})),{mailboxInfo:e.ParentFolderId.mailboxInfo}),e.ClientSeriesId&&!r||(e.ClientSeriesId=t),e.EffectiveRights={Read:!0,Modify:!0,Delete:!0,ViewPrivateItems:!0},e.IsOrganizer=!0}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}))},1038:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(296),a=n(1004),i=n(76);function o(){var e;return(e={})[a.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[a.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[a.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddClassicAttachment","InsertLink","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[a.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[a.a.Confetti]={confettiEnabled:!0},e[a.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[a.a.GdprAdsPrefs]={feature:a.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[a.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[a.a.ExternalImages]={externalImagesSelectedOption:0},e[a.a.EventCapture]={autoCollectionEnabled:!1},e[a.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[a.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,roamingTimeZoneTeachingMomentDisplayed:!1,bannedRoamingTimeZone:null,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[a.a.AmpDeveloper]={enabled:Object(i.h)("rp-ampDefault"),allowedSender:[]},e[a.a.CalendarHelp]={calendarHelpEnabled:!1},e[a.a.LinkedInViewProfile]={dismissed:!1},e[a.a.Bohemia]={bohemiaEnabled:Object(i.h)("cmp-prague")},e[a.a.GdprAdsV2]={feature:a.a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[a.a.GdprAdsV3]={feature:a.a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[a.a.Proofing]={feature:a.a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[a.a.ActiveProxyAddress]={feature:a.a.ActiveProxyAddress,activeProxyAddresses:[]},e[a.a.OutlookSpaces]={feature:a.a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[a.a.SxS]={feature:a.a.SxS,hideReadingPane:!1},e}},10405:function(e,t,n){var r=n(12262),a=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1058:function(e,t,n){"use strict";var r=n(0),a=n(76),i=255,o=175,c="_____";function u(e){if(!e)return null;var t=e.indexOf(c);-1!=t&&(e=e.substring(0,t));var n=Object(a.h)("cal-mf-joinButton")?o:i;if((e=e.trim()).length<n)return e;var r=e.substr(0,n).trim();return r.length>0?r.concat("..."):null}var d=n(106),s=n(159),l=n(5),f=n(7),b=n(1446),v=n(1447),O=n(1313),j=n(1448);n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return g}));var I=Object(b.a)(),p=[[Object(f.nc)("2019-11-03T00:00:00.000-03:00"),Object(f.nc)("2020-02-15T23:59:59.999-03:00")],[Object(f.nc)("2020-11-08T00:00:00.000-03:00"),Object(f.nc)("2021-02-20T23:59:59.999-03:00")],[Object(f.nc)("2021-11-07T00:00:00.000-03:00"),Object(f.nc)("2022-02-20T23:59:59.999-03:00")]];function m(e,t){t=t||Object(d.e)();var n=[],i=!1;if(null==e?void 0:e.ExtendedProperty){var o=e.ExtendedProperty.filter((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===v.a.PropertyName}))[0];if(null==o?void 0:o.Value)try{n=JSON.parse(o.Value)}catch(e){n=[]}e.ExtendedProperty.some((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===j.a.PropertyName&&!!e.Value}))&&(i=!0)}var c=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},I),e),{ItemId:e.ItemId?Object(r.__assign)(Object(r.__assign)({},e.ItemId),{mailboxInfo:t}):e.ItemId,ParentFolderId:e.ParentFolderId?Object(r.__assign)(Object(r.__assign)({},e.ParentFolderId),{mailboxInfo:t}):e.ParentFolderId,Start:h(e.Start),End:h(e.End),StartTimeZoneId:Object(s.b)(e.StartTimeZoneId),EndTimeZoneId:Object(s.b)(e.EndTimeZoneId),LastModifiedTime:h(e.LastModifiedTime),FreeBusyType:e.FreeBusyType,ResponseType:e.ResponseType,AppointmentReplyTime:h(e.AppointmentReplyTime),ExperienceType:e.ExperienceType?e.ExperienceType:"Unspecified",SeriesMasterItemId:e.SeriesMasterItemId?Object(r.__assign)(Object(r.__assign)({},e.SeriesMasterItemId),{mailboxInfo:t}):null,Sensitivity:t.type==d.a.GroupMailbox&&"Private"==e.Sensitivity?"Normal":e.Sensitivity,Preview:u(e.Preview),AppendOnSend:n,IsBookedFreeBlocks:i});if(!e.IsAllDayEvent&&e.SeriesId&&"Occurrence"==e.CalendarItemType&&"tzone://Microsoft/Custom"==e.StartTimeZoneId&&"E. South America Standard Time"==e.EndTimeZoneId&&!Object(a.h)("cal-killSwitch-63446")&&c.Start&&c.End&&p.some((function(e){var t=Object(r.__read)(e,2),n=t[0],a=t[1];return Object(f.Nb)(c.Start,n,a)}))){var l=Object(f.x)(c.End,c.Start);c.Start=Object(f.f)(c.Start,1),c.End=Object(f.h)(c.Start,l),c.StartTimeZoneId=c.EndTimeZoneId,c.__BrazilHack__=1}return c}function h(e){if(e){if(Object(a.h)("cal-assumeTzOffsetFromCalendarItem")){var t=Object(l.a)().timezone,n=!!t;return Object(f.Sb)(t,e,n)}return Object(f.qb)(e)}}function g(e){var t=[];return e.AppendOnSend&&e.AppendOnSend.length>0&&t.push(Object(O.a)({ExtendedFieldURI:v.a,Value:JSON.stringify(e.AppendOnSend)})),e.IsBookedFreeBlocks&&t.push(Object(O.a)({ExtendedFieldURI:j.a,Value:e.IsBookedFreeBlocks.toString()})),Object(r.__assign)(Object(r.__assign)({__type:"CalendarItem:#Exchange"},e),{Start:e.Start&&Object(f.rb)(e.Start),End:e.End&&Object(f.rb)(e.End),LastModifiedTime:e.LastModifiedTime&&Object(f.rb)(e.LastModifiedTime),AppointmentReplyTime:e.AppointmentReplyTime&&Object(f.rb)(e.AppointmentReplyTime),FreeBusyType:e.FreeBusyType,CharmId:e.CharmId,IsDraft:e.IsDraft,IsRoomRequested:e.IsRoomRequested,SkypeTeamsProperties:e.SkypeTeamsProperties&&JSON.stringify(e.SkypeTeamsProperties),ExtendedProperty:t})}},110:function(e,t,n){"use strict";var r=n(120),a={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,DaysInOneWeek:7,AllDaysOfWeek:[r.b.Sunday,r.b.Monday,r.b.Tuesday,r.b.Wednesday,r.b.Thursday,r.b.Friday,r.b.Saturday]};t.a=a},11050:function(e,t,n){"use strict";n.r(t);var r=n(2962),a=n(4),i=n(1504),o=n(4839),c=n(998),u=Object(c.e)("UpNextMailCalendarCacheId");function d(){return u.getLockId()}Object(a.orchestrator)(o.d,(function(){var e=Object(o.b)();"DoesNotExist"!==Object(i.d)(d())&&Object(r.j)(e,d())}));function s(){var e=Object(o.b)();Object(r.e)(e,d())}var l=n(0),f=n(9260),b=n(42),v=n(306),O=n(1),j=n(10405),I=Object(b.a)((function(e){return O.createElement("div",{className:j.upNextEventContainer},e.eventCountString&&O.createElement("div",{className:j.conflictingEventsCount},e.eventCountString),O.createElement(v.a,{className:j.eventIconColumn,iconName:"Event"}),O.createElement("div",{className:j.eventDetailsColumn},O.createElement("div",{className:j.eventName},e.eventName),O.createElement("div",{className:j.eventTimeLocationRow},O.createElement("div",{className:j.eventTime},e.timeUntilEvent),e.eventLocation&&O.createElement("div",{className:j.eventLocation},e.eventLocation))))})),p=n(12263),m=n(10),h=n(38),g=n(7),E=n(417),_=n(571),y=59*h.g;function C(e,t){var n=Object(_.i)();if(Object(E.t)(n,e.Start,e.End))return t?Object(m.b)(f.c)+",":Object(m.b)(f.c);var r=Object(g.mc)(e.Start),a=Math.abs(Object(g.Ab)(n)-Object(g.Ab)(r));if(a<=y){var i=Math.ceil(a/h.g);return Object(m.c)(Object(m.b)(p.a),i)}var o=Object(g.Jb)(n,r),c=Object(g.ab)(r);return o?c:Object(m.c)(Object(m.b)(f.f),c)}var w=n(1153);var S=n(1691),x=n(254),R=n(2157),T=n(1336),A=n(573),P=n(2366),F=n(10405),k="UpNext";function M(e,t,n,r,a,i){e.push(O.createElement(I,{key:t,eventCountString:a,eventLocation:r,eventName:n,timeUntilEvent:i}))}var D=Object(b.a)((function(e){var t,n,r=e.upNextEvent,a=r.ItemId,i=e.conflictingEvents.length+1,o=i>1,c=Object(l.__spread)([r],e.conflictingEvents),u=!o&&a,d=O.useCallback((function(){Object(T.b)()?function(e){Object(x.o)("TnS_UpNextClicked"),e?R.f.importAndExecute(k,e):R.h.importAndExecute(k)}(u):function(e){e?Object(P.a)(e,"Mail_UpNext",null,6):window.open(Object(A.e)())}(u)}),[u]),s=O.useCallback((function(){var e=c.length;n=setTimeout((function(){n&&Object(x.o)("TnS_UpNextHover",[e]),n=null}),300)}),[u]),b=O.useCallback((function(){n=null}),[u]);O.useEffect((function(){Object(x.o)("TnS_UpNext",[c.length],{sessionSampleRate:10})}),[u]);for(var v=[],j=i>3,I=j?2:c.length,p=0;p<I;p++){var h=c[p],g=null===(t=h.Location)||void 0===t?void 0:t.DisplayName,E=o&&Object(m.c)(Object(m.b)(f.a),p+1,i),_=C(h,!!g);M(v,h.ItemId.Id,Object(w.c)(h),g,E,_)}if(j){var y=i-I;M(v,"viewAll",Object(m.b)(f.g),null,Object(m.c)(Object(m.b)(f.d),y),C(r,!1))}var D=F.allEventsContainer;2==i?D=F.allEventsContainerTwoEvents:i>2&&(D=F.allEventsContainerThreeOrMoreEvents);var N=o?void 0:Object(w.e)(r),L=o?function(e,t,n){var r=[];r.push(Object(m.c)(Object(m.b)(f.b),t));for(var a=0;a<e.length;a++){var i=e[a];r.push(Object(m.c)(Object(m.b)(f.e),a+1,t)),r.push(Object(w.a)(i))}return n&&r.push(Object(m.b)(f.g)),r.join(" ")}(c.slice(0,I),c.length,j):Object(w.a)(r);return O.createElement(S.a,{ariaLabel:L,className:F.upNextEventButtonContainer,"data-is-focusable":!0,"data-automation-id":"UpNext",onClick:d,role:"menuitem",title:N,styles:e.containerStyle},O.createElement("div",{className:D,onMouseEnter:s,onMouseLeave:b},v))}));var N=Object(b.a)((function(e){var t="DoesNotExist"!==Object(i.d)(d())?Object(r.c)(d()):null;if(!t||!t.upNextEvent)return null;var n=t.conflictingEvents;return O.createElement(D,{upNextEvent:t.upNextEvent,conflictingEvents:n,containerStyle:e.containerStyle})}));function L(){return!!Object(r.b)(d())}n.d(t,"initializeUpNextV2",(function(){return s})),n.d(t,"UpNextV2",(function(){return N})),n.d(t,"isUpNextEventReady",(function(){return L}))},1113:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return f}));var r=n(0),a=n(23),i=n(1132);function o(){return b.get()}function c(e,t){var n=u(e);return n&&n.itemResponseShapeType===t?n:null}function u(e){var t=o()[e];return t||null}function d(e,t,n){var a=Object(i.a)().fullItemsMruMap.get(e);if(a){var o=Object(r.__read)(a.eventInfos.filter((function(e){return e.eventKey===t})),1)[0];if(o&&o.itemResponseShapeType===n)return o}return null}function s(e){var t=u(e);return t?t.loadState:null}function l(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.itemResponseShapeType;return n||"Default"}function f(){return"Default"}var b=Object(a.computed)((function(){var e=Object(i.a)();return Object(r.__spread)(e.fullItemsMruMap.keys()).reduce((function(t,n){return e.fullItemsMruMap.get(n).eventInfos.forEach((function(e){return t[e.eventKey]=e})),t}),{})}))},1130:function(e,t,n){"use strict";var r=n(417),a=n(7);function i(e){return o({start:e.Start,end:e.End})}function o(e){var t=Object(a.Xb)(e.end),n={start:e.start,end:e.end},r=Object(a.Ib)(e.end,t),i=Object(a.Ib)(e.start,t);return r&&!i&&(n.end=Object(a.ec)(n.end,1)),n}function c(e){return function(t){var n=i(t);return 0===Object(r.j)(e,n,!0)}}var u=n(38);function d(e){var t=i(e),n=Object(a.w)(Object(a.Xb)(t.end),Object(a.Xb)(t.start));return Math.ceil(n/u.e)}var s=n(110);function l(e){return e.IsAllDayEvent||Object(a.w)(e.End,e.Start)>=s.a.MillisecondsInOneDay}function f(e){return Object(a.Gb)(e.Start,e.End)?b(e):d(e)>=1}function b(e){return Math.abs(Object(a.s)(e.Start,e.End))>1}n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return b}))},1153:function(e,t,n){"use strict";var r=n(417),a=n(571),i=n(10),o=n(2209),c=n(7),u=n(1130),d=n(2210),s=n(1155);function l(e,t){var n=[];return e.IsDraft&&n.push(Object(i.b)(d.a)),e.Subject?n.push(e.Subject):t||n.push(Object(i.b)(d.b)),n.join(" ")}function f(e){return e.Location?Object(s.d)(e.Location.DisplayName,e.Location.PostalAddress):""}function b(e,t,n){var d=[];d.push(function(e,t,n){var d=l(e),s=Object(u.e)(e),f=j(e.Start,e.End,t,e.IsAllDayEvent,s,!0),b=function(e,t,n){if(Object(a.h)(e)||Object(a.h)(t))return o.h;return n?o.g:""}(e.Start,e.End,n),v=Object(i.b)(o.b);e.IsAllDayEvent&&s&&Object(c.w)(e.End,e.Start)==r.a.MillisecondsInOneDay?v=Object(i.b)(o.i):e.IsAllDayEvent&&s&&(v=Object(i.b)(o.a));return Object(i.c)(v,f,d,b)}(e,t,n));var s=f(e);return s&&d.push(Object(i.c)(Object(i.b)(o.c),s)),e.Organizer&&e.IsMeeting&&d.push(Object(i.c)(Object(i.b)(o.d),e.Organizer.Mailbox.Name)),"Occurrence"===e.CalendarItemType&&d.push(Object(i.b)(o.f)),"Private"===e.Sensitivity&&d.push(Object(i.b)(o.e)),d.join(" ")}function v(e,t){var n=[],r=l(e);r&&n.push(r);var a=f(e);a&&n.push(a);var i=Object(u.e)(e),o=j(e.Start,e.End,t,e.IsAllDayEvent,i,!1);return n.push(o),n.join("\n")}function O(e,t){var n=f(e),r=v(e);return n?r+" "+n:r}function j(e,t,n,a,d,s){if(n&&(e=Object(c.Rb)(n,e),t=Object(c.Rb)(n,t)),Object(c.Jb)(e,t))return Object(i.c)(Object(i.b)(o.l),s?Object(c.gb)(e):"",Object(c.ab)(e),Object(c.ab)(t)).replace("  "," ");if(a&&d){if(Object(c.w)(t,e)==r.a.MillisecondsInOneDay)return Object(c.gb)(e);var l=Object(c.gb)(Object(u.a)({start:e,end:t}).end);return Object(i.c)(Object(i.b)(o.j),Object(c.gb)(e),l)}return Object(i.c)(Object(i.b)(o.k),Object(c.gb)(e),Object(c.ab)(e),Object(c.gb)(t),Object(c.ab)(t))}n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return l}))},1169:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(417);function a(e,t){var n=[],a=[];return e.forEach((function(e){var i={start:e.Start,end:e.End};t.some((function(e){return 0===Object(r.j)(e,i,!0)}))?n.push(e):a.push(e)})),{eventsOverlapping:n,eventsNotOverlapping:a}}},1176:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r="A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऀ-५ॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",a=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),i=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),o=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),c=/[^\\]"/,u=/^[A-Za-z0-9_-]+:.*$/,d=function(e){var t=e.match(a);if(t)return-1!==t[0].indexOf("..")?null:t[0];var n=e.match(i);if(n){var r=c.exec(n[0]);return r&&r.index!==n[0].length-2?null:n[0]}return null};function s(e){if(!e)return!1;var t=d(e);return!!t&&!!e.substring(t.length+1).match(o)}function l(e){return u.test(e)}function f(e){return s(e)||l(e)}},1184:function(e,t,n){"use strict";var r=n(38),a=n(1295),i=n(1190),o=n(7),c=n(158);function u(e){var t=Object(c.w)();return e.ParentFolderId&&t&&e.ParentFolderId.Id===t.calculatedFolderId}function d(e){if(!e.ParentFolderId)return!1;var t=Object(c.l)(Object(c.w)()).ParentGroupId,n=Object(c.o)(e.ParentFolderId.Id);return n&&n.ParentGroupId===t}function s(e,t){var n=Object(i.a)(e);if(n!=Object(i.a)(t))return n?-1:1;var r=f(t)-f(e);if(0!=r)return r;if(0!=(r=Object(o.w)(e.Start,t.Start)))return r;if(b(e)&&b(t)){var c=u(e);if(c!=u(t))return c?-1:1;var s=d(e);if(s!=d(t))return s?-1:1}return 0!=(r=Object(a.a)(e,t))?r:0!=(r=Object(o.w)(t.End,e.End))?r:0!=(r=l(e.Subject,t.Subject))?r:0!=(r=l(e.CalendarItemType,t.CalendarItemType))?r:0!=(r=l(e.ParentFolderId.Id,t.ParentFolderId.Id))?r:l(e.ItemId.Id,t.ItemId.Id)}function l(e,t){return(e||"").localeCompare(t||"")}function f(e){var t=Object(o.w)(e.End,e.Start);return Math.max(Math.ceil(t/r.e),1)}function b(e){return"Booking"!=e.__type&&"AnonymousCalendarEvent"!=e.__type}n.d(t,"a",(function(){return s}))},1190:function(e,t,n){"use strict";var r=n(7);t.a=function(e){return e.IsAllDayEvent||Object(r.u)(e.End,e.Start)>0}},1205:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l}));var r=2,a=4,i=8,o=32,c=64,u=128,d=4294967296,s=8589934592,l=17179869184},1226:function(e,t,n){"use strict";n.d(t,"z",(function(){return r})),n.d(t,"p",(function(){return a})),n.d(t,"B",(function(){return i})),n.d(t,"C",(function(){return o})),n.d(t,"A",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"y",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"q",(function(){return l})),n.d(t,"s",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"D",(function(){return v})),n.d(t,"u",(function(){return O})),n.d(t,"a",(function(){return j})),n.d(t,"w",(function(){return I})),n.d(t,"c",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"E",(function(){return g})),n.d(t,"v",(function(){return E})),n.d(t,"b",(function(){return _})),n.d(t,"x",(function(){return y})),n.d(t,"d",(function(){return C})),n.d(t,"r",(function(){return w})),n.d(t,"t",(function(){return S})),n.d(t,"l",(function(){return x})),n.d(t,"i",(function(){return R})),n.d(t,"j",(function(){return T})),n.d(t,"k",(function(){return A})),n.d(t,"o",(function(){return P})),n.d(t,"n",(function(){return F}));var r="Sunday",a="Monday",i="Tuesday",o="Wednesday",c="Thursday",u="Friday",d="Saturday",s=[r,a,i,o,c,u,d],l=["January","February","March","April","May","June","July","August","September","October","November","December"],f="None",b="DailyRecurrence",v="WeeklyRecurrence",O="RelativeMonthlyRecurrence",j="AbsoluteMonthlyRecurrence",I="RelativeYearlyRecurrence",p="AbsoluteYearlyRecurrence",m=["None","First","Second","Third","Fourth","Last"],h="DailyRecurrence:#Exchange",g="WeeklyRecurrence:#Exchange",E="RelativeMonthlyRecurrence:#Exchange",_="AbsoluteMonthlyRecurrence:#Exchange",y="RelativeYearlyRecurrence:#Exchange",C="AbsoluteYearlyRecurrence:#Exchange",w="NoEndRecurrence:#Exchange",S="NumberedRecurrence:#Exchange",x="EndDateRecurrence:#Exchange",R=3,T=25,A=1,P=1,F=99},12262:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'@-webkit-keyframes _3GYWRGGf7P_GI0nsmyJJEq{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _2qguJkZ4YN-a4-jZornQTp{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _3GYWRGGf7P_GI0nsmyJJEq{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _2qguJkZ4YN-a4-jZornQTp{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _1uBAfIo7O7RpspBEYft67J{to{-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes gqklPe3BnRAQGJ-1Nd_Xp{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes _1uBAfIo7O7RpspBEYft67J{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes gqklPe3BnRAQGJ-1Nd_Xp{to{-webkit-transform:translateY(0);transform:translateY(0)}}.bquTIlYhtqsZHlrJCQ0ci{font-size:12px;font-weight:400;color:"[theme:themeDark, default:#0D62AA]";cursor:pointer;height:34px;overflow:hidden}html[dir] .bquTIlYhtqsZHlrJCQ0ci{padding:0 8px}._1KWaEy1JwXTPcXePft1XyO,._1Lt2W5uQ7oe52kMFzniHCz,.HpJj1IBE9g7fhlrQQuBva{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start;height:34px}.HpJj1IBE9g7fhlrQQuBva{height:68px}html[dir] .HpJj1IBE9g7fhlrQQuBva{-webkit-transform:translateY(0);transform:translateY(0);-webkit-transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1),-webkit-transform .3s cubic-bezier(.8,0,.2,1)}._1Lt2W5uQ7oe52kMFzniHCz{height:102px;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-play-state:running;animation-play-state:running;-webkit-animation-timing-function:cubic-bezier(.8,0,.2,1);animation-timing-function:cubic-bezier(.8,0,.2,1)}html[dir=ltr] ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:gqklPe3BnRAQGJ-1Nd_Xp;animation-name:gqklPe3BnRAQGJ-1Nd_Xp}html[dir=rtl] ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_1uBAfIo7O7RpspBEYft67J;animation-name:_1uBAfIo7O7RpspBEYft67J}html[dir] .bquTIlYhtqsZHlrJCQ0ci:hover .HpJj1IBE9g7fhlrQQuBva{-webkit-transform:translateY(-34px);transform:translateY(-34px);-webkit-transition-delay:.1s;transition-delay:.1s}.bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-duration:3.6s;animation-duration:3.6s}html[dir=ltr] .bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_2qguJkZ4YN-a4-jZornQTp;animation-name:_2qguJkZ4YN-a4-jZornQTp}html[dir=rtl] .bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_3GYWRGGf7P_GI0nsmyJJEq;animation-name:_3GYWRGGf7P_GI0nsmyJJEq}._1hagGpG7AzPUNXP0Svq92n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;-ms-flex-item-align:end;align-self:flex-end;height:34px}.Zxu7pq6NX4jIi550qVOsj{font-size:14px;font-weight:400;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;line-height:34px}html[dir=ltr] .Zxu7pq6NX4jIi550qVOsj{padding-right:6px}html[dir=rtl] .Zxu7pq6NX4jIi550qVOsj{padding-left:6px}._3PRzKbmV4xQJvn21aAkCeP{font-size:16px;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir=ltr] ._3PRzKbmV4xQJvn21aAkCeP{padding-right:8px}html[dir=rtl] ._3PRzKbmV4xQJvn21aAkCeP{padding-left:8px}._3wJAY7Lg8iqglCkKc_1xfx,._2KWQkcW6CcNYP-7HUovRXb,._5h5kaMsfWHnnSvF2gbHpv,._3xLd9sljnn8QP_g_E9drtK{overflow:hidden;word-break:break-all}html[dir] ._3wJAY7Lg8iqglCkKc_1xfx,html[dir] ._2KWQkcW6CcNYP-7HUovRXb,html[dir] ._5h5kaMsfWHnnSvF2gbHpv,html[dir] ._3xLd9sljnn8QP_g_E9drtK{text-align:start}.HI72OmTBCYbpLJFgasLYQ{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start}._5h5kaMsfWHnnSvF2gbHpv{font-weight:600;height:16px}._5h5kaMsfWHnnSvF2gbHpv,._1cph5Ohu1BNS65JDq4b3tl{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;max-width:162px}._1cph5Ohu1BNS65JDq4b3tl{display:-webkit-box;display:-ms-flexbox;display:flex}._3xLd9sljnn8QP_g_E9drtK{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;max-width:162px}html[dir=ltr] ._3xLd9sljnn8QP_g_E9drtK{margin-right:4px}html[dir=rtl] ._3xLd9sljnn8QP_g_E9drtK{margin-left:4px}._2KWQkcW6CcNYP-7HUovRXb{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}',""]),t.locals={upNextEventButtonContainer:"bquTIlYhtqsZHlrJCQ0ci",allEventsContainer:"_1KWaEy1JwXTPcXePft1XyO",allEventsContainerThreeOrMoreEvents:"_1Lt2W5uQ7oe52kMFzniHCz",allEventsContainerTwoEvents:"HpJj1IBE9g7fhlrQQuBva",reverseMotion:"gqklPe3BnRAQGJ-1Nd_Xp","reverseMotion-rtl":"_1uBAfIo7O7RpspBEYft67J",motionForThreeOrMore:"_2qguJkZ4YN-a4-jZornQTp","motionForThreeOrMore-rtl":"_3GYWRGGf7P_GI0nsmyJJEq",upNextEventContainer:"_1hagGpG7AzPUNXP0Svq92n",conflictingEventsCount:"Zxu7pq6NX4jIi550qVOsj",eventIconColumn:"_3PRzKbmV4xQJvn21aAkCeP",eventEntities:"_3wJAY7Lg8iqglCkKc_1xfx",eventLocation:"_2KWQkcW6CcNYP-7HUovRXb",eventName:"_5h5kaMsfWHnnSvF2gbHpv",eventTime:"_3xLd9sljnn8QP_g_E9drtK",eventDetailsColumn:"HI72OmTBCYbpLJFgasLYQ",eventTimeLocationRow:"_1cph5Ohu1BNS65JDq4b3tl"}},12263:function(e){e.exports=JSON.parse('{"a":"i7c"}')},1229:function(e,t,n){"use strict";n.d(t,"e",(function(){return"{id}"})),n.d(t,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(t,"a",(function(){return"data-custom"})),n.d(t,"c",(function(){return"originalsrc"})),n.d(t,"b",(function(){return"data-loadstatus"})),n.d(t,"d",(function(){return"pending"}))},1240:function(e,t,n){"use strict";function r(e,t){return!e.some((function(e){return e&&t&&e.calculatedFolderId===t.calculatedFolderId}))}function a(e,t){return e.indexOf(t)<0}function i(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e&&e.forEach((function(e){t(n,e)&&n.push(e)})),n}var o=n(23);function c(e,t){if(void 0===t&&(t=a),!e)return e;var n=new o.ObservableMap;return e.forEach((function(e,r){n.set(r,i(e,t))})),n}function u(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e.forEach((function(e){e&&e.forEach((function(e){t(n,e)&&n.push(e)}))})),n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}))},1250:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return f}));var r=n(1226);function a(e){return e?l(e)?r.e:f(e)?r.D:d(e)?r.u:c(e)?r.a:s(e)?r.w:u(e)?r.c:r.s:r.s}function i(e){return c(e)||d(e)}function o(e){return u(e)||s(e)}function c(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.b}function u(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.d}function d(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.v}function s(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.x}function l(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.f}function f(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.E}},1281:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),a=n(1038),i=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(a.a)()),{defaultOptions:e}}))},1295:function(e,t,n){"use strict";var r=n(1296);t.a=function(e,t){return Object(r.a)(e.FreeBusyType)-Object(r.a)(t.FreeBusyType)}},1296:function(e,t,n){"use strict";t.a=function(e){switch(e){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}}},1302:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(975),a=n(94);function i(){var e=!0;if(Object(a.u)()){var t=Object(r.d)(r.a.ExternalImages);e=null===t.externalImagesSelectedOption||0===t.externalImagesSelectedOption}else{var n=Object(a.i)().PolicySettings;e=void 0===n.ExternalImageProxyEnabled||n.ExternalImageProxyEnabled}return e}},1313:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"ExtendedPropertyType:#Exchange"},e)}},1329:function(e,t,n){"use strict";var r=n(1184),a=n(1295),i=(n(1296),n(7));var o=n(1356),c=function(e,t){return Object(i.Ab)(e.Start)<Object(i.Ab)(t.End)&&Object(i.Ab)(e.End)>Object(i.Ab)(t.Start)},u=function(e,t){return t.filter((function(t){return t!=e&&c(e,t)})).sort(r.a)};function d(e,t){var n,r,a,o,c;e.Start=t.Start,e.ItemId=t.ItemId,e.End=t.End,e.CalendarItemType="ThisAndFollowingInstancesMaster",e.Recurrence.RecurrenceRange.StartDate=(r=(n=t).StartTimeZoneId,a=n.Start,o=Object(i.Rb)(r,a),c=Object(i.Xb)(o),Object(i.vb)(c))}var s=n(1190);function l(e){e.Start=Object(i.Rb)(e.StartTimeZoneId,e.Start),e.End=Object(i.Rb)(e.EndTimeZoneId,e.End)}n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return o.a})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return s.a})),n.d(t,"h",(function(){return l}))},1339:function(e){e.exports=JSON.parse('{"a":"Yba"}')},1356:function(e,t,n){"use strict";function r(e){var t;return null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id}n.d(t,"a",(function(){return r}))},1372:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("poll",(function(e,t,n){return{requestFunction:e,requestIdentifier:t,interval:n}})),i=Object(r.action)("responseRetrieved",(function(e,t){return{response:e,responseIdentifier:t}})),o=Object(r.action)("cancelPoll",(function(e){return{requestIdentifier:e}})),c={currentRequest:new(n(23).ObservableMap)},u=Object(r.createStore)("requestIdStore",c);Object(r.mutator)(o,(function(e){var t=u().currentRequest.get(e.requestIdentifier);if(t){var n=t.timer;clearTimeout(n),t.timer=null}}));var d=n(0),s=Object(r.mutatorAction)("setCurrentRequestId",(function(e,t){var n=u().currentRequest.get(e);n?n.requestId=t:u().currentRequest.set(e,{requestId:t,timer:null})}));function l(e,t){return u().currentRequest.get(e).requestId===t}function f(e,t){return Object(d.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(d.__generator)(this,(function(i){switch(i.label){case 0:return n=Math.random(),s(t,n),[4,e()];case 1:return r=i.sent(),a={isCurrent:l(t,n)},[2,Object(d.__assign)({response:r},a)]}}))}))}var b=Object(r.mutatorAction)("setPollTimer",(function(e,t){var n=u().currentRequest.get(e);n&&(n.timer=t)}));Object(r.orchestrator)(a,(function(e){var t=e.requestFunction,n=e.requestIdentifier,r=e.interval;o(n);var c=setTimeout((function(){return function(e,t,n){return Object(d.__awaiter)(this,void 0,void 0,(function(){var r;return Object(d.__generator)(this,(function(o){switch(o.label){case 0:return[4,f((function(){return e()}),t)];case 1:return(r=o.sent()).isCurrent&&i(r.response,t),a(e,t,n),[2]}}))}))}(t,n,r)}),r);b(n,c)})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}))},1446:function(e,t,n){"use strict";function r(){return{__type:void 0,ItemId:void 0,ParentFolderId:void 0,Subject:void 0,ReminderIsSet:void 0,ReminderMinutesBeforeStart:void 0,LastModifiedTime:void 0,InstanceKey:void 0,Preview:void 0,EffectiveRights:void 0,HasAttachments:void 0,HasBlockedImages:void 0,Attachments:void 0,Sensitivity:void 0,Body:void 0,EntityNamesMap:void 0,TailoredXpEntities:void 0,IsDraft:void 0,Categories:void 0,Start:void 0,End:void 0,IsAllDayEvent:void 0,IsRoomRequested:void 0,AutoRoomBookingStatus:void 0,FreeBusyType:void 0,IsMeeting:void 0,IsCancelled:void 0,IsRecurring:void 0,IsResponseRequested:void 0,CalendarItemType:void 0,ResponseType:void 0,Organizer:void 0,RequiredAttendees:void 0,OptionalAttendees:void 0,Resources:void 0,AppointmentReplyTime:void 0,Recurrence:void 0,Location:void 0,IntendedFreeBusyStatus:void 0,IsOrganizer:void 0,AppointmentReplyName:void 0,IsSeriesCancelled:void 0,CharmId:void 0,Locations:void 0,ClientSeriesId:void 0,UID:void 0,ExperienceType:void 0,DoNotForwardMeeting:void 0,IsOnlineMeeting:void 0,JoinOnlineMeetingUrl:void 0,InboxReminders:void 0,MeetingRequestWasSent:void 0,ExtractionSourceId:void 0,StartTimeZoneId:void 0,EndTimeZoneId:void 0,OnlineMeetingProvider:void 0,OnlineMeetingJoinUrl:void 0,OnlineMeetingConferenceId:void 0,OnlineMeetingTollNumber:void 0,OnlineMeetingTollFreeNumbers:void 0,SeriesMasterItemId:void 0,ExtractionSourceInternetMessageId:void 0,HideAttendees:void 0,PersonId:void 0,InReplyTo:void 0,IsFreeBusyOnly:void 0,MeetingNotesWebUrl:void 0,ConversationId:void 0,SkypeTeamsProperties:void 0,DocLinks:void 0,AppendOnSend:void 0,IsBookedFreeBlocks:void 0,AssociatedTasks:void 0}}n.d(t,"a",(function(){return r}))},1447:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(298),a=Object(r.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})},1448:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(424),a=Object(r.a)("6ed8da90-450b-101b-98da-00aa003f1305","IsBookedFreeBlocks","Boolean")},1458:function(e){e.exports=JSON.parse('{"a":"Lda"}')},1459:function(e){e.exports=JSON.parse('{"a":"Kda"}')},1461:function(e,t,n){"use strict";var r=n(1205),a=n(1494),i=n(1158);var o=n(1767);function c(e){return function(e){return!(e<=0)&&(Object(i.a)(e,a.a)==a.a||Object(i.a)(e,r.d)==r.d||Object(i.a)(e,r.e)==r.e||Object(i.a)(e,a.b)==a.b||Object(i.a)(e,r.a)==r.a||Object(i.a)(e,r.b)==r.b||Object(i.a)(e,r.f)==r.f)}(e)||function(e){return Object(i.a)(e,r.g)==r.g||Object(i.a)(e,r.h)==r.h||Object(i.a)(e,r.i)==r.i}(e)||Object(o.a)(e)}n.d(t,"a",(function(){return c}))},1504:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("updateLoadedDateRange",(function(e,t){return{dateRange:e,eventsCacheLockId:t}})),i=Object(r.action)("updateCalendarEventLoadStates",(function(e,t){return{calendarIds:e,eventsCacheLockId:t}})),o=Object(r.action)("resetCalendarEventLoadStates",(function(e){return{eventsCacheLockId:e}})),c=Object(r.action)("updateLoadState",(function(e,t){return{eventsCacheLockId:t,loadState:e}})),u=Object(r.action)("initializeScenario",(function(e){return{eventsCacheLockId:e}})),d=Object(r.action)("updateIsInitializingCalendarEventsLoader",(function(e,t){return{eventsCacheLockId:t,isInitializingCalendarEventsLoader:e}})),s=n(0),l=n(1329),f=n(998);function b(e){var t=Object(f.n)(e);return Object(s.__assign)(Object(s.__assign)({},t),{getOrderedEvents:function(t,n){return function(e,t,n){var r=Object(f.n)(n).getCalendarEventsForDateRange,a=[];return e.forEach((function(e){a.push.apply(a,Object(s.__spread)(r(e,t)))})),a.sort(l.a)}(t,n,e)}})}var v=n(2102);var O=n(23),j={scenarios:new O.ObservableMap},I=Object(r.createStore)("EventsLoadedStore",j),p=n(158),m=n(631);function h(e){return Object(p.d)(e)&&!Object(p.c)(e)}function g(e){return Object(p.d)(e)&&Object(p.c)(e)}function E(e){return void 0===e&&(e=function(){return!0}),function(t,n){var r=Object(s.__read)(n,2),a=r[0],i=r[1];return e([a,i])&&t.push(a),t}}function _(e){return function(t){var n=Object(s.__read)(t,2);n[0];return n[1]===e}}var y=n(254);function C(e){return A(e).eventsCacheLockId}function w(e,t){return Object(p.d)(t)?h(t)?F(e).get(t):Object(m.d)(t):"Loading"}function S(e){return M(e).map((function(t){return w(e,t)}))}function x(e){return I().scenarios.has(e)?A(e).scenarioLoadState:"DoesNotExist"}function R(e){return A(e).loadedDateRange}function T(e,t){return k(e).reduce(E(_(t)),[])}function A(e){var t=I().scenarios.get(e);return t||(Object(y.o)("GetScenarioDataError",{eventsCacheLockId:e}),{eventsCacheLockId:e,loadedDateRange:null,scenarioLoadState:"DoesNotExist",calendarEventsLoadState:new O.ObservableMap({}),isInitializingCalendarEventsLoader:!1})}function P(e,t){var n=t||R(e),r=function(e){return M(e).filter(h).map(p.x)}(e),a=C(e),i=r?b(a).getOrderedEvents(r,n):[];return Object(v.a)()||(i=i.filter((function(e){return"Decline"!==e.ResponseType}))),i}function F(e){return A(e).calendarEventsLoadState}function k(e){return Object(s.__spread)(F(e).entries())}function M(e){return Object(s.__spread)(F(e).keys())}Object(r.mutator)(a,(function(e){var t=e.eventsCacheLockId,n=e.dateRange;A(t).loadedDateRange=n})),Object(r.mutator)(c,(function(e){var t=e.eventsCacheLockId,n=e.loadState;A(t).scenarioLoadState=n})),Object(r.mutator)(d,(function(e){var t=e.eventsCacheLockId,n=e.isInitializingCalendarEventsLoader;A(t).isInitializingCalendarEventsLoader=n})),Object(r.mutator)(u,(function(e){var t=e.eventsCacheLockId;I().scenarios.get(t)||I().scenarios.set(t,{eventsCacheLockId:t,loadedDateRange:null,scenarioLoadState:"Loading",calendarEventsLoadState:new O.ObservableMap({}),isInitializingCalendarEventsLoader:!0})})),Object(r.mutator)(f.t,(function(e){var t=e.calendarId,n=e.loadingState,r=function(e){var t=Object(s.__spread)(I().scenarios.entries()).filter((function(t){var n=Object(s.__read)(t,2);n[0];return n[1].eventsCacheLockId===e}));return t.length>0?{value:!0,eventsCacheLockId:t[0][0]}:{value:!1}}(e.lockId);if(r.value){var a=F(r.eventsCacheLockId);t&&a.has(t.id)&&a.set(t.id,n)}})),Object(r.mutator)(i,(function(e){var t=e.calendarIds,n=e.eventsCacheLockId,r=F(n);t.forEach((function(e){r.has(e)||r.set(e,"NotLoaded")})),M(n).forEach((function(e){t.some((function(t){return t===e}))||r.delete(e)}))})),Object(r.mutator)(o,(function(e){var t=e.eventsCacheLockId,n=F(t);M(t).forEach((function(e){n.set(e,"NotLoaded")}))}));var D=Object(r.action)("initializeCalendarEventsLoader",(function(e,t,n){return{calendarIds:e,dateRange:t,eventsCacheLockId:n}})),N=Object(r.action)("calendarEventsLoaderInitialized",(function(e){return{eventsCacheLockId:e}})),L=Object(r.action)("updateCalendarIds",(function(e,t){return{calendarIds:e,eventsCacheLockId:t}})),G=Object(r.action)("onCalendarIdsUpdated",(function(e){return{eventsCacheLockId:e}})),B=Object(r.action)("onDateRangeUpdated",(function(e,t){return{dateRange:e,eventsCacheLockId:t}})),q=Object(r.action)("loadFullEvent",(function(e,t,n){return{eventsCacheLockId:e,id:t,parentFolderId:n}})),K=Object(r.action)("updateDateRange",(function(e,t){return{dateRange:e,eventsCacheLockId:t}})),V=Object(r.action)("expandDateRange",(function(e,t){return{numberOfDays:e,eventsCacheLockId:t}})),U=n(7);function z(e,t){return null===t||!Object(U.Ib)(e.start,t.start)||!Object(U.Ib)(e.end,t.end)}var W=n(75),H=function(e,t,n){return e&&0!==e.length?function(e,t,n){var r=this;var a=C(n),i=Object(f.o)(a),o=e.map((function(e){return i.fetchCalendarEventsForDateRange(e,t)})),c=o.every((function(e){return null!==e.events})),u=new Promise((function(t){return Object(s.__awaiter)(r,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Promise.all(o.map((function(e){return e.fetchPromise})))];case 1:return r.sent(),e.forEach((function(e){return i.subscribeNotifications(e)})),[3,3];case 2:return n=r.sent(),W.g.warn("loadEvents: Exception occured: "+n.message),[3,3];case 3:return t(),[2]}}))}))}));return{canFetchAllEventsFromLocal:c,fetchPromise:u}}(e,t,n):{canFetchAllEventsFromLocal:!1,fetchPromise:new Promise((function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,e()]}))}))}))}};function J(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,a,i,o,u;return Object(s.__generator)(this,(function(d){switch(d.label){case 0:return(r=t.filter(h)).length>0?(a=r.map(p.x),i=H(a,n,e),o=i.canFetchAllEventsFromLocal,u=i.fetchPromise,o||c("Fetching",e),[4,u]):[3,2];case 1:d.sent(),d.label=2;case 2:return[2]}}))}))}var Y=function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return e?[4,Promise.all(e.filter(g).map(m.c).map((function(e){return e.catch(Q)})))]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))};function Q(e){return W.g.warn("Failed to update folderId:\n"+e),Promise.resolve()}function Z(e){o(e),a(null,e)}function X(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,o,u;return Object(s.__generator)(this,(function(d){switch(d.label){case 0:return n=t.calendarIds,r=t.dateRange,i(n,e),o=T(e,"NotLoaded"),Y(o),u=R(e),z(r,u)||0!==o.length?(c("Loading",e),z(r,u)&&Z(e),[4,J(e,n,r)]):[3,2];case 1:d.sent(),a(r,e),c("Loaded",e),G(e),d.label=2;case 2:return[2]}}))}))}Object(r.orchestrator)(D,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:if(t=e.eventsCacheLockId,n=e.calendarIds,r=e.dateRange,"DoesNotExist"===x(t))u(t);else if(function(e){return A(e).isInitializingCalendarEventsLoader}(t))return[2];return[4,X(t,{calendarIds:n,dateRange:r})];case 1:return a.sent(),N(t),d(!1,t),[2]}}))}))})),Object(r.orchestrator)(L,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return t=e.calendarIds,n=e.eventsCacheLockId,i(t,n),r=T(n,"NotLoaded"),Y(r),a=R(n),0===r.length?[3,2]:(c("Loading",n),[4,J(n,r,a)]);case 1:o.sent(),c("Loaded",n),G(n),o.label=2;case 2:return[2]}}))}))}));var $=n(1372),ee=(Object(r.orchestrator)(K,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return t=e.dateRange,n=e.eventsCacheLockId,r=R(n),z(t,r)?(c("Loading",n),Z(n),[4,Object($.c)((function(){return J(n,M(n),t)}),"UpdateDateRange_"+n)]):[3,2];case 1:i.sent().isCurrent&&(a(t,n),c("Loaded",n),B(t,n)),i.label=2;case 2:return[2]}}))}))})),Object(r.orchestrator)(V,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return t=e.eventsCacheLockId,n=e.numberOfDays,r=R(t),i={start:r.start,end:Object(U.e)(r.end,n)},c("Loading",t),[4,J(t,M(t),i)];case 1:return o.sent(),a(i,t),c("Loaded",t),[2]}}))}))})),Object(r.orchestrator)(q,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a;return Object(s.__generator)(this,(function(i){return t=e.eventsCacheLockId,n=e.parentFolderId,r=e.id,a=C(t),(0,Object(f.o)(a).fetchFullCalendarEvent)(r,n?n.Id:null,void 0,void 0,{fetchSource:t}),[2]}))}))})),n(533));function te(){var e=this;Object(s.__spread)(I().scenarios.entries()).reduce((function(e,t){var n=Object(s.__read)(t,2),r=n[0],a=(n[1],k(r).reduce(E(_("NotLoaded")),[]));return a&&a.length>0&&e.push({eventsCacheLockId:r,calendarIds:a}),e}),[]).forEach((function(t){return Object(s.__awaiter)(e,void 0,void 0,(function(){var e,n,r;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return e=t.eventsCacheLockId,n=t.calendarIds,(r=R(e))?(c("Loading",e),[4,J(e,n,r)]):[3,2];case 1:a.sent(),c("Loaded",e),a.label=2;case 2:return[2]}}))}))}))}Object(r.orchestrator)(ee.c,te),Object(r.orchestrator)(m.a,te);n.d(t,"h",(function(){return D})),n.d(t,"a",(function(){return N})),n.d(t,"l",(function(){return L})),n.d(t,"j",(function(){return G})),n.d(t,"k",(function(){return B})),n.d(t,"i",(function(){return q})),n.d(t,"m",(function(){return K})),n.d(t,"b",(function(){return V})),n.d(t,"e",(function(){return w})),n.d(t,"f",(function(){return S})),n.d(t,"d",(function(){return x})),n.d(t,"g",(function(){return R})),n.d(t,"c",(function(){return P}))},1506:function(e,t,n){"use strict";var r=n(569),a=n(608),i=n(0),o=n(315),c=n(76),u=n(1058),d=n(1771),s=n(1798),l=n(245),f=n(600),b=n(1033),v=n(1095);function O(e,t,n,r,a){return void 0===a&&(a=void 0),Object(i.__awaiter)(this,void 0,void 0,(function(){var O,j,I,p,m,h,g,E,_;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return O=e.Id,j=e.mailboxInfo,p=null,m=null,[4,Object(o.e)(j)];case 1:(h=i.sent()||{}).datapoint={customData:{itemId:O,fetchingMasterItem:n},jsonCustomData:function(e){var t=e.Body.ResponseMessages.Items[0];return{responseClass:t.ResponseClass,responseCode:t.ResponseCode}}},i.label=2;case 2:return i.trys.push([2,4,5,6]),[4,Object(s.a)({Header:Object(l.a)(),Body:Object(d.a)({EventIds:r,ItemShape:t,IncludeDeclinedMeetings:Object(c.h)("cal-surface-declinedMeetings")})},h)];case 3:return p=i.sent(),"Success"==(I=p.Body.ResponseMessages.Items[0]).ResponseClass?null!=I?null!=(g=I.Items[0])&&(!function(e){e.Locations?e.Locations=e.Locations.filter((function(e){return e})):e.Locations=[],e.Resources&&e.Resources.map((function(t){Object(b.c)(e.Locations,t.Mailbox.EmailAddress)||(e.Locations=e.Locations.filter((function(e){return e.DisplayName!==t.Mailbox.Name||Object(v.o)(e.PostalAddress)})),e.Locations.push(Object(v.e)(t.Mailbox.Name,t.Mailbox.EmailAddress)))}))}(g),a&&(g.ParentFolderId.Id=a),m={calendarEvent:Object(u.a)(g,e.mailboxInfo),error:null,responseCode:I.ResponseCode}):m={calendarEvent:null,error:"[getCalendarEventService] null response.",responseCode:I.ResponseCode}:(E="[getCalendarEventService] request failed. Message: "+I.MessageText+", ResponseCode: "+I.ResponseCode+", ResponseClass: "+I.ResponseClass,m={calendarEvent:null,error:E,responseCode:I.ResponseCode}),[3,6];case 4:return _=i.sent(),m={calendarEvent:null,error:_.message},[3,6];case 5:return Object(c.h)("cal-mf-diagnostics")&&Object(f.a)({action:"GetCalendarEvent",status:(null==I?void 0:I.ResponseClass)||"Error",response:null==p?void 0:p.Body}),[7];case 6:return[2,m]}}))}))}var j=n(25);function I(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"GetBirthdayEventJsonRequest:#Exchange"},n)),Object(j.a)("GetBirthdayEvent",e,t)}var p=n(1510);var m=n(158);function h(e,t,n,c){void 0===c&&(c=!1);var u=Object(m.o)(t);return u&&3==u.CalendarFolderType?function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,a,c,u,d;return Object(i.__generator)(this,(function(s){switch(s.label){case 0:return n=e.Id,a=e.mailboxInfo,[4,Object(o.e)(a)];case 1:return(c=s.sent()||{}).datapoint={customData:{itemId:n},jsonCustomData:function(e){var t,n;return{responseClass:null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseClass,responseCode:null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseCode}}},[4,I({Header:Object(l.a)(),Body:(f={CalendarItemId:Object(r.a)({Id:n})},Object(i.__assign)({__type:"GetBirthdayEventRequest:#Exchange"},f))},c)];case 2:return null!=(u=s.sent()).Body&&"Success"==u.Body.ResponseClass&&null!=(d=u.Body.BirthdayEvent)?[2,{calendarEvent:Object(p.a)(d,t,void 0,e.mailboxInfo),error:null}]:[2,{calendarEvent:null,error:"[getBirthdayEventService] request failed"}]}var f}))}))}(e,t):O(e,n,c,[c?Object(a.a)({OccurrenceId:e.Id}):Object(r.a)({Id:e.Id})],Object(m.L)(u)?t:void 0)}n.d(t,"a",(function(){return h}))},1507:function(e,t,n){"use strict";var r=n(0),a=n(1229),i=n(1447),o=n(1302),c=n(1662),u=n(76),d=n(314);var s=n(1448);function l(e){var t=[i.a];Object(u.h)("cal-time-panel-focusTime")&&t.push(s.a);var n={BaseShape:"IdOnly",MaximumBodySize:0,BodyType:"HTML",FilterHtmlContent:!0,InlineImageCustomDataTemplate:a.e,InlineImageUrlTemplate:a.f,AddBlankTargetToLinks:!0,CssScopeClassName:"cal_"+Math.ceil(65534*Math.random()+1).toString(16),AdditionalProperties:t,ImageProxyCapability:Object(u.h)("cal-bodyImageProxy")&&Object(o.a)()?c.a.OwaAndConnectorsProxy:c.a.None};if(!Object(u.h)("cal-mf-blockExternalContent"))return n;switch(e){case"Default":return Object(r.__assign)(Object(r.__assign)({},n),{BlockContentFromUnknownSenders:!0,BlockExternalImages:!0});case"WithBlockedExternalContent":return n;default:return Object(d.a)(e)}}n.d(t,"a",(function(){return l}))},1510:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(7),i=n(1446),o=n(106),c=n(417),u=n(974),d=n(360);function s(e,t,n,d){if(d=d||Object(o.e)(),!n){var s=Object(u.d)(t);s&&s.length>0&&(n=s.sort((function(e,t){var n=Object(c.l)(e),r=Object(c.l)(t);return n>r?-1:n<r?1:0}))[0])}var f=Object(i.a)(),b=function(e,t){var n=Object(a.mc)(e),r=l(n,Object(a.Db)(t.start));return Object(c.s)(t,r)?r:l(n,Object(a.Db)(t.end))}(e.Birthday,n),v=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f),e),{Subject:e.Name,Start:b,End:Object(a.e)(b,1),IsAllDayEvent:!0,ParentFolderId:{Id:t,mailboxInfo:d},ItemId:{Id:e.Id.Id,mailboxInfo:d},PersonId:e.PersonId,EffectiveRights:{Delete:!0,Modify:!0,Read:!0},FreeBusyType:"Free",ReminderIsSet:e.PopupReminderSettings[0].IsReminderSet,ReminderMinutesBeforeStart:e.PopupReminderSettings[0].ReminderMinutesBeforeStart,InboxReminders:e.EmailReminderSettings});return v||null}function l(e,t){var n=Object(a.yb)(e),r=Object(a.mb)(e),i=Object(d.a)(t,n),o=Math.min(r,i);return Object(a.mc)(t,n,o)}},158:function(e,t,n){"use strict";var r=n(174),a=n(0),i=n(4),o=Object(i.action)("initializeCalendarsCacheInStore",(function(e,t,n,r,a,i){return{defaultCalendarEntry:e,calendarEntries:t,calendarFolders:n,calendarGroups:r,folderIdMapping:a,calendarIdToChangeKeyMapping:i}})),c=Object(i.action)("updateChangeKeyByCalendarItemId",(function(e){return{itemId:e}})),u=Object(i.action)("addToCalendarsCache",(function(e,t,n){return{calendarEntry:e,folder:t,mailboxInfo:n}})),d=Object(i.action)("addCalendarGroupToCalendarsCache",(function(e){return{calendarGroup:e}})),s=Object(i.action)("updateCalendarEntry",(function(e,t){return{itemId:e,calendarEntry:t}})),l=Object(i.action)("updateCalendarFolder",(function(e,t){return{calendar:e,calendarFolder:t}})),f=Object(i.action)("removeCalendarFromCalendarsCache",(function(e){return{calendar:e}})),b=Object(i.action)("markCalendarEntryAsValid",(function(e){return{calendarEntry:e}})),v=Object(i.action)("calendarUpdated",(function(e,t){return{calendarId:e,updates:t}})),O=Object(i.action)("groupAssociationChanged",(function(e){return{payload:e}})),j=Object(i.action)("removeCalendarWithIDFromCalendarsCache",(function(e){return{calendarId:e}}));Object(i.mutator)(c,(function(e){var t=e.itemId,n=t.Id,a=t.ChangeKey;Object(r.a)().calendarItemIdToChangeKey.set(n,a)})),Object(i.mutator)(s,(function(e){var t=e.itemId.Id,n=e.calendarEntry,i=Object(r.a)().calendarEntryMapping.get(t),o=(n.ItemId,Object(a.__rest)(n,["ItemId"]));i&&Object.keys(o).forEach((function(e){i[e]=o[e]}))})),Object(i.mutator)(b,(function(e){var t=e.calendarEntry;Object(r.a)().validEntryMapping.set(t.ItemId.Id,!0)}));var I=n(227);function p(e,t){return t+"_"+e}function m(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function h(e,t,n){var a=Object(r.a)();a.calendarItemIdToChangeKey.delete(e),n||(a.calendarEntryMapping.delete(e),a.validEntryMapping.delete(e)),a.calendarFolderMapping.delete(e),t&&a.folderIdToCalendarId.delete(t)}Object(i.mutator)(o,(function(e){var t=e.defaultCalendarEntry;t&&Object(r.a)().defaultCalendars.set(t.id.mailboxInfo.userIdentity,t)})),Object(i.mutator)(o,(function(e){var t=e.calendarEntries;m(Object(r.a)().calendarEntryMapping,t)})),Object(i.mutator)(o,(function(e){var t=e.calendarFolders;m(Object(r.a)().calendarFolderMapping,t)})),Object(i.mutator)(o,(function(e){var t=e.folderIdMapping;m(Object(r.a)().folderIdToCalendarId,t)})),Object(i.mutator)(o,(function(e){var t=e.calendarIdToChangeKeyMapping;m(Object(r.a)().calendarItemIdToChangeKey,t)})),Object(i.mutator)(o,(function(e){var t=e.calendarGroups;m(Object(r.a)().calendarGroupsMapping,t)})),Object(i.mutator)(u,(function(e){var t=e.calendarEntry,n=e.folder,i=e.mailboxInfo,o=Object(r.a)();o.calendarItemIdToChangeKey.set(t.ItemId.Id,t.ItemId.ChangeKey);var c=Object(a.__assign)(Object(a.__assign)({},t),{id:{id:t.ItemId.Id,mailboxInfo:i}});o.calendarEntryMapping.set(t.ItemId.Id,c),o.calendarFolderMapping.set(t.ItemId.Id,n),n.FolderId?o.folderIdToCalendarId.set(n.FolderId.Id,{id:t.ItemId.Id,mailboxInfo:i}):n.DistinguishedFolderId&&o.folderIdToCalendarId.set(n.DistinguishedFolderId,{id:t.ItemId.Id,mailboxInfo:i})})),Object(i.mutator)(d,(function(e){var t=e.calendarGroup,n=Object(r.a)(),a=p(t.id.mailboxInfo.userIdentity,t.GroupId);n.calendarGroupsMapping.set(a,t)})),Object(i.mutator)(f,(function(e){var t=e.calendar;h(t.id.id,t.calculatedFolderId?t.calculatedFolderId:null)})),Object(i.mutator)(j,(function(e){var t=e.calendarId;h(t,Object(I.s)(t),!0)})),Object(i.mutator)(l,(function(e){var t=e.calendar,n=e.calendarFolder,r=Object(I.l)(t);Object.keys(n).forEach((function(e){r[e]=n[e]}))}));n(449);var g=n(496);function E(e){var t=Object(I.p)(e);return t?t.mailboxInfo:null}function _(e){var t=Object(I.l)(e),n=Object(I.h)(e);return t&&n&&!n.IsReadOnly&&t.EffectiveRights&&t.EffectiveRights.CreateContents}var y=n(420),C=n(26);function w(e,t){var n,r=Object(I.h)(e);if(Object(y.d)(r)){var a=r;return!a.IsOwnerEmailAddressInvalid&&a.OwnerEmailAddress==t}return(null===(n=e.id)||void 0===n?void 0:n.mailboxInfo)?t.indexOf(e.id.mailboxInfo.mailboxSmtpAddress)>=0:Object(C.a)().SessionSettings.UserEmailAddress==t}function S(e){return e?e.map(I.f).filter((function(e){return!!e})):null}function x(e){var t=Object(I.h)(e);return!!t&&t.IsGroupMailboxCalendar}function R(e){var t=Object(I.h)(e);return null==t?void 0:t.IsSchoolCalendar}var T=n(94),A=n(76),P=n(239);function F(e){if(e.IsGroupMailboxCalendar){var t=e.OwnerEmailAddress;return Object(A.h)("cal-groupNotifications")?{MailboxId:Object(I.w)(e)&&Object(A.h)("cal-showAddTeamsCalendars")?Object(I.c)(t):t}:null}var n=e.CalendarFolderId;if(n){var r=e.id.mailboxInfo.userIdentity;return Object(T.v)(r)?{FolderId:n.Id}:Object(P.p)(r)?{FolderId:n.Id,MailboxId:r,MailboxType:Object(P.r)(r)?2:3}:null}return null}var k,M,D=n(106);function N(e){return Object(I.o)().filter((function(t){return function(e,t){return!!e&&e.id.mailboxInfo.userIdentity===t}(t,e)})).sort(L)}function L(e,t){var n=G[e.GroupType]-G[t.GroupType];if(0!==n)return n;var r=B[e.id.mailboxInfo.type]-B[t.id.mailboxInfo.type];return 0!==r?r:e.GroupName.localeCompare(t.GroupName)}var G=((k={})[0]=0,k[2]=1,k[1]=2,k[3]=3,k),B=((M={})[D.a.UserMailbox]=0,M[D.a.TeamsMailbox]=1,M[D.a.GroupMailbox]=2,M[D.a.PublicMailbox]=3,M[D.a.SharedMailbox]=4,M[D.a.ArchiveMailbox]=5,M);function q(e,t){var n=Object(I.r)(e),r=Object(I.d)().filter((function(r){return function(e,t){return!!e&&e.id.mailboxInfo.userIdentity===t}(r,e)&&K(r,t)&&(i=n,!((a=r)&&i&&a.id.id===i.id.id));var a,i})).sort(V);return n&&K(n,t)&&r.unshift(n),r}function K(e,t){var n=Object(I.h)(e);return!!n&&n.ParentGroupId===t}function V(e,t){return e.displayName.localeCompare(t.displayName)}n.d(t,"E",(function(){return o})),n.d(t,"U",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"S",(function(){return s})),n.d(t,"T",(function(){return l})),n.d(t,"Q",(function(){return f})),n.d(t,"P",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"D",(function(){return O})),n.d(t,"R",(function(){return j})),n.d(t,"w",(function(){return I.r})),n.d(t,"G",(function(){return I.t})),n.d(t,"k",(function(){return I.g})),n.d(t,"g",(function(){return I.d})),n.d(t,"t",(function(){return I.o})),n.d(t,"u",(function(){return I.p})),n.d(t,"m",(function(){return I.i})),n.d(t,"j",(function(){return I.f})),n.d(t,"p",(function(){return I.l})),n.d(t,"l",(function(){return I.h})),n.d(t,"o",(function(){return I.k})),n.d(t,"q",(function(){return I.m})),n.d(t,"v",(function(){return I.q})),n.d(t,"r",(function(){return I.n})),n.d(t,"x",(function(){return I.s})),n.d(t,"i",(function(){return I.e})),n.d(t,"d",(function(){return I.b})),n.d(t,"I",(function(){return I.u})),n.d(t,"J",(function(){return I.v})),n.d(t,"M",(function(){return I.x})),n.d(t,"c",(function(){return I.a})),n.d(t,"n",(function(){return I.j})),n.d(t,"L",(function(){return I.w})),n.d(t,"O",(function(){return I.y})),n.d(t,"f",(function(){return I.c})),n.d(t,"h",(function(){return g.a})),n.d(t,"y",(function(){return E})),n.d(t,"s",(function(){return p})),n.d(t,"N",(function(){return _})),n.d(t,"F",(function(){return w})),n.d(t,"z",(function(){return S})),n.d(t,"H",(function(){return x})),n.d(t,"K",(function(){return R})),n.d(t,"C",(function(){return F})),n.d(t,"A",(function(){return N})),n.d(t,"B",(function(){return q}))},1618:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("UPDATE_SELECTED_CALENDARS_IN_STORE",(function(e,t){return{calendarIds:e,userIdentity:t}})),i=Object(r.action)("ADD_SELECTED_CALENDAR_IN_STORE",(function(e,t){return{calendarId:e,userIdentity:t}})),o={selectedCalendars:new(n(23).ObservableMap)},c=Object(r.createStore)("selectedCalendarsStore",o),u=n(1240);Object(r.mutator)(a,(function(e){var t=e.calendarIds,n=e.userIdentity;c().selectedCalendars.set(n,Object(u.b)(t))}));var d=n(0);function s(){return Object(u.c)(c().selectedCalendars)}function l(){return Object(u.d)(s())}function f(e){var t=s().get(e);return t||[]}Object(r.mutator)(i,(function(e){var t=e.calendarId,n=e.userIdentity;c().selectedCalendars.set(n,Object(u.b)(Object(d.__spread)(f(n),[t])))}));var b=Object(r.action)("UPDATE_SELECTED_CALENDARS",(function(e,t){return{calendarIds:e,userIdentity:t}})),v=Object(r.action)("ADD_SELECTED_CALENDAR",(function(e,t){return{calendarId:e,userIdentity:t}})),O=(Object(r.action)("INITIALIZE_SELECTED_CALENDARS",(function(e,t){return{calendarIds:e,userIdentity:t}})),Object(r.action)("SELECTED_CALENDARS_UPDATED",(function(e,t){return{calendarIds:e,userIdentity:t}}))),j=n(106),I=n(75),p=n(1753),m="OWA.ViewStateConfiguration";function h(e,t){var n=Object(j.e)(t);e&&p.a.importAndExecute(m,{Type:"String",Value:["SelectedCalendarsDesktop"]},{Type:"StringArray",Value:Object(u.b)(e)},n).catch((function(e){I.g.warn("Could not save new selected calendars list to user configuration")}))}Object(r.orchestrator)(b,(function(e){var t=e.calendarIds,n=e.userIdentity;a(t,n),O(t,n),h(t,n)})),Object(r.orchestrator)(v,(function(e){var t=e.calendarId,n=e.userIdentity;i(t,n);var r=f(n);O(r,n),h(r,n)}));var g=n(94);function E(e){return e?function(e){var t=s().get(e);return t?t.length:0}(e):(t=s(),n=0,t.forEach((function(e,t){e&&(n+=e.length)})),n);var t,n}Object(r.orchestrator)(g.z,(function(e){var t=e.userConfiguration,n=e.userIdentity,r=t.ViewStateConfiguration.SelectedCalendarsDesktop,i=n||Object(j.e)().userIdentity;a(r,i),O(r,i)})),n.d(t,"g",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"f",(function(){return O})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l}))},1645:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(115),a=n(1461);n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return Promise.all([n.e(81),n.e(466)]).then(n.bind(null,2840))})),o=new r.a(i,(function(e){return e.getTxpObjectFromTxpEntities}))},1662:function(e,t,n){"use strict";var r;!function(e){e.None="None",e.OwaProxy="OwaProxy",e.ConnectorsProxy="ConnectorsProxy",e.Compose="Compose",e.OwaAndConnectorsProxy="OwaAndConnectorsProxy",e.OwaConnectorsProxyAndCompose="OwaConnectorsProxyAndCompose"}(r||(r={})),t.a=r},1737:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(7);function a(e,t){if(null==t?void 0:t.RecurrenceRange){var n=t.RecurrenceRange.EndDate;if(n)return Object(r.Rb)(e,n)}return null}},174:function(e,t,n){"use strict";var r=n(4),a=n(23),i={calendarEntryMapping:new a.ObservableMap,calendarFolderMapping:new a.ObservableMap,calendarItemIdToChangeKey:new a.ObservableMap,folderIdToCalendarId:new a.ObservableMap,validEntryMapping:new a.ObservableMap,calendarGroupsMapping:new a.ObservableMap,defaultCalendars:new a.ObservableMap};t.a=Object(r.createStore)("calendarsCacheStore",i)},1753:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(115),a=new r.c((function(){return n.e(615).then(n.bind(null,3399))})),i=new r.a(a,(function(e){return e.updateUserConfigurationService}))},1767:function(e,t,n){"use strict";var r=n(1158);var a=n(1205),i=n(76),o=n(1770);function c(e){return function(e,t,n){return Object(r.a)(e,t)==t&&n}(e,a.c,Object(i.h)(o.a))}n.d(t,"a",(function(){return c}))},1768:function(e,t,n){"use strict";var r=n(288),a=!0,i=!0;function o(e,t,n){return Object(r.f)(e,"GET",n,{throwServiceError:a,customHeaders:s(t)})}function c(e,t,n,o){return Object(r.f)(e,"DELETE",n,{requestObject:o,sendPayloadAsBody:i,throwServiceError:a,customHeaders:s(t)})}function u(e,t,n,o,c){return Object(r.f)(e,"POST",n,{requestObject:o,sendPayloadAsBody:i,throwServiceError:a,customHeaders:s(t,c)})}function d(e,t,n,o,c){return Object(r.f)(e,"PATCH",n,{requestObject:o,sendPayloadAsBody:i,throwServiceError:a,customHeaders:s(t,c)})}function s(e,t){var n={};return e&&(n["x-anchormailbox"]=e),!0===t&&(n.Prefer="return=representation"),!1===t&&(n.Prefer="return=minimal"),n}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d}))},1770:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r="cal-txp-invoice",a="cal-txp-serviceReservationAdaptive"},1771:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetCalendarEventRequest:#Exchange"},e)}},1798:function(e,t,n){"use strict";var r=n(25),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetCalendarEventJsonRequest:#Exchange"},n)),Object(r.a)("GetCalendarEvent",e,t)}n.d(t,"a",(function(){return i}))},1799:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("logNotificationUpdateForDiagnostics",(function(e){return{notificationUpdateLog:e}}))},1811:function(e,t,n){"use strict";var r=n(25),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetCalendarViewJsonRequest:#Exchange"},n)),Object(r.a)("GetCalendarView",e,t)}n.d(t,"a",(function(){return i}))},1815:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),a=n(438),i=n(1811),o=n(1839),c=n(1029),u=n(7),d=n(245),s=n(964),l=n(315),f=n(603),b=n(454),v="X-OWA-ExplicitLogonUser",O="X-AnchorMailbox",j=6,I=null;function p(e,t,n,p,m,h){return void 0===n&&(n=Object(s.a)("calendar")),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,g;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=null,m?(s={headers:(g={},g[v]=m,g[O]=m,g)},[3,3]):[3,1];case 1:return p?[4,Object(l.e)(p.mailboxInfo)]:[3,3];case 2:s=r.sent(),r.label=3;case 3:return I||(I=Object(f.a)(j)),[2,I.add((function(){var r={Header:Object(d.a)(),Body:Object(o.a)({CalendarId:Object(c.a)({BaseFolderId:Object(a.a)({Id:n})}),RangeStart:Object(u.rb)(e),RangeEnd:Object(u.rb)(t),IncludeDeclinedMeetings:h})};return Object(i.a)(r,s).then((function(e){return Object(b.a)()&&b.c.importAndExecute({request:r.Body,options:s,folderId:n},e.Body),e.Body}),Object(b.a)()&&function(e){return b.e.importAndExecute({request:r.Body,options:s,folderId:n}).then((function(t){if(t)return t;throw e})).catch((function(t){throw e}))})}))]}}))}))}},1832:function(e,t,n){"use strict";var r=n(4),a=n(0),i=n(94),o=Object(r.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",(function(e,t){return{settings:e,userIdentity:t}})),c=Object(r.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",(function(e){return{userIdentity:e}}));var u="ows/beta/ScenarioSettings",d=["IsTimePanelDatePickerExpanded","TimePanelCalendarIds","IsTimePanelCalendarViewTaskListSelected"];function s(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l=71;function f(e){return 0!=(e&l)}var b=n(1037);function v(e){if(d.some((function(t){return t===e})))return"Owa";var t=Object(b.b)();return f(t)?s(t):null}var O=n(315),j=n(288);function I(e){var t;return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,c,d,l,I;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return n=["Owa"],f(r=Object(b.b)())&&(i=s(r),n.push(i)),o=function(e){var t=e.join(",");return u+"/?Scenarios="+t}(n),d=j.b,l=[o,void 0,void 0],[4,Object(O.b)(e)];case 1:return[4,d.apply(void 0,l.concat([a.sent(),!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS"]))];case 2:return c=a.sent(),I={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1,isTimePanelCalendarViewTaskListSelected:!0},null===(t=null==c?void 0:c.settings)||void 0===t||t.forEach((function(e){var t,n=v(e.settingName);(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName&&n===v("TimePanelCalendarIds")?I.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)||n!==v("TimePanelSelectedView")?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)||n!==v("SelectedCalendarListView")?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)||n!==v("IsTimePanelOpen")?!function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)||n!==v("IsTimePanelDatePickerExpanded")?function(e){return void 0!==e.isSelected&&"IsTimePanelCalendarViewTaskListSelected"===e.settingName}(e)&&n===v("IsTimePanelCalendarViewTaskListSelected")&&(I.isTimePanelCalendarViewTaskListSelected=e.isSelected):I.isTimePanelDatePickerExpanded=e.isExpanded:I.isTimePanelOpen=e.isOpen:I.timePanelSelectedCalendarView=e.selectedView:I.timePanelSelectedView=e.selectedView})),[2,I]}}))}))}var p=n(528),m=Object(p.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(p.a)(1e4)}),h={};function g(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return e=Object(i.g)().map(E),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))}function E(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),h[e]?[2]:(h[e]=m((function(){return I(e)})),[4,h[e].retriableFunc()]);case 1:return t=n.sent(),o(t,e),[3,3];case 2:return n.sent(),c(e),[3,3];case 3:return[2]}}))}))}var _=n(647);Object(r.orchestrator)(_.d,(function(e){E(e.userIdentity)}));function y(e,t){return u+"/"+e+"/"+t}function C(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(t=v("TimePanelSelectedView"))?(n=y(t,"TimePanelSelectedView"),r={ViewType:e},[4,Object(j.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function w(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,c;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(n=v("TimePanelCalendarIds"))?(r=y(n,"TimePanelCalendarIds"),i={CalendarIds:e},o=j.c,c=[r,i,void 0,void 0],[4,Object(O.b)(t)]):[3,3];case 1:return[4,o.apply(void 0,c.concat([a.sent(),!0,void 0]))];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function S(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(t=v("IsTimePanelOpen"))?(n=y(t,"IsTimePanelOpen"),r={IsOpen:e},[4,Object(j.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function x(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(t=v("SelectedCalendarListView"))?(n=y(t,"SelectedCalendarListView"),r={ViewType:e},[4,Object(j.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function R(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(t=v("IsTimePanelDatePickerExpanded"))?(n=y(t,"IsTimePanelDatePickerExpanded"),r={isExpanded:e},[4,Object(j.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function T(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(t=v("IsTimePanelCalendarViewTaskListSelected"))?(n=y(t,"IsTimePanelCalendarViewTaskListSelected"),r={isSelected:e},[4,Object(j.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}n.d(t,"i",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return g})),n.d(t,"h",(function(){return C})),n.d(t,"g",(function(){return w})),n.d(t,"f",(function(){return S})),n.d(t,"e",(function(){return x})),n.d(t,"d",(function(){return R})),n.d(t,"c",(function(){return T}))},1839:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetCalendarViewRequest:#Exchange"},e)}},2102:function(e,t,n){"use strict";var r=n(0),a=n(4),i=n(118),o=Object(a.action)("toggleShowDeclinedEventsMode",(function(e,t){return Object(i.c)({name:"ToggleShowDeclinedEventsMode",customData:{CurrentDateRangeType:t,ShowDeclinedEventsMode:e}},{isDeclinedEventsMode:e,dateRangeType:t})})),c=o,u=n(26),d=n(322),s=n(1753);Object(a.orchestrator)(o,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(a){return t=e.isDeclinedEventsMode,n=Object(u.a)(),Object(d.a)(Object(r.__assign)(Object(r.__assign)({},n),{ViewStateConfiguration:Object(r.__assign)(Object(r.__assign)({},n.ViewStateConfiguration),{CalendarViewShowDeclinedMeetings:t})})),s.a.importAndExecute("OWA.ViewStateConfiguration",{Type:"String",Value:["CalendarViewShowDeclinedMeetings"]},{Type:"Boolean",Value:[""+t]}),[2]}))}))}));var l=n(94),f=n(76);function b(){return!!Object(f.h)("cal-surface-declinedMeetings")&&Object(l.i)().ViewStateConfiguration.CalendarViewShowDeclinedMeetings}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return c}))},2157:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return b}));var r=n(1336),a=n(115),i=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(579)]).then(n.bind(null,3555))}));Object(a.f)(r.e,i,(function(e){return e.openTimePanelOrchestrator}));var o=Object(a.d)(i,(function(e){return e.TimePanel})),c=Object(a.d)(i,(function(e){return e.TimePanelHeaderBar})),u=new a.a(i,(function(e){return e.loadTimePanelData})),d=new a.a(i,(function(e){return e.openEventDetailsView})),s=(new a.a(i,(function(e){return e.openAttendeeTrackingView})),new a.a(i,(function(e){return e.closeAttendeeTrackingView})),new a.a(i,(function(e){return e.openTasksView}))),l=new a.a(i,(function(e){return e.openCalendarView})),f=new a.a(i,(function(e){return e.openConflictsView})),b=new a.a(i,(function(e){return e.closeConflictsView}));new a.a(i,(function(e){return e.openEventQuickComposeView}))},2209:function(e){e.exports=JSON.parse('{"c":"g5a","e":"h5a","f":"i5a","d":"j5a","b":"k5a","i":"l5a","a":"m5a","l":"n5a","j":"o5a","k":"p5a","h":"q5a","g":"r5a"}')},2210:function(e){e.exports=JSON.parse('{"a":"e5a","b":"f5a"}')},227:function(e,t,n){"use strict";n.d(t,"r",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"o",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"f",(function(){return O})),n.d(t,"l",(function(){return j})),n.d(t,"h",(function(){return I})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return m})),n.d(t,"q",(function(){return h})),n.d(t,"n",(function(){return g})),n.d(t,"s",(function(){return E})),n.d(t,"e",(function(){return _})),n.d(t,"b",(function(){return y})),n.d(t,"u",(function(){return C})),n.d(t,"v",(function(){return w})),n.d(t,"x",(function(){return S})),n.d(t,"a",(function(){return x})),n.d(t,"j",(function(){return R})),n.d(t,"w",(function(){return T})),n.d(t,"y",(function(){return A})),n.d(t,"c",(function(){return P}));var r=n(0),a=n(174),i=n(496),o=n(106),c=n(449);function u(e){return e||(e=Object(o.e)().userIdentity),Object(a.a)().defaultCalendars.get(e)}function d(e,t){var n=u(t);return n&&e===n.id}function s(){var e=Object(a.a)().calendarEntryMapping;return Object(r.__spread)(e.values())}function l(){return s().map((function(e){return O(e.id.id)})).filter((function(e){return e}))}function f(){var e=Object(a.a)().calendarGroupsMapping;return Object(r.__spread)(e.values())}function b(e){return Object(a.a)().folderIdToCalendarId.get(e)}function v(e){return Object(a.a)().calendarEntryMapping.get(e)}function O(e){var t=v(e);return t?{id:{id:e,mailboxInfo:Object(r.__assign)({},t.id.mailboxInfo)},calculatedFolderId:_(e),displayName:t.CalendarName,colorScheme:null}:null}function j(e){return Object(a.a)().calendarFolderMapping.get(e.id.id)}function I(e){var t;return v(null===(t=null==e?void 0:e.id)||void 0===t?void 0:t.id)}function p(e){var t=b(e);return t?v(t.id):void 0}function m(e){var t=Object(a.a)().calendarFolderMapping,n=b(e);return n?t.get(n.id):void 0}function h(e){return Object(a.a)().calendarItemIdToChangeKey.get(e)}function g(e){return E(e.id.id)}function E(e){var t=Object(a.a)().calendarFolderMapping.get(e);return t&&(t.FolderId||t.DistinguishedFolderId)?t.FolderId?t.FolderId.Id:t.DistinguishedFolderId:_(e)}function _(e){var t=Object(a.a)().calendarEntryMapping.get(e);if(t){var n=Object(i.a)(t);return n?n.Id:null}return null}function y(e){return!!v(e)}function C(e){var t=Object(a.a)(),n=t.folderIdToCalendarId,r=t.calendarEntryMapping,i=n.get(e);if(i){var o=r.get(i.id);return o&&!o.IsGroupMailboxCalendar&&null!=o.CalendarFolderId}return!1}function w(e){if(C(e)){var t=p(e);return null==t?void 0:t.IsReadOnly}return!1}function S(e){var t=Object(a.a)().validEntryMapping;return e&&t.get(e.ItemId.Id)}function x(e){return!C(E(e))&&!S(v(e))}function R(e){var t,n=Object(a.a)(),i=n.folderIdToCalendarId,o=n.calendarEntryMapping,c=i.get(e);c?t=o.get(c.id):t=Object(r.__spread)(o.values()).filter((function(t){return t.OwnerEmailAddress&&t.OwnerEmailAddress.toLowerCase()==e.toLowerCase()}))[0];return t}function T(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.id)||void 0===t?void 0:t.mailboxInfo)||void 0===n?void 0:n.type)==o.a.TeamsMailbox}function A(e,t){return[e,t].join(c.a)}function P(e){return e.split(c.a)[0]}},2366:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n(239),i=n(491),o=n(679);function c(e,t,n,c){var u="read/"+(Object(a.p)(e.mailboxInfo.userIdentity)?"account/"+encodeURIComponent(e.mailboxInfo.userIdentity)+"/":"")+encodeURIComponent(e.Id);Object(i.c)("calendar",u,Object(r.__assign)(Object(r.__assign)({},n),{entrySource:t}),o.a,!1,t)}},281:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(7);function a(e,t,n){return Object(r.Rb)(e,Object(r.Db)(t),Object(r.yb)(t),Object(r.mb)(t),Object(r.sb)(n),Object(r.xb)(n),Object(r.zb)(n),Object(r.wb)(n))}},2962:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("updateUpNextEvent",(function(e,t){return{id:e,eventsCacheLockId:t}})),i={scenarios:new(n(23).ObservableMap)},o=Object(r.createStore)("UpNextStore",i);Object(r.mutator)(a,(function(e){o().scenarios.set(e.eventsCacheLockId,e.id)}));var c=n(998),u=n(0),d=n(1504),s=(Object(r.action)("cancelRefreshUpNextPoll",(function(e){return{eventsCacheLockId:e}})),Object(r.action)("onUpNextEventUpdated",(function(e,t,n){return{id:e,parentFolderId:t,eventsCacheLockId:n}}))),l=Object(r.action)("initializeUpNextEventLoader",(function(e,t){return{calendarIds:e,eventsCacheLockId:t}})),f=n(7);function b(){var e=Object(f.lc)(),t=Object(f.e)(e,1);return{start:e,end:Object(f.A)(t)}}var v=n(971),O=n(1017),j=n(1329),I=n(38);function p(e,t){void 0===t&&(t=!1);var n=Object(f.Qb)(),r=Object(u.__spread)(e);return t||r.sort(j.a),function(e,t){if(!e||0===e.length)return null;var n=m(t),r=e.filter((function(r,a){return!!n(r)&&!e.slice(a+1).some((function(e){return Object(f.Hb)(e.End,t)}))}));if(0===r.length)return null;if(1===r.length)return r[0];return r.reduce((function(e,n){if(0===e.length)return[n];var r=h(e[0].Start,t),a=h(n.Start,t);return a<r?[n]:a===r?(e.push(n),e):e}),[]).sort(j.b)[0]}(r,n)}function m(e){return function(t){var n=Object(f.Hb)(t.End,e),r=Object(f.w)(t.End,t.Start)>I.e,a=!Object(O.c)(t),i=Object(v.v)(t);return!n&&!r&&!t.IsAllDayEvent&&!t.IsCancelled&&!t.IsDraft&&"Decline"!==t.ResponseType&&a&&i}}function h(e,t){return Math.abs(Object(f.w)(e,t))}var g=n(1130);function E(e){var t=b();return Object(d.c)(e,t).filter(Object(g.d)(t))}var _=n(571);function y(e,t){var n=Object(_.i)();return t.ItemId.Id!==e.ItemId.Id&&(Object(j.f)(t,e)&&!Object(f.Fb)(t.Start,e.Start)&&m(n)(t))}function C(e){return o().scenarios.get(e)}function w(e){var t=C(e);return t?function(e,t){return E(e).filter((function(e){return e.ItemId.Id===t.Id}))[0]||null}(e,t):null}function S(e){var t=w(e);if(!t)return{upNextEvent:null,conflictingEvents:[]};var n=E(e).filter((function(e){return y(t,e)}));return{upNextEvent:t,conflictingEvents:n}}function x(e){var t=w(e);if(!t)return{upNextEvent:null,eventsWithinUpNextEvent:[]};var n=E(e).filter((function(e){return function(e,t){if(t.ItemId.Id===e.ItemId.Id||!t.IsOnlineMeeting||null===t.OnlineMeetingJoinUrl)return!1;var n=Object(f.Nb)(Object(f.fc)(Object(f.Qb)(),1),t.Start,t.End),r=Object(f.Nb)(Object(f.Qb)(),t.Start,t.End),a=Object(f.w)(t.End,t.Start)>I.e;return(n||r)&&!a&&!t.IsAllDayEvent&&!t.IsCancelled&&!t.IsDraft&&"Decline"!==t.ResponseType&&!Object(O.c)(t)&&Object(v.v)(t)}(t,e)}));return{upNextEvent:t,eventsWithinUpNextEvent:n}}function R(e){return o().scenarios.has(e)}function T(){return Object(u.__spread)(o().scenarios.keys())}function A(e){return Object(u.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(u.__generator)(this,(function(r){return t=function(e){return p(E(e),!0)}(e),n=t?t.ItemId:null,C(e)===n?[2]:(a(n,e),s(n,t?t.ParentFolderId:null,e),[2])}))}))}function P(){T().forEach(A)}Object(r.orchestrator)(c.b,(function(){P()})),Object(r.orchestrator)(c.c,(function(){P()})),Object(r.orchestrator)(c.a,(function(){P()})),Object(r.orchestrator)(l,(function(e){var t=e.calendarIds,n=e.eventsCacheLockId,r=b();R(n)||a(null,n),Object(d.h)(t,r,n)}));var F=n(1372);Object(r.orchestrator)(d.a,(function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return R(t=e.eventsCacheLockId)?[4,A(t)]:[3,2];case 1:n.sent(),Object(F.b)((function(){return function(e){return Object(u.__awaiter)(this,void 0,void 0,(function(){return Object(u.__generator)(this,(function(t){switch(t.label){case 0:return[4,A(e)];case 1:return t.sent(),[2,null]}}))}))}(t)}),t,1e4),n.label=2;case 2:return[2]}}))}))}));Object(r.orchestrator)(d.k,(function(e){var t=e.eventsCacheLockId;R(t)&&A(t)})),Object(r.orchestrator)(_.l,(function(){T().forEach((function(e){return Object(d.m)(b(),e)}))})),Object(r.orchestrator)(d.j,(function(e){var t=e.eventsCacheLockId;R(t)&&A(t)}));n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"j",(function(){return d.l})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return C})),n.d(t,"c",(function(){return S})),n.d(t,"d",(function(){return x})),n.d(t,"g",(function(){return R})),n.d(t,"f",(function(){return y})),n.d(t,"i",(function(){return P}))},320:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(7),a=n(281);function i(e,t,n,i){var o=Object(a.a)(t,n,i);return Object(r.Fb)(e,o)&&(o=Object(r.Rb)(t,e)),{start:e,end:o}}},349:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(376),a=n(4),i=n(428),o=n(3),c={state:r.a.NotStarted,isPopoutV2:Object(o.a)(i.a)==i.b},u=Object(a.createStore)("popoutChild",c);u()},354:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return s})),n.d(t,"n",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"h",(function(){return O})),n.d(t,"b",(function(){return j})),n.d(t,"e",(function(){return I})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"o",(function(){return h}));var r=n(110),a=n(120),i=n(7);function o(e,t){return void 0===t&&(t=Object(i.Qb)()),d(Object(i.bc)(t,e),r.a.DaysInOneWeek)}function c(e,t){var n=u(e,t),r=Object(i.B)(e),a=Object(i.e)(Object(i.C)(r,t),1);return d(n,Math.abs(Object(i.s)(n,a)-1))}function u(e,t){var n=Object(i.ac)(e);return Object(i.bc)(n,t)}function d(e,t){return{start:e,end:Object(i.e)(e,t-1)}}function s(e,t,n,r,c){switch(void 0===c&&(c=1),e){case a.a.Day:return d(Object(i.Xb)(t),c);case a.a.Month:var u=Object(i.ac)(t),s=Object(i.B)(t);return d(u,Math.abs(Object(i.s)(u,s)-1));case a.a.Week:return o(n,t);case a.a.WorkWeek:return function(e,t,n){void 0===n&&(n=Object(i.Qb)());for(var r,a,c=o(e,n),u=0;u<=p(c);u++){var d=Object(i.e)(c.start,u);if(!r&&t.includes(Object(i.ob)(d))&&(r=d),d=Object(i.e)(c.end,-u),!a&&t.includes(Object(i.ob)(d))&&(a=d),r&&a)break}return{start:r,end:a}}(n,r,t)}}function l(e,t){var n=c(e,t);return Object(i.t)(n.end,n.start,t)}function f(e,t){var n;return d(n=t==a.a.WorkWeek?Object(i.k)(e.start,1):Object(i.e)(e.end,1),t==a.a.Month?Object(i.pb)(n):Object(i.s)(e.end,e.start)+1)}function b(e,t){var n,r;if(t==a.a.WorkWeek)n=Object(i.k)(e.start,-1),r=Object(i.k)(e.end,-1);else{r=Object(i.e)(e.start,-1);var o=t==a.a.Month?-Object(i.pb)(r):Object(i.s)(e.start,e.end)-1;n=Object(i.e)(e.start,o)}return{start:n,end:r}}function v(e,t){return e&&t&&0==Object(i.p)(e.start,t.start)&&0==Object(i.p)(e.end,t.end)}function O(e,t,n){if(!e||!t)throw new Error("Date ranges cannot be null in call to areDateRangesOverlapping");return n?Object(i.p)(e.start,t.start)<=0?Object(i.p)(e.end,t.start)>=0?0:1:Object(i.p)(t.end,e.start)>=0?0:-1:Object(i.p)(e.start,t.start)<0?Object(i.p)(e.end,t.start)>0?0:1:Object(i.p)(t.end,e.start)>0?0:-1}function j(e,t,n){return!(!e||!t)&&(n?Object(i.p)(e.start,t.start)<=0&&Object(i.p)(e.end,t.end)>=0:Object(i.p)(e.start,t.start)<0&&Object(i.p)(e.end,t.end)>0)}function I(e,t){return e&&t?{start:Object(i.p)(e.start,t.start)<0?e.start:t.start,end:Object(i.p)(e.end,t.end)>0?e.end:t.end}:null}function p(e){return Object(i.s)(e.end,e.start)}function m(e){return Math.floor(Object(i.v)(e.end,e.start)/24)+(Object(i.v)(e.end,e.start)%24>0?1:0)}function h(e,t){return Object(i.s)(e.start,t)<=0&&Object(i.s)(e.end,t)>=0}},376:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},396:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(7),a=n(281);function i(e,t,n){if(e&&t&&n){var i=Object(r.x)(t,e),o=Object(a.a)(e.tz,n,e);return{start:o,end:Object(r.Rb)(t.tz,Object(r.h)(o,i))}}return null}},397:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(7),a=n(281);function i(e,t,n,i){if(e&&t&&n){var o=Object(a.a)(e.tz,e,n),c=t;if(!Object(r.Hb)(o,t)||i){var u=Object(r.x)(t,e);c=Object(r.Rb)(t.tz,Object(r.h)(o,u))}return{start:o,end:c}}return null}},398:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(320);function a(e,t,n){return e&&t&&n?Object(r.a)(e,t.tz,t,n):null}},399:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(320);function a(e,t,n){return e&&t&&n?Object(r.a)(e,t.tz,n,t):null}},400:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(354),a=n(7);function i(e,t){return e&&null!=t?Object(r.c)(Object(a.Xb)(e),t+1):null}},417:function(e,t,n){"use strict";var r=n(354),a=n(7);function i(e,t,n){return Object(a.Nb)(e,t,n)}var o=n(110);function c(e,t){return function(e){var t=e%o.a.SecondsInOneMinute;return e-t+o.a.SecondsInOneMinute}(Object(a.y)(e,t))}var u=15*o.a.SecondsInOneMinute;function d(e,t){return c(e,t)<=u}var s=n(120),l=function(e,t,n){switch(n){case s.c.FirstFullWeek:return f(e,t,o.a.DaysInOneWeek);case s.c.FirstFourDayWeek:return f(e,t,4);default:return function(e,t){var n=b(e)-1,r=(Object(a.ob)(e)-n%o.a.DaysInOneWeek-t+2*o.a.DaysInOneWeek)%o.a.DaysInOneWeek;return Math.floor((n+r)/o.a.DaysInOneWeek+1)}(e,t)}};function f(e,t,n){var r=b(e)-1,i=Object(a.ob)(e)-r%o.a.DaysInOneWeek,c=b(Object(a.mc)(Object(a.Db)(e)-1,s.d.December,31))-1,u=(t-i+2*o.a.DaysInOneWeek)%o.a.DaysInOneWeek;0!==u&&u>=n&&(u-=o.a.DaysInOneWeek);var d=r-u;return d<0&&(0!==(u=(t-(i-=c%o.a.DaysInOneWeek)+2*o.a.DaysInOneWeek)%o.a.DaysInOneWeek)&&u+1>=n&&(u-=o.a.DaysInOneWeek),d=c-u),Math.floor(d/o.a.DaysInOneWeek+1)}function b(e){for(var t=Object(a.yb)(e),n=Object(a.Db)(e),r=0,i=0;i<t;i++)r+=v(i+1,n);return r+=Object(a.mb)(e)}function v(e,t){return Object(a.pb)(Object(a.mc)(t,e,0))}n(397),n(396),n(398),n(399),n(400);function O(e){for(var t=[],n=0;n<o.a.DaysInOneWeek;n++)e&1<<n&&t.push(n);return t}n.d(t,"h",(function(){return r.g})),n.d(t,"g",(function(){return r.f})),n.d(t,"m",(function(){return r.k})),n.d(t,"d",(function(){return r.c})),n.d(t,"e",(function(){return r.d})),n.d(t,"r",(function(){return r.n})),n.d(t,"n",(function(){return r.l})),n.d(t,"o",(function(){return r.m})),n.d(t,"b",(function(){return r.a})),n.d(t,"j",(function(){return r.h})),n.d(t,"c",(function(){return r.b})),n.d(t,"f",(function(){return r.e})),n.d(t,"l",(function(){return r.j})),n.d(t,"k",(function(){return r.i})),n.d(t,"s",(function(){return r.o})),n.d(t,"t",(function(){return i})),n.d(t,"u",(function(){return d})),n.d(t,"p",(function(){return c})),n.d(t,"q",(function(){return l})),n.d(t,"a",(function(){return o.a})),n.d(t,"i",(function(){return O}))},420:function(e,t,n){"use strict";var r="LinkedCalendarEntry:#Exchange";function a(e){return(null==e?void 0:e.__type)==r}function i(e){return(null==e?void 0:e.__type)==r&&!(null==e?void 0:e.IsGroupMailboxCalendar)}function o(e){return e.CanViewPrivateItems||a(e)}n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return"TeamsCalendarEntry:#Exchange"})),n.d(t,"c",(function(){return o}))},424:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(274),a=n(305),i=n(304),o=n(298);function c(e){return Object(r.a)({RequestServerVersion:"Exchange2015",TimeZoneContext:Object(a.a)({TimeZoneDefinition:Object(i.a)({Id:null!=e?e:"Pacific Standard Time"})})})}function u(e,t,n){return Object(o.a)({PropertySetId:e,PropertyName:t,PropertyType:n})}},428:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var r="popoutv2",a="1",i="_owa_projection_root"},449:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="_CHANNELTEAMSTYPE_"},452:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}));var r,a=2,i=[window.location.origin];function o(e,t,n){var r={version:a,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function c(e){if(i.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&a==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow"}(r||(r={}))},454:function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var r=n(14),a=n(3),i=n(76),o=new r.b((function(){return Promise.all([n.e(728),n.e(443)]).then(n.bind(null,934))})),c=new r.a(o,(function(e){return e.tryGetCalendarViewOffline})),u=new r.a(o,(function(e){return e.onGetCalendarViewResponse})),d=new r.a(o,(function(e){return e.tryGetCalendarFoldersOffline})),s=new r.a(o,(function(e){return e.onGetCalendarFoldersResponse}));function l(){return Object(i.h)("fwk-offline-services")&&Object(a.d)("offlineboot",window.location)}},4839:function(e,t,n){"use strict";var r,a=n(4),i=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS_IN_STORE",(function(e,t){return{calendarIds:e,userIdentity:t}})),o=Object(a.action)("SET_TIME_PANEL_CONFIG_LOAD_STATE",(function(e,t){return{loadState:e,userIdentity:t}})),c=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",(function(e,t){return{calendarIds:e,userIdentity:t}})),u=Object(a.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED");!function(e){e[e.Loaded=0]="Loaded",e[e.Failed=1]="Failed"}(r||(r={}));var d=n(76),s=n(1832),l=(Object(a.orchestrator)(s.b,(function(e){Object(d.h)("cal-time-panel-calendarPicker")&&(o(r.Failed,e.userIdentity),u())})),n(23)),f=Object(a.createStore)("timePanelSelectedCalendarIdsStore",{configLoadStates:new l.ObservableMap,calendarIdsMap:new l.ObservableMap}),b=n(1240);function v(){return Object(b.c)(f().calendarIdsMap)}function O(e){return e?function(e){var t=v().get(e);return t?t.length:0}(e):Object(b.d)(v()).length}function j(){return!!Object(d.h)("cal-time-panel-calendarPicker")&&O()>0}var I=n(1618),p=(Object(a.orchestrator)(I.f,(function(){j()||u()})),n(0));function m(){return f().configLoadStates}function h(){if(!Object(d.h)("cal-time-panel-calendarPicker"))return Object(I.b)();var e=m(),t=0===e.size,n=Object(p.__spread)(e.values()).some((function(e){return e===r.Loaded}));return t||n&&j()?v():Object(I.b)()}var g=n(528),E=n(75),_=n(94),y=n(106),C=Object(g.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(g.a)(1e3)}),w={};Object(a.orchestrator)(c,(function(e){return Object(p.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(p.__generator)(this,(function(r){switch(r.label){case 0:return t=e.calendarIds,n=e.userIdentity,Object(y.e)().userIdentity===n&&1===O()&&1===O(n)&&0===t.length?[2]:j()?[3,2]:[4,S()];case 1:r.sent(),r.label=2;case 2:return x(t,n),[2]}}))}))}));function S(){return Object(p.__awaiter)(this,void 0,void 0,(function(){return Object(p.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(Object(_.g)().map((function(e){var t;x(null!==(t=Object(I.b)().get(e))&&void 0!==t?t:[],e,!0)})))];case 1:return e.sent(),[2]}}))}))}function x(e,t,n){var r;return Object(p.__awaiter)(this,void 0,void 0,(function(){var a,o,c,d;return Object(p.__generator)(this,(function(l){switch(l.label){case 0:a=Object(b.b)(e),o=h().get(t),l.label=1;case 1:return l.trys.push([1,3,4,5]),i(a,t),n||u(),null===(r=w[t])||void 0===r||r.cancel(),c=C((function(){return Object(s.g)(a,t)})),w[t]=c,[4,c.retriableFunc()];case 2:return l.sent(),[3,5];case 3:return d=l.sent(),E.g.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+d),i(o,t),n||u(),[3,5];case 4:return delete w[t],[7];case 5:return[2]}}))}))}Object(a.orchestrator)(s.i,(function(e){var t;if(Object(d.h)("cal-time-panel-calendarPicker")){var n=e.settings,a=e.userIdentity;o(r.Loaded,a),(null===(t=n.timePanelCalendarIds)||void 0===t?void 0:t.length)>0&&i(n.timePanelCalendarIds,a),u()}})),Object(a.mutator)(o,(function(e){var t=e.userIdentity,n=e.loadState;f().configLoadStates.set(t,n)})),Object(a.mutator)(i,(function(e){var t=e.calendarIds,n=e.userIdentity;f().calendarIdsMap.set(n,Object(b.b)(t))}));function R(){return Object(b.d)(h())}n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return R}))},491:function(e,t,n){"use strict";var r=n(115),a=n(601),i=n(495),o=n(42),c=n(1),u=n(494),d=n(349),s=n(76),l=n(376),f=n(919),b=n(724),v=Object(o.a)((function(e){c.useEffect((function(){Object(s.h)("rp-popoutsDebug")||O()}),[]);return c.createElement("div",{className:b.view},Object(d.a)().state==l.a.Loading?c.createElement("span",null,c.createElement(f.a,null),e.loadingString):c.createElement("button",{onClick:O},"Get Data"))}));function O(){Object(u.a)()}var j=n(106);function I(e,t,n,r){var a="";if(r)a="readimid/",a+=encodeURIComponent(btoa(r));else{if(a=n?"readconv/":"read/",e&&e.type==j.a.GroupMailbox){a+="group/";var i=e.mailboxSmtpAddress.split("@");a+=i[1]+"/"+i[0]+"/"}a+=encodeURIComponent(n||t)}return a}n.d(t,"g",(function(){return m})),n.d(t,"c",(function(){return a.a})),n.d(t,"h",(function(){return i.a})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return d.a})),n.d(t,"d",(function(){return u.b})),n.d(t,"e",(function(){return I}));var p=new r.c((function(){return n.e(484).then(n.bind(null,15626))})),m=new r.b(p,(function(e){return e.bootPopout}))},494:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var r,a=n(0),i=n(495),o=n(452),c=n(376),u=n(349),d=!1;function s(){Object(i.a)(c.a.Loading),r?r():d=!0}function l(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return d?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(u.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var a=Object(o.b)(n);if(a&&a.type==o.a.SetData){window.removeEventListener("message",r);var i=void 0;try{i=e?e(a.serializedData):JSON.parse(a.serializedData)}catch(e){}t(i)}};window.addEventListener("message",r);try{var a=window.opener;Object(o.c)(a,o.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},495:function(e,t,n){"use strict";var r=n(349),a=n(4);t.a=Object(a.mutatorAction)("setPopoutChildState",(function(e){Object(r.a)().state=e}))},496:function(e,t,n){"use strict";function r(e){if(void 0!==e.CalendarFolderId)return e.CalendarFolderId;var t=e;return t.IsGeneralScheduleCalendar?{Id:t.OwnerEmailAddress,ChangeKey:""}:t.SharedFolderId?{Id:t.SharedFolderId.Id,ChangeKey:null!=t.SharedFolderId.ChangeKey?t.SharedFolderId.ChangeKey:""}:null}n.d(t,"a",(function(){return r}))},528:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(o,c){a?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return o(e)})).catch((function(e){t&&r>=t?c(e):setTimeout((function(){return i(o,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return i(e,t)}))},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},531:function(e,t,n){"use strict";var r=n(0),a=n(7),i=n(649),o=n(650),c=n(651),u=n(652),d=n(653),s=n(666),l=n(245),f=n(600),b=n(76),v=n(315);function O(e,t,n,O,j,I,p){return Object(r.__awaiter)(this,void 0,void 0,(function(){var m,h,g;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return m=Object(l.a)(),j&&(m.TimeZoneContext.TimeZoneDefinition.Id=j),g=null,I?[4,Object(v.e)(I)]:[3,2];case 1:g=r.sent(),r.label=2;case 2:return r.trys.push([2,,4,5]),[4,Object(s.a)({request:{Header:m,Body:Object(u.a)({MailboxDataArray:n.map((function(e){return Object(d.a)({Email:Object(o.a)({Address:e})})})),FreeBusyViewOptions:Object(c.a)({RequestedView:O,TimeWindow:Object(i.a)({StartTime:Object(a.rb)(e),EndTime:Object(a.rb)(t)}),MergedFreeBusyIntervalInMinutes:p})})}},g)];case 3:return h=r.sent(),[3,5];case 4:return Object(b.h)("cal-mf-diagnostics")&&Object(f.a)({action:"GetUserAvailabilityInternal",status:h?h.Body.ResponseCode:"Error",response:null==h?void 0:h.Body}),[7];case 5:return[2,h.Body]}}))}))}var j=n(311),I=n(75),p=n(603),m=Object(p.a)(4),h=function(e){var t={};return e.forEach((function(e){return t[e]={FreeBusyViewType:"None"}})),t};function g(e,t,n,a,i,o,c){return void 0===i&&(i=!0),Object(r.__awaiter)(this,void 0,void 0,(function(){var u,d,s,l,f,b,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(0===n.length)return[2];(u=new j.a("FreeBusyAvailabilityRequested")).addCustomData({numAttendees:n.length}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,m.add((function(){return O(e,t,n,"DetailedMerged",e.tz,o,c)}))];case 2:return d=r.sent(),u.addCustomData({executingRequests:m.getRunningCount(),queuedRequests:m.getQueueLength()}),u.end(),s="Success"===d.ResponseClass&&n.length===d.Responses.length,l={},s?n.forEach((function(e,t){l[e]=d.Responses[t].CalendarView})):l=h(n),i&&(f=s?Object.keys(l).filter((function(e){return"None"==l[e].FreeBusyViewType})):n).length>0&&g(e,t,f,a,!1,o,c),a(l),[3,4];case 3:return b=r.sent(),u.endWithError("ServerError",b),I.g.warn('[getAvailabilityFunction] Received error calling getUserAvailabilityService, Error: "'+b.stack+'"'),i?g(e,t,n,a,!1,o,c):(v=h(n),a(v)),[3,4];case 4:return[2]}}))}))}n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return O}))},533:function(e,t,n){"use strict";var r,a=n(4),i=Object(a.createStore)("cacheLoaderStore",{loadedCalendarAccounts:[]});!function(e){e[e.Outlook=0]="Outlook",e[e.OutlookGroup=1]="OutlookGroup",e[e.TeamsCalendars=2]="TeamsCalendars"}(r||(r={}));var o=n(314),c=n(106);function u(e,t){switch(e){case r.Outlook:case r.OutlookGroup:return(t||Object(c.e)().userIdentity)+e.toString();case r.TeamsCalendars:return e.toString();default:return Object(o.a)(e)}}var d=n(94),s=n(76);function l(e,t){var n=u(e,t);return i().loadedCalendarAccounts.some((function(e){return e===n}))}function f(e){return function(e){if(e&&e!==Object(d.c)()){var t=[r.Outlook];return Object(s.h)("cal-multiAccounts-groups")&&t.push(r.OutlookGroup),t}return[r.Outlook,r.OutlookGroup,r.TeamsCalendars]}(e).every((function(t){return l(t,e)}))}var b=Object(a.action)("addToLoadedCalendarAccounts",(function(e){return{calendarAccountData:e}}));Object(a.mutator)(b,(function(e){i().loadedCalendarAccounts.push(e.calendarAccountData)}));var v=n(647),O=n(75),j=Object(a.action)("calendarCacheInitializedForAccount",(function(e,t){return{calendarEndpointType:e,userId:t}})),I=n(0),p=n(631),m=n(689),h=n(115),g=new h.c((function(){return Promise.all([n.e(19),n.e(24),n.e(576)]).then(n.bind(null,15928))})),E=new h.a(g,(function(e){return e.initializeSelectedTeamsCalendars}));var _=n(528),y=Object(_.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(_.a)(1e4)}),C={};function w(e,t){if(t=t||Object(c.e)().userIdentity,l(e,t))return Promise.resolve();var n=u(e,t),a=C[n];if(a)return a.requestPromise;var i=y((function(){return function(e,t){return Object(I.__awaiter)(this,void 0,void 0,(function(){return Object(I.__generator)(this,(function(n){switch(n.label){case 0:switch(e){case r.Outlook:return[3,1];case r.OutlookGroup:return[3,3];case r.TeamsCalendars:return[3,5]}return[3,7];case 1:return[4,Object(p.f)(t)];case 2:return n.sent(),[3,8];case 3:return[4,Object(m.b)(t)];case 4:return n.sent(),[3,8];case 5:return[4,E.importAndExecute()];case 6:return n.sent(),[3,8];case 7:Object(o.a)(e),n.label=8;case 8:return[2]}}))}))}(e,t)})).retriableFunc();return C[n]={requestPromise:i},i.then((function(){b(n),j(e,t)})).catch((function(e){O.d("initializeCalendarsCacheForAccount: failed to initialize calendar cache",e)}))}Object(a.orchestrator)(v.d,(function(e){w(r.Outlook,e.userIdentity),Object(s.h)("cal-multiAccounts-groups")&&w(r.OutlookGroup,e.userIdentity)}));var S=n(239);function x(){return Object(I.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a,i,o;return Object(I.__generator)(this,(function(c){switch(c.label){case 0:return e=w(r.Outlook),t=Object(S.k)().map((function(e){return w(r.Outlook,e.userIdentity)})),n=w(r.OutlookGroup),a=w(r.TeamsCalendars),i=Object(I.__spread)([e,n],t,[a]),Object(s.h)("cal-multiAccounts-groups")&&(o=Object(S.k)().map((function(e){return w(r.OutlookGroup,e.userIdentity)})),i=i.concat(o)),[4,Promise.all(i)];case 1:return c.sent(),[2]}}))}))}n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return w})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return x}))},600:function(e,t,n){"use strict";var r=n(607);n.d(t,"a",(function(){return r.a}))},601:function(e,t,n){"use strict";var r=n(0),a=n(49),i=600,o=800,c=8,u=25,d={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},s=-1;function l(e,t,n){try{t=function(e){var t=u*(1+(s=(s+1)%c)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),i),width:Math.max(8*Math.pow(window.innerWidth,2/3),o)};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d),n),e)}(t);var l=(n||window).open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(a.e)()||Object(a.f)())&&l.moveTo(t.left,t.top),l}catch(e){return null}}var f=n(2),b=n(573),v=n(428),O="version";var j=n(118),I=n(491);t.a=Object(j.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,a,i){return[(t||"").split("/")[0],i]}})((function(e,t,n,r,i,o,c){var u=function(e){var t=null,n=void 0,r=null,i=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,(Object(a.e)()||Object(a.h)()||Object(a.f)())&&(t=e.projectionTabId||null),r=e.projectionTargetWindow,i=e.projectionParentWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r,projectionParentWindow:i}}(n),d=u.deeplinkCallback,s=u.projectionTabId,j=u.projectionTargetWindow,p=u.projectionParentWindow,m=s?"about:blank":function(e,t,n,r){var a;void 0===r&&(r={});var i=((a={})[O]=Object(f.l)(),a[v.a]=v.b,a);return Object.keys(r).map((function(e){i[e]=r[e]})),Object(b.q)(e,t,n,i)}(e,t,i,c),h=j||l(m,r,p);h&&I.g.import().then((function(t){return t(e,h,s,d)}))}))},603:function(e,t,n){"use strict";function r(e){var t=0,n=[];function r(){t-=1,n.length>0&&n.shift()()}return{add:function(a){return new Promise((function(i,o){var c=function(){t+=1,a().then((function(e){r(),i(e)}),(function(e){r(),o(e)}))};t===e?n.push(c):c()}))},getRunningCount:function(){return t},getQueueLength:function(){return n.length}}}n.d(t,"a",(function(){return r}))},607:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("logServiceCallForDiagnostics",(function(e){return{serviceCall:e}}))},608:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"RecurringMasterItemId:#Exchange"},e)}},614:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n(4),a=Object(r.action)("initializeOwaAccountsStore"),i=Object(r.action)("owaConnectedAccountAdded",(function(e,t){return{userIdentity:e,accountProviderType:t}})),o=Object(r.action)("removeAccount",(function(e){return{userIdentity:e}}))},615:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetUserUnifiedGroupsRequest:#Exchange"},e)}},616:function(e,t,n){"use strict";var r=n(25),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetUserUnifiedGroupsJsonRequest:#Exchange"},n)),Object(r.a)("GetUserUnifiedGroups",e,t)}n.d(t,"a",(function(){return i}))},631:function(e,t,n){"use strict";var r=n(0),a=n(158),i=n(106),o=n(26),c=n(420),u=n(75);function d(e,t,n){var d,s={},l={},f={},b={},v={},O=n?[n]:[Object(o.a)().SessionSettings.LogonEmailAddress],j=Object(i.e)(n);return e.forEach((function(e){v[e.ItemId.Id]=e.ItemId.ChangeKey;var n=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:e.GroupId,mailboxInfo:j}}),i=Object(a.s)(j.userIdentity,e.GroupId);b[i]=n,e.Calendars.forEach((function(e){if(function(e,t){if(7==e.CalendarFolderType)return!1;if(Object(c.d)(e)){var n=e;if(n.IsOwnerEmailAddressInvalid)return u.g.info("[getCalendarsService] Ommitting shared calendar with IsOwnerEmailAddressInvalid flag on, OwnerEmailAddress: {1}: "+n.OwnerEmailAddress),!1;var r=n.IsGeneralScheduleCalendar?n.OwnerEmailAddress:n.SharedFolderId?n.SharedFolderId.Id:null;if(!r)return u.g.info("[getCalendarsService] Ommitting linked calendar with null SharedFolderId, Id: {1}: "+e.ItemId.Id),!1;if(t.includes(r))return u.g.info("[getCalendarsService] Ommitting duplicate shared calendar from Calendar folder list. DuplicateKey: {1}: "+r),!1;if(t.push(r),n.OwnerEmailAddress=n.OwnerEmailAddress.toLowerCase(),n.IsGroupMailboxCalendar)return!1}return!0}(e,O)){var n=e.ItemId.Id,i=Object(a.h)(e).Id,o=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:n,mailboxInfo:j}});if(1==e.CalendarFolderType){var l=t&&t.filter((function(e){return e.FolderId.Id===i}))[0];d={id:{id:n,mailboxInfo:j},calculatedFolderId:i,displayName:l?l.DisplayName:e.CalendarName,colorScheme:null},o.CalendarName=d.displayName}!s[n]&&(s[n]=o),!f[i]&&(f[i]={id:e.ItemId.Id,mailboxInfo:j}),!v[n]&&(v[n]=e.ItemId.ChangeKey)}}))})),t.forEach((function(e){var t=f[e.FolderId.Id];t&&(l[t.id]=e)})),{defaultCalendar:d,calendarEntryMapping:s,calendarFolderMapping:l,folderIdMapping:f,calendarGroupMapping:b,calendarIdToChangeKeyMapping:v}}var s=n(681),l=n(245),f=n(684),b=n(94),v=n(315),O=n(454);function j(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=null,n=null,e&&!Object(b.v)(e)||(t=Object(f.a)()),t?[3,7]:[4,Object(v.e)(Object(i.e)(e))];case 1:n=r.sent(),r.label=2;case 2:return r.trys.push([2,4,,7]),[4,Object(s.a)({Header:Object(l.a)()},n)];case 3:return t=r.sent(),[3,7];case 4:return r.sent(),Object(O.a)()?[4,O.d.importAndExecute(e)]:[3,6];case 5:t=r.sent(),r.label=6;case 6:return[3,7];case 7:return t&&Object(O.a)()?n?[3,9]:[4,Object(v.e)(Object(i.e)(e))]:[3,11];case 8:n=r.sent(),r.label=9;case 9:return[4,O.b.importAndExecute({userIdentity:e,options:n},t)];case 10:r.sent(),r.label=11;case 11:return[2,t]}}))}))}var I=n(299),p=n(686);function m(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(v.e)({type:i.a.GroupMailbox,userIdentity:n,mailboxSmtpAddress:t,routingKey:null,requestOptions:null})];case 1:return o=r.sent(),c=Object(a.o)(e.Id),u=c&&(c.IsGeneralScheduleCalendar||c.IsGroupMailboxCalendar)?Object(I.a)({Id:"calendar",Mailbox:{EmailAddress:t}}):5==c.CalendarFolderType?c.SharedFolderId:e,[4,Object(p.a)({request:{FolderId:u}},o)];case 2:return[2,r.sent()]}}))}))}var h=n(438),g=n(254),E=n(4),_=Object(E.action)("calendarFolderIdUpdated"),y=Object(E.action)("setCalendarLoadState",(function(e,t){return{calendarId:e,loadState:t}}));function C(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),y(e,"Loading"),[4,w(e)];case 1:return n.sent(),[3,3];case 2:return(t=n.sent()).message&&(t.message.indexOf("ErrorApiQuarantined")>=0||t.message.indexOf("ErrorTooManyObjectsOpened")>=0)?y(e,"Throttled"):y(e,"Failed"),[3,3];case 3:return[2]}}))}))}function w(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,c,u,d,s,l,f,O,j;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!(t=Object(a.m)(e)))throw new Error("Unable to get calendar entry for calendar "+e);n=Object(a.x)(e),o=Object(a.i)(e),c=Object(a.u)(n),u=c?c.mailboxInfo:Object(i.e)(),d=Object(a.L)(t),O=Object(a.t)().filter((function(e){return e.GroupId==t.ParentGroupId})),f=O?O[0].id.mailboxInfo.userIdentity:Object(i.e)().userIdentity,5==t.CalendarFolderType&&Object(b.i)().SessionSettings.DefaultPublicFolderMailbox?s=Object(b.i)().SessionSettings.DefaultPublicFolderMailbox:(j=function(e,t){return e||(t?t.userIdentity:null)}(t.OwnerEmailAddress,u),s=d?Object(a.f)(j):j),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,m(Object(h.a)({Id:o}),s,f)];case 2:return l=r.sent(),[3,4];case 3:return r.sent(),Object(g.o)("getCalendarFolderConfigurationServiceFailed"),Object(a.P)(t),[2];case 4:if(!l)throw new Error("Unable to get folder for calendar "+e);return(Object(a.P)(t),5==t.CalendarFolderType?function(e,t,n){var r=e.CalendarFolder;if(r){t.CalendarFolderId||(t.CalendarFolderId=e.CalendarFolder.FolderId);var o=r.ReplicaList[0];Object(a.b)(t,r,(c=n,u=o,{type:i.a.UserMailbox,userIdentity:Object(i.e)().userIdentity,mailboxSmtpAddress:u,routingKey:Object(i.c)()+u,requestOptions:Object(v.a)(u,c)}))}var c,u}(l,t,u):function(e,t,n,r,i){var o,c,u=e.CalendarFolder;i&&(null===(o=null==u?void 0:u.FolderId)||void 0===o?void 0:o.Id)&&(u.FolderId.Id=Object(a.O)(u.FolderId.Id,r));(null===(c=null==u?void 0:u.EffectiveRights)||void 0===c?void 0:c.Read)&&(e.MasterList&&(t.RemoteCategories=e.MasterList),(r==t.OwnerEmailAddress||t.ItemId&&r==t.ItemId.Id)&&(Object(a.e)(r,{id:{id:t.ItemId.Id,mailboxInfo:n},calculatedFolderId:u.FolderId.Id}),Object(a.R)(r),Object(a.b)(t,u,n)))}(l,t,u,e,d),_(),[2])}}))}))}var S=n(239);function x(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,j(e)];case 1:if(null==(t=r.sent())||!t.WasSuccessful)throw o=new Error("[getCalendarFoldersFromServer] Failed to load calendars from server"),t?o.fetchErrorType="ServerFailure":o.networkError=!0,Object(u.d)(o),o;return n=d(t.CalendarGroups,t.CalendarFolders,e),c=t.CalendarGroups.length,i=c<1?{lowerBoundResultSize:null,upperBoundResultSize:0}:c<=3?{lowerBoundResultSize:1,upperBoundResultSize:3}:c<=6?{lowerBoundResultSize:4,upperBoundResultSize:6}:{lowerBoundResultSize:7,upperBoundResultSize:null},Object(g.o)("CalendarGroupsPerAccount",{connectedAccount_1:Object(S.p)(e),calendarGroupCount:t.CalendarGroups.length,calendarGroupCount_2:i.lowerBoundResultSize+" - "+i.upperBoundResultSize}),Object(a.E)(n.defaultCalendar,n.calendarEntryMapping,n.calendarFolderMapping,n.calendarGroupMapping,n.folderIdMapping,n.calendarIdToChangeKeyMapping),[2]}var c}))}))}var R=n(23),T=Object(E.createStore)("OwaCalendarsApiStore",{calendarIdsLoadState:new R.ObservableMap});function A(e){return T().calendarIdsLoadState.get(e)}Object(E.mutator)(y,(function(e){var t=e.calendarId,n=e.loadState;T().calendarIdsLoadState.set(t,n)})),Object(E.mutator)(a.Q,(function(e){var t=e.calendar;T().calendarIdsLoadState.delete(t.id.id)})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return j})),n.d(t,"c",(function(){return C})),n.d(t,"f",(function(){return x})),n.d(t,"a",(function(){return _})),n.d(t,"d",(function(){return A}))},647:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(614);n.d(t,"d",(function(){return r.b}));var a=n(115),i=new a.c((function(){return n.e(670).then(n.bind(null,938))})),o=new a.a(i,(function(e){return e.initializeOwaAccountsStore})),c=new a.b(i,(function(e){return e.initializeOwaConnectedAccount})),u=new a.a(i,(function(e){return e.removeOWAConnectedAccount}))},649:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"Duration:#Exchange"},e)}},650:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"EmailAddress:#Exchange"},e)}},651:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FreeBusyViewOptions:#Exchange"},e)}},652:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetUserAvailabilityRequest:#Exchange"},e)}},653:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"MailboxData:#Exchange"},e)}},666:function(e,t,n){"use strict";var r=n(25),a=n(0);function i(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(a.__assign)({__type:"GetUserAvailabilityInternalJsonRequest:#Exchange"},n))),Object(r.a)("GetUserAvailabilityInternal",e,t)}n.d(t,"a",(function(){return i}))},679:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(0),a=n(106),i=n(491),o={width:1095,height:640};function c(e,t,n,i){if(e){var o=Object(a.e)();u(Object(r.__assign)({ItemId:Object(r.__assign)({mailboxInfo:o},e)},t),n,!!t,i||0)}}function u(e,t,n,r,a,c){Object(i.c)("calendar","compose",{event:e,composeEntrySource:t,shouldDuplicate:a,eventScope:c,eventHasUpdates:n},o)}},681:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(25);function a(e,t){return Object(r.a)("GetCalendarFolders",e,t)}},684:function(e,t,n){"use strict";var r;function a(e){var t=e.getCalendarFolders;return r=t,e}function i(){var e=r;return r=void 0,e}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},686:function(e,t,n){"use strict";var r=n(25),a=n(0);function i(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(a.__assign)({__type:"GetCalendarFolderConfigurationRequest:#Exchange"},n))),Object(r.a)("GetCalendarFolderConfiguration",e,t)}n.d(t,"a",(function(){return i}))},688:function(e){e.exports=JSON.parse('{"a":"Kab"}')},689:function(e,t,n){"use strict";var r=n(0),a=n(284),i=n(688),o=n(10),c=n(616),u=n(615),d=n(245),s="Groups",l=n(106),f=n(420),b=n(315),v=n(158);function O(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 4,(t=[]).push({FilterType:1,SortType:4,SortDirection:"Descending"}),t.push({FilterType:2,SortType:4,SortDirection:"Descending"}),(n=Object(d.a)()).RequestServerVersion="V2018_01_08",[4,Object(b.e)(Object(l.e)(e))];case 1:return a=r.sent(),[4,Object(c.a)({Header:n,Body:Object(u.a)({RequestedGroupsSets:t})},a)];case 2:return[2,r.sent()]}}))}))}var j=Object(a.action)("getGroupCalendarsService")((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,O(e)];case 1:return null!=(t=n.sent())&&t.Body.GroupsSets&&t.Body.GroupsSets.length>0?[2,I(t.Body.GroupsSets,e)]:[2,null]}}))}))}));function I(e,t){var n=[],r=[],a=Object(v.s)(t,s);if(e.forEach((function(e){e.Groups.forEach((function(e){var i=e.SmtpAddress.toLowerCase(),o={type:l.a.GroupMailbox,userIdentity:t,mailboxSmtpAddress:i,routingKey:Object(l.c)(t)+i,requestOptions:null},c={__type:f.a,CalendarColor:-1,CalendarName:e.DisplayName,OwnerEmailAddress:i,OwnerName:e.DisplayName,IsGroupMailboxCalendar:!0,IsGeneralScheduleCalendar:!0,ItemId:{Id:i},ParentGroupId:a},u={DistinguishedFolderId:i,DisplayName:e.DisplayName};n.push({entry:c,folder:u,mailboxInfo:o});var d={id:{id:i,mailboxInfo:o},calculatedFolderId:i,displayName:e.DisplayName,colorScheme:null};r.push(d)}))})),r.length>0){var c={type:l.a.GroupMailbox,userIdentity:t,mailboxSmtpAddress:t,routingKey:Object(l.b)(),requestOptions:null},u={id:{id:a,mailboxInfo:c},GroupId:a,ItemId:{Id:a},GroupName:Object(o.b)(i.a),GroupType:3};return{groupCalendars:n,calendarGroup:u,calendars:r}}return null}var p=Object(a.action)("getGroupCalendars")((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,j(e)];case 1:return null!=(t=n.sent())&&null!=t.groupCalendars?(t.groupCalendars.forEach((function(e){Object(v.b)(e.entry,e.folder,e.mailboxInfo)})),Object(v.a)(t.calendarGroup),[2,{group:t.calendarGroup,calendars:t.calendars}]):[2,null]}}))}))})),m=n(254),h=n(94),g=Object(a.action)("initializeGroupCalendars")((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i,o,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:n=new m.a("initializeGroupCalendars"),e||(e=Object(l.e)().userIdentity),a=Object(h.j)(e).GroupsEnabled,i=Object(v.s)(e,s),o=!Object(v.t)().some((function(t){return t.id.id===i&&t.id.mailboxInfo.userIdentity===e})),c=a&&(t||o),n.addCustomData({issueServiceCall:c,GroupsEnabled:a,featureEnabled:!0,refresh:t,initialLoad:o}),r.label=1;case 1:return r.trys.push([1,4,,5]),c?[4,p(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return n.end(),[3,5];case 4:throw u=r.sent(),n.endWithError("ServerError",Error(u)),u;case 5:return[2]}}))}))})),E=n(4),_=n(75),y=n(498),C=null;Object(E.orchestrator)(v.D,(function(e){var t=e.payload,n=t.id,r=t.EventType,a=t.Group.SmtpAddress;_.g.info(n+": "+r+", "+a),C||(C=Object(y.a)(g.bind(null,Object(l.e)().userIdentity,!0),2e3)),C()})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return s}))},724:function(e,t,n){var r=n(725),a=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},725:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},9260:function(e){e.exports=JSON.parse('{"a":"b7c","d":"c7c","c":"d7c","g":"e7c","f":"f7c","b":"g7c","e":"h7c"}')},971:function(e,t,n){"use strict";var r=n(1645),a=n(158),i=n(1017),o=n(420);function c(e){return!!e.EffectiveRights&&!!e.EffectiveRights.Modify&&!Object(a.J)(e.ParentFolderId.Id)&&!Object(i.c)(e)&&("Private"!==e.Sensitivity||(t=e.ParentFolderId.Id,n=Object(a.o)(t),Object(o.c)(n)));var t,n}var u=function(e){return J(e)&&c(e)&&!e.IsCancelled},d=n(106),s=function(e){var t;return(null===(t=null==e?void 0:e.ParentFolderId)||void 0===t?void 0:t.mailboxInfo)&&e.ParentFolderId.mailboxInfo.type==d.a.GroupMailbox};function l(e,t){if(!e)return!1;var n=!s(e),r=function(t){return t?n?t.filter((function(t){return!e.Organizer||t.Mailbox.EmailAddress!=e.Organizer.Mailbox.EmailAddress})):t:[]},a=r(e.RequiredAttendees).length,i=r(e.OptionalAttendees).length;return t?a+i>0:a+i+r(e.Resources).length>0}function f(e){return!!e&&(e.IsDraft?l(e):e.IsMeeting||l(e))}var b=function(e){return!f(e)&&!e.IsOrganizer&&c(e)&&!e.IsCancelled},v=function(e){return!(!e.IsOrganizer||f(e)&&e.MeetingRequestWasSent||!c(e))},O=n(94),j=n(1058);function I(e){var t=Object(a.o)(e.ParentFolderId.Id),n=Object(j.c)(e);return c(e)&&f(e)&&!!t&&!!n&&!([3,6,7].includes(t.CalendarFolderType)||n.IsMeetingPollEvent)}function p(e){return!!(e.IsOrganizer&&e.IsMeeting&&e.MeetingRequestWasSent&&c(e))}var m=function(e){return v(e)||u(e)||b(e)};function h(e){return!s(e)&&!e.IsOrganizer&&e.IsMeeting&&!e.IsCancelled&&c(e)}function g(e){return 0==Object(O.i)().SessionSettings.WebSessionType&&h(e)&&e.IsResponseRequested&&!e.IsAllDayEvent&&(!e.IsRecurring||y(e))}function E(e){return!e.IsOrganizer&&e.IsCancelled&&c(e)}function _(e){return!Object(r.a)(e.EntityNamesMap)&&e.IsOrganizer&&c(e)}function y(e){return e.IsRecurring&&"RecurringMaster"!==e.CalendarItemType&&"ThisAndFollowingInstancesMaster"!==e.CalendarItemType}function C(e){return"RecurringMaster"===e.CalendarItemType}function w(e){return"ThisAndFollowingInstancesMaster"===e.CalendarItemType}function S(e){return s(e)&&!e.IsCancelled&&!e.DoNotForwardMeeting}function x(e){if(e){var t=Object(a.o)(e.ParentFolderId.Id);if(t)return t.IsSharedWithMe||Object(o.d)(t)}return!1}var R=n(76);function T(e){return s(e)?Object(R.h)("cal-groupNotifications"):!x(e)||Object(R.h)("cal-mf-enableFTDFOnSharedCalendar")}var A=function(e){var t=Object(a.o)(e.ParentFolderId.Id),n=t?t.CalendarFolderType:void 0;return(Object(i.c)(e)||c(e))&&(!n||1==n||3==n||5==n)};function P(e){var t;return!!(null===(t=e.EffectiveRights)||void 0===t?void 0:t.Read)}var F=n(435);function k(e){return e&&P(e)&&M(e.ItemId)}function M(e){return(null==e?void 0:e.Id)&&!Object(F.b)(e.Id)}var D=n(239);function N(e){return e.IsMeeting&&!Object(D.p)(e.ParentFolderId.mailboxInfo.userIdentity)}var L=n(1155);function G(e,t){var n,r;return!(t&&t.length>0)||(e.Subject&&-1!=e.Subject.toLowerCase().indexOf(t.toLowerCase())||(null===(n=e.Location)||void 0===n?void 0:n.DisplayName)&&-1!=Object(L.d)(e.Location.DisplayName,e.Location.PostalAddress).toLowerCase().indexOf(t.toLowerCase())||(null===(r=e.Organizer)||void 0===r?void 0:r.Mailbox)&&-1!=e.Organizer.Mailbox.Name.toLowerCase().indexOf(t.toLowerCase()))}var B=function(e){if(!e)return!1;var t=e.ParentFolderId.mailboxInfo.mailboxSmtpAddress;return q(e.RequiredAttendees,t)||q(e.OptionalAttendees,t)};function q(e,t){return e&&e.some((function(e){return e.Mailbox.EmailAddress.toLowerCase()==t}))}var K=n(1176);function V(e){if(!e)return!1;var t=!1;return e.forEach((function(e){var n;n=e.Mailbox,Object(K.a)(n.EmailAddress)||n.ItemId&&"PrivateDL"==n.MailboxType||(t=!0)})),t}function U(e){if(!e)return!1;var t=Object(a.o)(e.ParentFolderId.Id);return t&&3==t.CalendarFolderType}function z(e){return"Exception"===e}function W(e){return"Occurrence"===e}function H(e){return W(e.CalendarItemType)||z(e.CalendarItemType)}function J(e){return(null==e?void 0:e.IsMeeting)&&!e.IsOrganizer}function Y(e){return(null==e?void 0:e.IsMeeting)&&(null==e?void 0:e.IsOrganizer)}function Q(e){return Object(i.c)(e)&&f(e)}var Z=n(7);function X(e,t){return e&&t&&!Object(i.c)(e)&&Object(Z.Ib)(t.Start,e.Start)&&Object(Z.Ib)(t.End,e.End)&&t.IsAllDayEvent==e.IsAllDayEvent}function $(e){return"RecurringMaster"===e}function ee(e){return!(!e.IsMeeting||!e.IsOrganizer||!e.IsDraft&&e.MeetingRequestWasSent)}n.d(t,"j",(function(){return I})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"q",(function(){return h})),n.d(t,"n",(function(){return g})),n.d(t,"o",(function(){return E})),n.d(t,"h",(function(){return _})),n.d(t,"J",(function(){return y})),n.d(t,"K",(function(){return C})),n.d(t,"A",(function(){return w})),n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return T})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return v})),n.d(t,"i",(function(){return A})),n.d(t,"k",(function(){return c})),n.d(t,"l",(function(){return k})),n.d(t,"m",(function(){return M})),n.d(t,"p",(function(){return N})),n.d(t,"r",(function(){return G})),n.d(t,"s",(function(){return l})),n.d(t,"t",(function(){return B})),n.d(t,"u",(function(){return V})),n.d(t,"v",(function(){return P})),n.d(t,"w",(function(){return U})),n.d(t,"x",(function(){return f})),n.d(t,"y",(function(){return H})),n.d(t,"z",(function(){return z})),n.d(t,"B",(function(){return J})),n.d(t,"C",(function(){return x})),n.d(t,"D",(function(){return Y})),n.d(t,"E",(function(){return Q})),n.d(t,"F",(function(){return W})),n.d(t,"G",(function(){return s})),n.d(t,"H",(function(){return X})),n.d(t,"I",(function(){return $})),n.d(t,"L",(function(){return ee}))},975:function(e,t,n){"use strict";var r=n(115),a=n(1281),i=n(1004),o=n(4),c=[i.a.SurfaceActions];Object(o.orchestrator)(a.a,(function(e){var t=e.defaultOptions;c.forEach((function(e){t[e]&&Object(i.f)(Number(e),t[e])}))}));var u=n(1038);n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return b})),n.d(t,"c",(function(){return u.a})),n.d(t,"d",(function(){return i.d})),n.d(t,"b",(function(){return i.b})),n.d(t,"a",(function(){return i.a}));var d=new r.c((function(){return n.e(448).then(n.bind(null,15677))})),s=new r.a(d,(function(e){return e.createOrUpdateOptionsForFeature})),l=new r.a(d,(function(e){return e.updateAddinPinStatus})),f=new r.b(d,(function(e){return e.getServerOptionsForFeature})),b=new r.a(d,(function(e){return e.loadOptions}))},988:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return s}));var r=n(0),a=n(1052),i=n(1132),o=n(1028);function c(e,t){var n=Object(i.a)().calendarFolderEvents.get(e);return n?Object(r.__spread)(n.events.values()).filter(t):[]}function u(e,t){return void 0===t&&(t=null),t?Object(r.__read)(c(t,(function(t){return t.ItemId.Id===e})),1)[0]||null:function(e){for(var t=Object(i.a)(),n=Object(r.__spread)(t.calendarFolderEvents.keys()),a=0;a<n.length;a++){var o=n[a],c=t.calendarFolderEvents.get(o),u=Object(r.__read)(c?Object(r.__spread)(c.events.values()).filter(e):[null],1)[0];if(u)return u}return null}((function(t){return t.ItemId.Id===e}))}function d(e,t){void 0===t&&(t=null);var n=Object(i.a)();return t?n.calendarFolderEvents.get(t).events.get(e)||null:function(e){for(var t=Object(i.a)(),n=Object(r.__spread)(t.calendarFolderEvents.keys()),a=0;a<n.length;a++){var o=n[a],c=d(e,o);if(c)return c}return null}(e)}function s(e,t,n){var c=null,u=(c=e?function(e,t,n){var o=Object(i.a)().calendarFolderEvents.get(e);return o&&Object(r.__read)(Object(a.l)([t],n,o),1)[0]||null}(e,t,n):function(e,t){for(var n=Object(i.a)(),o=Object(r.__spread)(n.calendarFolderEvents.keys()),c=0;c<o.length;c++){var u=o[c],d=n.calendarFolderEvents.get(u),s=Object(r.__read)(d?Object(a.l)([e],t,d):[null],1)[0];if(s)return s}return null}(t,n))?"1":"no";return Object(o.a)({lockId:n,updateMessage:"Got "+u+" item from the cache for given folder and key"}),c}},998:function(e,t,n){"use strict";var r=n(974),a=n(1169),i=n(4),o=Object(i.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK",(function(e,t,n,r,a){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r,partialCalendarEvent:a}})),c=Object(i.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK_FAILED",(function(e,t,n,r){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r}})),u=Object(i.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED_FOR_LOCK",(function(e,t,n,r,a,i,o){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r,event:a,hasEventChanged:i,forceOverrideAllPropertiesForEventIfAvailable:o}})),d=Object(i.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED",(function(e,t,n,r){return{folderId:e,eventKey:t,itemResponseShapeType:n,event:r}})),s=Object(i.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_SERVER",(function(e){return{partialCalendarEvent:e}})),l=Object(i.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_PARTIAL_CALENDAR_EVENT",(function(e){return{partialCalendarEvent:e}})),f=Object(i.action)("CALENDAR_EVENT_MERGE_EVENTS_INTO_CACHE",(function(e){return{event:e}})),b=Object(i.action)("CALENDAR_EVENTS_REMOVE_FULL_CALENDAR_EVENT",(function(e,t){return{folderId:e,eventKey:t}})),v=Object(i.action)("CALENDAR_EVENTS_REMOVE_ALL_FULL_CALENDAR_EVENTS_INFO_FOR_CACHE",(function(e){return{folderId:e}})),O=Object(i.action)("ADD_CALENDAR_EVENTS_TO_EVENTS_CACHE",(function(e,t,n){return void 0===n&&(n=!1),{folderId:e,calendarEvents:t,forceReplace:n}})),j=Object(i.action)("ADD_CALENDAR_EVENTS_WITHING_CURRENT_LOCKED_DATE_RANGES",(function(e,t){return{folderId:e,calendarEvents:t}})),I=Object(i.action)("REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(function(e,t){return{folderId:e,instanceKey:t}})),p=Object(i.action)("INTERNAL_REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(function(e,t,n){return{folderId:e,instanceKey:t,onEventsRemoved:n}})),m=Object(i.action)("REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(function(e,t){return{folderId:e,predicate:t}})),h=Object(i.action)("INTERNAL_REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(function(e,t,n){return{folderId:e,predicate:t,onEventsRemoved:n}})),g=Object(i.action)("CALENDAR_EVENTS_RELEASE_LOCK",(function(e){return{lockId:e}})),E=Object(i.action)("RELEASE_LOCK",(function(e){return{lockId:e}})),_=Object(i.action)("CALENDAR_EVENTS_IN_EVENTS_CACHE_RELOADED",(function(e,t,n){return void 0===n&&(n=!1),{folderId:e,eventsReloaded:t,forceReplace:n}})),y=Object(i.action)("CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}})),C=Object(i.action)("INTERNAL_CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}})),w=Object(i.action)("INTERNAL_DELETE_EVENTS_CACHE",(function(e){return{folderId:e}})),S=Object(i.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_WAS_USED",(function(e,t){return{lockId:e,eventKey:t}})),x=Object(i.action)("UpdateItem",(function(e,t){return{existingItem:e,updatedItem:t}})),R=n(1339),T=n(1458),A=n(1459),P=n(10),F=n(118),k=Object(i.action)("calendarEventsRemoved",(function(e){return{eventsRemoved:e}})),M=Object(i.action)("calendarEventsAdded",(function(e){return{eventsAdded:e}})),D=Object(i.action)("calendarEventUpdated",(function(e){return{eventUpdated:e}})),N=Object(i.action)("calendarEventsRemovedMatchedFilter",(function(e){return{removePredicate:e}})),L=Object(i.action)("cacheReloaded",(function(e,t){return{previousEvents:e,reloadedEvents:t}})),G=Object(i.action)("deleteEventsCache",(function(e){return{folderId:e}})),B=Object(i.action)("loadingCalendarEvents",(function(e,t,n){return Object(F.c)({name:"CalendarLoadState",customData:{loadingState:n},options:{isVerbose:!0}},{lockId:e,calendarId:t,loadingState:n})})),q=Object(i.action)("instantCalendarEventCreate",(function(e,t,n,r,a,i,o){return void 0===r&&(r=function(){}),void 0===a&&(a=void 0),void 0===i&&(i=Object(P.b)(T.a)),void 0===o&&(o=function(){}),{eventToCreate:e,actionToExecute:t,onEventCreatedSuccess:n,onEventCreatedFailed:r,actionSource:a,errorMessage:i,onEventCreatedLocally:o}})),K=Object(i.action)("instantCalendarEventUpdate",(function(e,t,n,r,a,i,o,c,u){return void 0===i&&(i=function(){}),void 0===o&&(o=void 0),void 0===c&&(c=Object(P.b)(R.a)),void 0===u&&(u=function(){}),{eventId:e,eventChanges:t,eventScope:n,actionToExecute:r,onEventUpdateSuccess:a,onEventUpdateFailed:i,actionSource:o,errorMessage:c,onEventUpdatedLocally:u}})),V=Object(i.action)("instantCalendarEventDelete",(function(e,t,n,r,a,i,o,c,u,d){return void 0===i&&(i=function(){}),void 0===o&&(o=void 0),void 0===c&&(c=Object(P.b)(A.a)),void 0===u&&(u=!1),void 0===d&&(d=function(){return Promise.resolve(!1)}),{eventId:e,eventScope:t,dataPoint:n,actionToExecute:r,onEventDeleteSuccess:a,onEventDeleteFailed:i,actionSource:o,errorMessage:c,responseSent:u,asyncUndoAction:d}})),U=n(0),z=n(417);function W(e){if(0===e.length)return[];var t=[];return e.forEach((function(e){return function(e,t){for(var n=!1,r=0;r<t.length&&!n;r++){var a=t[r];0===Object(z.j)(a,e,!0)&&(t[r]=Object(z.f)(a,e),n=!0)}n||t.push(e)}(e,t)})),t}var H=n(988),J=n(254),Y=n(158),Q=n(971),Z=n(1058),X=n(315),$=n(76),ee=n(7);var te=n(569),ne=n(25);function re(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(U.__assign)({__type:"ExpandCalendarEventJsonRequest:#Exchange"},n)),Object(ne.a)("ExpandCalendarEvent",e,t)}var ae=n(245);function ie(e,t){return Object(U.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(U.__generator)(this,(function(i){switch(i.label){case 0:return n={Header:Object(ae.a)(),Body:(o={EventId:Object(te.a)({Id:e.Id}),WindowStart:Object(ee.rb)(t.start),WindowEnd:Object(ee.rb)(t.end),ReturnMaster:!0,ReturnRegularOccurrences:!0,ReturnExceptions:!0,ReturnCancellations:!0,IncludeDeclinedMeetings:Object($.h)("cal-surface-declinedMeetings")},Object(U.__assign)({__type:"ExpandCalendarEventRequest:#Exchange"},o))},r=re,a=[n],[4,Object(X.e)(e.mailboxInfo)];case 1:return[4,r.apply(void 0,a.concat([i.sent()]))];case 2:return[2,i.sent().Body]}var o}))}))}var oe=n(1799),ce=function(e){Object($.h)("cal-notificationDiagnostics")&&setTimeout((function(){return Object(oe.a)(e)}),0)},ue=n(1017),de=n(1075),se=n(1052);function le(e,t,n){var a=Object(se.k)(n,e,Object(r.f)(t));return(a||[]).filter((function(e){return!Object(Q.I)(e.CalendarItemType)}))}var fe=3,be=1,ve=n(1028),Oe=n(1510);function je(e,t,n){return function(r){if(!Ie(r)||r.ParentFolderId.Id!==e)return!1;var a=function(e,t){return function(n){return Ie(n)&&n.ParentFolderId.Id===e&&n.ItemId.Id===t}}(r.ParentFolderId.Id,r.ItemId.Id);return n?t.some(a):!t.some(a)}}function Ie(e){var t;return(null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id)&&e.ParentFolderId&&e.ParentFolderId.Id}var pe=n(531);function me(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(U.__assign)({__type:"GetBirthdayCalendarViewJsonRequest:#Exchange"},n)),Object(ne.a)("GetBirthdayCalendarView",e,t)}function he(e,t,n){return Object(U.__awaiter)(this,void 0,void 0,(function(){var r,a;return Object(U.__generator)(this,(function(i){switch(i.label){case 0:return r=me,a=[{Header:Object(ae.a)(),Body:(o={StartRange:Object(ee.rb)(e),EndRange:Object(ee.rb)(t)},Object(U.__assign)({__type:"GetBirthdayCalendarViewRequest:#Exchange"},o))}],[4,Object(X.e)(n.mailboxInfo)];case 1:return[4,r.apply(void 0,a.concat([i.sent()]))];case 2:return[2,i.sent().Body]}var o}))}))}var ge=n(1815),Ee=n(106),_e=n(1768),ye=n(94);function Ce(e,t,n,r){return Object(U.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(U.__generator)(this,(function(o){return a=Object(ye.i)().UserOptions.TimeZone,i="ows/api/beta/TeamsCalendarEvents/items?id="+encodeURIComponent(n)+"&rangeStart="+encodeURIComponent(Object(ee.rb)(e))+"&rangeEnd="+encodeURIComponent(Object(ee.rb)(t))+"&channelId="+r+"&timeZone="+a,[2,Object(_e.b)("getTeamsCalendarView",null,i)]}))}))}var we=n(75),Se=n(420);function xe(e,t,n,r){var a;return void 0===r&&(r=0),{fetchPromise:function(e,t,n,r){void 0===r&&(r=0);return Object(U.__awaiter)(this,void 0,void 0,(function(){var a,i,o,c;return Object(U.__generator)(this,(function(u){switch(u.label){case 0:return(a=Object(J.q)())&&a.addCustomData({outOfCacheRange:!0}),i=Object(Y.u)(t),n(i,"Loading"),Object(Y.I)(t)?3!=(o=Object(Y.o)(t)).CalendarFolderType?[3,2]:[4,Ae(e,i,t,n,r)]:[3,5];case 1:return[2,u.sent()];case 2:return[4,Te(e,i,t,n,null,r)];case 3:return[2,u.sent()];case 4:return[3,8];case 5:return o=Object(Y.l)({id:i}),Object(Y.M)(o)?(c=Object(Y.p)({id:{id:o.ItemId.Id,mailboxInfo:i.mailboxInfo}}),[4,Re(t,c,o,e,i,n,r)]):[3,7];case 6:return[2,u.sent()];case 7:return n(i,"Failed"),[2,null];case 8:return[2]}}))}))}(e,t,n,r),enhancedFetchPromise:Object($.h)("cal-mf-noPeekJump")&&t==(null===(a=Object(Y.w)())||void 0===a?void 0:a.calculatedFolderId)?wn.importAndExecute(e):null}}function Re(e,t,n,i,o,c,u){return void 0===u&&(u=0),Object(U.__awaiter)(this,void 0,void 0,(function(){var d,s,l;return Object(U.__generator)(this,(function(f){switch(f.label){case 0:if(!(!t&&Object(Se.d)(n)||n.hasOwnProperty("OwnerEmailAddress")&&!n.IsGroupMailboxCalendar&&t&&!t.EffectiveRights||t&&(!t.EffectiveRights||!t.EffectiveRights.Read)&&n.IsGeneralScheduleCalendar))return[3,7];f.label=1;case 1:if(!(u>=0))return[3,6];f.label=2;case 2:return f.trys.push([2,4,,5]),[4,Object(pe.b)(i.start,i.end,[n.OwnerEmailAddress],"DetailedMerged",null,o.mailboxInfo)];case 3:return"NoError"==(d=f.sent()).ResponseCode?(c(o,"Loaded"),function(e,t){var n=Object(r.a)(e);if(null==n?void 0:n.length){var i=Object(a.a)(n,[t]).eventsOverlapping;m(e,je(e,i,!0))}}(e,i),function(e){var t=Object(r.f)(e),n=t?Object(U.__spread)(t.events.values()):[];N(je(e,n,!1))}(e),[2,d.Responses[0].CalendarView.Items.map((function(e){return Object(Z.a)(e,o.mailboxInfo)}))]):(u--,[3,5]);case 4:return s=f.sent(),we.g.warn("[loadCalendarEventsInDateRange:loadCalendarEventsUsingFolderId: Exception occured: "+s),s.message&&(s.message.indexOf("ErrorApiQuarantined")>=0||s.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(c(o,"Throttled"),[2,null]):(u--,[3,5]);case 5:return[3,1];case 6:return c(o,"Failed"),[2,null];case 7:return l=t?t.FolderId.Id:n.SharedFolderId.Id,[4,Te(i,o,l,c,n.IsGroupMailboxCalendar?null:n.OwnerEmailAddress,u)];case 8:return[2,f.sent()]}}))}))}function Te(e,t,n,r,a,i){return void 0===i&&(i=0),Object(U.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(U.__generator)(this,(function(u){switch(u.label){case 0:if(!(i>=0))return[3,8];u.label=1;case 1:return u.trys.push([1,6,,7]),o=void 0,t.mailboxInfo&&t.mailboxInfo.type==Ee.a.TeamsMailbox?[4,Ce(e.start,e.end,Object(Y.f)(n),t.id)]:[3,3];case 2:return(o=u.sent())&&(o=o.Body),[3,5];case 3:return[4,Object(ge.a)(e.start,e.end,n,t,a,Object($.h)("cal-surface-declinedMeetings"))];case 4:o=u.sent(),u.label=5;case 5:return"NoError"==o.ResponseCode?(r(t,"Loaded"),[2,o.Items.map((function(e){return t.mailboxInfo&&t.mailboxInfo.type==Ee.a.TeamsMailbox&&(e.ParentFolderId.Id=n),Object(Z.a)(e,t.mailboxInfo)}))]):(i--,[3,7]);case 6:return c=u.sent(),we.g.warn("[loadCalendarEventsInDateRange:getCalendarView: Exception occured: "+c),c.message&&(c.message.indexOf("ErrorApiQuarantined")>=0||c.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(r(t,"Throttled"),[2,null]):(i--,[3,7]);case 7:return[3,0];case 8:return r(t,"Failed"),[2,null]}}))}))}function Ae(e,t,n,r,a){return void 0===a&&(a=0),Object(U.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(U.__generator)(this,(function(c){switch(c.label){case 0:if(!(a>=0))return[3,5];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,he(e.start,e.end,t)];case 2:return"NoError"==(i=c.sent()).ResponseCode?(r(t,"Loaded"),[2,i.BirthdayEvents.map((function(r){return Object(Oe.a)(r,n,e,t.mailboxInfo)}))]):(a--,[3,4]);case 3:return o=c.sent(),we.g.warn("[loadCalendarEventsInDateRange:getBirthdayCalendarView: Exception occured: "+o),o.message&&(o.message.indexOf("ErrorApiQuarantined")>=0||o.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(r(t,"Throttled"),[2,null]):(a--,[3,4]);case 4:return[3,0];case 5:return r(t,"Failed"),[2,null]}}))}))}var Pe={};function Fe(e,t){return function(e,t){ke(e);for(var n=Pe[e],r=0;r<n.length;r++)if(Object(z.c)(n[r].dateRange,t,!0))return{index:r,info:n[r]};return{index:-1,info:null}}(e,t).index>=0}function ke(e){Pe[e]||(Pe[e]=[])}var Me={};function De(e){Me[e]||(Me[e]=[])}function Ne(e,t){De(e);for(var n=Me[e],r=0;r<n.length;r++)if(Object(z.c)(n[r].dateRange,t,!0))return{index:r,info:n[r]};return{index:-1,info:null}}function Le(e,t,n){var a=Object(r.g)(e,t),i=Ne(t,n).info;if(a&&a.lockedDateRange&&Object(z.c)(a.lockedDateRange,n,!0)){var o=Object(Y.u)(t);B(e,o,"Loaded");var c=le(e,t,n);O=Ge(c,t,n,i);return{fetchPromise:Promise.resolve(c),enhancedFetchPromise:O,events:c}}var u=function(e,t){var n=Object(r.d)(e),a=Object(r.f)(e);return n.some((function(e){return Object(z.c)(e,t,!0)}))&&a?Object(se.j)(t,a.events).map((function(e){return Object(U.__assign)({},e)})):null}(t,n);if(u){var d=Be(e,t,n,Promise.resolve(u),"existing"),s=Ge(u,t,n,i);return null==d||d.then((function(n){var r=Object(Y.u)(t);B(e,r,"Loaded")})),{fetchPromise:d,enhancedFetchPromise:s,events:u}}if(null==i?void 0:i.requestPromises){var l=i.requestPromises,b=l.fetchPromise,v=l.enhancedFetchPromise;return i.lockIds.push(e),{fetchPromise:Be(e,t,n,null==b?void 0:b.then((function(e){return e?e.filter((function(e){var t=e.Start,r=e.End;return 0==Object(z.j)(n,{start:t,end:r},!0)})):[]})),"new"),enhancedFetchPromise:null==v?void 0:v.then((function(e){return qe(n)(e)})),events:null}}!function(e,t,n){De(t),Me[t].push({dateRange:n,requestPromises:null,lockIds:[e]})}(e,t,n);var O,j=function(e,t,n){var r=this,a=xe(t,e,n,be);return{fetchPromise:Object(U.__awaiter)(r,void 0,void 0,(function(){return Object(U.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,,2,3]),[4,null==a?void 0:a.fetchPromise];case 1:return[2,n.sent()];case 2:return function(e,t){var n=Ne(e,t).index;-1!==n&&Me[e].splice(n,1)}(e,t),[7];case 3:return[2]}}))})),enhancedFetchPromise:null==a?void 0:a.enhancedFetchPromise}}(t,n,function(e,t){return function(n,r){var a=Ne(e,t),i=a.index,o=a.info;-1!==i&&o.lockIds.forEach((function(e){B(e,n,r)}))}}(t,n)),I=null==j?void 0:j.fetchPromise,p=null==j?void 0:j.enhancedFetchPromise;return function(e,t,n){var r=Ne(e,t),a=r.index,i=r.info;-1!==a&&(i.requestPromises=n)}(t,n,j),{fetchPromise:Be(e,t,n,I,"new"),enhancedFetchPromise:O=function(e,t,n){return Object(U.__awaiter)(this,void 0,void 0,(function(){var r;return Object(U.__generator)(this,(function(a){switch(a.label){case 0:return[4,n];case 1:return(r=a.sent())&&(!function(e,t){ke(e),Pe[e].push({dateRange:t})}(e,t),r.forEach((function(e){return f(e)}))),[2,r]}}))}))}(t,n,p),events:null}}function Ge(e,t,n,r){var a,i,o=null;if(t===(null===(a=Object(Y.w)())||void 0===a?void 0:a.calculatedFolderId))if(Fe(t,n))o=Promise.resolve(e);else if(null===(i=null==r?void 0:r.requestPromises)||void 0===i?void 0:i.enhancedFetchPromise){o=r.requestPromises.enhancedFetchPromise.then(qe(n))}else we.g.warn("[loadEnhancedEvents] - Failed to load GetCalendarView++ events on an existing lock.");return o}function Be(e,t,n,r,a){return Object(U.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(U.__generator)(this,(function(c){switch(c.label){case 0:return[4,r];case 1:return i=c.sent(),o=i?i.length:"no",Object(ve.a)({lockId:e,updateMessage:"Fetched "+o+" "+a+" items for date range: "+n.start+" - "+n.end}),i&&y(e,t,n,i),[2,i]}}))}))}function qe(e){return function(t){return t?t.filter((function(t){var n=t.Start,r=t.End;return 0==Object(z.j)(e,{start:n,end:r},!0)})):[]}}function Ke(e,t){var n,a;return void 0===t&&(t=!1),Object(U.__awaiter)(this,void 0,void 0,(function(){var i,o,c,u,d,l;return Object(U.__generator)(this,(function(f){switch(f.label){case 0:i=function(e){var t=function(e){return De(e),Me[e].map((function(e){return e.dateRange}))}(e),n=null==t?void 0:t.filter((function(e){return null!==e})),a=Object(r.d)(e);return W(Object(U.__spread)(n,a))}(e),o=i.map((function(t){return xe(t,e,function(e,t){return function(n,a){"Loading"!==a&&Object(r.c)(e,t).forEach((function(e){B(e,n,a)}))}}(e,t),be)})),c=[],u=0,f.label=1;case 1:return u<o.length?[4,Promise.all([null===(n=o[u])||void 0===n?void 0:n.fetchPromise,null===(a=o[u])||void 0===a?void 0:a.enhancedFetchPromise]).then((function(e){var t=e[0],n=e[1];if(t&&n)for(var r=function(e){var r=t[e].ItemId.Id,a=null===(i=t[e].ParentFolderId)||void 0===i?void 0:i.Id,i=Object(U.__read)(n.filter((function(e){var t;return e.ItemId.Id===r&&(null===(t=e.ParentFolderId)||void 0===t?void 0:t.Id)===a})),1),o=i[0];o&&x(t[e],o),c.push(t[e])},a=0;a<t.length;a++)r(a);else t&&c.push.apply(c,Object(U.__spread)(t))}))]:[3,4];case 2:f.sent(),f.label=3;case 3:return u++,[3,1];case 4:return c.length>0?(c.forEach((function(e){return s(e)})),d=c.reduce((function(e,t){return t&&e.push(t),e}),[]),b=function(e){return e.ItemId.Id},v={},O=[],d.forEach((function(e){var t=b(e);v.hasOwnProperty(t)||(O.push(e),v[t]=!0)})),_(e,l=O,t),[2,l]):[2,null]}var b,v,O}))}))}function Ve(e,t,n,r){void 0===r&&(r=!1);var a=e.ParentFolderId.Id,i=!1,o=function(e,t,n){var r,a,i=null;if(n)i=Object(H.b)(t.ItemId.Id,e);else{r=Object(U.__read)(Object(H.a)(e,(function(e){return e.InstanceKey==t.InstanceKey})),1),i=r[0]}if(!i){var o=t.ClientSeriesId;if(o){a=Object(U.__read)(Object(H.a)(e,(function(e){return e.ClientSeriesId==o})),1),i=a[0]}}return i}(a,e,t);o?o.IsRecurring&&!t?r?k([o]):i=!0:(null==e.IsOnlineMeeting&&null!=o.IsOnlineMeeting&&(e.IsOnlineMeeting=o.IsOnlineMeeting),null==e.OnlineMeetingJoinUrl&&null!=o.OnlineMeetingJoinUrl&&(e.OnlineMeetingJoinUrl=o.OnlineMeetingJoinUrl),k([o])):we.g.info("[SharedCacheFunctions] addOrModifyItemInCache: Skipping removal of old item from cache as no old item was found"),!o&&n||(i||(O(a,[e]),M([e])),r?s(e):l(e))}function Ue(e,t){return void 0===t&&(t=!1),Object(U.__awaiter)(this,void 0,void 0,(function(){return Object(U.__generator)(this,(function(n){switch(n.label){case 0:return[4,Ke(e,t)];case 1:return n.sent(),[2]}}))}))}var ze=Object(i.action)("CALENDAR_EVENTS_CLEAR_ALL_FULL_CALENDAR_EVENTS",(function(){return{}}));function We(){ze(),Object(r.b)().map((function(e){return Ke(e,!0)}))}var He=n(1372),Je=864e5;var Ye,Qe={RowAdded:"RowAdded",RowModified:"RowModified",RowDeleted:"RowDeleted",Reload:"Reload"},Ze=2e3,Xe={},$e={},et=[],tt=!0,nt=!0;function rt(e,t){if(nt&&(Object(He.b)(We,"RELOAD_CALENDAR_SUBSCRIPTIONS",Je),nt=!1),Xe[e])return Xe[e].locks[t]=!0,void ce({message:"Already subscribed to calendar item notifications for folder",folderId:e});var n=Object(Y.o)(e);if(n){var r=Object(Y.C)(n);if(r){var a=Object($.h)("cal-surface-declinedMeetings");de.b.import().then((function(n){var i,o=Object(U.__assign)(Object(U.__assign)({},r),{ChannelId:n(),NotificationType:"CalendarItemNotification",IncludeDeclinedMeetings:a}),c={subscriptionId:""+o.NotificationType+e+(a?"declinedMeetings":""),requiresExplicitSubscribe:!0,subscriptionParameters:o},u={folderId:e,subscription:c,locks:(i={},i[t]=!0,i)};ce({message:"Subscribing to calendar item notifications for folder with includeDeclinedMeetings = "+a,folderId:e}),de.f.importAndExecute(c,at),Xe[e]=u}))}}else ce({message:"Calendar entry not found to subscribe to notifications for folder",folderId:e})}function at(e){ct(e,!0),function(e){if(et.some((function(e){return ut(e.NotificationPayload)})))ce({message:"A reload notification is in the queue. No additional notifications will be added",notificationPayload:e.NotificationPayload});else if(ut(e.NotificationPayload))ce({message:"A reload notification will be enqueued. All existing notifications will be discarded.",notificationPayload:e.NotificationPayload}),(et=[])[0]=e;else{for(var t=et.length-1;t>=0;t--){var n=et[t].NotificationPayload.Item,r=void 0,a=void 0,i=void 0;if(null!=e.NotificationPayload.Item.InstanceKey?(a=e.NotificationPayload.Item.InstanceKey,r=n.InstanceKey,i="InstanceKey"):(a=e.NotificationPayload.Item.ItemId.Id,r=n.ItemId.Id,i="ItemId"),a===r){ce({message:"Found an existing notification in the queue for the same "+i+". Old notification will be removed.",notificationPayload:e.NotificationPayload}),et[t].InstanceKeyToDelete&&(e.InstanceKeyToDelete=et[t].InstanceKeyToDelete),et.splice(t,1);break}}var o=!1;if(null!=e.NotificationPayload.Item.InstanceKey)if(e.NotificationPayload.EventType==Qe.RowModified&&Object(Q.I)(e.NotificationPayload.Item.CalendarItemType)&&null!=e.NotificationPayload.Item.UID&&($e[e.NotificationPayload.Item.InstanceKey]=e.NotificationPayload.Item.UID),e.NotificationPayload.EventType===Qe.RowAdded||e.NotificationPayload.EventType===Qe.RowModified){for(t=et.length-1;t>=0;t--)if(et[t].NotificationPayload.EventType===Qe.RowDeleted&&et[t].OriginalUID==e.NotificationPayload.Item.UID){ce({message:"Found an existing RowDeleted notification in the queue for the same UID, which will be removed from the queue.",notificationPayload:e.NotificationPayload}),e.InstanceKeyToDelete=et[t].NotificationPayload.Item.InstanceKey,et.splice(t,1);break}}else if(e.NotificationPayload.EventType===Qe.RowDeleted){var c=$e[e.NotificationPayload.Item.InstanceKey];if(delete $e[e.NotificationPayload.Item.InstanceKey],c){e.OriginalUID=c;for(t=et.length-1;t>=0;t--){var u=et[t].NotificationPayload.Item.UID;if((et[t].NotificationPayload.EventType===Qe.RowAdded||et[t].NotificationPayload.EventType===Qe.RowModified)&&u==c){ce({message:"Found an existing RowAdded or RowModified notification in the queue for the same UID, which will be merged with the RowDelete.",notificationPayload:e.NotificationPayload}),et[t].InstanceKeyToDelete=e.NotificationPayload.Item.InstanceKey,o=!0;break}}}}o?ce({message:"RowDeleted notification was merged with a RowAdded notification for the same UID and will not be enqueued",notificationPayload:e.NotificationPayload}):(ce({message:"Notification will be enqueued",notificationPayload:e.NotificationPayload}),et.push(e))}ce({message:"Notification queue length is "+et.length})}({NotificationPayload:e,InstanceKeyToDelete:null,OriginalUID:null}),tt?(Ye&&(ce({message:"Notification processing timer was already started. It will be cancelled and restarted."}),clearTimeout(Ye)),Ye=setTimeout(ot,Ze),ce({message:"Timer to drain queue has started"})):ce({message:"The notification was received while notification processing was suspended"})}function it(e){var t,n;if(ct(e.NotificationPayload,!1),ut(e.NotificationPayload))dt();else{var a=e.NotificationPayload.FolderId,i=null===(t=e.NotificationPayload.Item)||void 0===t?void 0:t.SkypeTeamsProperties;Object($.h)("cal-showAddTeamsCalendars")&&i&&!Object(Y.o)(a)&&(a=function(e,t){var n=JSON.parse(t);if(null==n?void 0:n.cid){var r=n.cid.split("@")[0];e=r?Object(Y.O)(e,r):e}return e}(a,i),(null===(n=e.NotificationPayload.Item)||void 0===n?void 0:n.ParentFolderId)&&(e.NotificationPayload.Item.ParentFolderId.Id=a));var o=Object(r.h)(a),c=Object(r.d)(a),u=Object(r.e)(a),d=Object(Y.o)(a),l=Object(Y.y)(a);d&&3==d.CalendarFolderType?dt(a):o&&(c.length>0||Object.keys(u).length>0)?e.NotificationPayload.EventType==Qe.RowDeleted?function(e,t){var n=t.Item.InstanceKey;I(e,n)}(a,e.NotificationPayload):Object(Q.I)(e.NotificationPayload.Item.CalendarItemType)?function(e,t,n){var r=Object(Z.a)(n.NotificationPayload.Item,t);if(r.UID){vt(e).forEach((function(a){var i=ie(r.ItemId,a);i.then((function(o){o&&"Success"==o.ResponseClass?function(e,t,n,r,a,i,o){if(ce({message:"Action to expand series completed successfully. Retrieved "+(a?a.length:0)+" items for dates: "+n.start.toString()+" - "+n.end.toString()+" ",folderId:r,notificationItem:e}),vt(r).some((function(e){return Object(z.b)(n,e)}))){ce({message:"Updating all cached items for the series and removing nonexistant ones",folderId:r});var c=a?a.map((function(e){return e.UID})):void 0;lt(n,e.ItemId.Id,e.InstanceKey,o,r,(function(e){return!c||!c.includes(e.UID)})),s(i),j(r,a),a.forEach((function(e){s(e)}))}else ce({message:"Range in the cache is different from what we originally requested - reloading cache",folderId:r}),Ue(r,!0)}(r,0,a,e,o.Occurrences.map((function(e){return Object(Z.a)(e,t)})),Object(Z.a)(o.RecurrenceMaster,t),n.InstanceKeyToDelete):st(r,i,a,e,n.InstanceKeyToDelete,o)})).catch((function(t){st(r,i,a,e,n.InstanceKeyToDelete,null,t.message)}))}))}}(a,l,e):function(e,t,n){var r=Object(Z.a)(n.Item,t),a=!1;switch(n.EventType){case Qe.RowAdded:a=!0;break;case Qe.RowModified:a=null==r.InstanceKey||Object(Q.F)(r.CalendarItemType)||Object(Q.z)(r.CalendarItemType)}Ve(r,a,!1,!0)}(0,l,e.NotificationPayload):ce({message:o?"Events cache was empty for folder":"Events cache has not been loaded for folder yet",folderId:e.NotificationPayload.FolderId,notificationPayload:e.NotificationPayload})}}function ot(){var e=et.length;if(e>=8||et.some((function(e){return ut(e.NotificationPayload)})))dt();else for(var t=0;t<e;t++){it(et[t])}et=[],$e={},clearTimeout(Ye)}function ct(e,t){var n,r=(null===(n=e.Item)||void 0===n?void 0:n.ItemId)?e.Item.ItemId.Id:"<null>";if(ce({message:(t?"Got calendar notification":"Processing calendar notification")+" for event type "+e.EventType,folderId:e.FolderId,notificationPayload:e}),t){var a=e.Item?e.Item.CalendarItemType:"<null>";Object(J.o)("IncomingNotification",{NotificationType:e.EventType,ItemType:a,ItemId:r},{isCosmosDatapoint:!0})}}function ut(e){return e.EventType==Qe.Reload||e.Reload}function dt(e){var t,n,r=e?[e]:Object.keys(Xe);try{for(var a=Object(U.__values)(r),i=a.next();!i.done;i=a.next()){Ue(i.value,!0)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}function st(e,t,n,r,a,i,o){if(void 0===o&&(o=null),i&&"ErrorItemNotFound"==i.ResponseCode)ce({message:"Action to expand recurring series failed with item not found because item is not on the server. Removing series.",folderId:r,notificationItem:e}),lt(n,e.ItemId.Id,e.InstanceKey,a,r);else{var c=i?i.ResponseCode+": "+i.MessageText:o;ce({message:"Action to expand recurring series failed for unknown reason, reloading cache",folderId:r,notificationItem:e,errorMessage:c}),Ue(r,!0)}}function lt(e,t,n,r,a,i){var o=function(a){var o,c={start:a.Start,end:a.End},u=0==Object(z.j)(e,c,!0),d=a.InstanceKey==n||r&&a.InstanceKey==r||t&&t===(null===(o=a.SeriesMasterItemId)||void 0===o?void 0:o.Id);return u&&(Object(ue.c)(a)||d&&(!i||i(a)))};m(a,o);var c=Object(H.a)(a,o);k(c)}function ft(){tt&&(clearTimeout(Ye),ce({message:"Processing of notifications will be suspended"}),tt=!1)}function bt(){tt||(tt=!0,ce({message:"Processing of notifications will be resumed"}),Ye=setTimeout(ot,Ze))}function vt(e){return W(Object(r.d)(e))}Object(i.orchestrator)(L,(function(e){var t=e.previousEvents,n=e.reloadedEvents;n&&(t&&k(t),M(n))})),Object(i.orchestrator)(m,(function(e){var t=e.folderId,n=e.predicate,r=null;h(t,n,(function(e){r=e})),r&&(r.forEach((function(e){return b(t,e.Key)})),k(r))})),Object(i.orchestrator)(I,(function(e){var t=e.folderId,n=e.instanceKey,r=null;p(t,n,(function(e){r=e})),r&&(r.forEach((function(e){return b(t,e.Key)})),k(r))})),Object(i.orchestrator)(y,(function(e){var t=e.lockId,n=e.folderId,r=e.dateRange,a=e.calendarEvents;C(t,n,r,a),a&&M(a)})),Object(i.orchestrator)(j,(function(e){var t=e.folderId,n=e.calendarEvents,i=Object(r.d)(t),o=Object(a.a)(n,i).eventsOverlapping;o.length>0&&(O(t,o),M(o))})),Object(i.orchestrator)(_,(function(e){var t=e.folderId,n=e.eventsReloaded,a=e.forceReplace,i=Object(r.a)(t);O(t,n,a),L(i,n)})),Object(i.orchestrator)(G,(function(e){var t=e.folderId;!function(e){var t=Xe[e];t?(ce({message:"Unsubscribing from calendar item notifications for folder",folderId:e}),de.g.importAndExecute(t.subscription,at),delete Xe[e]):ce({message:"Could not unsubscribe calendar item notifications for folder due to subscription data not found",folderId:e})}(t),v(t),w(t)}));var Ot=n(1737),jt=n(1250),It=n(316);function pt(e,t){var n=function(e){return Object(jt.d)(e)?mt:Object(jt.h)(e)?ht:Object(jt.e)(e)?gt:(Object(jt.i)(e),null)}(e.Recurrence);if(!n)return[Object(U.__assign)({},e)];var r=W(t),a=[],i=e.Recurrence.RecurrencePattern.Interval;r.forEach((function(t){var r=function(e,t){var n=Object(ee.Xb)(e.Start),r=Object(Ot.a)(n.tz,e.Recurrence),a={start:n,end:r};return function(e,t){e.start=Object(ee.p)(e.start,t.start)>0?e.start:t.start,e.end=null!=e.end&&Object(ee.p)(e.end,t.end)<0?e.end:t.end}(a,t),a}(e,t),o=n(e,r,i);a.push.apply(a,Object(U.__spread)(o))}));var o=Object(ee.x)(e.Start,Object(ee.Xb)(e.Start)),c=Object(ee.x)(e.End,Object(ee.Xb)(e.Start));return function(e,t,n,r){var a=[];return r.forEach((function(r){var i={};It(i,e),i.Start=Object(ee.h)(r,t),i.End=Object(ee.h)(r,n),i.CalendarItemType="Occurrence",a.push(i)})),a}(e,o,c,a)}function mt(e,t,n){for(var r=[],a=Object(ee.s)(t.end,t.start),i=0;i<=a;i+=n){var o=Object(ee.e)(t.start,i);r.push(o)}return r}function ht(e,t,n){for(var r=[],a=e.Recurrence.RecurrencePattern,i=a.DaysOfWeek.split(" ").map((function(e){return Et(e)})),o=Math.max(Et(a.FirstDayOfWeek),0),c=t.start;Object(ee.p)(c,t.end)<=0;){for(var u=c,d=Object(ee.C)(u,o);Object(ee.p)(u,d)<=0;)i.includes(Object(ee.ob)(u))&&Object(z.s)(t,u)&&r.push(u),u=Object(ee.e)(u,1);c=Object(ee.bc)(Object(ee.e)(c,7*n),o)}return r}function gt(e,t,n){var r=[];if(Object(jt.b)(e.Recurrence))for(var a=(u=e.Recurrence.RecurrencePattern).DayOfMonth,i=t.start;Object(ee.p)(i,t.end)<=0;){for(var o=i,c=Object(ee.B)(o);Object(ee.p)(o,c)<=0;)Object(ee.mb)(o)==a&&Object(z.s)(t,o)&&r.push(o),o=Object(ee.e)(o,1);i=Object(ee.ac)(Object(ee.i)(i,n))}else{var u,d=Et((u=e.Recurrence.RecurrencePattern).DaysOfWeek),s=-1;switch(u.DayOfWeekIndex){case"First":s=1;break;case"Second":s=2;break;case"Third":s=3;break;case"Fourth":s=4}for(i=t.start;Object(ee.p)(i,t.end)<=0;){var l=void 0;l=s>0?_t(d,s,i):yt(d,i),Object(z.s)(t,l)&&r.push(l),i=Object(ee.ac)(Object(ee.i)(i,n))}}return r}function Et(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e)}function _t(e,t,n){var r=Object(ee.ac)(n),a=(e-Object(ee.ob)(r)+7)%7+7*(t-1);return Object(ee.e)(r,a)}function yt(e,t){var n=_t(e,5,t);return Object(ee.yb)(n)==Object(ee.yb)(t)?n:_t(e,4,t)}function Ct(e,t){if(t){var n=e.ParentFolderId.Id;e.Recurrence?m(n,(function(t){return t.InstanceKey==e.InstanceKey})):m(n,(function(t){return t.ItemId.Id===e.ItemId.Id}))}}Object(i.orchestrator)(q,(function(e){return Object(U.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o,c,u,d,s,l,f,b;return Object(U.__generator)(this,(function(v){switch(v.label){case 0:t=e.eventToCreate,n=e.actionToExecute,a=e.actionSource,i=e.onEventCreatedFailed,o=e.onEventCreatedSuccess,c=e.errorMessage,u=e.onEventCreatedLocally,O=t,d=Object(r.h)(O.ParentFolderId.Id),function(e,t,n,a){if(t){var i=e.ParentFolderId.Id;if(e.Recurrence){var o=Object(r.d)(i),c=pt(e,o);Object(ue.a)(c.concat(e),!1);var u=c.map((function(e){return Object(U.__assign)(Object(U.__assign)({},e),{CalendarItemType:"Occurrence"})}));j(i,u)}else Object(ue.b)(e),j(i,[e])}n(a)}(t,d,u,a),s=function(){return q(t,n,(function(){return i(c,null,a)}),o,a,c)},l=null,v.label=1;case 1:return v.trys.push([1,3,,4]),[4,n(t)];case 2:return l=v.sent(),[3,4];case 3:throw f=v.sent(),Ct(t,d),i(f,s,a),f;case 4:if(b=null,!l.isSuccessful)throw Ct(t,d),i(c,s,a),c;return b=l.createdItem,function(e,t,n){t.ParentFolderId||(t.ParentFolderId=Object(U.__assign)({},e.ParentFolderId));if(n){if(t.Recurrence)return;var r=t.ParentFolderId.Id;m(r,(function(t){return t.ItemId.Id===e.ItemId.Id})),Ve(t,!0,!1)}}(t,b,d),o(b),[2]}var O}))}))}));var wt=n(316);function St(e,t){var n={Key:e,Start:t.Start,End:t.End};return wt(t,n),t}var xt=n(1113),Rt=n(1132);var Tt=n(12),At=n(1329);function Pt(e,t){return void 0===t&&(t=!1),t?Ft(e):Object(At.c)(e)}function Ft(e){var t;return null===(t=e.SeriesMasterItemId)||void 0===t?void 0:t.Id}var kt=n(316);function Mt(e){if(e){var t=Object(Rt.a)();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,Object(se.f)())}}function Dt(e){var t,n;if((n=e).Key&&void 0!==n.Start&&void 0!==n.End){e.Key;e=Object(U.__rest)(e,["Key"])}var r=Pt(e),a=null===(t=e.ParentFolderId)||void 0===t?void 0:t.Id;if(a){var i=Object(H.c)(r,a);i&&Object(se.q)(i,e)}}Object(i.mutator)(g,(function(e){var t=e.lockId,n=Object(Rt.a)();Object(U.__spread)(n.calendarFolderEvents.keys()).forEach((function(e){n.calendarFolderEvents.get(e).locksInfo.get(t)&&Object(se.n)(t,n.calendarFolderEvents.get(e))})),n.fullItemsMruMap.delete(t)})),Object(i.mutator)(d,(function(e){var t=e.folderId,n=e.eventKey,r=e.event,a=Object(H.c)(n,t);a&&Object(se.q)(a,r,!0)})),Object(i.mutator)(l,(function(e){Dt(e.partialCalendarEvent)})),Object(i.mutator)(f,(function(e){Dt(e.event)})),Object(i.mutator)(C,(function(e){var t=e.lockId,n=e.folderId,a=e.dateRange,i=e.calendarEvents;Mt(n);var o=Object(r.f)(n),c=Object(xt.a)(),u=i.filter((function(e){return!Object(Q.I)(e.CalendarItemType)})).map((function(e){return St(e.ItemId.Id,e)})).filter((function(e){return!c[e.Key]}));Object(se.b)(a,u,t,o);var d=o.locksInfo.get(t).lockedDateRange,s=Object(ee.s)(d.end,d.start),l=Object(Tt.f)()?42:110;if(s>l){var f=function(e,t,n){var r=Object(ee.s)(t.end,t.start);if(r===n)return t;if(r>n)return{start:t.start,end:Object(ee.e)(t.start,n)};var a=n-r,i=Math.abs(Object(ee.s)(t.end,e.end)),o=Math.abs(Object(ee.s)(e.start,t.start)),c=t.start,u=t.end;if(i>0){var d=Math.min(a,i);u=Object(ee.e)(u,d),a-=d}if(a>0&&o>0){var s=Math.min(a,o);c=Object(ee.e)(c,-1*s)}return{start:c,end:u}}(d,a,l);Object(se.h)(f,t,o)}})),Object(i.mutator)(p,(function(e){var t=e.folderId,n=e.instanceKey,a=e.onEventsRemoved;Mt(t);var i=Object(r.f)(t);a(Object(se.o)((function(e){return e.InstanceKey===n}),i))})),Object(i.mutator)(h,(function(e){var t=e.folderId,n=e.predicate,a=e.onEventsRemoved;Mt(t);var i=Object(r.f)(t);a(Object(se.o)(n,i))})),Object(i.mutator)(w,(function(e){var t=e.folderId;Object(Rt.a)().calendarFolderEvents.delete(t)})),Object(i.mutator)(O,(function(e){var t=e.folderId,n=e.calendarEvents,a=e.forceReplace;Mt(t);var i=n.map((function(e){return St(e.ItemId.Id,e)})),o=Object(r.f)(t);a?Object(se.p)(i,o):Object(se.r)(i,o.events)})),Object(i.mutator)(x,(function(e){kt(e.existingItem,e.updatedItem)}));var Nt=new Map;var Lt=5;function Gt(e,t,n,r){qt(t,n);var a=e.eventKey,i=n.get(t),o=i.eventInfos,c=Object(U.__read)(o.filter((function(e){return e.eventKey===a})),1)[0];c?Kt(i.eventInfos.indexOf(c),e,i):(o.push(e),function(e,t){!function(e,t,n){for(;e.eventInfos.length>t&&0<e.eventInfos.length;)Vt(0,e,n)}(e,e.maxSize||Lt,t)}(i,r));Object(U.__spread)(n.keys()).forEach((function(t){n.get(t).eventInfos.forEach((function(t){e.eventKey===t.eventKey&&(t.itemResponseShapeType=e.itemResponseShapeType)}))}))}function Bt(e,t,n,r){void 0===r&&(r=function(){}),qt(t,n);var a=n.get(t),i=Object(U.__read)(a.eventInfos.filter((function(t){return t.eventKey===e})),1)[0],o=a.eventInfos.indexOf(i);return-1!==o&&Vt(o,a,r),-1!==o}function qt(e,t){if(!t.get(e)){var n=function(e){return Nt.get(e)}(e);t.set(e,{eventInfos:[],maxSize:n})}}function Kt(e,t,n){if(-1===e)throw new Error("Item with eventKey "+t.eventKey+" does not exist in the MRU");n.eventInfos.splice(e,1),n.eventInfos.push(t)}function Vt(e,t,n){if(e<0||e>=t.eventInfos.length)throw new Error("Invalid index to remove "+e);var r=t.eventInfos[e];t.eventInfos.splice(e,1),n(r.eventKey)}function Ut(e){if(e){var t=Object(Rt.a)();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,Object(se.f)())}}function zt(e,t){return function(n){Object(se.i)([n],e,Object(Rt.a)().calendarFolderEvents.get(t))}}Object(i.mutator)(o,(function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,a=e.partialCalendarEvent,i=e.itemResponseShapeType;Ut(n);var o=Object(Rt.a)();if(a){var c=St(t,a);Object(se.a)(c,r,o.calendarFolderEvents.get(n))}Gt({eventKey:t,itemResponseShapeType:i,folderId:n,loadState:0},r,o.fullItemsMruMap,zt(r,n))})),Object(i.mutator)(c,(function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,a=e.itemResponseShapeType;Ut(n),Gt({eventKey:t,itemResponseShapeType:a,folderId:n,loadState:2},r,Object(Rt.a)().fullItemsMruMap,zt(r,n))})),Object(i.mutator)(u,(function(e){var t=e.lockId,n=e.eventKey,r=e.folderId,a=e.event,i=e.hasEventChanged,o=e.itemResponseShapeType,c=e.forceOverrideAllPropertiesForEventIfAvailable;Ut(r);var u=Object(Rt.a)(),d=St(n,a);Object(se.a)(d,t,u.calendarFolderEvents.get(r),i,c),Gt({eventKey:n,itemResponseShapeType:o,folderId:r,loadState:1},t,u.fullItemsMruMap,zt(t,r))})),Object(i.mutator)(b,(function(e){var t=e.folderId,n=e.eventKey,r=Object(Rt.a)();r.calendarFolderEvents.get(t)&&Object(U.__spread)(r.fullItemsMruMap.keys()).forEach((function(e){Bt(n,e,r.fullItemsMruMap)}))})),Object(i.mutator)(v,(function(e){var t=e.folderId,n=Object(Rt.a)(),r=n.calendarFolderEvents.get(t);if(r){var a=Object(U.__spread)(r.locksInfo.entries()).reduce(Object(se.d)(),{}),i=Object.keys(a);Object(U.__spread)(n.fullItemsMruMap.keys()).forEach((function(e){i.forEach((function(t){return Bt(t,e,n.fullItemsMruMap)}))}))}})),Object(i.mutator)(ze,(function(){var e=Object(Rt.a)();Object(U.__spread)(e.fullItemsMruMap.keys()).forEach((function(t){!function(e,t){qt(e,t),t.get(e).eventInfos=[]}(t,e.fullItemsMruMap)}))})),Object(i.mutator)(S,(function(e){var t=Object(Rt.a)(),n=e.lockId;!function(e,t,n){qt(t,n);var r=n.get(t),a=r.eventInfos,i=Object(U.__read)(a.filter((function(t){return t.eventKey===e})),1)[0];i&&Kt(r.eventInfos.indexOf(i),i,r)}(e.eventKey,n,t.fullItemsMruMap)}));var Wt=n(608);function Ht(e,t){var n;if(3==t){var r=Object(H.b)(e);n=(null==r?void 0:r.SeriesMasterItemId)?Object(te.a)({Id:r.SeriesMasterItemId.Id}):n=Object(Wt.a)({OccurrenceId:e})}else n=Object(te.a)({Id:e});return n}function Jt(e,t){t&&Ue(e.ParentFolderId.Id)}Object(i.orchestrator)(V,(function(e){return Object(U.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o,c,u,d,s,l,f,b,v,O,j;return Object(U.__generator)(this,(function(I){switch(I.label){case 0:t=e.eventId,n=e.eventScope,a=e.dataPoint,i=e.actionToExecute,o=e.onEventDeleteSuccess,c=e.onEventDeleteFailed,u=e.responseSent,d=e.actionSource,s=e.errorMessage,l=e.asyncUndoAction,f=Object(H.b)(t.Id),b=(p=f)&&Object(r.h)(p.ParentFolderId.Id),function(e,t,n){if(n){var r=e.ParentFolderId.Id;if(3==t||2==t){var a=e.Start;m(r,(function(n){return n.InstanceKey==e.InstanceKey&&(3==t||2==t&&!Object(ee.Hb)(n.Start,a))}))}else m(r,(function(t){return t.ItemId.Id===e.ItemId.Id}))}}(f,n,b),a&&a.markUserPerceivedTime(),v=Ht(t.Id,n),null,I.label=1;case 1:return I.trys.push([1,4,,5]),[4,l(f,u,d)];case 2:return I.sent()?(Jt(f,b),[2]):[4,i(v)];case 3:if(!I.sent().isSuccessful)throw new Error(s);return[3,5];case 4:throw O=I.sent(),Jt(f,b),j=function(){return V(t,n,null,i,o,(function(){return c(O,null,d)}),d,s,u)},c(O,j,d),O;case 5:return o(),[2]}var p}))}))}));var Yt=n(1506),Qt=n(1507),Zt=(Object(i.orchestrator)(s,(function(e){return Object(U.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a,i,o;return Object(U.__generator)(this,(function(c){switch(c.label){case 0:return t=e.partialCalendarEvent,n=Pt(t),r=t.ParentFolderId.Id,null===Object(xt.f)(t.ItemId.Id)?[3,2]:(a=Object(xt.b)(t.ItemId.Id),i=Object(Qt.a)(a),[4,Object(Yt.a)(t.ItemId,r,i)]);case 1:(o=c.sent().calendarEvent)&&d(r,n,a,o),c.label=2;case 2:return[2]}}))}))})),n(239));Object(i.orchestrator)(K,(function(e){return Object(U.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o,c,u,d,s,l,f,b,v,O,I,p;return Object(U.__generator)(this,(function(h){switch(h.label){case 0:t=e.eventId,n=e.eventChanges,a=e.errorMessage,i=e.actionToExecute,o=e.onEventUpdateFailed,c=e.onEventUpdateSuccess,u=e.onEventUpdatedLocally,d=e.actionSource,s=e.eventScope,l=Object(H.b)(t.Id),f=Ht(t.Id,e.eventScope),l&&Object(Q.I)(l.CalendarItemType)&&(s=3),(b=function(e,t){if(!e)return!1;var n=e.ParentFolderId.Id;if(!Object(r.h)(n))return!1;var a=t.ParentFolderId;if(a&&a.Id!=n)return!1;return!0}(l,n))&&function(e,t,n,a,i){var o,c,u=e.ParentFolderId.Id;!Object(Q.F)(e.CalendarItemType)||0!=n&&1!=n||(t.CalendarItemType="Exception");var d=Object(U.__assign)(Object(U.__assign)({},e),t);if(3==n||2==n)if(t.Recurrence||t.Start||t.StartTimeZoneId||t.End||t.EndTimeZoneId||2==n){var s=e.Start;if(m(u,(function(t){return(Object(Q.F)(t.CalendarItemType)||Object(Q.z)(t.CalendarItemType))&&t.InstanceKey==e.InstanceKey&&(3==n||2==n&&!Object(ee.Hb)(t.Start,s))})),3===n||2===n){var l=Object(r.d)(u);2===n&&(E=l,_=e.Start,y=[],E.forEach((function(e,t){Object(ee.p)(e.start,_)<=0&&Object(ee.p)(e.end,_)<=0&&y.push(t),Object(ee.p)(e.start,_)<=0&&Object(ee.p)(e.end,_)>0&&(e.start=Object(ee.Xb)(_))})),y.reverse().forEach((function(e){E.splice(e,1)})));var f=d;"Occurrence"!=d.CalendarItemType||d.Recurrence||(f=Object(H.b)(d.SeriesMasterItemId.Id))||(f=d);var b=pt(f,l),v=2===n;Object(ue.a)(b.concat(d),v),delete t.Start,delete t.End;var O=b.map((function(e){return Object(U.__assign)(Object(U.__assign)(Object(U.__assign)({},e),t),{CalendarItemType:"Occurrence"})}));j(d.ParentFolderId.Id,O)}}else{var I=Object(H.a)(u,(function(t){return t.InstanceKey==e.InstanceKey&&Object(Q.F)(t.CalendarItemType)}));try{for(var p=Object(U.__values)(I),h=p.next();!h.done;h=p.next()){var g=h.value;x(g,t),D(g)}}catch(e){o={error:e}}finally{try{h&&!h.done&&(c=p.return)&&c.call(p)}finally{if(o)throw o.error}}}var E,_,y;if(!Object(Q.z)(e.CalendarItemType)||3!=n){var C=null==e.InstanceKey||Object(Q.F)(e.CalendarItemType)||Object(Q.z)(e.CalendarItemType);Ve(d,C,!0)}a(d,i)}(l,n,s,u,d),v=function(){return K(t,n,s,i,c,(function(){return o(a,null,d)}),d,a)},O=null,h.label=1;case 1:return h.trys.push([1,3,,4]),[4,i(f)];case 2:return O=h.sent(),[3,4];case 3:throw I=h.sent(),b&&Ue(l.ParentFolderId.Id),o(I,v,d),I;case 4:if(!O.isSuccessful)throw b&&Ue(l.ParentFolderId.Id),o(a,v,d),a;return(null===(p=n.ParentFolderId)||void 0===p?void 0:p.mailboxInfo)&&Object(Zt.p)(n.ParentFolderId.mailboxInfo.userIdentity)&&(Ue(n.ParentFolderId.Id,!0),Ue(l.ParentFolderId.Id,!0)),c(),[2]}}))}))}));var Xt=n(159),$t=(Object(i.orchestrator)(Xt.l,We),n(115));function en(e){var t=Object(Y.u)(e),n=t&&Object(Y.p)({id:t});return n?n.CharmId:null}function tn(e){return(null==e?void 0:e.CharmId)||en(e.ParentFolderId.Id)}function nn(){Object(r.b)().map((function(e){Object(Se.e)(Object(Y.o)(e))&&Ke(e,!0)}))}var rn=3e5;function an(e){e?Object(He.b)(nn,"RELOAD_LINKEDCALENDAR_ENTRIES",rn):Object(He.a)("RELOAD_LINKEDCALENDAR_ENTRIES")}function on(e,t,n){return{FreeBusyType:"Decline"===n?"Free":"Free"===e&&"Decline"!==t?"Free":"Accept"===n?"Busy":"Tentative",AppointmentReplyTime:Object(ee.Qb)(),ResponseType:n}}var cn=n(314),un=n(1887),dn=n(23),sn={};function ln(e,t){return e+t}function fn(e,t){var n=ln(e,t);return sn[n]||Promise.resolve({calendarEvent:null,error:"Could not find full event promise in existing promises"})}function bn(e,t,n,r,a,i){var o,c,u;void 0===n&&(n=null),void 0===a&&(a={fetchSource:"unknown"});var d=On(n,r);i||(i=Object(xt.b)(t.Id));var s,l=Object(xt.e)(t.Id,i);if(l)s=function(e,t,n,r,a,i){var o=a(t);switch(n.loadState){case 1:return{event:o,fullEventPromise:Promise.resolve({calendarEvent:o,error:null}),promiseSource:2};case 0:return{event:o,fullEventPromise:fn(t.Id,i),promiseSource:0};case 2:var c=In(o,t,r,e,i);return Object(U.__assign)({event:o},c);default:return Object(cn.a)(n.loadState)}}(n=n||l.folderId,t,l,!1,d,i);else{var f=d(t),b=In(f,t,!1,n||(null===(o=null==f?void 0:f.ParentFolderId)||void 0===o?void 0:o.Id)||null,i);s=Object(U.__assign)({event:f},b)}var v=null;return s&&(n=n||(null===(u=null===(c=s.event)||void 0===c?void 0:c.ParentFolderId)||void 0===u?void 0:u.Id)||null,v={event:s.event,fullEventPromise:pn(s.fullEventPromise,s.promiseSource,s.event,e,n,a,t.Id,!1,i)}),v}function vn(e,t,n,r,a,i){var o,c,u;void 0===n&&(n=null),void 0===a&&(a={fetchSource:"unknown"});var d,s=On(n,r)(t);n=n||(null===(o=null==s?void 0:s.ParentFolderId)||void 0===o?void 0:o.Id);var l=s&&Ft(s);i||(i=l?Object(xt.b)(l):Object(xt.c)());var f=null;return(d=function(e,t,n,r,a){var i=r&&Object(xt.e)(r,n);if(i&&1===i.loadState){var o=Object(H.c)(r,e);return{event:o,fullEventPromise:Promise.resolve({calendarEvent:o,error:null}),promiseSource:2}}return i&&0===i.loadState?{event:Object(H.c)(r,e)||jn(a),fullEventPromise:fn(r,n),promiseSource:0}:{event:jn(a),fullEventPromise:mn(t,!0,e,n),promiseSource:0}}(n,t,i,l,s))&&(n=n||(null===(u=null===(c=d.event)||void 0===c?void 0:c.ParentFolderId)||void 0===u?void 0:u.Id)||null,f={event:d.event,fullEventPromise:pn(d.fullEventPromise,d.promiseSource,d.event,e,n,a,l,!0,i)}),f}function On(e,t){return function(n){return Object(H.b)(n.Id,e)||(null==t?void 0:t(n))}}function jn(e){return e&&Object(U.__assign)(Object(U.__assign)({},Object(un.a)(Object(dn.toJS)(e))),{ItemId:Object(U.__assign)({},null==e?void 0:e.SeriesMasterItemId),CalendarItemType:"RecurringMaster"})}function In(e,t,n,r,a){return e&&e.EffectiveRights&&!Object(Q.v)(e)?{fullEventPromise:Promise.resolve({calendarEvent:e,error:null}),promiseSource:1}:{fullEventPromise:mn(t,n,r,a),promiseSource:0}}function pn(e,t,n,r,a,i,d,s,l){return Object(U.__awaiter)(this,void 0,void 0,(function(){var f,b,v,O,j,I,p,m,h,g;return Object(U.__generator)(this,(function(E){switch(E.label){case 0:f=Object(xt.d)(r,d,l),b=null,v=null,O=null,E.label=1;case 1:return E.trys.push([1,5,6,7]),we.g.info("[fetchFullCalendarEvent] Handling loading full calendar event Key: "+d+", Lock: "+r),!a||f&&1===f.loadState||d&&(we.g.info("[fetchFullCalendarEvent] Loading full calendar event Key: "+d+", Lock: "+r),function(e,t,n){var r=ln(e,t);sn[r]=n}(d,l,e),o(r,a,d,l,n)),2!=t?[3,2]:(b=n,[3,4]);case 2:return[4,e];case 3:j=E.sent(),b=null==j?void 0:j.calendarEvent,v=null==j?void 0:j.error,O=null==j?void 0:j.responseCode,void 0===d&&(d=Pt(j.calendarEvent)),E.label=4;case 4:if(!b)throw I=new Error("[fetchFullCalendarEvent] Action source:"+i.fetchSource+" with error: "+v),O&&(I.responseCode=O,I.fetchErrorType="ServerFailure"),I.diagnosticInfo=JSON.stringify({responseCode:O,eventKey:d}),I;return p=a||b.ParentFolderId.Id,g=f,f=Object(xt.d)(r,d,l),!p||f&&1===f.loadState?(we.g.info('[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "'+d+'", Lock: "'+r+'", FolderId: "'+p+'"'),S(r,d)):(we.g.info('[fetchFullCalendarEvent] Loaded full calendar event Key: "'+d+'", Lock: "'+r+'", FolderId: "'+p+'"'),Object(J.o)("FullCalendarEventLoaded",Object(U.__assign)({eventKey:d,lockId:r,prevFullItemLoadState:g?g.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:void 0!==b.RequiredAttendees,isSameAsExistingEvent:n===b,eventScope:s?3:0,errorMessage:null},i)),u(r,p,d,l,b,s,0===t)),(m=Object(H.c)(d,a))&&D(m),[2,m];case 5:throw h=E.sent(),g=f,f=Object(xt.d)(r,d,l),Object(J.o)("FullCalendarEventLoaded",Object(U.__assign)({eventKey:d,lockId:r,prevFullItemLoadState:g?g.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1,eventScope:s?3:0,errorMessage:h.toString()},i)),a&&c(r,a,d,l),h;case 6:return function(e,t){var n=ln(e,t);delete sn[n]}(d,l),[7];case 7:return[2]}}))}))}function mn(e,t,n,r){var a=this;return Object(U.__awaiter)(a,void 0,void 0,(function(){return Object(U.__generator)(this,(function(a){switch(a.label){case 0:return[4,hn(fe,e,t,n,r)];case 1:return[2,a.sent()]}}))}))}function hn(e,t,n,r,a){return Object(U.__awaiter)(this,void 0,void 0,(function(){var i,o,c;return Object(U.__generator)(this,(function(u){switch(u.label){case 0:i=0,u.label=1;case 1:if(!(i<e))return[3,6];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,Object(Yt.a)(t,r,Object(Qt.a)(a),n)];case 3:return o=u.sent(),i++,!o.error||i>=e?[2,o]:[3,5];case 4:if(c=u.sent(),we.g.warn('[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "'+t.Id+'" with try '+i+": Error "+c.toString()),++i>=e)throw c;return[3,5];case 5:return[3,1];case 6:return[2,{calendarEvent:null,error:"Error: Unable to fetch event"}]}}))}))}function gn(e){var t=this;if(!e)throw new Error("The lock id should be provided");return{fetchCalendarEventsForDateRange:function(t,n){var r=Le(e,t,n);return{fetchPromise:r.fetchPromise,enhancedFetchPromise:r.enhancedFetchPromise,events:r.events}},subscribeNotifications:function(t){return rt(t,e)},fetchFullCalendarEvent:function(n,r,a,i,o){var c=Object(H.b)(n.Id),u=En(e,n,r,a,i,o,(null==c?void 0:c.IsOrganizer)?"WithBlockedExternalContent":null),d=u.event,s=u.fullEventPromise;return s=s.then((function(c){return Object(U.__awaiter)(t,void 0,void 0,(function(){return Object(U.__generator)(this,(function(t){switch(t.label){case 0:return c.IsOrganizer&&c.HasBlockedImages?[4,En(e,n,r,a,i,o,"WithBlockedExternalContent").fullEventPromise]:[3,2];case 1:c=t.sent(),t.label=2;case 2:return[2,c]}}))}))})),{event:d,fullEventPromise:s}},fetchFullCalendarEventAndUpdateItemResponseShapeType:function(t,n,r,a,i,o){return En(e,t,r,a,i,o,n)},getLockId:function(){return e},release:function(){return E(e)}}}function En(e,t,n,r,a,i,o){return a?vn(e,t,n,r,i,o):bn(e,t,n,r,i,o)}function _n(e,t){var n=Object(se.g)(e);return t&&function(e,t){t?Nt.set(e,t):Nt.delete(e)}(n,t.maxMruSize),gn(n)}function yn(e){return{getCalendarEventsForDateRange:function(t,n){return le(e,t,n)},getEnhancedCalendarEventsForDateRange:function(t,n){return function(e,t,n){return Fe(t,n)?le(e,t,n):null}(e,t,n)},getFullCalendarEvent:function(t,n){return Object(H.d)(t,n,e)}}}n.d(t,"s",(function(){return wn})),n.d(t,"j",(function(){return H.b})),n.d(t,"c",(function(){return k})),n.d(t,"b",(function(){return M})),n.d(t,"a",(function(){return D})),n.d(t,"d",(function(){return N})),n.d(t,"f",(function(){return G})),n.d(t,"t",(function(){return B})),n.d(t,"p",(function(){return q})),n.d(t,"r",(function(){return K})),n.d(t,"q",(function(){return V})),n.d(t,"v",(function(){return bt})),n.d(t,"w",(function(){return ft})),n.d(t,"h",(function(){return en})),n.d(t,"k",(function(){return tn})),n.d(t,"m",(function(){return Ht})),n.d(t,"l",(function(){return xt.f})),n.d(t,"u",(function(){return an})),n.d(t,"i",(function(){return on})),n.d(t,"g",(function(){return ie})),n.d(t,"e",(function(){return _n})),n.d(t,"o",(function(){return gn})),n.d(t,"n",(function(){return yn}));var Cn=new $t.c((function(){return Promise.all([n.e(4),n.e(262)]).then(n.bind(null,15842))})),wn=new $t.a(Cn,(function(e){return e.getCalendarEventsFromRest}))}}]);
//# sourceMappingURL=owa.UpNextV2.js.map
self.scriptsLoaded['owa.UpNextV2.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.UpNextV2.js'] = (new Date()).getTime();