self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.38.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[38],{1033:function(r,c,t){"use strict";t.d(c,"d",(function(){return _})),t.d(c,"a",(function(){return n})),t.d(c,"c",(function(){return s})),t.d(c,"b",(function(){return p}));var e=t(1159);function _(r,c){if(null==r&&null!=c||null!=r&&null==c)return!1;if(null==r&&null==c)return!0;if(0==r.length&&0==c.length)return!0;if(r.length!=c.length)return!1;for(var t=0;t<r.length;){if(!a(r[t],c[t]))return!1;t++}return!0}function a(r,c){return!(!r&&c||r&&!c)&&(r.Id===c.Id||Object(e.a)(r.PostalAddress)&&Object(e.a)(c.PostalAddress)&&r.PostalAddress.LocationUri.toLowerCase()===c.PostalAddress.LocationUri.toLowerCase())}function n(r,c){return r&&Object(e.a)(c.PostalAddress)?s(r,c.PostalAddress.LocationUri):p(r,c.Id)}function s(r,c){return!!(c&&r&&r.some((function(r){return Object(e.a)(r.PostalAddress)&&r.PostalAddress.LocationUri.toLowerCase()===c.toLowerCase()})))}function p(r,c){return r&&r.some((function(r){return r.Id===c}))}},1095:function(r,c,t){"use strict";var e=/\(([^)]*)\)/gi,_=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,a=/\s+/gi;function n(r){var c="";if(!r)return c;var t=(r=(r=(r=(r=r.replace(e,"")).replace(_,"")).replace(a," ")).trim()).split(" ");return t.length>=2?(c+=t[0].charAt(0).toUpperCase(),c+=t[t.length-1].charAt(0).toUpperCase()):0!=t.length&&(c+=t[0].charAt(0).toUpperCase()),c}var s=t(981),p=Object.keys(s.a).length/2;function o(r){if(!r)return null;for(var c=0,t=r.length-1;t>=0;t--){var e=r.charCodeAt(t),_=t%8;c^=(e<<_)+(e>>8-_)}return c%p}function i(r){return{personaId:r,displayName:r,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:n(r),textBoyColor:o(r),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:r}}var u=t(1155),d=t(123);function l(r){var c;if(r){var t=function(r){return r?null!=r.HomeAddressesArray&&r.HomeAddressesArray.length>0?r.HomeAddressesArray[0].Value:null!=r.BusinessAddressesArray&&r.BusinessAddressesArray.length>0?r.BusinessAddressesArray[0].Value:null!=r.OtherAddressesArray&&r.OtherAddressesArray.length>0?r.OtherAddressesArray[0].Value:null:null}(r),e=Object(u.c)(r.DisplayName,t);return"Room"==r.PersonaTypeString&&(t.LocationUri=r.EmailAddress.EmailAddress),{personaId:null===(c=r.PersonaId)||void 0===c?void 0:c.Id,feedbackId:r.FeedbackId,displayName:e,postalAddress:t,emailAddress:r.EmailAddress,displayAddress:Object(u.a)(t),initials:n(e),textBoyColor:o(e),selectionSource:"LocationWell",personaType:Object(d.b)(r.PersonaTypeString)?"Unknown":r.PersonaTypeString,personaControlId:null==r.PersonaId?r.FeedbackId:r.PersonaId.Id,availability:r.Availability,numberOfAvailableTimeSlots:r.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:r.TotalNumberOfTimeSlots,isPartialAvailability:r.IsPartialAvailability,capacity:r.Capacity,entityType:r.EntityType,audioDeviceName:r.AudioDeviceName,displayDeviceName:r.DisplayDeviceName,videoDeviceName:r.VideoDeviceName,isWheelChairAccessible:r.IsWheelChairAccessible}}return null}var y=t(1159);function f(r){if((null==r?void 0:r.DisplayName)&&r.PostalAddress){var c=Object(u.c)(r.DisplayName,r.PostalAddress),t=Object(y.a)(r.PostalAddress)&&!Object(d.b)(r.PostalAddress.LocationUri)?{EmailAddress:r.PostalAddress.LocationUri}:null;return{personaId:r.Id,displayName:r.DisplayName,postalAddress:r.PostalAddress,emailAddress:t,displayAddress:Object(u.a)(r.PostalAddress),initials:n(c),textBoyColor:o(c),personaType:Object(y.a)(r.PostalAddress)?"Room":"Unknown",personaControlId:r.DisplayName}}return null}var b=t(0),A=t(42),m=t(1),v=t(10),h=t(26),g=t(288),O=t(280),P=290,j=135;function L(r,c,t,e,_,a){_=_||P,a=a||j;var n=Object(h.a)();if((!Object(d.b)(t)||r&&c)&&n.PolicySettings.PlacesEnabled){var s=Object(v.c)("/OWS/beta/Location/locationmap?Latitude={0}&Longitude={1}&Address={2}&Culture={3}&Width={4}&Height={5}",r&&r.toString(),c&&c.toString(),encodeURIComponent(t),n.SessionSettings.UserCulture,_,a);Object(g.b)(s,void 0,!0).then((function(r){Object(O.a)(r.status)?r.json().then((function(r){e("data:image/png;base64,"+r.ib)})):e("")}))}else e("")}var w=t(1429),C=t(75),N=t(316),S=Object(A.a)((function(r){var c,t,e=m.useRef(),_=Object(b.__read)(m.useState(null),2),a=_[0],n=_[1];m.useEffect((function(){var c,t=!0;return(null===(c=r.locationPersona)||void 0===c?void 0:c.postalAddress)&&r.locationPersona.postalAddress.Latitude&&r.locationPersona.postalAddress.Longitude&&!Object(d.b)(r.locationPersona.displayName)&&!a&&"pending"!=e.current&&"failed"!=e.current&&(e.current="pending",L(r.locationPersona.postalAddress.Latitude,r.locationPersona.postalAddress.Longitude,null,(function(r){t&&(n(r),r?e.current="success":(e.current="failed",C.g.warn("getLocationPhoto.downloadLocationPhoto failed")))}),64,64)),function(){return t=!1}}),[null===(c=r.locationPersona.postalAddress)||void 0===c?void 0:c.Latitude,null===(t=r.locationPersona.postalAddress)||void 0===t?void 0:t.Longitude,r.locationPersona.displayName]);var p=r.locationPersona,o=r.className,i=r.size,u=r.showPersonaDetails;if(p){var l={};return Object(d.b)(a)?N(l,{imageInitials:p.initials,initialsColor:p.textBoyColor}):N(l,{imageUrl:a,imageShouldFadeIn:!1}),m.createElement(w.a,Object(b.__assign)({className:o,presence:s.b.none,hidePersonaDetails:!u,size:i,text:p.displayName,secondaryText:p.displayAddress},l))}return null})),k="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}&FORM=CalLoc",I="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}&FORM=CalLoc";function U(r,c,t,e){return r&&c?Object(v.c)(k,r.toString(),c.toString(),t,e):t?Object(v.c)(I,t,e):null}var D=t(1244),T=t(115);function z(r,c){return{Id:c,DisplayName:r,PostalAddress:{LocationSource:"Resource",LocationUri:c,Type:"Business"}}}var B=t(1033);function F(r){return{EmailAddress:r.PostalAddress.LocationUri,Name:r.DisplayName}}function x(r){return{Id:r,DisplayName:r,PostalAddress:{Type:"Business",LocationSource:"None"}}}function E(r,c,t,e){return r?{PostalAddress:{LocationUri:t,LocationSource:e,Type:c,Street:r.streetAddress,City:r.addressLocality,State:r.addressRegion,Country:r.addressCountry,PostalCode:r.postalCode,PostOfficeBox:r.postOfficeBoxNumber,Longitude:r.longitude,Latitude:r.latitude}}:null}function R(r){return!Object(D.a)(r.PostalAddress)&&/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&//=]*)/i.test(r.DisplayName)}function W(r){return function(){var c=/^http*/i.test(r)?r:"//"+r;window.open(c,"_blank")}}function H(r){var c=[];return r&&"string"!=typeof r&&c.push({Id:r.personaId,DisplayName:r.displayName,PostalAddress:r.postalAddress}),c}t(1421);t.d(c,"r",(function(){return q})),t.d(c,"k",(function(){return i})),t.d(c,"j",(function(){return l})),t.d(c,"i",(function(){return f})),t.d(c,"a",(function(){return S})),t.d(c,"l",(function(){return U})),t.d(c,"m",(function(){return L})),t.d(c,"o",(function(){return D.a})),t.d(c,"p",(function(){return y.a})),t.d(c,"e",(function(){return z})),t.d(c,"b",(function(){return B.a})),t.d(c,"c",(function(){return B.b})),t.d(c,"d",(function(){return B.c})),t.d(c,"n",(function(){return F})),t.d(c,"f",(function(){return x})),t.d(c,"g",(function(){return E})),t.d(c,"s",(function(){return W})),t.d(c,"q",(function(){return R})),t.d(c,"h",(function(){return H}));var V=new T.c((function(){return t.e(1202).then(t.bind(null,15929))})),q=new T.b(V,(function(r){return r.createTxpPostalAddressFromLocationPersona}))},1155:function(r,c,t){"use strict";var e=t(26),_=t(123),a="en-us",n={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","sw-ke":"a_c_pc_pr_ctry","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};var s=", ";function p(r,c,t,e,a,n){var s=[];Object(_.b)(r)||(s[s.length]=r);var p="";return Object(_.b)(c)||(p=c),Object(_.b)(t)||(p=Object(_.b)(p)?t:p+n+t),Object(_.b)(e)||(p=Object(_.b)(p)?e:p+n+e),Object(_.b)(p)||(s[s.length]=p),Object(_.b)(a)||(s[s.length]=a),s}function o(r,c,t,o,i){var u=function(){var r=Object(e.a)(),c="";(null==r?void 0:r.SessionSettings)&&!Object(_.b)(r.SessionSettings.UserCulture)&&(c=r.SessionSettings.UserCulture.toLowerCase());var t=n[c];return null==t&&(t=n[a]),t}(),d=[],l=s;switch(u){case"a_c_pc_pr_ctry":d=p(r,c,t,o,i,l);break;case"a_c_pr_ctry_pc":d=p(r,c,o,i,t,l);break;case"a_c_pr_pc_ctry":d=p(r,c,o,t,i,l);break;case"a_ctry_c_pr_pc":d=p(r,i,c,o,t,l);break;case"a_pc_c_pr_ctry":d=p(r,t,c,o,i,l);break;case"a_pc_pr_c_ctry":d=p(r,t,o,c,i,l);break;case"c_a_pc_pr_ctry":d=p(c,r,t,o,i,l);break;case"ctry_pc_pr_c_a":d=p(i,t,o,c,r,l);break;case"ctry_pr_c_pc_a":d=p(i,o,c,t,r,l);break;case"pc_ctry_pr_c_a":d=p(t,i,o,c,r,l);break;case"pc_pr_c_a_ctry":d=p(t,o,c,r,i,l)}return d.join(l)}function i(r){return r?o(r.Street,r.City,r.PostalCode,r.State,r.Country):""}function u(r,c){return Object(_.b)(r)?i(c):r}var d=t(10);function l(r,c,t){var e=i(c);return Object(_.b)(r)?e:""==e||t?r:Object(d.c)("{0} ({1})",r,e)}t.d(c,"a",(function(){return i})),t.d(c,"b",(function(){return o})),t.d(c,"c",(function(){return u})),t.d(c,"d",(function(){return l}))},1159:function(r,c,t){"use strict";t.d(c,"a",(function(){return _}));var e=t(1244);function _(r){return Object(e.a)(r)&&"Resource"===r.LocationSource}},1244:function(r,c,t){"use strict";function e(r){return!!r&&(!!r.LocationUri||!(!r.Latitude||!r.Longitude))}t.d(c,"a",(function(){return e}))},1421:function(r,c,t){"use strict";function e(r){var c=[];return r&&r.forEach((function(r){c.push({Id:r.personaId,DisplayName:r.displayName,PostalAddress:r.postalAddress})})),c}t.d(c,"a",(function(){return e}))}}]);
//# sourceMappingURL=owa.38.js.map
self.scriptsLoaded['owa.38.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.38.js'] = (new Date()).getTime();