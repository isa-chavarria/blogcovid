self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[139,4,16,23,34,45,55],{1005:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1148);function i(e){return Object(r.a)().attachments.get(e.Id)}},1010:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(0),i=n(1849),o=n(2094),a=n(1540),c=n(254),u="EditorRibbonUsage";function s(e,t){for(var n,o=[],c=2;c<arguments.length;c++)o[c-2]=arguments[c];var u=a.Editor.prototype[t];return Object(i.b)(e,(function(e){n=u.call.apply(u,Object(r.__spread)([e],o))}),null),n}function l(e,t,n,a){var s;void 0===n&&(n=[]),void 0===a&&(a=n);var l=o[t];return Object(i.b)(e,(function(e){s=l.apply(void 0,Object(r.__spread)([e],n)),(null==a?void 0:a.length)>0&&Object(c.o)(u+t,Object(r.__spread)(a.map((function(e){return JSON.stringify(e)})),[e.isDarkMode()]))}),null),s}},1011:function(e,t,n){"use strict";function r(e){return t=e||"",(n=o.exec(t))&&n.length>1&&i[n[1].toLowerCase()];var t,n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},o=/^\s*([^;\s]*)(?:;|\s|$)/;function a(e){var t="";return Object.entries(i).forEach((function(n){n[1]===e&&(t=n[0])})),t}},1024:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"n",(function(){return a})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return h})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return m})),n.d(t,"q",(function(){return g})),n.d(t,"a",(function(){return O}));var r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",o="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange",u="Box",s="Dropbox",l="Facebook",d="GDrive",f="Mailbox",p="MailMessage",b="OneDriveConsumer",h="OneDrivePro",v="WopiBox",m="WopiDropbox",g="WopiEgnyte",O={providers:{BOX:u,DROPBOX:s,FACEBOOK:l,GDRIVE:d,MAILBOX:f,ONE_DRIVE_CONSUMER:b,ONE_DRIVE_PRO:h,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:v,WOPI_EGNYTE:g},attachmentTypes:{FILE_ATTACHMENT_TYPE:r,ITEM_ATTACHMENT_TYPE:i,ITEM_ID_ATTACHMENT_TYPE:o,REFERENCE_ATTACHMENT_TYPE:a,LINK_ATTACHMENT_TYPE:c}}},1029:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},e)}},1034:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return c}));var r="POST",i="cors",o="GET",a="PUT",c="PATCH"},1049:function(e,t,n){"use strict";n.d(t,"f",(function(){return l})),n.d(t,"n",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"m",(function(){return b})),n.d(t,"l",(function(){return h})),n.d(t,"k",(function(){return v})),n.d(t,"i",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"o",(function(){return O}));var r=n(115),i=n(1575);n.d(t,"p",(function(){return i.a}));var o=n(1148);n.d(t,"b",(function(){return o.a}));var a=n(1241);n.d(t,"c",(function(){return a.a}));var c=n(1333);n.d(t,"e",(function(){return c.a})),n.d(t,"d",(function(){return c.b}));var u=n(1024);n.d(t,"a",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(4),n.e(16),n.e(55),n.e(136)]).then(n.bind(null,3108))})),l=new r.a(s,(function(e){return e.addAndInitializeAttachments})),d=new r.a(s,(function(e){return e.setPreviewImageUrl})),f=new r.a(s,(function(e){return e.refreshDownloadUrl})),p=new r.a(s,(function(e){return e.createAttachmentInfo})),b=new r.a(s,(function(e){return e.setAttachmentInfo})),h=new r.a(s,(function(e){return e.refreshThumbnailImageUrl})),v=new r.a(s,(function(e){return e.refreshPreviewImageUrl})),m=new r.b(s,(function(e){return e.getAttachment})),g=new r.b(s,(function(e){return e.checkPendingAttachmentOperation})),O=new r.b(s,(function(e){return e.shouldShowImageView}))},1051:function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return p}));var r=n(4),i=Object(r.action)("reloadReadingPaneAfterClosingSxS"),o=Object(r.action)("onSxSReadingPaneChange",(function(e,t){return{readingPaneState:e,sxsId:t}})),a=Object(r.action)("onBeforeSxSReadingPaneChange",(function(e){return{id:e}})),c=Object(r.action)("onSxSChangeOrClose",(function(e,t){return{selectedLinkId:e,isSelectedLinkReadOnly:t}})),u=Object(r.action)("showSxS",(function(e,t,n,r,i,o,a){return{customization:e,extendedViewState:t,editState:n,selectedLinkId:r,sigsInfo:i,sxsId:o,displayMode:a}})),s=Object(r.action)("closeSxS"),l=Object(r.action)("onComposeStateChange",(function(e,t){return{composeId:e,sxsId:t}})),d=Object(r.action)("cloneSxSStore",(function(e,t){return{sxsId:e,newSxSId:t}})),f=Object(r.action)("onMainWindowSxSIdChange",(function(e){return{sxsId:e}})),p=Object(r.action)("onCustomizationChange",(function(e,t){return{customization:e,sxsId:t}}))},1070:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},1075:function(e,t,n){"use strict";var r=n(115),i=n(1142),o={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return o}));var a=new r.c((function(){return Promise.all([n.e(726),n.e(433)]).then(n.bind(null,15578))})),c=new r.a(a,(function(e){return e.subscribe})),u=new r.a(a,(function(e){return e.unsubscribe})),s=new r.b(a,(function(e){return e.getChannelId})),l=(new r.b(a,(function(e){return e.getChannelReady})),new r.a(a,(function(e){return e.setup}))),d=new r.a(a,(function(e){return e.initializeNotificationManager})),f=new r.b(a,(function(e){return e.getNotificationEmitter}));i.a},1077:function(e,t,n){"use strict";var r=n(1290),i=n(1070),o=n(1049);function a(e,t,n,a){if(Object(o.e)(n))return function(e){return 2===Object(o.c)(e)?s():c()}(n);if(3===Object(o.c)(n)&&!a)return u();var l;switch(t){case 2:l={allowEdit:!1,previewMethod:i.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:l={allowEdit:!1,previewMethod:i.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:l={allowEdit:!1,previewMethod:i.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:l={allowEdit:e.wacEdit,previewMethod:i.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:l={allowEdit:!1,previewMethod:i.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:l={allowEdit:!1,previewMethod:i.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:l=s();break;case 11:l={allowEdit:!1,previewMethod:i.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:l={allowEdit:!1,previewMethod:i.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:l={allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]};break;case 13:l={allowEdit:!1,previewMethod:i.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]};break;default:l=function(e){return e.__type===o.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||e.__type===o.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(n)?u():c()}return l}function c(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.Download]}}function u(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function s(){return{allowEdit:!1,previewMethod:i.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var l=n(284),d=(Object(l.action)("setPreviewLoaded")((function(e,t){e.previewLoaded=t})),Object(l.action)("setIsPlaceholderAttachment")((function(e,t){e.isPlaceholderAttachment=t}))),f=Object(l.action)("setThumbnailLoadState")((function(e,t){e.thumbnailLoadState=t}));function p(e,t,n,r,o,a){return void 0===a&&(a=null),{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:n,isReadOnly:t,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]},parentItemId:a,fileType:o}}var b=n(26);function h(){return Object(b.a)().SessionSettings.CompanyName}function v(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}n.d(t,"d",(function(){return a})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return i.a})),n.d(t,"a",(function(){return r.a}))},1084:function(e,t,n){"use strict";var r=n(994),i=n(980);function o(e){return e.map((function(e){return{fileType:r.a.Uri,name:e.name,type:Object(i.b)(e.url)||"",size:0,uri:e.url}}))}var a=n(75);function c(e,t,n){if(e.length!=t.length)return a.d("The sizes of subjects and latestItemIds are different"),null;for(var i=[],o=0;o<e.length;o++){var c={fileType:r.a.MailItem,name:e[o],size:(null==n?void 0:n[o])||0,itemId:t[o]};i.push(c)}return i}function u(e,t,n){var i=[],o={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return i.push(o),i}function s(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var i=e[n],o={fileType:r.a.Local,name:i.name,size:i.size,type:i.type,fileObject:i};t.push(o)}return t}function l(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function d(e){var t,n;return null===e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function f(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function b(e){switch(e?e.toLowerCase():null){case p.ONE_DRIVE_PRO.toLowerCase():return 0;case p.GDRIVE.toLowerCase():return 5;case p.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.DROPBOX.toLowerCase():return 2;case p.BOX.toLowerCase():return 3;case p.WOPI_BOX.toLowerCase():return 7;case p.WOPI_EGNYTE.toLowerCase():return 8;case p.MAILBOX.toLowerCase():return 4;case p.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"i",(function(){return o})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return r.a}))},1085:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},1089:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},1093:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(979),i=n(1011),o=n(61),a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function u(e,t,n){return void 0===n&&(n=!0),s(Object(r.a)(e)||Object(i.a)(t),n)}function s(e,t){return void 0===t&&(t=!0),!!e&&(a.indexOf(e.toLowerCase())>=0||t&&c.indexOf(e.toLowerCase())>=0&&(Object(o.e)()||Object(o.d)()||Object(o.h)()||Object(o.g)()&&!Object(o.l)()))}},1127:function(e,t,n){"use strict";var r,i=n(115),o=n(1237),a=n(1307),c=n(2309);!function(e){e.PasteHtml="PasteHtml",e.InsertLinkFromToolbar="InsertLinkFromToolbar",e.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",e.AutoLink="AutoLink",e.ReplyOrForward="ReplyOrForward",e.LinkContextMenu="LinkContextMenu",e.Undo="Undo",e.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",e.RestoreCursor="RestoreCursor",e.ShareLinkCompose="ShareLinkCompose",e.NewFluidFile="NewFluidFile",e.Unknown="Unknown"}(r||(r={}));var u=n(1879),s=n(1502),l=(n(2040),n(1359)),d=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function f(e){var t=Object(l.a)(e);return t&&-1!==d.indexOf(t.source)}var p=n(2126);function b(e){var t=Object(l.a)(e);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored,sharingRecipientsInfo:t.sharingRecipientsInfo,typeOfLink:f(e)?"newLink":"oldLink"}:null}var h=n(2169);function v(){return Object(h.a)().sharingLinks.size}var m=n(2310);n.d(t,"q",(function(){return O})),n.d(t,"u",(function(){return _})),n.d(t,"y",(function(){return w})),n.d(t,"w",(function(){return j})),n.d(t,"v",(function(){return y})),n.d(t,"t",(function(){return I})),n.d(t,"x",(function(){return S})),n.d(t,"s",(function(){return k})),n.d(t,"r",(function(){return C})),n.d(t,"B",(function(){return g})),n.d(t,"c",(function(){return o.a})),n.d(t,"d",(function(){return o.b})),n.d(t,"e",(function(){return o.c})),n.d(t,"g",(function(){return o.d})),n.d(t,"E",(function(){return o.g})),n.d(t,"z",(function(){return o.e})),n.d(t,"A",(function(){return o.f})),n.d(t,"F",(function(){return a.e})),n.d(t,"G",(function(){return a.f})),n.d(t,"H",(function(){return a.g})),n.d(t,"D",(function(){return a.c})),n.d(t,"f",(function(){return a.b})),n.d(t,"C",(function(){return c.b})),n.d(t,"a",(function(){return r})),n.d(t,"n",(function(){return u.a})),n.d(t,"h",(function(){return s.a})),n.d(t,"i",(function(){return s.b})),n.d(t,"p",(function(){return s.c})),n.d(t,"o",(function(){return f})),n.d(t,"b",(function(){return p.a})),n.d(t,"l",(function(){return l.a})),n.d(t,"k",(function(){return b})),n.d(t,"j",(function(){return v})),n.d(t,"m",(function(){return m.a}));var g=new i.c((function(){return Promise.all([n.e(4),n.e(16),n.e(45),n.e(369)]).then(n.bind(null,15560))})),O=new i.b(g,(function(e){return e.addRecipientsIntoLink})),_=new i.b(g,(function(e){return e.removeRecipientsFromLink})),w=new i.b(g,(function(e){return e.updateRecipientPermissionInfos})),j=new i.b(g,(function(e){return e.setGetPermissionInfoFailure})),y=new i.b(g,(function(e){return e.resetSharingRecipientsInfo})),I=new i.b(g,(function(e){return e.ignoreSharingTip})),S=new i.b(g,(function(e){return e.setLinkActionStatus})),k=new i.b(g,(function(e){return e.getSharingTipRecipientInfo})),C=new i.b(g,(function(e){return e.createCloudFileFromSharingLink}))},1129:function(e,t,n){"use strict";var r=n(2313),i=n(1747),o=n(2423),a=n(284);t.a=Object(a.action)("setOngoingActionAndActionMessage")((function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(o.a)(e)?Object(i.a)(e,!0):Object(i.a)(e,!1)}))},1137:function(e,t,n){"use strict";var r,i=n(980),o=n(1523),a=n(1093),c=n(1991);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.AccessDisabled=4]="AccessDisabled"}(r||(r={}));var u=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=r[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,i){e&&(e=e.toLowerCase());var o=this.getFileAccessLevel(e,t),u=!1,s=!1,l=!1,d="ReferenceAttachment:#Exchange"===i;o!==r.Block&&n&&(this.isWacViewingEnabled(e)&&(u=!0),!this.directFileAccessEnabled&&d&&(u=!1),s=this.isForceBrowserViewingFirst(u),u&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(l="FileAttachment:#Exchange"===i?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),u||Object(a.b)(e)||Object(c.a)(e)||this.directFileAccessEnabled||(o=r.AccessDisabled));return{directFileAccessEnabled:this.directFileAccessEnabled,level:o,useWac:u,forceBrowserViewingFirst:s,wacEdit:l}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=r.Undefined),n===r.Block)return r.Block;var i=this.mimeTypeToPolicyMap[t];return i===r.Block?r.Block:n===r.ForceSave||i===r.ForceSave?r.ForceSave:n===r.Allow||i===r.Allow?r.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach((function(t){e[t]=n}))},e.prototype.createPolicyMap=function(e,t,n){var i={};return this.addPolicyIntoMap(i,n,r.Allow),this.addPolicyIntoMap(i,t,r.ForceSave),this.addPolicyIntoMap(i,e,r.Block),i},e}(),s=null,l=null;function d(){if(!s){var e=Object(o.f)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;s=new u(t,n),n&&(l=s)}return s}function f(e,t){var n=Object(i.b)(e.Name),r=e.ContentType;return d().getPolicyInfo(n,r,t,e.__type)}function p(e,t){var n=Object(i.b)(e.Name),r=e.ContentType;return function(){if(!l){var e=Object(o.f)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return d();l=new u(e.AttachmentPolicy,!0)}return l}().getPolicyInfo(n,r,t,e.__type)}function b(e,t,n,i){if(i)return!1;var o=f(e,!0),a=d();return o.level!==r.Block&&a.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return d}))},1148:function(e,t,n){"use strict";var r=n(23),i=n(4),o={attachments:new r.ObservableMap({})},a=Object(i.createStore)("attachment",o);t.a=a},1156:function(e,t,n){"use strict";var r=n(1959),i=n(115),o=n(1051),a=n(1201),c=(n(1077),n(1101)),u=n(76);function s(e){return Object(u.h)("doc-SxS-multipleViews")?e==window?Object(a.b)().mainWindowSxSId:Object(c.f)(e):null}var l=n(1285),d=n(0),f=n(1415);function p(){var e,t;if(Object(u.h)("doc-SxS-multipleViews")){try{for(var n=Object(d.__values)(Object(a.b)().sxsStoreMapping.keys()),r=n.next();!r.done;r=n.next()){var i=r.value,o=Object(a.b)().sxsStoreMapping.get(i);if(o.shouldShow&&1==o.displayMode)return!0}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1}return Object(l.a)(f.a)}var b=n(2060),h=n(1673),v=n(1687),m=n(2088);n.d(t,"F",(function(){return O})),n.d(t,"q",(function(){return _})),n.d(t,"r",(function(){return w})),n.d(t,"s",(function(){return j})),n.d(t,"t",(function(){return y})),n.d(t,"u",(function(){return I})),n.d(t,"v",(function(){return S})),n.d(t,"w",(function(){return k})),n.d(t,"x",(function(){return C})),n.d(t,"y",(function(){return T})),n.d(t,"z",(function(){return A})),n.d(t,"A",(function(){return P})),n.d(t,"B",(function(){return E})),n.d(t,"C",(function(){return x})),n.d(t,"D",(function(){return L})),n.d(t,"E",(function(){return N})),n.d(t,"G",(function(){return R})),n.d(t,"h",(function(){return o.a})),n.d(t,"N",(function(){return o.i})),n.d(t,"L",(function(){return o.g})),n.d(t,"O",(function(){return o.j})),n.d(t,"i",(function(){return o.b})),n.d(t,"M",(function(){return o.h})),n.d(t,"H",(function(){return o.c})),n.d(t,"K",(function(){return o.f})),n.d(t,"I",(function(){return o.d})),n.d(t,"J",(function(){return o.e})),n.d(t,"j",(function(){return a.a})),n.d(t,"f",(function(){return r})),n.d(t,"k",(function(){return s})),n.d(t,"m",(function(){return l.a})),n.d(t,"n",(function(){return l.b})),n.d(t,"o",(function(){return l.c})),n.d(t,"p",(function(){return l.d})),n.d(t,"l",(function(){return p})),n.d(t,"e",(function(){return f.b})),n.d(t,"d",(function(){return f.a})),n.d(t,"g",(function(){return b.a})),n.d(t,"b",(function(){return h.a})),n.d(t,"c",(function(){return v.a})),n.d(t,"a",(function(){return m.a}));var g=new i.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(571)]).then(n.bind(null,15547))})),O=new i.b(g,(function(e){return e})),_=new i.b(g,(function(e){return e.canCloseSxS})),w=new i.b(g,(function(e){return e.closeComposeInSxS})),j=new i.b(g,(function(e){return e.createImageGalleryFromAttachmentViewStateIds})),y=new i.b(g,(function(e){return e.editAndReply})),I=new i.b(g,(function(e){return e.editInDraft})),S=new i.b(g,(function(e){return e.forceCloseSxS})),k=new i.a(g,(function(e){return e.logUsageWithSxSCustomData})),C=new i.b(g,(function(e){return e.onBeforeImageGalleryItemSelected})),T=new i.b(g,(function(e){return e.onChangeByImageGallery})),A=new i.b(g,(function(e){return e.onPendingNavigation})),P=new i.b(g,(function(e){return e.onPreviewOperationFinished})),E=new i.b(g,(function(e){return e.onPreviewOperationStart})),x=new i.b(g,(function(e){return e.openComposeInSxS})),L=new i.b(g,(function(e){return e.reloadTextPreview})),N=new i.b(g,(function(e){return e.showSxS})),R=new i.a(g,(function(e){return e.tryCloseSxS}));new i.b(g,(function(e){return e.tryExitSxSEditMode}))},1179:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return f}));var r,i=n(1515),o=n(1300),a=n(980),c={};function u(e){return e in c?c[e]:(c[e]={extraSmall:Object(o.a)(e+"_16x16"),small:Object(o.a)(e+"_20x20"),medium:Object(o.a)(e+"_32x32"),large:Object(o.a)(e+"_64x64"),cdn:Object(i.a)(e+"_16x16")},c[e])}var s="generic",l=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".apk":"exe",".application":"exe",".app":"exe",".appref-ms":"exe",".appx":"exe",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".ipa":"exe",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":s,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".msi":"exe",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xap":"exe",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),d=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"});function f(e,t,n){if(void 0===t&&(t=!1),t)return r=r||{extraSmall:null,small:Object(o.a)("folder_20x20"),medium:Object(o.a)("folder_32x32"),large:Object(o.a)("folder_64x64"),cdn:Object(i.a)("folder_16x16")};var c=null,f=Object(a.b)(e);return f&&(c=l[f.toLowerCase()]),!c&&n&&n in d&&(c=d[n]),u(c||s)}},1181:function(e,t,n){"use strict";var r=n(1034),i=n(1371);function o(e){var t;try{t=btoa(e)}catch(n){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}n.d(t,"d",(function(){return r.d})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"e",(function(){return r.e})),n.d(t,"c",(function(){return r.c})),n.d(t,"f",(function(){return i.a})),n.d(t,"g",(function(){return o}))},1201:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return v}));var r=n(1077),i=n(1142),o=n(2582),a=n(4),c=n(1687),u=n(1673),s=n(76),l=n(1415),d=n(23);function f(){var e={shouldShow:!1,displayMode:0,viewState:Object(o.a)(),extendedViewState:{previewMode:r.b.Unsupported,attachmentId:null,selectionSource:c.a.MailList,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},editState:{mode:u.a.View,editAllowed:!1,itemId:null,isDraft:!1},customPreviewState:null,eventManager:new i.a,pendingPreviewOperation:null,pendingNavigation:null,readingPaneState:null,composeId:null,customization:null,isInvisible:!1,shouldUseFakeRightHandSide:!1,isUsingFakeRightHandSide:!1,shouldHideReadingPaneOutsideSxS:!1,attachmentViewStateIdFromListView:null,sessionPreviewCount:0,sessionStartTime:0,meetingMessageAddToCalendarStatus:1,sigsInfo:null};return e.viewState.previewPane=null,e}var p=Object(a.createStore)("sxsstore",f()),b={mainWindowSxSId:null,sxsStoreMapping:new d.ObservableMap({})},h=Object(a.createStore)("sxsStore",b);function v(e){if(Object(s.h)("doc-SxS-multipleViews")){if(e=e||l.a,!h().sxsStoreMapping.has(e)){var t=f();h().sxsStoreMapping.set(e,t)}return h().sxsStoreMapping.get(e)}return p()}},1237:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l}));var r=n(4),i=Object(r.action)("ADD_SHARING_LINK",(function(e,t,n,r,i,o,a){return{linkId:e,url:t,sharingLinkIds:n,response:r,source:i,providerType:o,unwrappedUrl:a}})),o=Object(r.action)("SHARING_LINK_REMOVED",(function(e,t){return{linkId:e,sharingLinkIds:t}})),a=Object(r.action)("DELETE_LINK",(function(e,t){return{linkId:e,targetWindow:t}})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(function(e,t,n,r){return{linkId:e,providerId:t,isTryAgain:n,targetWindow:r}})),u=Object(r.action)("ON_LINK_HAS_CHANGED",(function(e,t,n,r){return{linkId:e,recipientInfos:t,composeId:n,isCalendar:r}})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(function(e,t){return{linkId:e,linkIdContainer:t}})),l=Object(r.action)("ON_FLUID_LINK_CREATED",(function(e,t,n){return{linkId:e,containerId:t,url:n}}))},1241:function(e,t,n){"use strict";var r=function(e){return e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e)},i=n(10),o=n(1024);function a(e){switch(e.__type){case o.e:return 0;case o.n:return e.IsLink?3:1;case o.i:return 3;case o.g:return 2;case o.h:var t=e;return r(e.EmbeddedItemClass)||Object(i.f)(t.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e.__type)}}n.d(t,"a",(function(){return a}))},1249:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1),i={};function o(e){var t;null===(t=i[e.type])||void 0===t||t.forEach((function(t){return t(e)}))}function a(e){var t;return i[e]=null!==(t=i[e])&&void 0!==t?t:new Map}function c(e,t,n){var i=r.useRef();r.useEffect((function(){return function(e,t,n){var r=a(e);0===r.size&&window.addEventListener(e,o),r.set(t,n)}(e,i,t),function(){return function(e,t){var n=a(e);n.delete(t),0===n.size&&window.removeEventListener(e,o)}(e,i)}}),n)}},1259:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973),i=null;t.default=function(e,t){e.focus();var n=function(){return e.getDocument().execCommand(t,!1,null)},o=e.getSelectionRange();o&&o.collapsed?(e.addUndoSnapshot(),n(),function(e){i||(i=Object.keys(r.PendableFormatCommandMap).map((function(e){return r.PendableFormatCommandMap[e]})));return i.indexOf(e)>=0}(t)&&e.triggerPluginEvent(13,{formatState:r.getPendableFormatState(e.getDocument())})):e.addUndoSnapshot(n,"Format")}},1261:function(e,t,n){"use strict";var r=n(0),i=n(25);function o(e){return Object(r.__assign)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function a(e){var t,n,r=o({ProviderType:e});return void 0===(t=r)||t.__type||(t=o(t)),Object(i.a)("GetNewAttachmentDataProviderCreationInfo",t,n)}function c(e){return Object(r.__assign)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function u(e){var t,n,r=c({ProviderType:e});return void 0===(t=r)||t.__type||(t=c(t)),Object(i.a)("GetAttachmentDataProviderCreator",t,n)}var s=n(2327),l=n(1567);n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return w}));var d="code",f="token",p=3e3,b=3;function h(e){return{state:e}}function v(e){return e.state}function m(e){return e.code}function g(e,t,n,i,o){var c={providerType:e,getAuthUrlInfo:null,getCSRFToken:v,getOAuthCode:m};return function e(t,n,i,o,c,l,d){return Object(r.__awaiter)(this,void 0,void 0,(function(){var f,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),f=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,u(t)];case 1:return b=r.sent(),f=b.AttachmentDataProviderCreator.ProviderAppKey,i=b.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,a(t)];case 3:b=r.sent(),f=b.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(s.d)(t,i,o,f,c,l),[3,6];case 5:return r.sent(),d>0&&setTimeout((function(){return e(t,n,i,o,c,l,--d)}),p),[3,6];case 6:return[2]}}))}))}(e,c,t,n,i,o,b),c}var O=null;function _(){if(!O){if(O={},Object(l.a)(3)&&(O[3]=g(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),d,h)),Object(l.a)(2)&&(O[2]=g(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),d,h)),Object(l.a)(6)){var e=g(6,"https://www.facebook.com/dialog/oauth",Object(s.b)(6),f,(function(e){return{state:e,scope:"user_photos,email"}}));e.getCSRFToken=v,e.getOAuthCode=function(e){return e.access_token},O[6]=e}if(Object(l.a)(5)){var t=g(5,"https://accounts.google.com/o/oauth2/auth",s.a+"/ADPRedirect.aspx",d,(function(e){var t={state:e,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));t.getCSRFToken=function(e){return JSON.parse(e.state).state},O[5]=t}Object(l.a)(1)&&(O[1]=g(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),d,(function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(l.a)(7)&&(O[7]=g(7,"",Object(s.c)(7),d,h)),Object(l.a)(8)&&(O[8]=g(8,"",Object(s.c)(8),d,h)),Object(l.a)(9)&&(O[9]=g(9,"",Object(s.c)(9),d,h))}return O}function w(e){var t=_();return e in t?t[e]:null}},1265:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1181),i=n(1522);function o(e){switch(e){case 3:return a;case 2:return c;case 0:return u;case 1:return s;case 5:return l;default:throw new Error("File provider "+e+" is not supported.")}}var a={providerType:3,create_shared_link_request:{requestUrlFormat:i.a+"/{0}/{1}",method:r.e,body:{shared_link:{access:"open",permissions:{can_download:!0,can_preview:!0}}},dataPointName:"BoxCreateLink"},get_file_info_request:{requestUrlFormat:i.a+"/shared_items",method:r.b,additional_headers:{BoxApi:"shared_link={0}"},dataPointName:"GetBoxFileInfo"}},c={providerType:2,get_shared_link_request:{requestUrlFormat:i.b+"/list_shared_links",method:r.d,body:{path:null,direct_only:!0},dataPointName:"DropboxCreateLink"},create_shared_link_request:{requestUrlFormat:i.b+"/create_shared_link_with_settings",method:r.d,body:{path:null,settings:{requested_visibility:"public"}},dataPointName:"DropboxCreateNewLink"},get_file_info_request:{requestUrlFormat:i.b+"/get_shared_link_metadata",method:r.d,body:{url:null},dataPointName:"GetDropboxFileInfo"}},u={providerType:0,create_shared_link_request:{requestUrlFormat:"https://{0}/"+Object(i.q)(0)+"/{1}/driveItem/invite",method:r.d,additional_headers:{prefer:"getDefaultLink"},dataPointName:"OneDriveProCreateLink"},get_file_info_request:{requestUrlFormat:"https://{0}/"+Object(i.q)(0)+"/{1}/?expand=sharepointIds,permission,driveItem(select=webDavUrl,name,folder,package)",method:r.b,dataPointName:"GetODBFileInfo"},get_shared_item_request:{requestUrlFormat:"https://{0}/"+Object(i.q)(0)+"/{1}/",method:r.b,dataPointName:"GetODBSharedItem",additional_headers:{prefer:"redeemSharingLinkIfNecessary"}}},s={providerType:1,create_shared_link_request:{requestUrlFormat:i.e+"/"+Object(i.i)(1)+"/items/{0}/action.createLink",method:r.d,body:{type:null},dataPointName:"OneDriveConsumerCreateLink"},change_link_permission_request:{requestUrlFormat:i.e+"/"+Object(i.q)(1)+"/{0}/root/action.createLink",method:r.d,body:{type:null},dataPointName:"OneDriveConsumerChangeLinkPermission"},get_drive_item_request:{requestUrlFormat:i.e+"/"+Object(i.q)(1)+"/{0}/driveItem",method:r.b,dataPointName:"GetODCDriveItem"},get_file_permission_request:{requestUrlFormat:i.e+"/"+Object(i.q)(1)+"/{0}/driveItem/permissions",method:r.b,dataPointName:"GetODCFilePermission"}},l={providerType:5,get_file_info_request:{requestUrlFormat:i.d+"/{0}?fields=id,name,webViewLink,mimeType,capabilities,permissions,permissionIds",method:r.b,dataPointName:"GetGDriveFileInfo"},create_shared_link_request:{requestUrlFormat:i.d+"/{0}/permissions",method:r.d,body:{role:null,type:"anyone"},dataPointName:"GDriveCreateLink"},change_link_permission_request:{requestUrlFormat:i.d+"/{0}/permissions/{1}",method:r.c,body:{role:null},dataPointName:"GDriveChangeLinkPermission"}}},1266:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(1181);function o(e,t,n,o,a,c,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s={method:o,mode:i.a,body:a,datapointNamePrefix:u},[4,Object(i.f)(e,t,c,s,n)];case 1:return[2,r.sent()]}}))}))}},1272:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(1241);function i(e){return a(e.type)}function o(e){return a(Object(r.a)(e))}function a(e){return 1===e||3===e}},1282:function(e,t,n){"use strict";function r(e){var t=e&&(e.commonAncestorContainer||e),n=t&&(t.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(t)?t:null));return n&&(n.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=r,t.default=function(e,t){var n=r(e),i=n&&n[t],o=window,a=o&&o[t];return a&&e instanceof a||i&&e instanceof i}},1285:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(1201),i=n(106);function o(e){return Object(r.a)(e).shouldShow}function a(e){return Object(r.a)(e).shouldShow&&Object(r.a)(e).shouldHideReadingPaneOutsideSxS}function c(e,t){return o(t)&&Object(i.f)(e,Object(r.a)(t).extendedViewState.attachmentId)}function u(e,t){return o(t)&&(e&&e.composeId===Object(r.a)(t).composeId||!e&&Object(r.a)(t).composeId)}},1288:function(e,t,n){"use strict";var r=n(0),i=n(1791),o=n.n(i),a=n(10),c=n(296),u=n(715),s=n(289),l=n(25);function d(e){return Object(r.__assign)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=d(e)),Object(l.a)("GetAccessTokenforDataProvider",e,t)}function p(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=d({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),o=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(a=new Headers).append("X-OWA-ActionName",o),[4,f(i,{headers:a,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(c=r.sent()).json()];case 2:return[2,{token:r.sent(),response:c}]}}))}))}var b="onedrive_implicit.access",h="Bearer ",v=n(76),m=function(e,t,n){return Object(r.__assign)({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},g=function(e){return"TokenRetrievalError"===e._typeSpec},O=[],_={},w=1,j=30,y="",I="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function S(e){_[e]=null}function k(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p(e,t,n)];case 1:return i=r.sent(),function(e,t,n){O=O.filter((function(e){return e!==t}));var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var i="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,o=n.response.headers.get("x-tokenresult"),a=null!=o&&o.indexOf(I)>0;throw m(new Error(i),r.TokenResultCode,a)}var c=_[e]||{};c[t]=r,_[e]=c}(e,t,i),[2,i.token]}}))}))}function C(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(r.__generator)(this,(function(r){return i=y,0===e&&n&&(o=Object(s.parse)(n),i=Object(a.c)("{0}//{1}/",o.protocol,o.hostname)),Object(v.h)("doc-attachment-testAuthFallback")?[2,""]:[2,A(e,i,t,null)]}))}))}function T(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return[2,A(0,e,t,n)]}))}))}function A(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n||!function(e,t){var n=_[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var i=new Date(r.AccessTokenExpiry),a=o()(new Date(Date.now()),w);return null!=i&&a<i}(e,t)?[3,1]:(a=_[e],c=a[t],o()(new Date(Date.now()),j)>new Date(c.AccessTokenExpiry)&&-1===O.indexOf(t)&&(O.push(t),k(e,t,i)),[2,c.AccessToken]);case 1:return[4,k(e,t,i)];case 2:return[2,(c=r.sent()).AccessToken]}}))}))}function P(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(c.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(b)]:[3,2];case 1:return i=r.sent(),[3,4];case 2:return[4,C(e,t,n)];case 3:i=r.sent(),r.label=4;case 4:return[2,h+i]}}))}))}n.d(t,"d",(function(){return P})),n.d(t,"c",(function(){return C})),n.d(t,"e",(function(){return T})),n.d(t,"b",(function(){return S})),n.d(t,"f",(function(){return g})),n.d(t,"a",(function(){return h}))},1290:function(e,t,n){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),t.a=r},1293:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u}));var r=n(115),i=new r.c((function(){return Promise.all([n.e(12),n.e(17),n.e(19),n.e(34),n.e(333)]).then(n.bind(null,2872))})),ReactEditor=Object(r.d)(i,(function(e){return e.ReactEditor})),o=new r.b(i,(function(e){return e.setTableHeaderRow})),a=new r.b(i,(function(e){return e.operateContent})),c=new r.b(i,(function(e){return e.focusToEditor}));function u(e){c.import().then((function(t){return t(e)}))}},1298:function(e,t,n){"use strict";function r(e){var t=e.AttachmentPolicy;return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}n.d(t,"a",(function(){return r}))},1299:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(314);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1300:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2454),i="fileType-icon";function o(e){return r[function(e){return i+"-"+e}(e)]}},1307:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l}));var r=n(4),i=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(function(e,t){return{linkId:e,sharingDialogResponse:t}})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(function(e,t){return{linkId:e,newPermission:t}})),a=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(function(e,t,n,r){return{linkId:e,newLinkUrl:t,oldLinkUrl:n,expirationDate:r}})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(function(e,t){return{linkId:e,actionStatus:t}})),u=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(function(e,t,n,r,i,o,a,c,u){return{linkId:e,sharingUrl:t,currentUrl:n,canonicalUrl:r,newPermissionLevel:i,providerType:o,composeId:a,recipientInfos:c,isCalendar:u}})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(function(e,t){return{linkId:e,linkModel:t}})),l=Object(r.action)("TOKEN_UNAVAILABLE",(function(e){return{linkId:e}}))},1308:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(0),i=n(1360),o=function(){return Object(r.__spread)(Object(i.a)().providers.values())},a=function(e){return Object(i.a)().providers.get(e)||null}},1333:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.AttachmentId)&&i(e.AttachmentId.Id)}function i(e){return e&&-1!==e.indexOf("smime-")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},1342:function(e){e.exports=JSON.parse('{"b":"Yia","d":"Zia","c":"_ia","a":"$ia"}')},1344:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},1346:function(e,t,n){"use strict";var r=n(0),i=n(1937),o=n(1764),a=n(1129),c={},u=function(){function e(e,t,n){var r=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var e=r.getActionCompletePercent();e<=r.maxPercent?(r.updatePropertyHandler(e),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout((function(){return e.updatePropertyHandler(1.1)}),500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function s(e,t){var n=c[e.Id];n&&(t?n.complete():n.abort(),delete c[e.Id])}function l(e,t,n,r){var i=new u(e,t,n);c[r.Id]=i,i.start()}var d=n(2873),f=n(4);Object(f.orchestrator)(i.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=e.attachment,Object(a.a)(i,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(d.a)(null,null,e.attachment.attachmentId.Id)];case 2:return t=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=t&&"Success"===t.ResponseClass?14:15,function(e,t,n,r,i){s(e,!0),Object(o.a)(n,i),Object(a.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7),[2]}var i}))}))}));var p=n(1089),b=n(2204);function h(e){return Object(r.__assign)({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}var v=n(25);function m(e,t,n,r,i){var o,a,c=function(e,t,n,r,i){return h({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:i})}(e,t,n,r,i);return void 0===(o={requestObject:c}).requestObject||o.requestObject.__type||(o.requestObject=h(o.requestObject)),Object(v.a)("ConvertLocalToRefAttachment",o,a)}var g=n(254),O=n(1005),_=n(1623),w=n(1075),j=n(284),y={},I=Object(j.action)("convertClassicToCloudy")((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=new g.a("AttachmentConvertClassicToCloudy"),function(e){Object(a.a)(e,5,8)}(e),o=function(t){if(k(e,t.ResultCode),C(i,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(t){k(e,1),n(!1,null),C(i,e.attachmentId,1,t)},[4,S(e.attachmentId,t,o,c)];case 1:return r.sent(),[2]}}))}))}));function S(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,a,c,u,s,l;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:return[4,Object(_.a)(n)];case 1:o=r.__read.apply(void 0,[d.sent(),4]),a=o[0],c=o[1],u=o[2],s=o[3],y[e.Id]=a,d.label=2;case 2:return d.trys.push([2,4,,5]),[4,m(e.Id,t,a,s,a)];case 3:return d.sent(),[3,5];case 4:return l=d.sent(),i(l.message),w.g.importAndExecute(c,u),[3,5];case 5:return[2]}}))}))}function k(e,t){switch(t){case 0:break;case 11:Object(a.a)(e,0,0);break;default:Object(a.a)(e,0,9)}delete y[e.attachmentId.Id]}function C(e,t,n,r){var i=Object(O.a)(t);e.addCosmosOnlyData(JSON.stringify({size:i.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}var T={name:"CancelConvertClassicToCloudy"},A={name:"CancelConvertCloudyToClassic"};function P(e){return Object(r.__assign)({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}function E(e){var t,n,r=function(e){return P({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=P(t)),Object(v.a)("CancelConvertLocalToRefAttachment",t,n)}var x=n(118),L=Object(x.d)("cancelConvertClassicToCloudy",T)((function(e){var t,n=(t=e.attachmentId.Id,y[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(a.a)(e,5,10),E(n)})),N=n(1508),R=Object(j.action)("setActionCompletePercent")((function(e,t){e.actionCompletePercent=t})),D=n(2201),F=n(1830),M=(n(1747),n(1443)),U=n(1882),B=n(1077),q=n(2103),W=n(2556),V=n(2863),z=n(1272),H=Object(j.action)("updateAttachment")((function(e,t,n,i,o){Object(W.a)(e.attachmentId);var c=Object(r.__assign)(Object(r.__assign)({},i.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=c,i.Name&&(n.Name=i.Name),i.Size&&(n.Size=i.Size),i.ContentType&&(n.ContentType=i.ContentType),i.__type&&(n.__type=i.__type),n.IsInline&&(n.ContentId=i.ContentId),Object(z.b)(i)){var u=n;u.AttachLongPathName=i.AttachLongPathName,u.PermissionType=i.PermissionType,u.ProviderType=i.ProviderType,u.AttachmentThumbnailUrl=i.AttachmentThumbnailUrl,u.AttachmentPreviewUrl=i.AttachmentPreviewUrl}if(Object(q.a)([{attachmentId:c,attachment:n,permissionInfo:o}],!1),e.attachmentId=c,Object(U.a)(e))Object(F.a)(e,1);else{Object(B.g)(e,!1),setTimeout((function(){R(e,1.1)}),500),Object(a.a)(e,0,0);var s=Object(O.a)(c);Object(M.a)(e,s,!1,e.strategy.supportedMenuActions),s.download.url||Object(V.a)(c,e.isReadOnly,!0)}}));function G(e){return Object(r.__assign)({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}function J(e,t,n,r,i,o,a,c){var u,s,l=function(e,t,n,r,i,o,a,c){return G({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:i,fullPathLocation:o,attachmentDataProviderId:c,PermissionLevel:a})}(e,t,n,r,i,o,a,c);return void 0===(u={requestObject:l}).requestObject||u.requestObject.__type||(u.requestObject=G(u.requestObject)),Object(v.a)("ConvertRefToLocalAttachment",u,s)}function Y(e){return $(Object(O.a)(e).model.Size)}function K(e){return 2856+.00145*e}function X(e){return 4*$(e)}function Q(e){return 4*$(e)}function Z(e){return 2*$(e)}function $(e){return Math.round(e/256)}var ee=n(2595),te={},ne=Object(f.action)("convertCloudyToClassic",(function(e,t,n,r,i,o){return{attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:i,source:o}})),re=ne;function ie(e,t,n,i,o,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s,l,d,f;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return[4,Object(_.a)(o)];case 1:c=r.__read.apply(void 0,[p.sent(),4]),u=c[0],s=c[1],l=c[2],d=c[3],te[e.Id]=u,p.label=2;case 2:return p.trys.push([2,4,,5]),[4,J(e.Id,t,u,d,u,n,i)];case 3:return p.sent(),[3,5];case 4:return f=p.sent(),a(f.message),w.g.importAndExecute(s,l),[3,5];case 5:return[2]}}))}))}function oe(e,t){switch(t){case 0:break;case 11:Object(a.a)(e,0,0);break;default:Object(a.a)(e,0,12)}delete te[e.attachmentId.Id]}function ae(e,t,n,r,i){var o,a=Object(O.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size,attachmentId:null===(o=a.model.AttachmentId)||void 0===o?void 0:o.Id})),e.addCustomData([n,i]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}function ce(e){return Object(r.__assign)({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}function ue(e){var t,n,r=function(e){return ce({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=ce(t)),Object(v.a)("CancelConvertRefToLocalAttachment",t,n)}Object(f.orchestrator)(ne,(function(e){var t=e.attachment;!function(e,t,n,i,o,c){Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=new g.a("AttachmentConvertCloudyToClassic"),function(e){Object(a.a)(e,6,11)}(e),s=function(t){if(oe(e,t.ResultCode),ae(u,e.attachmentId,t.ResultCode,t.Exception,c),0===t.ResultCode){var n=Object(ee.a)({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});o(!0,n)}else o(!1,null);return!0},l=function(t){oe(e,1),o(!1,null),ae(u,e.attachmentId,1,t,c)},[4,ie(e.attachmentId,t,n,i,s,l)];case 1:return r.sent(),[2]}}))}))}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,(function(n,r){n?e.replaceAttachmentHandler(t,r,!1,!0):s(t.attachmentId,n)}),e.source),l(Y(t.attachmentId),.1,(function(e){R(t,e)}),t.attachmentId)}));var se=Object(f.action)("cancel_ConvertCloudyToClassic",(function(e){return Object(x.c)(A,{attachmentViewState:e})})),le=se;Object(f.orchestrator)(se,(function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,te[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(a.a)(e.attachmentViewState,6,10),ue(n)}));var de=n(1049),fe=n(1137),pe=n(2067),be=n(1487);function he(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,be.h.import()];case 1:return n.sent()(e.model.AttachLongPathName,pe.a.OneDrivePro).then((function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&0===n.ResultCode?[2]:(t=Object(fe.b)(e.model,!0),[4,de.h.importAndExecute(t,e.attachmentClass,e.model,!0,e.model.ProviderType,n)]);case 1:return i=r.sent(),de.m.importAndExecute(e.id,i),Object(de.p)(e.id),[2]}}))}))})),[2]}}))}))}var ve=n(76),me=n(980);function ge(e,t,n){if(e&&t===de.a.providers.ONE_DRIVE_PRO&&(Object(ve.h)("doc-SxS-jsApi-ODB-Base")||Object(ve.h)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(ve.h)("doc-SxS-jsApi-ODB-Readonly"))){var r=n&&n.substring(n.lastIndexOf("."));switch(Object(me.f)(r)){case me.a.Word:return Object(ve.h)("doc-SxS-jsApi-ODB-Word");case me.a.Excel:return Object(ve.h)("doc-SxS-jsApi-ODB-Excel");case me.a.PowerPoint:return!Object(ve.h)("doc-SxS-jsApi-ODB-Readonly")&&Object(ve.h)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var Oe=n(1883),_e=n(1084);function we(e,t,n,r,i){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===i&&(i=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:_e.a.Inline,skipProcessInlineImage:i}}function je(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}var ye=n(1792);n(1909);n.d(t,"a",(function(){return p.a})),n.d(t,"h",(function(){return b.a})),n.d(t,"c",(function(){return L})),n.d(t,"e",(function(){return I})),n.d(t,"u",(function(){return N.a})),n.d(t,"w",(function(){return N.c})),n.d(t,"v",(function(){return N.b})),n.d(t,"D",(function(){return N.d})),n.d(t,"x",(function(){return R})),n.d(t,"y",(function(){return D.a})),n.d(t,"z",(function(){return F.a})),n.d(t,"A",(function(){return a.a})),n.d(t,"E",(function(){return H})),n.d(t,"r",(function(){return M.a})),n.d(t,"o",(function(){return M.b})),n.d(t,"d",(function(){return le})),n.d(t,"f",(function(){return re})),n.d(t,"m",(function(){return he})),n.d(t,"b",(function(){return ge})),n.d(t,"B",(function(){return l})),n.d(t,"C",(function(){return s})),n.d(t,"k",(function(){return K})),n.d(t,"l",(function(){return Q})),n.d(t,"q",(function(){return X})),n.d(t,"j",(function(){return Z})),n.d(t,"g",(function(){return Oe.a})),n.d(t,"i",(function(){return we})),n.d(t,"p",(function(){return Y})),n.d(t,"t",(function(){return je})),n.d(t,"s",(function(){return U.a})),n.d(t,"n",(function(){return ye.a}))},1359:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2169),i=n(1502);function o(e){var t=Object(r.a)(),n=Object(i.b)(e);return t.sharingLinks.get(n)}},1360:function(e,t,n){"use strict";var r=n(4),i=n(23),o=n(1554),a={providers:new i.ObservableMap,loadState:o.a.NotLoaded,removalPending:new i.ObservableMap},c=Object(r.createStore)("fileProviderStore",a);t.a=c},1361:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c}));var r="originalsrc",i="shash",o="data-auth",a="&reserved=0",c="Verified"},1371:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),i=n(254),o=n(1288),a=n(280),c=n(1344),u=n(1640),s=n(75),l=n(1034);function d(e,t,n,a,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(o.d)(e,!1,n)];case 1:return u=r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return u&&u.split(o.a)[1]?(Object(i.o)("fetchServiceViaDataProvider",[e]),s.g.info("fetchServiceViaDataProvider"),[4,f(t,u,a,c)]):[3,5];case 4:return[2,r.sent()];case 5:Object(i.o)("fetchServiceFailedToGetToken",[e]),r.label=6;case 6:return 0!==e?[3,8]:(Object(i.o)("fetchServiceViaOWAServer"),s.g.info("fetchServiceViaOWAServer"),[4,p(e,t,a,c)]);case 7:return[2,r.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function f(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s;return Object(r.__generator)(this,(function(r){return c=n.datapointNamePrefix+"DataProvider",u=new i.a(c),s={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},o&&Object.keys(o).forEach((function(e){s[e]=o[e]})),[2,fetch(e,{method:n.method,mode:n.mode,headers:s,body:n.body}).then((function(e){if(Object(a.a)(e.status))return u.end(),e.json();var t=new Error(c+" : Response status = "+e.status+", body = "+e.body);u.endWithError("ServerError",t);var n={datapointName:c,responseStatus:e.status,responseBody:e.body};throw JSON.stringify(n)})).then((function(e){return JSON.stringify(e)}))]}))}))}function p(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,d,f,p,b,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=n.datapointNamePrefix+"OWA",d=new i.a(s),f=Object(c.a)({ProviderType:e,Url:t,Method:n.method,Body:n.body?n.body:JSON.stringify({}),Headers:JSON.stringify(o),IsJsonPost:n.method===l.d}),[4,Object(u.a)(f)];case 1:if(p=r.sent(),Object(a.a)(p.Status))return d.end(),[2,p.Body];throw b=new Error(s+" : Response status = "+p.Status+", ServerTraceLog = "+p.ServerTraceLog),d.endWithError("ServerError",b),h={datapointName:s,responseStatus:p.Status,responseServerTraceLog:p.ServerTraceLog},JSON.stringify(h)}}))}))}},1375:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n(4),i=Object(r.action)("FILE_PROVIDER_ADDED",(function(e){return{providerViewState:e}})),o=Object(r.action)("FILE_PROVIDER_REMOVED",(function(e){return{providerType:e}})),a=Object(r.action)("PROVIDERS_LOADED",(function(e){return{providers:e}}))},1395:function(e,t,n){"use strict";var r=n(239),i=n(0),o={};function a(e){return o[e]}function c(e,t){var n=o[e];o[e]=Object(i.__assign)(Object(i.__assign)({},n),t)}var u=n(94),s=n(25);var l=n(254),d=n(75),f=n(528),p=n(427),b=n(353);function h(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return(t={}).headers=new Headers,[4,Object(p.a)(e)];case 1:return n=r.sent(),Object(b.b)(t.headers,n),[2,t]}}))}))}var v=Object(f.b)({timeBetweenRetryInMS:function(){return 3e4}});function m(e,t){t=t<1?1:t,setInterval((function(){!function(e){Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,o,u,f,p,b=this;return Object(i.__generator)(this,(function(m){switch(m.label){case 0:if(t=function(){return Object(i.__awaiter)(b,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t={},Object(r.p)(e.userIdentity)?[4,h(e.userIdentity)]:[3,2];case 1:t=i.sent(),i.label=2;case 2:return[2,(o=t,Object(s.a)("GetAttachmentDownloadToken",{},o))];case 3:throw n=i.sent(),d.g.warn("Unable to get the download token "+n),n.networkError=!0,n;case 4:return[2]}var o}))}))},null==(n=a(e.userIdentity))?void 0:n.isRefreshingDownloadToken)return[3,4];c(e.userIdentity,{isRefreshingDownloadToken:!0}),o=0,u=v((function(){return Object(i.__awaiter)(b,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return o++,[4,t()];case 1:return n=r.sent(),d.g.info("update new token"),c(e.userIdentity,{downloadToken:n,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,f=new l.b("AttachmentRefreshDownloadToken"),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,u()];case 2:return m.sent(),f.addCustomData([o]),f.end(),[3,4];case 3:return p=m.sent(),d.g.warn("Retry to refresh token failed: "+p),f.addCustomData([o]),f.endWithError("ServerError",p),c(e.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(e)}),6e4*t)}var g=n(314);function O(e){var t=Object(r.g)(null==e?void 0:e.userIdentity),n=a(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Outlook":!function(e){var t=Object(r.p)(e.userIdentity)?Object(u.j)(e.userIdentity):Object(u.i)(),n=null==t?void 0:t.ApplicationSettings;if(n){var i=n.DownloadUrlBase;c(e.userIdentity,{downloadUrlBase:i,downloadToken:n.FirstDownloadToken}),i&&m(e,n.DownloadTokenRefreshMinutes)}}(e);break;case"Google":case"ICloud":break;default:Object(g.a)(t)}var i=a(e.userIdentity);return i||(Object(l.o)("FilesUrlDataNotFound",{accountProviderType:t}),d.g.warn("Unable to get the url data")),i}function _(e){if(!e)return null;var t=O(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return _}))},1415:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var r,i="sxsIdMainWindow";!function(e){e[e.Mail=0]="Mail",e[e.FilesHub=1]="FilesHub",e[e.DeepLink=2]="DeepLink",e[e.GroupFilesHub=3]="GroupFilesHub",e[e.PopOut=4]="PopOut"}(r||(r={}))},1427:function(e,t,n){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1443:function(e,t,n){"use strict";var r=n(2050),i=n(10),o=n(1764),a=n(1129);var c=n(1089),u=n(1272),s=n(1137),l=n(1049),d=n(284);n.d(t,"b",(function(){return p}));var f=null;function p(){return f||(f=Object.keys(c.a).reduce((function(e,t){var n=c.a[t];return Number.isInteger(n)&&e.push(n),e}),[])),f}t.a=Object(d.action)("initializeAttachmentFullViewState")((function(e,t,n,d,f){var b;d&&0!==d.length||(b=t.model,d=Object(l.e)(b)?function(e){return 2===Object(l.c)(e)?[c.a.Preview,c.a.Download]:[c.a.Download]}(b):p());var h=Object(s.b)(t.model,!0),v=Object(s.e)(),m=Object(u.a)(t),g=Object(r.a)(v,h,t.attachmentClass,t.model,m?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,d,e.isReadOnly,n,f);e.strategy=g,function(e,t,n){n&&!Object(i.f)(t.model.AttachmentOriginalUrl)&&(Object(o.a)(e,2),Object(a.a)(e,0,2))}(e,t,e.strategy.isSaveToCloudSupported)}))},1463:function(e,t,n){"use strict";var r=n(115),i=n(1761),o=n(1762),a=(n(1360),n(1375)),c=n(1517),u=(n(2311),n(2262),n(1308));var s=n(1743),l=n(1554),d=n(1261);n.d(t,"l",(function(){return p})),n.d(t,"n",(function(){return b})),n.d(t,"k",(function(){return h})),n.d(t,"m",(function(){return v})),n.d(t,"b",(function(){return i.a})),n.d(t,"i",(function(){return o.a})),n.d(t,"d",(function(){return a.a})),n.d(t,"e",(function(){return a.b})),n.d(t,"o",(function(){return a.c})),n.d(t,"a",(function(){return c.b})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return u.b})),n.d(t,"j",(function(){return s.a})),n.d(t,"c",(function(){return l.a})),n.d(t,"f",(function(){return d.b}));var f=new r.c((function(){return Promise.all([n.e(1),n.e(711),n.e(4),n.e(16),n.e(277)]).then(n.bind(null,15604))})),p=new r.b(f,(function(e){return e.loadProviders})),b=new r.b(f,(function(e){return e.removeFileProvider})),h=new r.b(f,(function(e){return e.addFileProvider})),v=new r.b(f,(function(e){return e.removeAndAddFileProvider}))},1469:function(e,t,n){"use strict";function r(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},1470:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"m",(function(){return o})),n.d(t,"l",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"n",(function(){return h})),n.d(t,"k",(function(){return v})),n.d(t,"p",(function(){return m})),n.d(t,"h",(function(){return g}));var r=100,i=1,o="PublicDL",a="PrivateDL",c="GroupMailbox",u="RecommendedGroup",s="InternalMailbox",l="ExternalMailbox",d="Mailbox",f="OneOff",p="Contact",b="ImplicitContact",h="PublicFolder",v="Other",m="Room",g="LinkedIn"},1476:function(e,t,n){"use strict";var r=n(0),i=n(1875),o=n(2037),a=n(314);var c=Object(i.a)((function(e){switch(e){case 0:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportImageThumbnail:!0,supportPreview:function(e,t){return t},supportedPermissionLevels:[2,1]});case 3:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:function(e,t){return!1}});case 2:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportPreview:function(e,t){return!1}});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e){return Object(o.a)(e)},supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:function(e,t){return!1}});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(a.a)(e)}})),u=c.getDataProviderInfo;c.getDefaultDataProviderInfo;t.a=u},1485:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(1760),i=n(1298),o=n(26),a=n(1299);function c(){var e=Object(o.a)();return Object(i.a)(e)}function u(e){var t=Object(o.a)();return(e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!function(e){return e.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t}))}(e)?Object(i.a)(t):[]).map(a.a)}},1486:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},1487:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"l",(function(){return m}));var r=n(115),i=n(1789);n.d(t,"n",(function(){return i.a}));var o=n(1742);n.d(t,"a",(function(){return o.a}));n(1470);var a=n(1427);n.d(t,"d",(function(){return a.b})),n.d(t,"c",(function(){return a.a}));var c=n(1790);n.d(t,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(4),n.e(16),n.e(45),n.e(553)]).then(n.bind(null,3556))})),s=new r.b(u,(function(e){return e.getSharingInformation})),l=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),d=new r.b(u,(function(e){return e.getInfoBarCreator})),f=new r.b(u,(function(e){return e.hasLargeDLRecipient})),p=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),b=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),h=new r.b(u,(function(e){return e.getInvididualRecipients})),v=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),m=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},1501:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r,i=n(1179),o=n(1515);function a(e,t,n,a,c){if(n)return r=r||{extraSmall:Object(i.b)("generic").extraSmall,small:Object(i.b)("generic").small,medium:Object(i.b)("blockedfile").medium,large:Object(i.b)("generic").large,cdn:Object(o.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":case"IPM.Schedule.Meeting.Request":case"IPM.Schedule.Meeting.Canceled":return Object(i.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(i.b)("calendar")}return a?Object(i.b)("sharedfolder"):Object(i.a)(e,!1,t)||Object(i.b)("generic")}},1502:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(76),i="_ODSPPSL";function o(e){return Object(r.h)("doc-link-savePermission")&&e&&-1!==e.indexOf(i)?e.substring(0,e.length-i.length):e}function a(e){return!!Object(r.h)("doc-link-savePermission")&&e.lastIndexOf(i)===e.length-i.length}function c(e,t){return!Object(r.h)("doc-link-savePermission")||2!==t&&1!==t?e:e+i}},1508:function(e,t,n){"use strict";var r=n(0),i=n(254),o=n(2862),a=n(1005),c=n(2269),u=n(2563),s=n(76),l=n(2375),d=n(284),f=n(1909),p=n(1764),b=n(2050),h=n(1129),v=Object(d.action)("updateIsViewingInProviderSupported")((function(e,t){e.strategy.isViewingInProviderSupported=t}));n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return _})),n.d(t,"b",(function(){return w}));t.a=Object(d.action)("saveToCloud")((function(e,t,n,i,o){var a=Object(r.__read)(g(e,t,n,i,!1,o),2),c=a[0],s=a[1];Object(u.b)(e.attachmentId,null,c,s)}));function m(e,t,n,i,o,a){var c=Object(r.__read)(g(e,t,n,i,!0,a),2),s=c[0],l=c[1];Object(u.c)(e.attachmentId,s,l,o)}function g(e,t,n,r,o,a,c){var u=new i.a("AttachmentSaveToCloud");f.a.run(2,e.attachmentId,c),_(e,o);return[function(i){var o=0===i.ResultCode;return w(e,o,o?i.Item.Location:null,c),t(o),O(u,e.attachmentId,i.ResultCode,"ServerError",i.Exception,n,r,a),!0},function(i,o,c,s){w(e,!1,null,s),t(!1),O(u,e.attachmentId,o,c,i,n,r,a)}]}function O(e,t,n,r,o,u,d,f){var p=Object(a.a)(t);e.addCustomData({entryPoint:u,result:n});var b=Object(c.a)(p);e.addCosmosOnlyData(JSON.stringify({size:p.model.Size,fileType:b})),0===n?e.end():e.endWithError(r,new Error(o)),Object(s.h)("doc-attachment-sigs")&&Object(l.a)(null==d?void 0:d.Id).then((function(e){i.l.importAndExecute("SavedAttachment",{itemId:e,customProperties:{FileId:t.Id,FileType:b,Destination:"Cloud",Sender:f}})}))}function _(e,t){void 0===t&&(t=!1);var n=t?18:1;Object(h.a)(e,2,n)}function w(e,t,n,r){if(t){Object(p.a)(e,2),Object(o.a)(e.attachmentId,n),f.a.run(3,e.attachmentId,r);var i=Object(b.b)(!1,!1,n);v(e,i)}else f.a.run(4,e.attachmentId,r);Object(h.a)(e,0,t?3:4)}},1515:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(76),i=1;function o(e){return Object(r.h)("doc-fileIcon-newCdn")?"https://outlook-"+(i++%2+1)+".cdn.office.net/assets/mail/file-icon/png/"+e+".png":"https://r"+(i++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},1517:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a}));var r,i=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var o=Object.freeze([1,3,2,6,5,7,8,9]),a=Object.freeze(Object(i.__spread)(o,[0,4,10]))},1522:function(e,t,n){"use strict";var r=n(0),i="https://www.googleapis.com/drive/v3/files",o=n(1288);function a(e,t,n){return void 0===n&&(n={forceTokenRefresh:!1,requestInit:{}}),Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=n.forceTokenRefresh,a=n.requestInit||{},[4,Object(o.d)(t,i,e)];case 1:return c=r.sent(),a.headers||(a.headers=new Headers),a.headers.set("Authorization",c),[4,fetch(e,a)];case 2:return[2,r.sent()]}}))}))}function c(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(i+"?"+e,5,{forceTokenRefresh:t})];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o)}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}function u(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(i+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:return n=r.sent(),[2,{errorResponse:null,result:JSON.parse(n)}];case 3:return[2,{errorResponse:t,result:null}]}}))}))}var s=n(314),l=n(1181),d=n(289),f=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function p(){return Object.keys(f).map((function(e){return f[e]})).join(",")}var b,h="_api/v2.0",v="/v1.0",m="root";function g(e){switch(e){case 1:return v;case 0:return h;default:return Object(s.a)(e)}}function O(e){return g(e)+"/drive"}function _(e){return g(e)+"/shares"}function w(e){return O(e)+"/items"}function j(e,t,n,i,o,a,c){return void 0===a&&(a=b.None),Object(r.__awaiter)(this,void 0,void 0,(function(){var u,h,v,g,O,_,j,y,I;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=o||m,u=function(e){switch(e){case 0:return f.name;case 1:return f.size;default:return f.lastModifiedDateTime}}(n),h=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(s.a)(e)}}(i),v=function(e,t,n){switch(e){case 0:return"folder,"+t+" "+n;case 1:return t+" "+n;default:return Object(s.a)(e)}}(t,u,h),g="expand=thumbnails(select=medium)&orderby="+v+"&select="+p(),a!==b.None&&(g=g+"&filter="+function(e){switch(e){case b.None:return"";case b.Folder:return"("+f.folder+" ne null)";default:return Object(s.a)(e)}}(a)),c&&(g=g+"&$top="+c.maxEntries,c.skipToken&&(g=g+"&$skiptoken="+c.skipToken)),O=e+"/"+w(t)+"/"+o+"/children?"+g,_={Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"},[4,Object(l.f)(t,encodeURI(O),O,{method:l.b,mode:l.a,datapointNamePrefix:"getOneDriveItems"},_)];case 1:return j=r.sent(),y=JSON.parse(j),I=y["@odata.nextLink"]?function(e){var t=Object(d.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(y["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:y.value,skipToken:I}}]}}))}))}function y(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,a,c,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=i||m,o="expand=thumbnails(select=medium)&select="+p(),a=t+"/"+w(e)+"/"+i+"/children?"+o,c={name:n,folder:{}},(u=new Headers).append("Content-Type","application/json"),u.append("Accept","application/json"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.f)(e,encodeURI(a),a,{method:l.d,mode:l.a,body:JSON.stringify(c),datapointNamePrefix:"createNewFolder"},null)];case 2:return s=r.sent(),[2,{errorResponse:null,result:JSON.parse(s)}];case 3:return[2,{errorResponse:r.sent(),result:null}];case 4:return[2]}}))}))}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(b||(b={}));var I=n(2786),S=n(1371),k=n(280);var C=Object.freeze({folderInfo:{type:0,identifier:m},sliceSize:10485760,conflictBehavior:"rename",onProgress:function(){}});function T(e,t,n){var i=this,o=function(){return Promise.resolve({errorResponse:null,result:null})};return{uploadPromise:Object(r.__awaiter)(i,void 0,void 0,(function(){var i,a,c,u,d,f,p,b,h,v,m,g,_,j,y;return Object(r.__generator)(this,(function(T){switch(T.label){case 0:switch(function(e){Object.keys(C).forEach((function(t){e[t]=e[t]||C[t]}))}(n),i=n.fileToUpload,a=i.fileName,c=i.fileBlob,u=n.folderInfo,d=u.type,f=u.identifier,p=n.conflictBehavior,b=n.sliceSize,h=n.onProgress,d){case 0:v=t+"/"+w(e)+"/"+f+":/"+encodeURI(a)+":/createUploadSession";break;case 1:v=t+"/"+O(e)+"/"+f+":/"+encodeURI(a)+":/createUploadSession";break;default:Object(s.a)(d)}return m={item:{"@name.conflictBehavior":p}},[4,Object(S.a)(e,v,v,{method:l.d,mode:l.a,body:JSON.stringify(m),datapointNamePrefix:"createUploadSession"},null)];case 1:return g=T.sent(),_=function(e,t,n,i){var o=this,a=e.uploadUrl,c=t.size,u=null,l=null,d=function(e,t,n,i,o,a){var c=this;return function(u,s){return Object(r.__awaiter)(c,void 0,void 0,(function(){var c,l,d,f,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=function(e,t,n){var r=A(e,t,n),i=r.rangeStart,o=r.rangeEnd;return new Headers({"Content-Range":"bytes "+i+"-"+o+"/"+n,Accept:"application/json"})}(s,t,n),l=function(e){var r=A(e,t,n).rangeStart;return function(e){var t=e.loaded;i({loaded:r+t,total:n})}}(s),[4,(b=e,h=l,v={method:"PUT",body:u,headers:c},void 0===v&&(v={method:"POST"}),new Promise((function(e,t){var n=v.method,r=v.body,i=v.headers,o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&e({status:o.status,text:function(){return Promise.resolve(o.responseText)}})},o.ontimeout=function(){t(new Error("Request timed out"))},o.onerror=function(){t(new Error("Request failed"))},o.onabort=function(){t(new Error("Request aborted"))},h&&(o.upload.onprogress=h),o.open(n,b,!0),new Headers(i).forEach((function(e,t){o.setRequestHeader(t,e)})),r?o.send(r):o.send()})))];case 1:return 201!==(d=r.sent()).status&&200!==d.status?[3,3]:[4,d.text()];case 2:f=r.sent(),p=JSON.parse(f),o(p),r.label=3;case 3:if(!Object(k.a)(d.status))throw a(d),new Error("Unable to upload file");return[2]}var b,h,v}))}))}}(a,n,c,i,(function(e){u=e}),(function(e){l=e})),f=Object(I.a)(t,d,{sliceSize:n,numberOfSlicesToParallelize:1}),p=f.onCompletePromise,b=f.cancel,h=Object(r.__awaiter)(o,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,p];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{errorResponse:l,result:null}];case 4:switch(e){case 0:return u?[2,{errorResponse:null,result:u}]:[2,{errorResponse:l,result:null}];case 1:throw new Error("Upload was cancelled");default:return[2,Object(s.a)(e)]}return[2]}}))}));return{uploadPromise:h,cancel:function(){return Object(r.__awaiter)(o,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:b(),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,h];case 2:return e.sent(),[3,5];case 3:return[4,P(a)];case 4:return[2,e.sent()];case 5:return[2]}}))}))}}}(JSON.parse(g),c,b,h),j=_.uploadPromise,y=_.cancel,o=y,[4,j];case 2:return[2,T.sent()]}}))})),cancel:function(){return Object(r.__awaiter)(i,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,o()];case 1:return[2,e.sent()]}}))}))}}}function A(e,t,n){var r=e*t;return{rangeStart:r,rangeEnd:Math.min(r+t,n)-1}}function P(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,fetch(e,{method:"DELETE"})];case 1:return t=n.sent(),Object(k.a)(t.status)?[2,{errorResponse:null,result:null}]:[2,{errorResponse:t,result:null}]}}))}))}var E="https://api.dropboxapi.com/2/files";function x(e,t){switch(e){case 0:return t;case 1:return null;default:Object(s.a)(e)}return null}function L(e){return"file"===e[".tag"]}function N(e){return"folder"===e[".tag"]}function R(e){return"deleted"===e[".tag"]}function D(e){return"folder"===e.type}function F(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.path=e.path||"",t=E+"/list_folder",n={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,a(t,2,{requestInit:n})];case 1:return(i=r.sent()).ok?[4,i.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o).entries}];case 3:return[2,{errorResponse:i,result:null}]}}))}))}var M,U="https://api.box.com/2.0",B=2e3;function q(e,t){return void 0===t&&(t=B),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(U+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).entries}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(M||(M={}));var W=M,V="https://graph.facebook.com/v2.7",z=200;function H(e,t){return void 0===t&&(t=z),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(V+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).data}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}var G=n(632),J=n(633),Y=n(438),K=n(964),X=n(1045),Q=n(492),Z=n(245),$=n(75);function ee(e,t){var n=function(e,t){return Object(J.a)({ParentFolderIds:[Object(Y.a)({Id:e})],ItemShape:Object(Q.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return Object(G.a)({Header:Object(Z.a)(),Body:n})}function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(X.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,ee(e=e||Object(K.a)("inbox"),n)];case 1:return i=r.sent(),(o=i.Body.ResponseMessages.Items[0])&&"Success"===o.ResponseClass&&o.RootFolder.Items?[2,{errorResponse:null,result:o.RootFolder.Items}]:($.g.warn("Find Item Response of get mail messages failed with "+o),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}}))}))}n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return j})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"v",(function(){return T})),n.d(t,"i",(function(){return O})),n.d(t,"q",(function(){return _})),n.d(t,"e",(function(){return"https://api.onedrive.com"})),n.d(t,"b",(function(){return"https://api.dropboxapi.com/2/sharing"})),n.d(t,"d",(function(){return i})),n.d(t,"p",(function(){return x})),n.d(t,"t",(function(){return L})),n.d(t,"u",(function(){return N})),n.d(t,"s",(function(){return R})),n.d(t,"j",(function(){return F})),n.d(t,"r",(function(){return D})),n.d(t,"h",(function(){return q})),n.d(t,"a",(function(){return U})),n.d(t,"c",(function(){return W})),n.d(t,"k",(function(){return H})),n.d(t,"n",(function(){return te}))},1523:function(e,t,n){"use strict";var r=n(115),i=[0,1],o=n(1931),a=n(1901),c=n(10),u=n(314),s=n(1085);function l(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(a.a),messageParts:[Object(c.b)(a.a),d()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(o.b),messageParts:[Object(c.b)(o.b),d()],color:s.a.Red};default:return Object(u.a)(e)}}function d(){return{text:Object(c.b)(o.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(1485),p=n(1299),b=(n(1298),n(0)),h=n(76),v=n(26);function m(){var e=Object(v.a)();if(Object(h.h)("fwk-devTools")){if(Object(h.h)("doc-attachment-CA-readOnlyAccessIssues"))return Object(b.__assign)(Object(b.__assign)({},e),{AttachmentPolicy:Object(b.__assign)(Object(b.__assign)({},e.AttachmentPolicy),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0})});if(Object(h.h)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(b.__assign)(Object(b.__assign)({},e),{AttachmentPolicy:Object(b.__assign)(Object(b.__assign)({},e.AttachmentPolicy),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})})}return e}function g(){var e=m().AttachmentPolicy;return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return _})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return f.a})),n.d(t,"d",(function(){return p.a})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return m}));var O=new r.c((function(){return n.e(1199).then(n.bind(null,15416))})),_=new r.b(O,(function(e){return e.getAccessIssuesForAttachments}))},1538:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r={};function i(e,t){r[e]=t}function o(e){return e in r?r[e]:null}function a(e){r[e]=null}},1539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973),i="​";t.default=function(e,t){e.focus();var n=e.getSelectionRange();if(n&&n.collapsed){var o=n.startContainer;if("SPAN"==r.getTagOfNode(o)&&(!o.firstChild||"BR"==r.getTagOfNode(o.firstChild)&&!o.firstChild.nextSibling))e.addUndoSnapshot(),t(o);else o&&3==o.nodeType&&o.nodeValue==i&&"SPAN"==r.getTagOfNode(o.parentNode)||(e.addUndoSnapshot(),o=e.getDocument().createTextNode(i),n.insertNode(o)),r.applyTextStyle(o,t),e.select(o,-1)}else e.addUndoSnapshot((function(){for(var n,r,i=e.getSelectionTraverser(),o=i&&i.currentInlineElement;o;){var a=i.getNextInlineElement();o.applyStyle((function(e,i){t(e,i),n=n||e,r=e})),o=a}n&&r&&e.select(n,-2,r,-3)}),"Format")}},1554:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(r||(r={}))},1567:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(26),i=n(296),o=n(314),a=n(76);function c(e){var t=Object(r.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.h)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.h)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.h)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.h)("doc-fileProvider-facebook");case 1:return!!Object(i.a)()||t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(a.h)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.h)("doc-fileProvider-wopiClient");default:return Object(o.a)(e)}}},1575:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",(function(e){return{attachmentId:e}}))},1617:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return d}));var r=n(115),i=new r.c((function(){return Promise.all([n.e(1),n.e(5),n.e(13),n.e(19),n.e(334)]).then(n.bind(null,4224))})),o=Object(r.d)(i,(function(e){return e.TextColorPicker})),a=Object(r.d)(i,(function(e){return e.BackColorPicker})),c=Object(r.d)(i,(function(e){return e.FontNamePicker})),u=Object(r.d)(i,(function(e){return e.FontSizePicker})),s=Object(r.d)(i,(function(e){return e.InsertTableCallout})),l=new r.b(i,(function(e){return e.displayInsertLinkDialog})),d=new r.b(i,(function(e){return e.showImageAltTextDialog}))},1621:function(e,t,n){"use strict";var r=n(314),i=n(10),o=n(37),a="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",l="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",d="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",p="pdfprint.aspx?id={0}&location={1}",b=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var h=n(296),v=n(49),m=n(2),g=n(22),O=n(1395),_=n(106),w=n(239);function j(e,t,n,c,s,d,f,h,v){var m;switch(void 0===s&&(s=0),void 0===d&&(d=0),void 0===f&&(f=!0),void 0===h&&(h=null),void 0===v&&(v=null),n){case 0:m=u;break;case 3:m=p;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&b.indexOf(t.toLowerCase())>=0}(h))return null;m=l;break;default:Object(r.a)(n)}var O=c?d:s;!O&&s&&(O=s);var _=Object(i.c)("{0}{1}{2}&permissionLevel={3}",a,v,Object(i.c)(m,encodeURIComponent(e.Id),encodeURIComponent(t)),O);f&&(_=_+"&X-OWA-CANARY="+Object(o.a)());return Object(g.a)(_)}function y(e,t,n,u,l){var p;switch(void 0===u&&(u=!1),void 0===l&&(l=!0),n){case 0:p=c;break;case 1:p=s;break;case 2:p=d;break;case 3:p=f;break;default:return Object(r.a)(n)}if(!Object(i.f)(p)){var b=function(e,t,n,r,c){if(void 0===c&&(c=!1),!t||!t.Id||!t.mailboxInfo)return null;var u=t.mailboxInfo.userIdentity,s=u&&Object(w.p)(u),l=t.mailboxInfo.type===_.a.GroupMailbox,d=s&&!l?Object(_.c)(t.mailboxInfo.mailboxSmtpAddress)+u:e,f=Object(O.b)(t.mailboxInfo),p=null==f?void 0:f.downloadUrlBase,b=Object(i.c)(n,encodeURIComponent(t.Id));if(!p||c&&"Firefox"===Object(v.a)().browser){var j=a+b+"&X-OWA-CANARY="+Object(o.a)();return Object(g.a)(j)}var y="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(h.a)()&&(y+="&isc=1");var I=Object(i.c)(y,p,d,b,window.location.hostname,Object(m.l)()||"unofficial");return r&&(I+="&X-OWA-CANARY="+Object(o.a)(),I+="&token="+(null==f?void 0:f.downloadToken)),I}(e,t,p,l,3===n);return Object(i.c)("{0}{1}{2}",b,u?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return y}))},1623:function(e,t,n){"use strict";var r=n(0),i=n(435),o=n(1075);function a(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=t||Object(i.a)(),a={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null,noSubscriptionFailureReload:!0},c=function(t){e(t)&&o.g.importAndExecute(a,c)},[4,o.f.import()];case 1:return r.sent()(a,c),[4,o.b.import()];case 2:return u=r.sent()(),[2,[n,a,c,u]]}}))}))}n.d(t,"a",(function(){return a}))},1640:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25),i=n(1344);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},1654:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(115),i=n(1179);n.d(t,"e",(function(){return i.a})),n.d(t,"b",(function(){return i.b}));var o=n(1501);n.d(t,"d",(function(){return o.a}));var a=n(1300);n.d(t,"c",(function(){return a.a}));var c=new r.c((function(){return n.e(273).then(n.bind(null,2973))})),u=Object(r.d)(c,(function(e){return e.CloudIconWithOverlay}))},1656:function(e,t,n){"use strict";var r=n(1621);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var i=n(1395);n.d(t,"c",(function(){return i.a}))},1673:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.View=0]="View",e[e.EnteringEdit=1]="EnteringEdit",e[e.Edit=2]="Edit",e[e.Saving=3]="Saving"}(r||(r={}))},1679:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25);function i(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},1687:function(e,t,n){"use strict";var r;!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub",e[e.FolderTree=12]="FolderTree"}(r||(r={})),t.a=r},1692:function(e,t,n){"use strict";var r=n(314),i=n(106),o=n(1656),a=n(37),c=n(1469);function u(e,t,n,a,u){var s;void 0===u&&(u=!0);var l=t,d=l.AttachmentId,f=l.Name,p=l.OriginalPermissionType,b=l.PermissionType,h=Object(c.a)(t),v=(null===(s=null==e?void 0:e.mailboxInfo)||void 0===s?void 0:s.type)===i.a.GroupMailbox?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return o.b(d,h,n,a,b,p,u,f,v);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:o.b(d,h,1,a,b,p,u,f,v);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function s(e,t,n,r){var i;return void 0===n&&(n=!1),void 0===r&&(r=!0),o.a(null===(i=e.mailboxInfo)||void 0===i?void 0:i.routingKey,e,t,n,r)}function l(e,t,n,r,i){void 0===i&&(i=!1);var c=n?u(e,t,1,r,!1):s(e,1,i,!1);if(n)return{url:c,init:{credentials:"include"}};var l=Object(o.c)(e.mailboxInfo),d=new Headers;return d.set("X-Token",l),d.set("X-OWA-CANARY",Object(a.a)()),{url:c,init:{headers:d}}}function d(e,t,n,r,i,o){return void 0===o&&(o=!1),r?u(e,t,n,i):s(e,n,o)}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l}))},1703:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Initial=0]="Initial",e[e.Adaptive=1]="Adaptive",e[e.Show=2]="Show",e[e.Hide=3]="Hide",e[e.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},1729:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Blank=0]="Blank",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Custom=3]="Custom",e[e.Image=4]="Image",e[e.Wac=5]="Wac",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.Text=8]="Text",e[e.NativePdf=9]="NativePdf",e[e.PdfJs=10]="PdfJs",e[e.IFrame=11]="IFrame"}(r||(r={}))},1742:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1743:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1360);function i(){return Object(r.a)().loadState}},1746:function(e,t,n){var r=n(1278);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},1747:function(e,t,n){"use strict";var r=n(284);t.a=Object(r.action)("setShouldShowImageOverlay")((function(e,t){e.shouldShowImageOverlay=t}))},1755:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1282);t.default=function(e){return r.default(e,"HTMLElement")}},1760:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1761:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},1762:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2418),i=n(2261),o=n(2353),a=n(10),c=n(314);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(a.b)(o.b);case 1:return Object(a.b)(o.a);case 2:case 9:return Object(a.b)(r.b);case 3:case 7:return Object(a.b)(r.a);case 5:return Object(a.b)(r.e);case 6:return Object(a.b)(r.d);case 4:return Object(a.b)(r.f);case 10:return Object(a.b)(i.b);case 8:return Object(a.b)(r.c);default:return Object(c.a)(e)}}},1764:function(e,t,n){"use strict";var r=n(284);t.a=Object(r.action)("addCompletedAction")((function(e,t){e.completedActions.push(t)}))},1789:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1790:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1791:function(e,t,n){var r=n(1746),i=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},1792:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(0),i=n(314),o=n(1875),a=n(296);var c=Object(o.a)((function(e){switch(e){case 0:return t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},Object(r.__assign)(Object(r.__assign)({},t),{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return function(){var e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object(r.__assign)(Object(r.__assign)({},e),{supportConvertCloudyToClassic:Object(a.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(i.a)(e)}var t})),u=c.getDataProviderInfo,s=c.getDefaultDataProviderInfo;t.a=u},1830:function(e,t,n){"use strict";var r=n(284);t.a=Object(r.action)("setInlineAttachmentStatus")((function(e,t){e.status=t}))},1844:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(4),i=Object(r.action)("tryProcessSharePointLink",(function(e,t,n){return{element:e,itemId:t,sxsId:n}})),o=Object(r.action)("tryUndoProcessSharePointLink",(function(e){return{elements:e}})),a=Object(r.action)("previewLinkInSxS",(function(e,t,n,r){return{wacUrlGetter:e,itemId:t,targetWindow:n,sxsId:r}}))},1847:function(e,t,n){"use strict";var r=n(1),i=r.createContext(window);t.a=i},1849:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}));var r={};function i(e,t,n){r[e.editorId]={htmlEditor:t,plainTextEditor:n}}function o(e,t,n){var i=r[e.editorId];i&&(i.htmlEditor==t&&(i.htmlEditor=null),i.plainTextEditor==n&&(i.plainTextEditor=null),i.htmlEditor||i.plainTextEditor||delete r[e.editorId])}function a(e,t,n,i){if(e){var o=e.bodyType,a=void 0===o||"HTML"===o,c="Text"===o,u=r[e.editorId]||{},s=u.htmlEditor,l=u.plainTextEditor;a&&t&&(s&&!s.isDisposed()||i)?t(s):c&&n&&(l||i)&&n(l)}}},1875:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1024),o=n(1084),a=[0,1,3,2,6,5,7,8,4];function c(e){var t=null,n=function(n){var i=Object(o.b)(n);return null===i?null:function(){var n,i;if(!t){t={};try{for(var o=Object(r.__values)(a),c=o.next();!c.done;c=o.next()){var u=c.value;t[u]=e(u)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}return t}()[i]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?i.l:i.m)}}}},1879:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(979);function i(e){var t=(Object(r.a)(e)||"").toLowerCase();return!!e&&".fluid"===t}},1882:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},1883:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(1077),o=n(1084);function a(e,t,n,a,c,u,s){void 0===c&&(c=o.a.Unknown),void 0===u&&(u=!1),void 0===s&&(s=null);var l=Object(i.c)(e,t,a,u,c,s),d=l.strategy;return Object(r.__assign)(Object(r.__assign)({},l),{attachmentType:0,strategy:Object(r.__assign)(Object(r.__assign)({},d),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},1901:function(e){e.exports=JSON.parse('{"a":"Cia"}')},1909:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=null,i={register:function(e){r=e},run:function(e,t,n){r&&r(e,t,n)}}},1913:function(e,t,n){"use strict";function r(e,t){if(null===e)return[];var n=[];if(0===t){var r=e;r.CanShareInternally&&(n.push(2),n.push(1)),r.CanCreateOrganizationEditLink&&n.push(6),r.CanCreateOrganizationViewLink&&n.push(5)}return e.CanCreateAnonymousEditLink&&n.push(4),e.CanCreateAnonymousViewLink&&n.push(3),n.length>0?n:[]}function i(e,t,n){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;case 6:return n?t?2:1:0;default:return 0}}function o(e,t,n){var r=i(e,n);if(0===r)switch(t){case 2:return n?4:3;case 1:return n?6:5;case 5:return n?2:1;default:return 0}return r}var a=n(3097),c=n(10),u="OneDrivePro",s=n(314),l=n(26);function d(e,t){switch(e){case 3:return Object(c.b)(a.b);case 4:return Object(c.b)(a.a);case 6:return Object(c.b)(a.d);case 5:return Object(c.b)(a.e);case 1:return t===u?Object(c.b)(a.g):Object(c.b)(a.b);case 2:return t===u?Object(c.b)(a.f):Object(c.b)(a.a);case 0:return Object(c.b)(a.c);default:return Object(s.a)(e)}}function f(e,t){return 0===t?function(e){var t,n=null===(t=Object(l.a)().SessionSettings)||void 0===t?void 0:t.CompanyName;switch(e){case 3:return Object(c.b)(a.i);case 4:return Object(c.b)(a.h);case 6:return Object(c.c)(Object(c.b)(a.j),n);case 5:return Object(c.c)(Object(c.b)(a.k),n);case 1:return Object(c.b)(a.g);case 2:return Object(c.b)(a.f);case 0:return Object(c.b)(a.c);default:return Object(s.a)(e)}}(e):d(e,null)}function p(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return p}))},1931:function(e){e.exports=JSON.parse('{"a":"Aia","b":"Bia"}')},1937:function(e,t,n){"use strict";var r=n(4),i=n(118),o=Object(r.action)("addCalendarEventsAttachment",(function(e,t){return Object(i.c)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e})}));t.a=o},1959:function(e,t,n){"use strict";n.r(t),n.d(t,"EnteredEditModeEvent",(function(){return r})),n.d(t,"ExitedEditModeEvent",(function(){return i})),n.d(t,"PreviewLoadEvent",(function(){return o})),n.d(t,"PreviewErrorEvent",(function(){return a})),n.d(t,"PreviewLoadOrErrorEvent",(function(){return c})),n.d(t,"CloseEvent",(function(){return u})),n.d(t,"AnimationEndEvent",(function(){return s}));var r="EnteredEditMode",i="ExitedEditMode",o="PreviewLoad",a="PreviewError",c="PreviewLoadOrError",u="Close",s="AnimationEnd"},1968:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(115),i=new r.c((function(){return n.e(549).then(n.bind(null,3180))})),o=new r.b(i,(function(e){return e.extractFileUrlFromOfficeSharePointLink})),a=new r.b(i,(function(e){return e.isLinkPrefixedWithBaseUrl})),c=new r.b(i,(function(e){return e.isSharePointLink})),u=new r.b(i,(function(e){return e.isSharePointServiceGeneratedLink})),s=new r.b(i,(function(e){return e.isOfficeSharePointLink})),l=new r.b(i,(function(e){return e.getParsedQueryStringFromUrl}))},1991:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(979),i=[".txt",".xml",".log"];function o(e){return a(Object(r.a)(e))}function a(e){return!!e&&i.indexOf(e.toLowerCase())>=0}},1994:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973);t.default=function(e,t){var n=e.getElementAtCursor("OL,UL");if(r.Browser.isChrome&&"indent"!==t){var i=e.getElementAtCursor("LI");if(i){var o=e.getSelectionRange(),a=r.getSelectionPath(i,o);if(o&&(o.collapsed||e.getElementAtCursor("LI",o.startContainer)==i&&e.getElementAtCursor("LI",o.endContainer)==i))if("OL"===n.tagName&&"insertUnorderedList"===t||"UL"===n.tagName&&"insertOrderedList"===t)e.getDocument().execCommand(t,!1,null);else{var c=n.parentElement;if("OL"==c.tagName||"UL"==c.tagName)i.nextElementSibling&&r.splitBalancedNodeRange(i),n.insertAdjacentElement("afterend",i),e.select(r.createRange(i,a.start,a.end));else{i.nextElementSibling&&r.splitBalancedNodeRange(i);var u=r.wrap(r.toArray(i.childNodes)),s=r.createRange(u,a.start,a.end),l=r.getSelectionPath(u,s);n.insertAdjacentElement("afterend",u),e.deleteNode(i);var d=r.createRange(u,l.start,l.end);e.select(d)}0==n.childElementCount&&e.deleteNode(n)}else e.getDocument().execCommand(t,!1,null)}else e.getDocument().execCommand(t,!1,null)}else e.getDocument().execCommand(t,!1,null);var f=e.getElementAtCursor("OL,UL");return f==n&&(f=null),f}},2024:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},2037:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function i(e){return!!e.ContentType&&r.indexOf(e.ContentType.toLowerCase())>-1}},2040:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1359),i=n(1879),o=n(76);function a(e){var t=[];return null==e||e.forEach((function(e){var n=Object(r.a)(e),a=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(n.permissionLevel),c=Object(o.h)("cmp-fluidPreredeem")&&function(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}(a)&&Object(i.a)(n.fileName);if(1===a||2===a||c){var u={ProviderType:"OneDrivePro",Url:n.url,PermissionType:a};t.push(u)}})),t}},2050:function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(1137),a=n(1089),c=n(314),u=n(1077);function s(e){switch(e){case a.a.Download:return u.a.Download;case a.a.OpenInNewTab:return u.a.OpenInNewTab;case a.a.Preview:return u.a.Preview;case a.a.ImportCalendarEventAttachment:case a.a.ChangePermissions:case a.a.CopyLink:case a.a.SaveToCloud:case a.a.ViewInProvider:case a.a.ConvertClassicToCloudy:case a.a.ConvertCloudyToClassic:case a.a.MoveAttachmentToInline:case a.a.RefreshLink:case a.a.IgnoreExpiration:return null;default:return Object(c.a)(e)}}function l(e){switch(e){case u.a.Download:return a.a.Download;case u.a.OpenInNewTab:return a.a.OpenInNewTab;case u.a.Preview:return a.a.Preview;case u.a.NoAction:return null;default:return Object(c.a)(e)}}var d=n(1792);var f=n(1049),p=n(296),b=n(1523);function h(e,t,n,i,a,c,p,h,m,g,O){var _=Object(u.d)(t,n,i,g);!function(e,t){var n=Object(b.c)();0===n?e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download})):1===n&&(e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download&&e!==u.a.Preview})));var r=function(e,t,n){void 0===n&&(n=!1);var r=e.filter((function(e){return-1!==t.indexOf(e)}));return n&&(r=r.filter((function(e,t,n){return n.indexOf(e)===t}))),r}(e.supportedOpenActions.map(l).filter((function(e){return!!e})),t);e.supportedOpenActions=r.map(s)}(_,h);var w,j=function(e){return e.__type===f.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(i),y=g&&function(e){return e.__type===f.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(i),I=Object(o.d)(i,j||y,m,O),S=j,k=v(j,y,c),C=function(e,t,n){return e.convertClassicToCloudyEnabled&&!t&&!n}(e,j||y,m),T=function(e,t,n,r,i){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){var o=Object(d.a)(i);return(null==o?void 0:o.supportConvertCloudyToClassic)||!1}return!1}(e,j,m,p,a),A=function(e,t,n,r){return 2===e&&!t&&!n&&!r}(n,j,y,m);switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:w=function(e,t,n,i,o,a,c,u){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isOpeningByLinkSupported:n,isOpeningInProviderSupported:i,isViewingInProviderSupported:o,isConvertClassicToCloudySupported:a,isConvertCloudyToClassicSupported:c,isMoveAttachmentToInlineSupported:u,showActionsMenu:!0,supportedMenuActions:[]})}(_,I,j||y,S,k,C,T,A);break;case 1:w=function(e){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(_);break;default:w=j?function(e,t,n,i){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:t,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:i,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(_,S,k,T):function(e,t,n,i){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:i,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(_,I,k,C)}return w.supportedMenuActions=h,w}function v(e,t,n){if(e||t)return!1;var r=Object(p.a)(),o=Object(d.b)(r);return!Object(i.f)(n)&&(r||(null==o?void 0:o.supportViewInProvider))}n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return v}))},2060:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ConversationReadingPane=0]="ConversationReadingPane",e[e.ItemReadingPane=1]="ItemReadingPane"}(r||(r={}))},2067:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d}));var r=n(115),i=n(2024);n.d(t,"a",(function(){return i.a}));var o=new r.c((function(){return Promise.all([n.e(45),n.e(276)]).then(n.bind(null,4106))})),a=new r.b(o,(function(e){return e.createGetSharingInfoResponse})),c=new r.b(o,(function(e){return e.checkSharingLinkUrlDomain})),u=new r.b(o,(function(e){return e.getLinkProviderType})),s=new r.b(o,(function(e){return e.isOneDriveProRelatedLink})),l=new r.b(o,(function(e){return e.convertToAttachmentDataProviderType})),d=new r.b(o,(function(e){return e.convertToLinkProviderType}))},2088:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected",e[e.SelectedAndPending=3]="SelectedAndPending",e[e.SelectedAndSaving=4]="SelectedAndSaving",e[e.NotSelectedAndSaving=5]="NotSelectedAndSaving",e[e.OtherSaving=6]="OtherSaving",e[e.PendingNavigation=7]="PendingNavigation"}(r||(r={})),t.a=r},2094:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3063);t.changeFontSize=r.default,t.FONT_SIZES=r.FONT_SIZES;var i=n(3064);t.clearBlockFormat=i.default,t.TAGS_TO_UNWRAP=i.TAGS_TO_UNWRAP,t.TAGS_TO_STOP_UNWRAP=i.TAGS_TO_STOP_UNWRAP,t.ATTRIBUTES_TO_PRESERVE=i.ATTRIBUTES_TO_PRESERVE;var o=n(3065);t.clearFormat=o.default;var a=n(3066);t.createLink=a.default;var c=n(3067);t.getFormatState=c.default,t.getElementBasedFormatState=c.getElementBasedFormatState,t.getStyleBasedFormatState=c.getStyleBasedFormatState;var u=n(3068);t.insertImage=u.default;var s=n(3069);t.insertTable=s.default;var l=n(3070);t.editTable=l.default;var d=n(3071);t.formatTable=d.default;var f=n(3072);t.removeLink=f.default;var p=n(3073);t.replaceWithNode=p.default;var b=n(3074);t.setAlignment=b.default;var h=n(2356);t.setBackgroundColor=h.default;var v=n(2359);t.setTextColor=v.default;var m=n(3075);t.setDirection=m.default;var g=n(2357);t.setFontName=g.default;var O=n(2358);t.setFontSize=O.default;var _=n(3076);t.setImageAltText=_.default;var w=n(3077);t.setIndentation=w.default;var j=n(2360);t.toggleBold=j.default;var y=n(3079);t.toggleBullet=y.default;var I=n(2361);t.toggleItalic=I.default;var S=n(3080);t.toggleNumbering=S.default;var k=n(3081);t.toggleBlockQuote=k.default;var C=n(3082);t.toggleCodeBlock=C.default;var T=n(3083);t.toggleStrikethrough=T.default;var A=n(3084);t.toggleSubscript=A.default;var P=n(3085);t.toggleSuperscript=P.default;var E=n(2362);t.toggleUnderline=E.default;var x=n(3086);t.toggleHeader=x.default;var L=n(973);t.getPendableFormatState=L.getPendableFormatState},2103:function(e,t,n){"use strict";var r=n(0),i=n(76),o=n(10),a=n(2967),c=n(3178),u=n(1476),s=n(3098),l=n(2422);function d(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,l.f.import()];case 1:return(n=r.sent())?[4,n(e.AttachLongPathName)]:[3,3];case 2:t=r.sent(),r.label=3;case 3:return[2,t]}}))}))}var f=n(2557),p=n(3006),b=n(1272),h=n(2668),v=n(1137),m=n(26),g=n(75),O=n(284),_=n(1148);var w=n(1241);t.a=Object(O.action)("addAndInitializeAttachments")((function(e,t,n,l){void 0===n&&(n=!1),void 0===l&&(l=!1);var j=Object(_.a)();n||(e=e.filter((function(e){return!j.attachments.has(e.attachment.AttachmentId.Id)}))),e.map((function(e){var n=e.attachmentId,j=e.attachment,y=e.permissionInfo,I=e.modelInitializationValues,S=function(e,t){var n={id:e,type:Object(w.a)(t),download:{url:null},attachmentClass:0,previewImage:{url:null},thumbnailImage:{url:null},info:{allowDownload:!1,supportedPermissionLevels:[],sharingInfo:null},model:t};return 1===n.type?Object(r.__assign)(Object(r.__assign)({},n),{type:1,openUrl:null,originalUrl:null,isFolder:t.AttachmentIsFolder,requiresFetchingSharingInformation:!1}):n}(n,j);return l||function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){var l,w,j,y,I,S,k;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return l=Object(b.a)(e),w=Object(v.b)(e.model,!0),j=Object(c.a)(w,e.model),e.attachmentClass=j,e.info=Object(a.a)(w,j,e.model,l,l?e.model.ProviderType:null,t),e.info.allowDownload&&(e.download.url=Object(f.a)(e.id,e.model,!0,!0)),l?(e.openUrl=Object(p.a)(e.model,Object(m.a)()),Object(i.h)("doc-unwrap-safelinks")?(y=e,[4,d(e.model)]):[3,2]):[3,3];case 1:y.originalUrl=r.sent(),r.label=2;case 2:n||(I=e.model,(null==(S=Object(u.a)(I.ProviderType))?void 0:S.requiresFetchingSharingInformation)&&!Object(o.f)(I.AttachLongPathName)&&(e.requiresFetchingSharingInformation=!0)),r.label=3;case 3:return Object(h.a)(e.model)&&(k=e.id.Id,Object(s.a)(e.id,e.model,l).then(Object(O.action)("updateAttachmentThumbnailUrl")((function(e){Object(_.a)().attachments.has(k)&&(Object(_.a)().attachments.get(k).thumbnailImage.url=e)})),(function(e){g.g.warn(e)}))),[2]}}))}))}(S,y,t),function(e,t){t=t||{},Object.keys(t).forEach((function(n){t[n]&&(e[n]=t[n])}))}(S,I||{}),S})).forEach((function(e){j.attachments.set(e.id.Id,e)}))}))},2126:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded",e[e.attachingAsACopy=4]="attachingAsACopy",e[e.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2169:function(e,t,n){"use strict";var r=n(23),i=n(4),o={sharingLinks:new r.ObservableMap({})},a=Object(i.createStore)("sharingLinkStore",o);t.a=a},2193:function(e,t,n){"use strict";function r(e,t,n){var r,i=e||((null===(r=null===window||void 0===window?void 0:window.navigator)||void 0===r?void 0:r.userAgent)?window.navigator.userAgent:""),o=-1!==i.indexOf("MSIE")||-1!==i.indexOf("rv:")&&-1!==i.indexOf("Trident"),a=-1===i.indexOf("Edge")&&-1!==i.indexOf("Chrome"),c=-1!==i.indexOf("Firefox"),u=-1!==i.indexOf("Edge");return a?function(e){e=e||(null===navigator||void 0===navigator?void 0:navigator.plugins);try{return e&&"function"==typeof e.namedItem&&(null!==e.namedItem("Chrome PDF Viewer")||null!==e.namedItem("Microsoft Edge PDF Viewer"))}catch(e){return!1}}(n):o?function(e){try{return null!==e("AcroPDF.PDF")}catch(e){return!1}}(t||function(e){return new ActiveXObject(e)}):!c&&!u}n.d(t,"a",(function(){return r}))},2194:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1024),i=n(1476),o=n(1137),a=n(49),c=n(76);function u(e,t,n){var u=e.level!==o.a.Block&&e.directFileAccessEnabled;return u&&t.__type===r.n&&(u=function(e,t){if(e.AttachLongPathName){var n=document.createElement("a");if(n.href=e.AttachLongPathName,(!Object(c.h)("doc-unwrap-safelinks")||Object(a.i)())&&n.host.indexOf(s,0)>0||n.search.indexOf(l,0)>0)return!1}if(r=e.ProviderType,o=Object(i.a)(r),(null==o?void 0:o.supportDownload)&&!e.AttachmentIsFolder)return".fluid"!==t&&!function(e,t){return!(e||t&&"application/onenote"!==t&&"image/png"!==t)}(t,e.ContentType);var r,o;return!1}(t,n)),u}var s="safelinks.protection.outlook.com",l="b7780972f918485c8cfc32b1ba7438eb"},2201:function(e,t,n){"use strict";var r=n(284);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(e,t){e.shouldShowContextMenu=t}))},2204:function(e,t,n){"use strict";var r=n(1443),i=n(0),o=n(1290),a=n(1070);var c=n(2771);function u(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return e.strategy.previewMethod!==a.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||(r=e.strategy).previewMethod===a.a.Wac&&(r.previewMethod=a.a.Unsupported,r.supportedOpenActions=r.supportedOpenActions.filter((function(e){return e!==o.a.Preview}))),n.label=2;case 2:return[2]}var r}))}))}var s=n(1883),l=n(1084),d=n(1346),f=n(2103),p=n(1005);function b(e,t,n,i,o,a,c,b,h){void 0===c&&(c=null),void 0===h&&(h=!1),Object(f.a)([{attachmentId:e,attachment:t}],n,o);var v=Object(p.a)(e),m=Object(s.a)(e,n,i,1===v.type,l.a.Unknown,!1,c);if(Object(r.a)(m,v,!1,b,a),h){var g=v.model.ProviderType;Object(d.b)(m.isCloudy,g,v.model.Name)||u(m)}return m}n.d(t,"a",(function(){return b}))},2228:function(e,t,n){"use strict";var r=n(115),i=n(1538);n.d(t,"a",(function(){return i.a})),n.d(t,"d",(function(){return i.c}));var o=n(1261);n.d(t,"b",(function(){return o.b}));var a=n(1567);n.d(t,"c",(function(){return a.a}));var c=new r.c((function(){return n.e(275).then(n.bind(null,3644))})),u=new r.a(c,(function(e){return e.addFileProviderAfterAuthFinished}));"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.lazyAddFileProviderAfterAuthFinished=u);new r.b(c,(function(e){return e.getAddableFileProviderInfo})),new r.b(c,(function(e){return e.addFileProvider})),new r.b(c,(function(e){return e.createAddableFileProviderInfo})),new r.b(c,(function(e){return e.getAuthRedirectPageUrl}))},2261:function(e){e.exports=JSON.parse('{"a":"jha","b":"kha"}')},2262:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2228);function i(e){return Object(r.c)(e)}},2268:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function i(e){return e&&void 0!==e.fetchErrorType}function o(e,t){e.addCustomProperty("ErrorInformation",t)}function a(e,t){o(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a}))},2269:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(980);function i(e){var t="";return(null==e?void 0:e.model)&&(t=Object(r.c)(e.model.Name||"")||e.model.ContentType||""),t}},2298:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l}));var r=n(115),i=n(1844);n.d(t,"f",(function(){return i.a}));var o=new r.c((function(){return n.e(548).then(n.bind(null,3950))})),a=new r.b(o,(function(e){return e.tryProcessSharePointLink})),c=new r.b(o,(function(e){return e.tryUndoProcessSharePointLink})),u=new r.b(o,(function(e){return e.docLinkHadPreviewInfo})),s=new r.b(o,(function(e){return e.forceGetWacInfoOperation})),l=new r.b(o,(function(e){return e.getValidDocLinkPreviewInfo}))},2309:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}function i(e){return void 0!==e.length}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},2310:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1968),o=n(123),a=n(58);function c(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,i.b.import()];case 1:return t=n.sent(),[2,u(t(e))]}}))}))}function u(e){if(!Object(o.b)(null==e?void 0:e.nav)){var t={nav:e.nav};return Object(a.stringify)(t)}return null}},2311:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(1517),i="file provider is not addable";function o(e){return r.a.indexOf(e)>-1}},2313:function(e,t,n){"use strict";var r=n(284);t.a=Object(r.action)("setOngoingAction")((function(e,t){e.ongoingAction=t}))},2314:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoOp=0]="NoOp",e[e.AlwaysHidden=1]="AlwaysHidden",e[e.CopyMailReadingPaneContainer=2]="CopyMailReadingPaneContainer",e[e.LoadConversationReadingPane=3]="LoadConversationReadingPane",e[e.LoadItemReadingPane=4]="LoadItemReadingPane"}(r||(r={}))},2323:function(e,t,n){"use strict";var r="color",i="bgcolor",o="data-ogsc",a="data-ogac",c="data-ogsb",u="data-ogab";function s(e){return{attrColor:e.getAttribute(r)||null,attrBgColor:e.getAttribute(i)||null,styleColor:e.style.getPropertyValue("color"),styleBgColor:e.style.getPropertyValue("background-color")}}function l(e,t){return e.hasAttribute(t)?e.getAttribute(t)||null:void 0}function d(e){return{attrColor:l(e,a),attrBgColor:l(e,u),styleColor:l(e,o),styleBgColor:l(e,c)}}function f(e,t){void 0!==t.attrColor&&!e.hasAttribute(a)&&e.setAttribute(a,t.attrColor||""),void 0!==t.attrBgColor&&!e.hasAttribute(u)&&e.setAttribute(u,t.attrBgColor||""),void 0!==t.styleColor&&!e.hasAttribute(o)&&e.setAttribute(o,t.styleColor||""),void 0!==t.styleBgColor&&!e.hasAttribute(c)&&e.setAttribute(c,t.styleBgColor||"")}function p(e,t){void 0!==t.attrColor&&(null===t.attrColor?e.removeAttribute(r):e.setAttribute(r,t.attrColor||"")),void 0!==t.attrBgColor&&(null===t.attrBgColor?e.removeAttribute(i):e.setAttribute(i,t.attrBgColor||"")),void 0!==t.styleColor&&e.style.setProperty("color",t.styleColor||""),void 0!==t.styleBgColor&&e.style.setProperty("background-color",t.styleBgColor||"")}var b=n(246);function h(e){var t=e.currentTarget,n=t.getElementsByTagName("*"),r=Object(b.c)();r&&(t.style.backgroundColor="white",t.style.color="black");for(var i=[],o=0;o<n.length;o++){var a=n[o],c=d(a);i.push(s(a)),p(a,c)}window.requestAnimationFrame((function(){r&&(t.style.backgroundColor="",t.style.color="");for(var e=0;e<n.length;e++)p(n[e],i[e])}))}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return h}))},2327:function(e,t,n){"use strict";var r=n(573),i=n(2);function o(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s}));var a=Object(i.E)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.m)()+"/mail/"+n+t}function u(e){var t=Object(r.m)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return a+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,i,a){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),c=o(t,"client_id",r);if(c=o(c,"redirect_uri",n),c=o(c,"response_type",i),a){var u=a(e);c=Object.keys(u).reduce((function(e,t){return o(e,t,u[t])}),c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2353:function(e){e.exports=JSON.parse('{"b":"lha","a":"mha"}')},2355:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973);function i(e){var t=e.getStartNode();return e instanceof r.StartEndBlockElement&&t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf(r.getTagOfNode(t.parentNode))>=0}t.default=function(e,t){for(var n=e.getSelectionTraverser(),r=n&&n.currentBlockElement,o=[];r;)i(r)||o.push(r),r=n.getNextBlockElement();o.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}},2356:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1539);t.default=function(e,t){if("string"==typeof t){var n=t.trim();r.default(e,(function(e,t){e.style.backgroundColor=t?"":n}))}else{var i=e.isDarkMode(),o=i?t.darkModeColor:t.lightModeColor;r.default(e,(function(e,n){e.style.backgroundColor=n?"":o,i&&(e.dataset.ogsb=t.lightModeColor)}))}}},2357:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1539);t.default=function(e,t){t=t.trim(),r.default(e,(function(e,n){e.style.fontFamily=n?"":t}))}},2358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1539),i=n(973);t.default=function(e,t){t=t.trim(),r.default(e,(function(e,n){e.style.fontSize=n?"":t,"normal"!=i.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))}},2359:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1539);t.default=function(e,t){if("string"==typeof t){var n=t.trim();r.default(e,(function(e,t){e.style.color=t?"":n}))}else{var i=e.isDarkMode(),o=i?t.darkModeColor:t.lightModeColor;r.default(e,(function(e,n){e.style.color=n?"":o,i&&(e.dataset.ogsc=t.lightModeColor)}))}}},2360:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1259);t.default=function(e){r.default(e,"bold")}},2361:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1259);t.default=function(e){r.default(e,"italic")}},2362:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1259);t.default=function(e){r.default(e,"underline")}},2363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,r){e.getSelectedRegions().forEach((function(e){return t(e,n,r)})),e.select(n,r)}),"Format")}},2364:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2363),i=n(973);t.default=function(e,t){r.default(e,(function(e,n,r){var o=i.createVListFromRegion(e,!0);o&&(o.changeListType(n,r,t),o.writeBack())}))}},2365:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973),i="&#8203;",o="LI,THEAD,TBODY,TR,TD,TH".split(","),a=function(e){};t.default=function(e,t,n,c,u){void 0===c&&(c=function(e){return r.wrap(e,t)}),void 0===u&&(u=r.unwrap),e.focus(),e.addUndoSnapshot((function(s,l){var d,f=e.getSelectionRange();if(f&&0==e.queryElements(t,1,u).length){var p=r.Position.getStart(f).normalize().node,b=e.getBlockElementAtNode(p),h=r.Position.getEnd(f).normalize().node,v=e.getBlockElementAtNode(h),m=b&&v?e.collapseNodes(b.getStartNode(),v.getEndNode(),!0):[];if(0==m.length)m=r.fromHtml("<DIV>"+(r.Browser.isIEOrEdge?i:"<BR>")+"</DIV>",e.getDocument()),e.insertNode(m[0]),e.select(m[0],0);else if(1==m.length){var g=r.getTagOfNode(m[0]);"BR"==g?m=[r.wrap(m[0])]:"LI"!=g&&"TD"!=g||(m=r.toArray(m[0].childNodes))}else for(;m[0]&&e.contains(m[0].parentNode)&&m.some((function(e){return o.indexOf(r.getTagOfNode(e))>=0}));)m=[r.splitBalancedNodeRange(m)];d=c(m),(n||a)(d)}return!e.select(s,l)&&d&&e.select(d),d}),"Format")}},2374:function(e,t,n){"use strict";var r=null,i={register:function(e){r=e},available:function(){return!!r},run:function(e,t){r&&r(e,t)}};t.a=i},2375:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),i=n(298),o=n(645),a=n(569),c=n(492),u=n(646),s=n(245),l=n(75),d="0xe0b",f=Object(i.a)({PropertyTag:d,PropertyType:"Binary"});function p(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=null,i=Object(c.a)({BaseShape:"IdOnly",AdditionalProperties:[f]}),[4,b([e],i)];case 1:return o=r.sent(),"Success"===(null===(t=null==o?void 0:o[0])||void 0===t?void 0:t.ResponseClass)&&(a=o[0],u=a.Items[0],n=function(e,t){var n;if(e){var r=e.ExtendedProperty;if(r)for(var i=r.length,o=0;o<i;o++){var a=r[o];if((null===(n=a.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===t)return a}}return null}(u,d)),n?[2,n.Value]:(l.g.info("[getImmutableEntryId] extendedProperty could not be retrieved"),[2,null])}}))}))}function b(e,t){var n=Object(s.a)(),r=e.map((function(e){return Object(a.a)({Id:e})}));return Object(u.a)({Header:n,Body:Object(o.a)({ItemShape:t,ItemIds:r})}).then((function(e){var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items})).catch((function(e){return l.g.warn("GetItem:"+e.message),null}))}},240:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,a){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){o(t),a&&a(t,n)}.bind(this),i)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var a=e[o];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return i&&t++,a.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(o)if(e[a])continue;var c=r[a],u=c.expire-i;if(u<=0){this.del(a);continue}u=u>0?u:void 0,this.put(a,c.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},2418:function(e){e.exports=JSON.parse('{"b":"dha","a":"eha","e":"fha","d":"gha","f":"hha","c":"iha"}')},2422:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return c}));var r=n(115),i=n(1361);n.d(t,"b",(function(){return i.b})),n.d(t,"d",(function(){return i.d})),n.d(t,"a",(function(){return i.a})),n.d(t,"c",(function(){return i.c})),n.d(t,"e",(function(){return i.e}));var o=new r.c((function(){return n.e(257).then(n.bind(null,4227))})),a=new r.b(o,(function(e){return e.evaluateSafeLink})),c=(new r.b(o,(function(e){return e.evaluateSafeLinks})),new r.b(o,(function(e){return e.isSafeLink})))},2423:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",(function(){return r}))},2464:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("loadItemAttachment",(function(e,t){return{itemAttachmentId:e,perfDatapoint:t}}))},2556:function(e,t,n){"use strict";var r=n(1148),i=n(284);t.a=Object(i.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},2557:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1024),i=n(1272),o=n(1692);function a(e,t,n,a){if(void 0===a&&(a=!1),Object(i.b)(t))switch(t.ProviderType){case r.c:return function(e){var t=e.AttachLongPathName,n=t.lastIndexOf("?");return t.substring(0,n)+"?dl=1"}(t)}return Object(o.a)(e,t,0,Object(i.b)(t),n,a)}},2563:function(e,t,n){"use strict";var r=n(0),i=n(1049),o=n(254),a={},c=5e3,u=12;function s(e,t,n,s,d){var f=new o.a("SaveToCloudProgressManager"),p=setInterval((function(){!function(e,t,n,o,a,c,u){Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(s=u[e])?(s.counter++,s.counter>c?(l(e,u),s.datapoint.addCustomData({operationId:e,counter:s.counter}),s.datapoint.endWithError("Timeout"),a&&a(),[2]):[4,i.g.import()]):[2];case 1:return r.sent()(t,n,e,0,(function(e){o&&o(e.NotificationPayloads)})),[2]}}))}))}(n,e,t,s,d,u,a)}),c);a[n]={timer:p,counter:0,datapoint:f}}function l(e,t){void 0===t&&(t=null),t||(t=a);var n=t[e];if(n){clearInterval(n.timer);var r=n.datapoint;r.addCustomData({operationId:e,counter:n.counter}),r.end(),delete t[e]}}var d=n(4),f=Object(d.action)("cancelSaveAttachmentsToCloud",(function(e){return{operationId:e}}));Object(d.orchestrator)(f,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return l(e.operationId),[2]}))}))}));var p=Object(d.action)("saveAttachmentsToCloud",(function(e,t,n,r,i,o,a,c,u){return{attachmentId:e,itemId:t,notificationHandler:n,serviceCallFailureCallback:r,operationCreatedCallback:i,folderId:o,attachmentIds:a,showProgressBar:c,subscriptionId:u}})),b=n(106);function h(e){return Object(r.__assign)({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}var v=n(25);function m(e,t,n,r,i,o,a){var c,u,s=function(e,t,n,r,i,o,a){return h({ewsAttachmentId:e,itemId:t,subscriptionId:n,groupSmtpAddress:i,channelId:r,folderItemId:o,attachmentIds:a})}(e,t,n,r,(null==i?void 0:i.type)===b.a.GroupMailbox?i.mailboxSmtpAddress:null,o,a);return c={requestObject:s},u=null==i?void 0:i.requestOptions,void 0===c.requestObject||c.requestObject.__type||(c.requestObject=h(c.requestObject)),Object(v.a)("SaveAttachmentsToCloud",c,u)}var g=n(1623),O=n(1075);Object(d.orchestrator)(p,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,o,a,c,u,d,f;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return t=!1!==e.showProgressBar,!(n=e.attachmentId||e.itemId)&&e.attachmentIds.length>0&&(n=e.attachmentIds[0]),i=function(r){if(!r||"Reload"===r.EventType)return!1;if(23===r.ResultCode)return!1;var i=e.notificationHandler(r);return t&&i&&(l(n.Id),t=!1),i},o=e.subscriptionId,[4,Object(g.a)(i,o)];case 1:return a=r.__read.apply(void 0,[p.sent(),4]),c=a[0],u=a[1],d=a[2],f=a[3],function(e,t,n,i,o,a,c,u,s){Object(r.__awaiter)(this,void 0,void 0,(function(){var l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,m(e?e.Id:null,t?t.Id:null,n,a,_(t,e,s),u,s?s.map((function(e){return e.Id})):null)];case 1:return[2,r.sent()];case 2:return l=r.sent(),c(l,1,"ServerError"),O.g.importAndExecute(i,o),[2,null];case 3:return[2]}}))}))}(e.attachmentId,e.itemId,c,u,d,f,e.serviceCallFailureCallback,e.folderId,e.attachmentIds),t&&s(e.attachmentId,e.itemId,n.Id,(function(e){e.forEach((function(e){i(e)}))}),(function(){e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout")})),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,u,d),[2]}}))}))}));function _(e,t,n){return e?e.mailboxInfo:t?t.mailboxInfo:n[0].mailboxInfo}function w(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=function(n){if(!n||"Reload"===n.EventType)return!1;if(23===n.ResultCode)return!1;var r=t(n);return r&&l(e.Id),r},[4,Object(g.a)(o,i)];case 1:return r.sent(),s(e,null,e.Id,(function(e){e.forEach((function(e){o(e)}))}),(function(){n("Progress manager timeout. OperationId = "+e.Id,3,"Timeout")})),[2]}}))}))}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return w}))},2582:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1142),i=n(1729),o=n(1703);function a(){return{previewPane:{downloadUrl:null,mode:i.a.Blank},didAutoHideRightPane:!1,hideRightPane:!1,rightPaneSize:0,leftPaneSizePixels:0,rightPaneSizePixels:0,rightPaneDisplay:o.a.Initial,eventManager:new r.a}}},2595:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FileAttachment:#Exchange"},e)}},2668:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1476),i=n(1333),o=n(1137),a=n(980),c=n(1024);function u(e){if(!Object(o.b)(e,!0).directFileAccessEnabled&&!e.IsInline||Object(i.b)(e.AttachmentId.Id))return!1;if(e.Thumbnail)return!0;var t=Object(a.g)(e.Name,e.ContentType,!1),n=Object(a.h)(e.Name);if((e.__type===c.e||e.__type===c.h)&&(t||n))return!0;if(e.__type===c.n){var u=e,s=Object(r.a)(u.ProviderType);if(u.AttachmentThumbnailUrl||t&&s&&s.supportImageThumbnail)return!0}return!1}},2719:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(1522),o=n(3005);function a(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(o.a)(e.AttachLongPathName),[4,Object(i.l)(n)];case 1:return a=r.sent(),[2,(null===(t=a.result)||void 0===t?void 0:t.thumbnailLink)||null]}}))}))}},2727:function(e,t,n){"use strict";var r="OLK_Beautified_",i="olkBeautifulLink",o="true",a=n(3687),c=n(10);function u(e,t,n){return{name:Object(c.b)(a.a),key:"OpenInNewTab",onClick:function(){(t||window).open(e,"_blank"),n&&n()}}}function s(e){var t;return"a"===e.tagName.toLowerCase()&&0===(null===(t=e.id)||void 0===t?void 0:t.indexOf(r))}function l(e,t,n){return s(t)&&t.setAttribute(i,o),null}n.d(t,"a",(function(){return"owaAttachmentRemoveOnSend"})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return"OWA"})),n.d(t,"f",(function(){return"OWAInsertLinkPlaceHolder"})),n.d(t,"g",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"h",(function(){return s}))},2770:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return f}));var r=n(115),i=n(1156);n.d(t,"a",(function(){return i.c}));var o=n(2374);n.d(t,"c",(function(){return o.a}));var a=n(2314);n.d(t,"b",(function(){return a.a}));var c=n(2464);n.d(t,"h",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(4),n.e(16),n.e(36),n.e(55),n.e(138)]).then(n.bind(null,4840))})),s=new r.a(u,(function(e){return e.previewAttachment})),l=new r.a(u,(function(e){return e.previewAttachmentInSxS})),d=new r.a(u,(function(e){return e.previewImageInSxS})),f=new r.a(u,(function(e){return e.previewLinkInSxS}))},2771:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),i=n(254),o=n(2268),a=n(2861),c={},u={},s=[],l=0,d=2;function f(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,c;return Object(r.__generator)(this,(function(u){return a=new i.a("InitializeWacUrl"),n&&a.addCustomProperty("actionSource",n),(c=b(e,t,a))?[2,c]:[2,new Promise((function(i,c){var u={attachmentId:e,isEdit:t,actionSource:n,datapoint:a,resolve:i,reject:c};o?p(u):(s.push(u),function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:if(!s.length)return[2];if(l>=d)return[2];t=s.shift(),l++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,p(t)];case 2:return n.sent(),[3,4];case 3:return l--,e(),[7];case 4:return[2]}}))}))}())}))]}))}))}function p(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,s,l,d,f,p,h,v,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(i=e.attachmentId,s=e.isEdit,l=e.actionSource,d=e.datapoint,f=e.resolve,p=e.reject,h=b(i,s,d))return f(h),[2];d.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(a.a)(i.Id,s,null,null===(t=i.mailboxInfo)||void 0===t?void 0:t.requestOptions,l)];case 2:return 0===(v=r.sent()).Status&&((s?u:c)[i.Id]={expireTime:(new Date).getTime()+36e5,value:v}),v.WacUrl||d.addCustomProperty("WacUrlIsEmpty",!0),d.addCustomProperty("WacAttachmentResponseStatus",null===(n=v.Status)||void 0===n?void 0:n.toString()),d.end(),f(v),[3,4];case 3:return m=r.sent(),Object(o.a)(m)&&Object(o.c)(d,m.response),Object(o.d)(d,m.toString()),d.endWithError("ServerError"),p(m),[3,4];case 4:return[2]}}))}))}function b(e,t,n){var r=t?u:c,i=r[e.Id];if(i){if(i.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),i.value;delete r[e.Id]}return null}},2786:function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=!1;return{task:function(){return new Promise((function(c,u){for(var s=0,l=0,d=0,f=function(){var p,b,h,v,m;a&&c(1),s<n&&d<t.length&&((p=d,b=t[p],h=b.start,v=b.end,m=e.slice(h,v),r(m,o(p),i)).then((function(){return s-=1,(l+=1)===t.length&&c(0),void f()})).catch(u),d+=1,s+=1)},p=0;p<n;p++)f()}))},cancelTask:function(){return a=!0}}}var i=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function o(e,t,n){void 0===n&&(n=i),function(e){e.sliceSize=e.sliceSize||i.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||i.numberOfSlicesToParallelize}(n);var o=n.sliceSize,u=n.numberOfSlicesToParallelize,s=Math.ceil(e.size/o),l=function(e,t,n){for(var r=[],i=0,o=0;o<e;o++){var a=Math.min(i+t,n);r.push({start:i,end:a}),i=a}return r}(s,o,e.size),d=r(e,[l[0]],1,t,s,(function(){return 0})),f=l.length>2?r(e,l.slice(1,l.length-1),u,t,s,(function(e){return e+1})):c(),p=l.length>1?r(e,[l[l.length-1]],1,t,s,(function(){return l.length-1})):c();return{onCompletePromise:d.task().then(a(f.task)).then(a(p.task)),cancel:function(){d.cancelTask(),f.cancelTask(),p.cancelTask()}}}function a(e){return function(t){return 0===t?e():Promise.resolve(t)}}function c(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}n.d(t,"a",(function(){return o}))},280:function(e,t,n){"use strict";var r=n(576);n.d(t,"a",(function(){return r.a}))},2861:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1679);function i(e,t,n,i,o){if(o){var a="getWacAttachmentInfo"+o;(i=i||{}).headers=i.headers||new Headers,i.headers.set("X-OWA-ActionName",a)}return Object(r.a)({attachmentId:e,isEdit:t,draftId:n,appId:null},i)}},2862:function(e,t,n){"use strict";var r=n(1005),i=n(284);t.a=Object(i.action)("setAttachmentOriginalUrl")((function(e,t){Object(r.a)(e).model.AttachmentOriginalUrl=t}))},2863:function(e,t,n){"use strict";var r=n(1005),i=n(2557),o=n(284);t.a=Object(o.action)("refreshDownloadUrl")((function(e,t,n){void 0===n&&(n=!1);var o=Object(r.a)(e),a=Object(i.a)(e,o.model,t,n);o.download.url=a}))},2867:function(e,t,n){"use strict";var r=n(0),i=n(254),o=n(123),a=n(1265),c=n(1266);function u(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s,l,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)(3),i=t?"folders":"files",u=Object(o.a)(n.create_shared_link_request.requestUrlFormat,i,e),[4,Object(c.a)(n.providerType,u,null,n.create_shared_link_request.method,JSON.stringify(n.create_shared_link_request.body),null,n.create_shared_link_request.dataPointName)];case 1:return s=r.sent(),l=JSON.parse(s),d={webUrl:l.shared_link.url,type:g,scope:_},[2,{expirationDateTime:null,shareId:l.id,link:d}]}}))}))}function s(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(2),(n=t.create_shared_link_request.body).path=e,[4,Object(c.a)(t.providerType,t.create_shared_link_request.requestUrlFormat,null,t.create_shared_link_request.method,JSON.stringify(n),null,t.create_shared_link_request.dataPointName)];case 1:return i=r.sent(),[2,JSON.parse(i)]}}))}))}function l(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(2),(n=t.get_shared_link_request.body).path=e,[4,Object(c.a)(t.providerType,t.get_shared_link_request.requestUrlFormat,null,t.get_shared_link_request.method,JSON.stringify(n),null,t.get_shared_link_request.dataPointName)];case 1:return i=r.sent(),(o=JSON.parse(i).links[0])?[3,3]:[4,s(e)];case 2:o=r.sent(),r.label=3;case 3:return u={webUrl:o.url,type:g,scope:_},[2,{expirationDateTime:null,shareId:o.id,link:u}]}}))}))}function d(e){var t=function(e){var t=e.match(/\/d\/(.+)\//gm);return!t||t.length>1?"":t[0].substring(3).replace("/","")}(e);return Object(o.b)(t)&&(t=function(e){var t=e.match(/\/folders\/(.+)$/gm);return!t||t.length>1?"":t[0].substring(9)}(e)),t}function f(e){var t,n;if(e)try{for(var i=Object(r.__values)(e),o=i.next();!o.done;o=i.next()){var a=o.value;if("anyoneWithLink"===a.id)return a.role}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null}function p(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(5),n=Object(o.a)(t.get_file_info_request.requestUrlFormat,e),[4,Object(c.a)(t.providerType,n,null,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return i=r.sent(),[2,JSON.parse(i)]}}))}))}function b(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p(d(e))];case 1:return(t=r.sent())&&t.permissionIds&&-1!==t.permissionIds.indexOf("anyoneWithLink")?(n=null,i=0,"reader"===(o=f(t.permissions))?(n=g,i=4):"writer"===o&&(n=O,i=5),[2,{ResultCode:0,FileName:t.name,MimeType:"application/vnd.google-apps.folder"===t.mimeType?j:t.mimeType,SharingLinkKind:i,BlocksDownload:t.capabilities.canDownload,CanShareExternally:!0,CanCreateAnonymousEditLink:!0,CanCreateAnonymousViewLink:!0,ExpirationDate:null,OriginalUrl:null,Type:n,providerFileId:t.id}]):[2,null]}}))}))}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(5),n=Object(o.a)(t.get_file_info_request.requestUrlFormat,e),[4,Object(c.a)(t.providerType,n,null,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return i=r.sent(),u=JSON.parse(i),s={webUrl:u.webViewLink,type:null,scope:_},(null==u?void 0:u.permissions)&&("reader"!==(l=f(u.permissions))&&"writer"!==l||(s.type="reader"===l?g:O)),[2,{expirationDateTime:null,shareId:u.id,link:s}]}}))}))}function v(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,h(e)];case 1:return null!=(t=r.sent()).link.type?[3,3]:(n=Object(a.a)(5),i=Object(o.a)(n.create_shared_link_request.requestUrlFormat,e),(u=n.create_shared_link_request.body).role="reader",[4,Object(c.a)(n.providerType,i,null,n.create_shared_link_request.method,JSON.stringify(u),null,n.create_shared_link_request.dataPointName)]);case 2:s=r.sent(),(l=JSON.parse(s))&&"reader"===l.role&&(t.link.type=g),r.label=3;case 3:return[2,t]}}))}))}var m=n(980),g="view",O="edit",_="anonymous",w="0001-01-01T00:00:00Z",j="text/directory";function y(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)(1),i=Object(o.a)(n.create_shared_link_request.requestUrlFormat,e),u=!Object(m.g)(t),(s=n.change_link_permission_request.body).type=u?O:g,[4,Object(c.a)(n.providerType,i,null,n.create_shared_link_request.method,JSON.stringify(s),null,n.create_shared_link_request.dataPointName)];case 1:return l=r.sent(),[2,JSON.parse(l)]}}))}))}var I=n(1181),S=n(289);function k(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)(0),null===(i=Object(S.parse)(e).hostname)&&t&&(i=Object(S.parse)(t).hostname,e="https://"+i+e),u=Object(o.a)(n.create_shared_link_request.requestUrlFormat,i,Object(I.g)(e)),[4,Object(c.a)(n.providerType,u,n.create_shared_link_request.additional_headers,n.create_shared_link_request.method,null,e,n.create_shared_link_request.dataPointName)];case 1:return s=r.sent(),[2,JSON.parse(s).value[0]]}}))}))}function C(e,t,n,a,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(Object(o.b)(n))throw new Error("CreateSharingLinkFromFileProvider should have valid location.");switch(s=null,e){case 1:return[3,1];case 0:return[3,3];case 2:return[3,5];case 3:return[3,7];case 5:return[3,9]}return[3,11];case 1:return[4,y(t,n)];case 2:return s=r.sent(),[3,12];case 3:return[4,k(n,c)];case 4:return s=r.sent(),[3,12];case 5:return[4,l(n)];case 6:return s=r.sent(),[3,12];case 7:return[4,u(t,a)];case 8:return s=r.sent(),[3,12];case 9:return[4,v(t)];case 10:return s=r.sent(),[3,12];case 11:throw new Error("File provider "+e+" is not supported.");case 12:return s.expirationDateTime&&Object(i.o)("expiration time found",[s.expirationDateTime]),[2,s]}}))}))}function T(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(3),n=t.get_file_info_request.requestUrlFormat,(i=JSON.parse(JSON.stringify(t.get_file_info_request.additional_headers))).BoxApi=Object(o.a)(i.BoxApi,e),[4,Object(c.a)(t.providerType,n,i,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return u=r.sent(),[2,{ResultCode:0,FileName:(s=JSON.parse(u)).name,MimeType:"folder"===s.type?j:null,SharingLinkKind:4,BlocksDownload:!s.shared_link.permissions.can_download,CanShareExternally:!0,ExpirationDate:null,OriginalUrl:null,Type:g,providerFileId:s.id,location:e}]}}))}))}function A(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(2),(n=t.get_file_info_request.body).url=e,[4,Object(c.a)(t.providerType,t.get_file_info_request.requestUrlFormat,null,t.get_file_info_request.method,JSON.stringify(n),null,t.get_file_info_request.dataPointName)];case 1:return i=r.sent(),[2,{ResultCode:0,FileName:(o=JSON.parse(i)).name,MimeType:"folder"===o[".tag"]?j:null,SharingLinkKind:4,BlocksDownload:!o.link_permissions.allow_download,CanShareExternally:!0,ExpirationDate:null,OriginalUrl:null,Type:g,providerFileId:o.id,location:e}]}}))}))}var P=n(75);function E(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(0),n=Object(S.parse)(e),i=Object(o.a)(t.get_file_info_request.requestUrlFormat,n.hostname,Object(I.g)(e)),[4,Object(c.a)(t.providerType,i,null,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return u=r.sent(),P.g.info(u),[2,null]}}))}))}function x(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(1),n=Object(o.a)(t.get_drive_item_request.requestUrlFormat,Object(I.g)(e)),[4,Object(c.a)(t.providerType,n,null,t.get_drive_item_request.method,null,null,t.get_drive_item_request.dataPointName)];case 1:return i=r.sent(),[2,JSON.parse(i)]}}))}))}function L(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(1),n=Object(o.a)(t.get_file_permission_request.requestUrlFormat,Object(I.g)(e)),[4,Object(c.a)(t.providerType,n,null,t.get_file_permission_request.method,null,null,t.get_file_permission_request.dataPointName)];case 1:if(i=r.sent(),JSON.parse(i).value.forEach((function(t){var n,r;(null===(n=t.link)||void 0===n?void 0:n.webUrl)&&0===e.indexOf(null===(r=t.link)||void 0===r?void 0:r.webUrl)&&(u=t)})),!u)throw new Error("GetODCSharingInfo failed to find the matching link");return[2,u]}}))}))}function N(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,x(e)];case 1:return t=r.sent(),[4,L(e)];case 2:return n=r.sent(),i=n.link.type===O?5:4,[2,{ResultCode:0,FileName:t.name,MimeType:t.file?t.file.mimeType:j,SharingLinkKind:i,BlocksDownload:!1,CanShareExternally:!0,CanCreateAnonymousEditLink:!0,CanCreateAnonymousViewLink:!0,ExpirationDate:n.expirationDateTime===w?null:n.expirationDateTime,OriginalUrl:null,Type:n.link.type,providerFileId:t.id,location:e}]}}))}))}function R(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(t){case 0:return[2,E(e)];case 1:return[2,N(e)];case 2:return[2,A(e)];case 3:return[2,T(e)];case 5:return[2,b(e)];default:throw new Error("getFileInfo is not supported for "+t+".")}return[2]}))}))}function D(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(t){case 4:case 3:break;default:throw new Error("We do not support this permission level for GDrive: "+t)}return n=d(e),i=Object(a.a)(5),u=Object(o.a)(i.change_link_permission_request.requestUrlFormat,n,"anyoneWithLink"),s=i.change_link_permission_request.body,l=4===t?"writer":"reader",s.role=l,[4,Object(c.a)(i.providerType,u,null,i.change_link_permission_request.method,JSON.stringify(s),null,i.change_link_permission_request.dataPointName)];case 1:return r.sent(),[2]}}))}))}function F(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(t){case 4:case 3:break;default:throw new Error("OneDriveConsumer does not support this permission level: "+t)}return n=Object(a.a)(1),i=Object(o.a)(n.change_link_permission_request.requestUrlFormat,Object(I.g)(e)),(u=n.change_link_permission_request.body).type=4===t?O:g,[4,Object(c.a)(n.providerType,i,null,n.change_link_permission_request.method,JSON.stringify(u),null,n.change_link_permission_request.dataPointName)];case 1:return s=r.sent(),[2,JSON.parse(s)]}}))}))}function M(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(Object(o.b)(t))throw new Error("CreateSharingLinkFromFileProvider should have valid location.");return 1!==e?[3,2]:[4,F(t,n)];case 1:return[2,r.sent()];case 2:return 5!==e?[3,4]:[4,D(t,n)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}n(3167);n.d(t,"i",(function(){return C})),n.d(t,"j",(function(){return R})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return O})),n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return"organization"})),n.d(t,"c",(function(){return"user"})),n.d(t,"g",(function(){return w})),n.d(t,"f",(function(){return j})),n.d(t,"h",(function(){return M}))},2873:function(e,t,n){"use strict";var r=n(0),i=n(438),o=n(25);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ImportCalendarEventJsonRequest:#Exchange"},n)),Object(o.a)("ImportCalendarEvent",e,t)}var c=n(1029),u=n(245),s=n(315);function l(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,d;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return o?[4,Object(s.e)(o)]:[3,2];case 1:d=f.sent(),l={headers:d.headers,authNeededOnUnAuthorized:d.authNeededOnUnAuthorized},f.label=2;case 2:return[2,a({Header:Object(u.a)(),Body:(p={Content:e,ImportedItemFolderId:Object(c.a)({BaseFolderId:Object(i.a)({Id:t})}),AttachmentId:n},Object(r.__assign)({__type:"ImportCalendarEventRequest:#Exchange"},p))},Object(r.__assign)({datapoint:{jsonCustomData:function(e){return{status:e.ResponseClass,numberOfEventsImported:e.NumberOfEventsImported}}}},l)).then((function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")}))]}var p}))}))}n.d(t,"a",(function(){return l}))},2967:function(e,t,n){"use strict";var r=n(1913),i=n(980),o=n(7),a=n(76);var c=n(2194),u=n(1476);function s(e,t,n,s,l,d){if(void 0===d&&(d=null),1===t)return{allowDownload:!1,supportedPermissionLevels:null,sharingInfo:null};var f,p=Object(i.b)(n.Name),b=Object(c.a)(e,n,p),h=function(e,t,n){if(!e)return null;if(n&&n.length>0)return n;var r=Object(u.a)(t);return null==r?void 0:r.supportedPermissionLevels}(s,l,Object(r.a)(d,0)),v=(f=d)&&0===f.ResultCode?(Object(a.h)("doc-attachment-referenceAttachmentExpiration")||(f.ExpirationDate=null),{getSharingInfoSucceeded:!0,blocksDownload:f.BlocksDownload,canonicalUrl:f.CanonicalUrl,canShareInternally:f.CanShareInternally,canShareExternally:f.CanShareExternally,expirationDate:f.ExpirationDate?Object(o.mc)(f.ExpirationDate):null,canRefresh:!1,shareId:f.ShareId,siteUrl:f.SiteUrl,linkType:f.Type}):null;return s?function(e,t,n){return{allowDownload:e,supportedPermissionLevels:t,sharingInfo:n}}(b,h,v):function(e){return{allowDownload:e,supportedPermissionLevels:null,sharingInfo:null}}(b)}n.d(t,"a",(function(){return s}))},297:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"TokenRequest:#Exchange"},e)}},3005:function(e,t,n){"use strict";function r(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",(function(){return r}))},3006:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(10),i=n(1024),o=n(1913);function a(e){return Object(r.f)(e)?null:("/"!=(e=e.trim())[e.length-1]&&(e+="/"),e)}function c(e,t){var n=e.AttachLongPathName;if(Object(o.f)(e.PermissionType)||e.ProviderType!==i.m)return n;var r=t.ApplicationSettings;if(null!==n&&null!==r){var c=void 0;null!==(c=a(r.VDirIsPublicProperty||t.PublicComputersDetectionEnabled&&t.SessionSettings.IsPublicComputerSession?r.ExternalSPMySiteHostURL:r.InternalSPMySiteHostURL))&&(n=function(e,t){var n,r,i,o=new RegExp("^(https?)\\:[\\/\\\\]{2}([\\w\\.-]+)(\\:[0-9]{1,4})?(.*)$","i"),a=o.exec(e),c=o.exec(t);return a&&c&&a.length>=5&&c.length>=5&&(c[1]&&c[2]&&(i=c[1]+"://"+c[2],n=!0),c[3]&&(i+=c[3]),a[4]&&(r=!0,i+=a[4])),n&&r?i:null}(n,c))}return null!==n?n:e.AttachLongPathName}},3063:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1539),i=n(973);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];var o=1,a=1e3;function c(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,o);else if(e>r||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),a);else if(1==t){for(var i=0;i<n.length;i++)if(e<n[i]){e=n[i];break}}else for(i=n.length-1;i>=0;i--)if(e>n[i]){e=n[i];break}return e}t.default=function(e,n,o){void 0===o&&(o=t.FONT_SIZES);var a=0==n?1:-1;r.default(e,(function(e){var t=parseFloat(i.getComputedStyle(e,"font-size"));e.style.fontSize=c(t,a,o)+"pt","normal"!=i.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))},t.getNewFontSize=c},3064:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2355),i=n(973);function o(e,t){return e.indexOf(i.getTagOfNode(t))<0}t.TAGS_TO_UNWRAP="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),t.TAGS_TO_STOP_UNWRAP=["TD","TH","TR","TABLE","TBODY","THEAD"],t.ATTRIBUTES_TO_PRESERVE=["href"],t.default=function(e,n,a,c){void 0===n&&(n=t.TAGS_TO_UNWRAP),void 0===a&&(a=t.TAGS_TO_STOP_UNWRAP),void 0===c&&(c=t.ATTRIBUTES_TO_PRESERVE),e.focus(),e.addUndoSnapshot((function(t,u){var s=[{}],l=a.join(",");r.default(e,(function(t){var n=s[s.length-1],r=e.getElementAtCursor(l,t);r!=n.td&&n.first&&s.push(n={}),n.td=r,n.first=n.first||t,n.last=t})),s.filter((function(e){return e.first})).forEach((function(t){var r=e.collapseNodes(t.first,t.last,!0);if(o(a,r[0]))for(;e.contains(r[0].parentNode)&&o(a,r[0].parentNode);)r=[i.splitBalancedNodeRange(r)];if(r.forEach((function(e){return function e(t,n,r,a){if(1!=t.nodeType||"BR"==i.getTagOfNode(t))return!1;var c=i.toArray(t.childNodes).map((function(t){return e(t,n,r,a)})).reduce((function(e,t){return e&&t}),!0);if(!o(r,t))return!1;var u=i.isBlockElement(t);n.indexOf(i.getTagOfNode(t))>=0||c?(u&&!c&&i.wrap(t),i.unwrap(t)):function(e,t){for(var n=0,r=i.toArray(e.attributes);n<r.length;n++){var o=r[n];t.indexOf(o.name.toLowerCase())<0&&0!=o.name.indexOf("data-")&&e.removeAttribute(o.name)}}(t,a);return u}(e,n,a,c)})),t.td){var u=t.td.getAttribute("style")||"",s=u.split(";");(u=(s=s.filter((function(e){return 0==e.trim().toLowerCase().indexOf("border")}))).join(";"))?t.td.setAttribute("style",u):t.td.removeAttribute("style")}})),e.select(t,u)}),"Format")}},3065:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1259),i=n(2356),o=n(2357),a=n(2358),c=n(2359),u=n(2360),s=n(2361),l=n(2362),d=["font","text-decoration","color","background"];t.default=function(e){e.focus(),e.addUndoSnapshot((function(){r.default(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")}));var t=e.getDefaultFormat(),n=0===Object.keys(t).length;e.queryElements("[style]",2,(function(e){d.forEach((function(t){return e.style.removeProperty(t)})),n&&""===e.getAttribute("style")&&e.removeAttribute("style")})),n||(t.fontFamily&&o.default(e,t.fontFamily),t.fontSize&&a.default(e,t.fontSize),t.textColor&&(t.textColors?c.default(e,t.textColors):c.default(e,t.textColor)),t.backgroundColor&&(t.backgroundColors?i.default(e,t.backgroundColors):i.default(e,t.backgroundColor)),t.bold&&u.default(e),t.italic&&s.default(e),t.underline&&l.default(e))}),"Format")}},3066:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973),i=/^[a-zA-Z]+:/i,o=/^[\w.%+-]+@/i,a=/^ftp\./i,c="istemptitle";function u(e){return e.queryElements("a[href]",1)[0]}function s(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,l){e.focus();var d=(function(e){var t=new r.HtmlSanitizer,n=(new DOMParser).parseFromString("<a></a>","text/html"),i=n.body.firstChild;return i.href=e||"",t.sanitize(n.body),i.getAttribute("href")}(t)||"").trim();if(d){var f=r.matchLink(d),p=f?f.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(i)<0&&(t=0==e.search(o)?"mailto:":0==e.search(a)?"ftp://":"http://"),t+e}(d),b=f?f.originalUrl:d;e.addUndoSnapshot((function(){var t=e.getSelectionRange(),r=null;return t&&t.collapsed?(r=u(e))?(r.href=p,s(r,l)):((r=e.getDocument().createElement("A")).textContent=l||b,r.href=p,e.insertNode(r)):(e.getDocument().execCommand("createLink",!1,p),s(r=u(e),l)),n&&r&&(r.removeAttribute(c),r.title=n),r}),"CreateLink")}}},3067:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1540),o=n(973),a=n(973);function c(e,t){var n=a.getTagOfNode(i.cacheGetElementAtCursor(e,t,"OL,UL")),r=a.getTagOfNode(i.cacheGetElementAtCursor(e,t,"H1,H2,H3,H4,H5,H6"));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:r&&parseInt(r[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0]}}t.getElementBasedFormatState=c,t.getStyleBasedFormatState=function(e){return e.getStyleBasedFormatState()},t.default=function(e,t){return r(r(r(r({},o.getPendableFormatState(e.getDocument())),c(e,t)),e.getStyleBasedFormatState()),{canUndo:e.canUndo(),canRedo:e.canRedo()})}},3068:function(e,t,n){"use strict";function r(e,t){e.addUndoSnapshot((function(){var n=e.getDocument().createElement("img");n.src=t,n.style.maxWidth="100%",e.insertNode(n)}),"Format")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"==typeof t)r(e,t);else{var n=new FileReader;n.onload=function(t){e.isDisposed()||r(e,t.target.result)},n.readAsDataURL(t)}}},3069:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973);function i(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,o){var a=e.getDocument(),c=a.createDocumentFragment(),u=a.createElement("table");c.appendChild(u),u.cellSpacing="0",u.cellPadding="1";for(var s=0;s<n;s++){var l=a.createElement("tr");u.appendChild(l);for(var d=0;d<t;d++){var f=a.createElement("td");l.appendChild(f),f.appendChild(a.createElement("br")),f.style.width=i(t)}}e.focus(),e.addUndoSnapshot((function(){var t=new r.VTable(u);t.applyFormat(o||{bgColorEven:"#FFF",bgColorOdd:"#FFF",topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB"}),t.writeBack(),e.insertNode(c),e.runAsync((function(){return e.select(new r.Position(u,0).normalize())}))}),"Format")}},3070:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973);t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&e.addUndoSnapshot((function(i,o){var a=new r.VTable(n);a.edit(t),a.writeBack(),e.focus(),e.select(i,o)||e.select(e.contains(n)?n:a.getCurrentTd())}),"Format")}},3071:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&e.addUndoSnapshot((function(i,o){var a=new r.VTable(n);a.applyFormat(t),a.writeBack(),e.focus(),e.select(i,o)}),"Format")}},3072:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973);t.default=function(e){e.focus(),e.addUndoSnapshot((function(t,n){e.queryElements("a[href]",1,r.unwrap),e.select(t,n)}),"Format")}},3073:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i){if(!t||!n)return!1;var o;if(o="string"==typeof t?(i=i||e.getContentSearcherOfCursor())&&i.getRangeFromText(t,r):t){var a=e.getSelectionRange();return a.collapsed&&o.endContainer==a.startContainer&&o.endOffset==a.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:o}),!0}return!1}},3074:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1259);t.default=function(e,t){var n="justifyLeft",i="left";1==t?(n="justifyCenter",i="center"):2==t&&(n="justifyRight",i="right"),e.addUndoSnapshot((function(){r.default(e,n),e.queryElements("[align]",1,(function(e){return e.style.textAlign=i}))}),"Format")}},3075:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2355);t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,i){r.default(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),e.select(n,i)}),"Format")}},3076:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(){e.queryElements("img",1,(function(e){return e.setAttribute("alt",t)}))}),"Format")}},3077:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3078),i=n(1994);t.default=function(e,t){if(e.useExperimentFeatures())r.default(e,t);else{var n=0==t?"indent":"outdent";e.addUndoSnapshot((function(){var t;return e.focus(),e.getElementAtCursor("OL,UL")?t=i.default(e,n):(e.getDocument().execCommand(n,!1,null),e.queryElements("BLOCKQUOTE",1,(function(e){t=t||e,e.style.marginTop="0px",e.style.marginBottom="0px"}))),t}),"Format")}}},3078:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2363),i=n(973),o=n(973),a='<blockquote style="margin-top:0;margin-bottom:0"></blockquote>';function c(e,t){if(t.length>0){var n=t[0].getStartNode(),r=t[t.length-1].getEndNode(),i=o.collapseNodesInRegion(e,[n,r]);o.wrap(i,a)}}function u(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),r=o.findClosestElementAncestor(n,e.rootNode,"blockquote");if(r){for(n==r&&(n=o.wrap(o.toArray(n.childNodes)));o.isNodeInRegion(e,n)&&"BLOCKQUOTE"!=o.getTagOfNode(n);)n=o.splitBalancedNodeRange(n);o.isNodeInRegion(e,n)&&o.unwrap(n)}}))}t.default=function(e,t){var n=0==t?c:u;r.default(e,(function(e,r,a){for(var c=i.getSelectedBlockElementsInRegion(e),u=[[]],s=0;s<c.length;s++){var l=c[s].getStartNode(),d=o.createVListFromRegion(e,!0,l);if(d){for(u.push([]);c[s+1]&&d.contains(c[s+1].getStartNode());)s++;d.setIndentation(r,a,t),d.writeBack()}else u[u.length-1].push(c[s])}u.forEach((function(t){return n(e,t)}))}))}},3079:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2364),i=n(1994);t.default=function(e){e.useExperimentFeatures()?r.default(e,2):(e.focus(),e.addUndoSnapshot((function(){return i.default(e,"insertUnorderedList")}),"Format"))}},3080:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2364),i=n(1994);t.default=function(e){e.useExperimentFeatures()?r.default(e,1):(e.focus(),e.addUndoSnapshot((function(){return i.default(e,"insertOrderedList")}),"Format"))}},3081:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2365),i="blockquote",o=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){r.default(e,i,t||o)}},3082:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2365),i=n(973),o="pre",a="code",c="CODE";function u(e){var t=i.wrap(e,a);return i.wrap(t,o)}function s(e){if(!e)return null;var t=e.childNodes[0];return 1==e.childNodes.length&&i.getTagOfNode(t)==c&&i.unwrap(t),i.unwrap(e)}t.default=function(e,t){r.default(e,o,t,u,s)}},3083:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1259);t.default=function(e){r.default(e,"strikeThrough")}},3084:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1259);t.default=function(e){r.default(e,"subscript")}},3085:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1259);t.default=function(e){r.default(e,"superscript")}},3086:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(973);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),e.addUndoSnapshot((function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,(function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);for(var r=e.getDocument().createElement("div");t.firstChild;)r.appendChild(t.firstChild);e.replaceNode(t,r)})),t>0){for(var i=e.getSelectionTraverser(),o=i?i.currentBlockElement:null,a=new r.HtmlSanitizer({styleCallbacks:{"font-size":function(){return!1}}});o;){var c=o.collapseToSingleElement();a.sanitize(c),o=i.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}}),"Format")}},3097:function(e){e.exports=JSON.parse('{"b":"h_a","a":"i_a","d":"j_a","e":"k_a","g":"l_a","f":"m_a","c":"n_a","i":"o_a","h":"p_a","j":"q_a","k":"r_a"}')},3098:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1024),o=n(2719),a=n(1692);function c(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n?(c=t).ProviderType===i.f&&c.AttachLongPathName?[4,Object(o.a)(c)]:[3,2]:[2,Object(a.a)(e,t,2,n,!0)];case 1:return[2,r.sent()];case 2:return[2,c.AttachmentThumbnailUrl||null]}}))}))}},3167:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),i=n(1181),o=n(123),a=n(289),c=n(1265),u=n(1266);function s(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(c.a)(0),n=Object(a.parse)(e),s=Object(o.a)(t.get_shared_item_request.requestUrlFormat,n.hostname,Object(i.g)(e)),[4,Object(u.a)(t.providerType,s,t.get_shared_item_request.additional_headers,t.get_shared_item_request.method,null,null,t.get_shared_item_request.dataPointName)];case 1:return l=r.sent(),[2,JSON.parse(l)]}}))}))}},3178:function(e,t,n){"use strict";var r=n(1024),i=n(1476),o=n(980);function a(e){var t=Object(o.b)(e.Name);return t&&".pdf"===t.toLowerCase()}var c=[".mp3"];var u=[".ics",".ical",".ifb",".icalendar"];var s=[".eml",".msg"];var l=n(2037),d=["image/jpeg","image/png","image/gif","image/bmp"];function f(e){return Object(o.g)(e.Name)||e.__type!==r.n&&function(e){if(e)return d.indexOf(e.toLowerCase())>=0;return!1}(e.ContentType)}var p=n(2193),b=n(1137);function h(e,t){if(a(e)&&Object(p.a)()){if(t)return!0;var n=Object(b.c)(e,!0);return Object(b.b)(e,!0).directFileAccessEnabled&&n.directFileAccessEnabled}return!1}var v=n(1991),m=[".mp4"],g=[".mov"];var O=n(296);function _(e,t){var n;t.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||t.__type===r.a.attachmentTypes.LINK_ATTACHMENT_TYPE?n=function(e){var t=Object(i.a)(e.ProviderType);return t&&t.supportPreview(e,Object(O.a)())}(t)?f(t)?e.directFileAccessEnabled?2:0:Object(l.a)(t)?6:h(t,!0)?e.directFileAccessEnabled?3:0:e.useWac?4:0:0:n=t.__type===r.a.attachmentTypes.FILE_ATTACHMENT_TYPE?e.level===b.a.Block?1:e.level===b.a.AccessDisabled?0:f(t)?2:a(t)?function(e,t){if(!Object(b.e)().isPdfPreviewEnabled())return 1;if(h(t,!1))return 3;if(function(e){return a(e)}(t))return 7;if(e.useWac)return 4;return 0}(e,t):e.useWac?4:function(e){var t=Object(o.b)(e.Name);return!!t&&c.indexOf(t.toLowerCase())>=0}(t)?5:function(e){var t=Object(o.b)(e.Name);return!!t&&s.indexOf(t.toLowerCase())>=0}(t)?10:Object(v.b)(t.Name)?11:function(e,t){var n,r=Object(o.b)(e.Name);if(r){var i=t||((null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.userAgent)?window.navigator.userAgent:""),a=-1!==i.indexOf("Safari")&&-1===i.indexOf("Chrome");return m.indexOf(r.toLowerCase())>=0||a&&g.indexOf(r.toLowerCase())>=0}return!1}(t)?12:function(e){var t=Object(o.b)(e.Name);return!!t&&-1!==u.indexOf(t.toLowerCase())}(t)?13:0:t.__type===r.a.attachmentTypes.ITEM_ATTACHMENT_TYPE?8:t.__type===r.a.attachmentTypes.ITEM_ID_ATTACHMENT_TYPE?9:0;return n}n.d(t,"a",(function(){return _}))},3386:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("SET_IS_CONTEXT_MENU_OPEN",(function(e,t){return{linkId:e,value:t}})),o=Object(r.action)("RESET_IS_CONTEXT_MENU_OPEN_FOR_LINKS",(function(){return{}})),a=Object(r.action)("UPDATE_COMPOSE_LINK_VIEW_STATE",(function(e,t,n){return{linkId:e,displayName:t,isLinkBeautified:n}})),c=Object(r.action)("REMOVE_COMPOSE_LINK_VIEW_STATE",(function(e){return{linkId:e}})),u=Object(r.action)("ADD_COMPOSE_LINK_VIEW_STATE",(function(e){return{linkId:e}})),s=Object(r.action)("REMOVE_ALL_COMPOSE_LINK_VIEW_STATES"),l=Object(r.action)("PREVIEW_SP_DOC_LINK_IN_SXS",(function(e,t,n,r,i){return{wacUrlGetter:e,linkId:t,readOnly:n,targetWindow:r,sxsId:i}})),d=Object(r.action)("onLinkSelectionChange",(function(e,t){return{selectedLinkId:e,isSelectedLinkReadOnly:t}})),f={composeLinks:new(n(23).ObservableMap)({}),selectedLinkId:null,isSelectedLinkReadOnly:null},p=Object(r.createStore)("composeLinkViewStore",f),b=n(1127);function h(e){var t=p();return e=Object(b.i)(e),t.composeLinks.get(e)}Object(r.mutator)(u,(function(e){var t=p(),n=Object(b.i)(e.linkId),r={linkId:n,isContextMenuOpen:!1,isLinkBeautified:!1,displayName:null};t.composeLinks.set(n,r)})),Object(r.mutator)(c,(function(e){var t=p(),n=Object(b.i)(e.linkId);t.composeLinks.delete(n)})),Object(r.mutator)(s,(function(e){p().composeLinks.clear()})),Object(r.mutator)(a,(function(e){var t=h(e.linkId);t&&(t.displayName=e.displayName)})),Object(r.mutator)(b.H,(function(e){var t=h(e.linkId);t&&!t.isLinkBeautified&&t.displayName===e.oldLinkUrl&&(t.displayName=e.newLinkUrl)})),Object(r.mutator)(i,(function(e){h(e.linkId).isContextMenuOpen=e.value})),Object(r.mutator)(o,(function(e){p().composeLinks.forEach((function(e){return e.isContextMenuOpen=!1}))})),Object(r.mutator)(a,(function(e){h(e.linkId).isLinkBeautified=e.isLinkBeautified})),Object(r.mutator)(d,(function(e){var t=p(),n=e.selectedLinkId,r=e.isSelectedLinkReadOnly;t.selectedLinkId=n,t.isSelectedLinkReadOnly=r}));var v=n(242);Object(r.orchestrator)(b.g,(function(e){var t=(e.targetWindow||window).document.getElementById(e.linkId);t&&(v.unmountComponentAtNode(t),t.remove(),c(e.linkId))}));var m="LinkContextMenu",g="style",O=";",_="rgb(58, 58, 58)",w="background-color: rgb(58, 58, 58) !important;";var j=n(919),y=n(340),I=n(1),S=n(6057);function k(e){return I.createElement(j.a,{className:S.linkSpinner,size:y.a.xSmall})}function C(e){v.render(I.createElement(I.StrictMode,null,I.createElement(k,null)),e)}var T,A=n(0),P=n(42),E=n(565),x=n(95),L=n(254),N=n(314),R=n(2727),D=n(2298),F=n(76),M=n(1487);!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected"}(T||(T={}));var U,B=T,q=n(1346),W=n(10),V=n(5056);!function(e){e.contextMenu="contextMenu",e.sharingTip="sharingTip"}(U||(U={}));var z=n(980),H=n(2867),G=n(26);function J(e){var t;if(!Object(G.a)().AttachmentPolicy.ClassicAttachmentsEnabled||e.sharingInfo.blocksDownload)return!1;var n=e.mimeType;return(!n||"application/onenote"!==n&&n!==H.f)&&((null===(t=e.sharingInfo)||void 0===t||!t.blocksDownload)&&".fluid"!==(Object(z.b)(e.fileName)||"").toLowerCase())}var Y=n(1463),K=n(123),X=n(75);function Q(e,t){var n=Object(b.l)(e),r=function(e,t){for(var n=0;n<e.length;n++)if(e[n].type===t)return e[n].model.Id;return X.d("createAttachmentFromLink: Could not get "+t.toString()+" provider ID. File will not upload."),""}(Object(Y.h)(),n.providerType);Object(K.b)(r)||Object(b.e)(e,r,!1,t)}var Z=["OneDrivePro","OneDriveConsumer","Dropbox","Box","Mailbox","GDrive","Facebook","WopiBox","WopiEgnyte","WopiDropbox","MailMessage"];var $=n(1913),ee=n(4496);function te(e,t,n,r){var i=[];return e.supportedPermissionLevels&&e.supportedPermissionLevels.forEach((function(o){if(1!==o&&2!==o){var a=Object($.e)(o,e.providerType);i.push({text:a,key:a,title:a,onClick:function(){Object(L.o)("AttachmentLinkViewChangePermission"),function(e,t,n,r,i){Object(A.__awaiter)(this,void 0,void 0,(function(){var o,a,c;return Object(A.__generator)(this,(function(u){return e===t.permissionLevel?[2]:(o=function(e,t){if(0!==t.providerType)return null;switch(e){case 6:return t.sharingUrls.organizationEditLink;case 5:return t.sharingUrls.organizationViewLink;case 2:case 1:case 0:return t.sharingInfo.canonicalUrl;default:return null}}(e,t),a=null,0===t.providerType&&(c=t.sharingInfo,a=c.canonicalUrl),Object(b.f)(t.linkId,o,t.url,a,e,t.providerType,n,r,i),[2])}))}))}(o,e,t,n,r),Je()},isChecked:o===e.permissionLevel,canCheck:!0})}})),i.length>0?{items:i,className:ee.fixWidthContextMenu,directionalHintFixed:!0}:null}var ne=n(306);var re=n(5523);function ie(e,t,n,r,i,o,a){return Object(A.__awaiter)(this,void 0,void 0,(function(){var c,u,s;return Object(A.__generator)(this,(function(l){switch(l.label){case 0:return Je(),[4,re.a.import()];case 1:return c=l.sent(),u=e.canonicalUrl,s=e.siteUrl,c(s,u,e.shareId,n,o).then((function(n){var o=n.shareId!==e.shareId;Object(b.F)(t,n),o?Object(b.A)(t,i,r,a):Object(L.o)("LinkUnchangedFromSharingDialog",{hasResponse:!0})})).catch((function(e){Object(L.o)("LinkUnchangedFromSharingDialog",{hasResponse:!1})})),[2]}}))}))}var oe=n(4497),ae=n(487);var ce=n(5057),ue=n(4073),se=n(4074),le=n(61);function de(e,t){return Object(W.f)(e.href)?null:{name:Object(W.b)(ce.a),key:"CopyLink",onClick:function(){!function(e,t){var n=Object(le.l)()?Object(W.b)(se.a):Object(W.b)(ue.a);(t||window).prompt(n,e)}(e.href,t),Object(L.o)("AttachmentLinkViewCopyLink")}}}var fe=n(232);function pe(e){return{key:e,itemType:fe.a.Divider}}var be=n(6061);function he(e){var t="";if(null==e||"I"===e.nodeName)return"";if("#text"===e.nodeName)return e.textContent.trim();for(var n=0;n<e.childNodes.length;n++)t+=he(e.childNodes[n]);return t}var ve=n(1002),me=n(1617);function ge(e,t,n,r){var i=Object(b.l)(e.linkId),o=(Object(z.b)(i.fileName)||"").toLowerCase();return e.isLinkBeautified&&".fluid"!==o?(me.f.import(),{name:Object(W.b)(be.a),key:"EditLink",onClick:function(){Object(L.o)("AttachmentLinkViewEditLink"),function(e,t,n){Object(A.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return Object(A.__generator)(this,(function(c){switch(c.label){case 0:return r=he(e),i={LinkUrl:e.href,DisplayText:r,HasChanged:!1},[4,me.f.import()];case 1:return o=c.sent(),a=n||window,[4,o(i,a)];case 2:if(c.sent()===ve.a.ok&&i.HasChanged){if(i.LinkUrl===e.href&&Object(K.b)(i.DisplayText))return[2];t(i.LinkUrl,i.DisplayText.length>0?i.DisplayText:null)}return[2]}}))}))}(t,n,r)}}):null}var Oe=n(5058);function _e(e,t,n,r,i){return n?null:{name:Object(W.b)(Oe.a),key:"Preview",onClick:function(){!function(e,t,n,r){Object(A.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(A.__generator)(this,(function(a){switch(a.label){case 0:return Object(L.o)("PreviewLinkInSxS"),[4,D.c.import()];case 1:return i=a.sent(),(o=i(e))&&!o.needRedeem?[3,4]:[4,D.b.import()];case 2:return[4,a.sent()(e,!0,!0)];case 3:o=a.sent(),a.label=4;case 4:return l((function(){return Promise.resolve(o.wacUrlInfo)}),t,o.wacUrlInfo.readOnly,n,r),[2]}}))}))}(e,t,r,i),Je()}}}var we=n(6062);var je=n(1085),ye=n(5059),Ie=n(5060),Se=n(4498),ke=n(1847);var Ce=n(6063);function Te(e){return e===M.c.linkHasExpired||e===M.c.linkWillExpire}var Ae=n(7);function Pe(e,t,n,r){switch(e){case M.c.externalRecipientCSL:case M.c.getSharingInfoFailed:case M.c.noPermissionSet:case M.c.noPermissionToShare:case M.c.noPermissionToShareExternally:case M.c.sharingWithLargeDL:return t;case M.c.linkHasExpired:case M.c.linkWillExpire:return function(e,t,n){if(t===b.b.refreshFailed)return Object(W.b)(Ce.e);if(e===M.c.linkHasExpired)return Object(W.b)(Ce.a);var r=Object(Ae.R)(n);return Object(W.c)(Object(W.b)(Ce.c),r)}(e,n,r);default:return Object(N.a)(e)}}var Ee,xe=n(6064),Le=n(6065),Ne=n(1249),Re=n(6066),De=n(487),Fe=Object(P.a)((function(e){var t=e.sharingLinkInfo.linkActionStatus;return Object(Ne.a)("transitionend",(function(t){return Object(b.D)(e.sharingLinkInfo.linkId,b.b.none)}),[e.sharingLinkInfo.linkId]),Te(e.sharingIssue.id)&&t!==b.b.none&&t!==b.b.refreshFailed?t===b.b.refreshing?I.createElement("div",{className:Re.overlay},I.createElement(j.a,{className:Re.spinner,size:y.a.medium}),Object(W.b)(Le.b)):t===b.b.refreshSucceeded?I.createElement("div",{className:De(Re.overlay,Re.fadeOut)},I.createElement(ne.a,{iconName:"CheckMark",className:Re.check}),Object(W.b)(Le.a)):null:null})),Me=n(4497),Ue=n(6068),Be=n(309).bind(Ue),qe=Object(P.a)((function(e){var t,n,r=I.useContext(ke.a),i=function(t){var n;Object(M.n)(e.sharingLinkInfo.linkId),n=e.sharingIssue.id,Object(L.o)("AttachmentLinkRefreshedSharingTip",[n]),t.stopPropagation()},o=function(t){var n;ie(e.sharingLinkInfo.sharingInfo,e.sharingLinkInfo.linkId,e.sharingLinkInfo.permissionLevel,e.composeId,e.recipientInfos,r,e.isCalendar),n=e.sharingIssue.id,Object(L.o)("AttachmentLinkViewChangePermissionSharingDialog",[U.sharingTip,n]),t.stopPropagation()},a=function(t){var n;Q(e.sharingLinkInfo.linkId,r),n=e.sharingIssue.id,Object(L.o)("AttachmentLinkAttachAsACopy",[U.sharingTip,n]),Je(),t.stopPropagation()},c=function(t){var n;b.t.import().then((function(t){return t(e.sharingLinkInfo.linkId,e.sharingIssue.id)})),n=e.sharingIssue.id,Object(L.o)("AttachmentLinkSharingTipIgnored",[n]),t.stopPropagation()},u=e.sharingIssue,s=e.sharingLinkInfo,l={error:u.messageRank===je.b.Error},d=(t=u.id,n=s.linkActionStatus,Te(t)?n===b.b.refreshFailed?Object(W.b)(Ce.f):t===M.c.linkWillExpire?Object(W.b)(Ce.d):t===M.c.linkHasExpired?Object(W.b)(Ce.b):null:null);return I.createElement("div",{className:Me.menuItemContainer,"aria-label":u.sharingTipString,"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:null,tabIndex:0},I.createElement(Fe,{sharingLinkInfo:s,sharingIssue:u}),I.createElement("div",{className:Me.iconContainer},I.createElement(ne.a,{iconName:"Info",className:Be(Ue.sharingTipIcon,l),title:d})),function(e,t){var n=-1!==t.sharingTipActions.indexOf(M.b.ignore),r=-1!==t.sharingTipActions.indexOf(M.b.refreshExpiration)&&e.sharingInfo.canRefresh,u=e.linkActionStatus===b.b.refreshFailed?Object(W.b)(xe.b):Object(W.b)(Se.a),s=e.sharingInfo.canShareExternally||e.sharingInfo.canShareInternally,l=-1!==t.sharingTipActions.indexOf(M.b.changePermission)&&s,d=-1!==t.sharingTipActions.indexOf(M.b.attachAsACopy)&&!l&&J(e),f=Pe(t.id,t.sharingTipString,e.linkActionStatus,e.sharingInfo.expirationDate);return I.createElement("div",{className:Me.text},I.createElement("span",{className:Ue.paddingRight},f),r&&I.createElement(I.Fragment,null,I.createElement("button",{className:Ue.actionButton,onClick:i},u),I.createElement("span",{className:Ue.divider}," "," | "," ")),l&&I.createElement(I.Fragment,null,I.createElement("button",{className:Ue.actionButton,onClick:o},Object(W.b)(ye.a)),I.createElement("span",{className:Ue.divider}," "," | "," ")),d&&I.createElement(I.Fragment,null,I.createElement("button",{className:Ue.actionButton,onClick:a},Object(W.b)(xe.a)),I.createElement("span",{className:Ue.divider}," "," | "," ")),n&&I.createElement("button",{className:Ue.actionButton,onClick:c},Object(W.b)(Ie.a)))}(s,u))}));function We(e){var t=p();return e===t.selectedLinkId?!1===t.isSelectedLinkReadOnly?B.Edit:B.Selected:B.None}!function(e){e[e.SharingTip=0]="SharingTip",e[e.ChangePermission=1]="ChangePermission",e[e.Preview=2]="Preview",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.AttachACopy=4]="AttachACopy",e[e.RevertToFullUrl=5]="RevertToFullUrl",e[e.EditLink=6]="EditLink",e[e.CopyLinkToClipboard=7]="CopyLinkToClipboard"}(Ee||(Ee={}));var Ve=n(4496),ze=n(309).bind(Ve),He=Object(P.a)((function(e){var t=Object(b.l)(e.composeLinkViewState.linkId);if(!t||t.linkActionStatus===b.b.attachingAsACopy||t.linkActionStatus===b.b.pendingAttachAsACopy)return null;var n,r,i,o,a,c,u,s,l,d,f,p,h,g,O=Object(A.__read)((n=e.composeLinkViewState,r=e.anchorElement,e.editor,i=e.composeEditorViewState,o=e.operateContent,a=e.composeId,c=e.recipientInfo,u=e.isCalendar,s=e.targetWindow,l=e.sxsId,d=!1,f=!1,p=[],h=Object.keys(Ee).filter((function(e){return!isNaN(Number(Ee[e]))})).map((function(e){return Ee[e]})),g=function(e,t){o(i,(function(n){return n.addUndoSnapshot((function(){return function(e,t,n,r){v.unmountComponentAtNode(t);var i=document.createElement("a");i.href=n,i.innerText=r,e.replaceNode(t,i),e.select(i,-3),e.triggerContentChangedEvent(m)}(n,r,e,t)})),null}))},h.forEach((function(e){switch(e){case Ee.SharingTip:var t=function(e,t,n,r){var i=M.i.tryImportForRender();if(!i)return null;var o=i(Object(b.k)(e.linkId),t);if(o.length>0){o.length>1&&Object(L.o)("AttachmentLinkMultipleSharingTipsShown");var a=[];return o.map((function(i){var o=Object(b.l)(e.linkId);a.push({key:"contextualSharingTip",onRender:function(e,a){return I.createElement(qe,{sharingIssue:i,sharingLinkInfo:o,composeId:n,recipientInfos:t,isCalendar:r})}})})),a}return null}(n,c,a,u);t&&t.length>0&&(d=!0,t.forEach((function(e,t){p.push(e),p.push(pe("divider_sharing "+t))})));break;case Ee.OpenInNewTab:var i=Object(R.g)(Object(b.l)(n.linkId).url,s,(function(){Je(),Object(L.o)("OpenInNewTab",{entryPoint:"BeautifulLinkContextMenu"})}));i&&p.push(i);break;case Ee.AttachACopy:var o=function(e,t){var n=Object(b.l)(e);if(!J(n))return null;var r=Object(q.n)(Z[n.providerType]);return(null==r?void 0:r.supportConvertCloudyToClassic)?{name:Object(W.b)(V.a),key:"AttachACopy",onClick:function(){Object(L.o)("AttachmentLinkAttachAsACopy",[U.contextMenu]),Je(),Q(e,t)}}:null}(n.linkId,s);o&&p.push(o);break;case Ee.ChangePermission:var h=function(e,t,n,r,i){var o=Object(b.l)(e),a=o.sharingInfo;if(!o.accessTokenAvailable)return null;var c=function(){Object(L.o)("AttachmentLinkViewChangePermissionSharingDialog",[U.contextMenu]),ie(a,o.linkId,o.permissionLevel,t,n,r,i)};return{key:"ChangePermissionsSharingDialog",onRender:function(e,t){return I.createElement("button",{className:ae(oe.menuItemContainer,oe.buttonStyles),"aria-label":Object($.e)(o.permissionLevel,0),"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:c,tabIndex:0},I.createElement("div",{className:oe.iconContainer},I.createElement("img",{src:(n=o.permissionLevel,function(e){var t="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing";switch(e){case 2:case 3:return t+"/companyonly.svg";case 4:case 5:return t+"/anyone.svg";case 6:return t+"/directrecipients.svg";default:return t+"/existingaccess.svg?v2"}}(function(e){switch(e){case 4:return 5;case 3:return 4;case 6:return 3;case 5:return 2;case 2:case 1:return 6;default:return 1}}(n))),className:oe.permissionIcon})),I.createElement("div",{className:ae(oe.text,oe.paddingForChevron)},Object($.e)(o.permissionLevel,0)),I.createElement(ne.a,{iconName:"ChevronRight",className:ae(oe.chevronRight,"flipForRtl")}));var n}}}(n.linkId,a,c,s,u);if(h)p.push(h),p.push(pe("divider_perms")),f=!0;else{var v=function(e,t,n,r){var i=Object(b.l)(e.linkId);return{text:Object($.e)(i.permissionLevel,0),key:"changePermission",className:ee.smallFontContextMenu,subMenuProps:te(i,t,n,r)}}(n,a,c,u);v&&(p.push(v),p.push(pe("divider_perms")))}break;case Ee.EditLink:var m=ge(n,r,g,s);m&&p.push(m);break;case Ee.RevertToFullUrl:var O=function(e,t,n){var r=Object(b.l)(e.linkId),i=(Object(z.b)(r.fileName)||"").toLowerCase();return e.isLinkBeautified&&".fluid"!==i?{name:Object(W.b)(we.a),key:"RevertToFullUrl",onClick:function(){Object(L.o)("AttachmentLinkViewRevertToFullUrl"),Je(),n(t.href,t.href)}}:null}(n,r,g);O&&p.push(O);break;case Ee.Preview:if(Object(F.h)("doc-SxS-jsApi-ODB-Links")){var _=D.a.tryImportForRender(),w=Object(b.l)(n.linkId),j=w.unwrappedUrl?w.unwrappedUrl:w.url;if(n.isLinkBeautified&&_&&_(j)&&We(n.linkId)===B.None){var y=_e(j,n.linkId,u,s,l);y&&p.push(y)}}break;case Ee.CopyLinkToClipboard:var S=de(r,s);S&&p.push(S);break;default:Object(N.a)(e)}})),[p,d||f]),2),_=O[0],w={conditionalPadding:O[1]};return I.createElement(E.a,{className:ze(w),target:e.anchorElement,shouldFocusOnMount:!0,onDismiss:Ye,items:_,directionalHint:x.DirectionalHint.bottomLeftEdge,gapSpace:2})})),Ge=null;function Je(){Ge&&(v.unmountComponentAtNode(Ge),Ge.parentNode&&Ge.parentNode.removeChild(Ge),Ge=null),o()}function Ye(e){Je()}var Ke=n(1293);var Xe=n(1654);var Qe,Ze=n(2),$e=n(2323),et=n(1010),tt=n(2422);!function(e){e[e.None=0]="None",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(Qe||(Qe={}));var nt=n(4499),rt=n.n(nt),it=n(4499),ot=n(309).bind(it),at=Object(P.a)((function(e){var t=Object(F.h)("cmp-prague")&&e.sharingLink.fileName.indexOf(".fluid")>0;I.useEffect((function(){return o(),e.viewState.isLinkBeautified&&n.current.setAttribute("contenteditable","false"),Object(F.h)("doc-link-errorAttribute")&&n.current.setAttribute("owa-btf-l-cmp-only",""),n.current.setAttribute($e.f,""),n.current.addEventListener("click",c),n.current.addEventListener("contextmenu",c),e.operateContent(e.composeEditorViewState,(function(t,r,i){var o=t.queryElements("#"+e.originalElement.id),a=!1;if(o&&1===o.length){X.g.info("operateContent replacing node with beautiful link"),t.replaceNode(o[0],n.current);var c=t.getSelectionRange();t.hasFocus()&&c&&c.startContainer===c.endContainer&&c.startContainer===n.current.parentNode&&(a=!0)}else if(o&&o.length>=1){(u=new Error("BeautifulLinkWithMoreThanOne")).diagnosticInfo=e.originalElement.id,X.d(u)}else{var u;(u=new Error("BeautifulLinkWithNoTarget")).diagnosticInfo=e.originalElement.id,X.d(u)}return a?i.createRange(n.current,-3):null})),function(){n.current&&(n.current.removeEventListener("click",c),n.current.removeEventListener("contextmenu",c))}}),[]);var n=I.useRef(),r=I.useRef(),o=function(){if(e.originalElement&&"a"===e.originalElement.tagName.toLowerCase()){var t=function(e){var t=e.getAttribute(g);e.style.backgroundColor===_&&(t=t.replace(w,""));t&&t.length>0&&t.lastIndexOf(O)!==t.length-1&&(t+=O);return t}(e.originalElement);if(t+=n.current.getAttribute(g),e.isLinkPreviouslyBeautified){var r=e.originalElement.querySelector("SPAN");if(r){var i=r.getAttribute(g);i&&(i.lastIndexOf("width:")>=0?X.d("Ignore dangerous Span style ${spanStyle}"):t+=i)}}n.current.setAttribute(g,t),function(e,t){var n=e.getAttribute(tt.b);n&&n.length>0&&t.setAttribute(tt.b,n);var r=e.getAttribute(tt.d);r&&r.length>0&&t.setAttribute(tt.d,r)}(e.originalElement,n.current)}},a=e.viewState?function(e,t,n){var r=t(),i=Object(b.k)(e);if(null===i)return Qe.None;var o=b.s.tryImportForRender(),a=M.i.tryImportForRender();if(o&&a){var c=a(i,o(r,n));if(c&&c.length>0)return c.some((function(e){return e.messageRank===je.b.Error}))?Qe.Error:Qe.Warning}return Qe.None}(e.viewState.linkId,e.getRecipientWells,e.fromAddress):Qe.None,c=function(t){!function(e,t,n,r,o,a,c,u){Object(A.__awaiter)(this,void 0,void 0,(function(){var s,l,d,f,p,m,g,O;return Object(A.__generator)(this,(function(_){switch(_.label){case 0:return Je(),s=b.s.tryImportForRender(),l=[],s&&(l=s(a,c)),d=!a.some((function(e){return Object(b.C)(e)})),f=e.ownerDocument.defaultView,(Ge=f.document.createElement("span")).id="sharingLinkContextMenu",e.appendChild(Ge),p=Object(b.i)(e.id),v.render(I.createElement(I.StrictMode,null,I.createElement(He,{composeLinkViewState:h(p),anchorElement:e,editor:t,composeEditorViewState:n,operateContent:r,composeId:o,recipientInfo:l,isCalendar:d,targetWindow:f,sxsId:u})),Ge),i(p,!0),[4,M.i.import()];case 1:return m=_.sent(),g=Object(b.k)(p),O=m(g,l).length>0,Object(L.o)("LinkContextMenuOpened",{hasSharingIssue:O,linkId:p}),[2]}}))}))}(n.current,e.editor,e.composeEditorViewState,e.operateContent,e.composeId,e.getRecipientWells(),e.fromAddress,e.sxsId),t.preventDefault()};Object(F.h)("doc-SxS-jsApi-ODB-Links")?r.current=We(e.sharingLink.linkId):r.current=B.None;var u={attachingAsACopy:e.sharingLink.linkActionStatus===b.b.attachingAsACopy||e.sharingLink.linkActionStatus===b.b.pendingAttachAsACopy,link:e.viewState.isLinkBeautified};u[function(e){switch(e){case B.Edit:return"edit";case B.Selected:return"selected";case B.None:return"none";default:return Object(N.a)(e)}}(r.current)]=!0;var s=e.viewState.isLinkBeautified&&e.hasValidFileName&&!t;return I.createElement("a",{ref:function(e){return n.current=e},href:e.sharingLink.url,onMouseOver:function(){n.current&&e.viewState.isLinkBeautified&&!t&&(n.current.style.backgroundColor="rgb(237,235,233)")},onMouseLeave:function(){n.current&&e.viewState.isLinkBeautified&&!t&&(n.current.style.backgroundColor="rgb(243,242,241)")},style:function(n){var r=ut(e.composeEditorViewState),i={};return e.viewState.isLinkBeautified&&(i={padding:"0 1px",borderRadius:"2px",userSelect:"all"},t||(i=Object(A.__assign)(Object(A.__assign)({},i),{backgroundColor:"rgb(244,244,244)"}))),n===Qe.Error&&r&&(i=Object(A.__assign)(Object(A.__assign)({},i),{color:rt.a.linkErrorColor})),i}(a),id:Object(b.h)(e.sharingLink.linkId,e.sharingLink.permissionLevel),className:ot("OWAAutoLink",function(t){var n=ut(e.composeEditorViewState);if(t===Qe.Error&&!n)return Object(F.h)("doc-link-errorAttribute")?it.linkWithSharingIssueAttribute:it.linkWithSharingIssue}(a),u)},e.viewState.isLinkBeautified&&Object(F.h)("doc-SxS-jsApi-ODB-Links")?I.createElement(I.Fragment,null,I.createElement("span",{className:R.a},I.createElement(ne.a,{className:r.current===B.Edit?it.editLinkIcon:null,iconName:"Edit",hidden:r.current!==B.Edit}))):null,s&&I.createElement("img",{src:e.fileIcon,style:{width:"16px",height:"16px",verticalAlign:"middle",padding:"1px 2px 2px 0"},alt:"",role:"presentation"}),e.viewState.displayName,function(t){return e.viewState.isLinkBeautified?I.createElement(I.Fragment,null,I.createElement("span",{className:R.a},I.createElement("img",{alt:"",role:"presentation",src:ct(t),hidden:t===Qe.None,style:{width:"12px",height:"12px",verticalAlign:"top"}}))):null}(a))}));function ct(e){return e===Qe.Error?Object(W.c)("{0}{1}",Object(Ze.v)(),"resources/images/redinfo_24.png"):e===Qe.Warning?Object(W.c)("{0}{1}",Object(Ze.v)(),"resources/images/greyinfo_24.png"):""}function ut(e){return Object(et.a)(e,"isDarkMode")||!1}function st(e,t,n,r,i,o,c,u,s,l,d,f){return Object(A.__awaiter)(this,void 0,void 0,(function(){var p,b,m,g,O,_,w;return Object(A.__generator)(this,(function(j){switch(j.label){case 0:return X.g.info("createSharingLinkView for id="+o.id+" isLinkPreviouslyBeautified="+l),p=s||l,b=u||l,m=function(e,t,n){if(e&&t){var r=Object(Xe.e)(e,n===H.f,n);return r.cdn?r.cdn:(X.d("Failed to get cdn fileicon for "+e),"")}return""}(l?he(o):c.fileName,p,c.mimeType),g=(d||window).document,O=g.createElement("span"),_=function(e,t,n,r,i){return i?he(e):n&&r?t.fileName:e.innerText}(o,c,b,s,l),a(c.linkId,_,p),[4,Ke.c.import()];case 1:return w=j.sent(),v.render(I.createElement(I.StrictMode,null,I.createElement(ke.a.Provider,{value:d||window},I.createElement(at,{viewState:h(c.linkId),getRecipientWells:n,fromAddress:r,sharingLink:c,fileIcon:m,hasValidFileName:b,editor:e,composeEditorViewState:t,originalElement:o,composeId:i,isLinkPreviouslyBeautified:l,operateContent:w,sxsId:f}))),O),[2]}}))}))}n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return"OWAAutoLink"})),n.d(t,"f",(function(){return"SPAN"})),n.d(t,"c",(function(){return"contextmenu"})),n.d(t,"b",(function(){return"click"})),n.d(t,"a",(function(){return"owa-btf-l-cmp-only"})),n.d(t,"g",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"l",(function(){return l})),n.d(t,"m",(function(){return c})),n.d(t,"j",(function(){return C})),n.d(t,"h",(function(){return Je})),n.d(t,"i",(function(){return st}))},339:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(240),i=null,o=3e4;function a(){return null==i&&(i=new r.Cache),i}function c(e){return a().get(e)}function u(e){return a().del(e)}function s(e,t){a().put(e,t,o)}},3622:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),i=n(254),o=n(1344),a=n(1640),c=n(75);function u(e,t,n,u,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,d,f,p,b,h,v,m,g,O,_,w,j,y;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:l=new i.a("getWacInfoForOneDriveJsApi",{isCore:!0}),u&&l.addCustomData({redeemSharingLinkIfNecessary:u}),r.label=1;case 1:return r.trys.push([1,3,,4]),d=btoa(t),f="u!"+d.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),p=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0],b=p+"_api/v2.0/shares/"+f+"/root?select=openWith/wac,officeBundle,@content.downloadUrl,name,size,currentUserRole&action="+(n?"Open":"View"),h=new Object,u&&(h.prefer="redeemSharingLinkIfNecessary"),v=Object(o.a)({ProviderType:e,Url:b,Headers:JSON.stringify(h)}),m=(new Date).getTime(),[4,Object(a.a)(v)];case 2:if(200===(g=r.sent()).Status&&g.Body)return O=(new Date).getTime(),(_=JSON.parse(g.Body)).fetchStartTime=m,_.responseStartTime=O,!_.openWith.wac&&s||(_.openWith.wac.fileGetUrl=_["@content.downloadUrl"],_.openWith.wac.accessTokenExpiry&&(_.openWith.wac.accessTokenExpiry=new Date(Number(_.openWith.wac.accessTokenExpiry))),!n&&_.currentUserRole&&(_.currentUserRole.readOnly=!0)),l.end(),[2,_];throw l.addCustomData({StatusCode:g.Status}),(w=g.Headers)&&(j=JSON.parse(w))&&l.addCustomData({SharePointError:j.SharePointError,SPClientServiceRequestDuration:j.SPClientServiceRequestDuration,SPRequestGuid:j.SPRequestGuid}),new Error("Result status is: "+g.Status+" or empty response body.");case 3:return y=r.sent(),l.endWithError("ServerError",y),c.g.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+y),[3,4];case 4:return[2,null]}}))}))}},3687:function(e){e.exports=JSON.parse('{"a":"A9a"}')},390:function(e,t,n){"use strict";var r=n(0),i=n(240),o=n(271),a=n(341),c=n(297),u=n(121),s=n(25);function l(e,t){return void 0===e||e.__type||(e=Object(c.a)(e)),Object(s.a)("GetAccessTokenforResource",e,t)}var d=n(69),f=n(98),p="OWA_GetAccessTokenForResource";function b(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(d.a)()];case 1:return(i=r.sent())&&e==Object(f.a)()?[2,{AccessToken:i}]:(o={isUserActivity:!1,datapoint:{customData:{Scenario:p,Resource_Url:e,Retry_attempt:t,Request_Id:n},headersCustomData:function(e){return{TokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){var t;return{TokenStatus:(null===(t=null==e?void 0:e.TokenResultCode)||void 0===t?void 0:t.toString())||2}}},returnFullResponseOnSuccess:!0},[4,l(Object(c.a)({Resource:e,UserToken:i}),o)]);case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}}))}))}function h(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return t<1?[2,Promise.reject()]:[2,b(e,t,i).catch((function(r){return Object(u.a)(n).then((function(){return h(e,t-1,2*n,i)}))}))]}))}))}var v,m=n(76),g=n(490),O=3,_=500;function w(e,t){var n=this,i=null,o=null,a=new Promise((function(e,t){return Object(r.__awaiter)(n,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return i=e,o=t,[2]}))}))})),c={onFulfilled:i,onRejected:o,resource:e,requestId:t};return(null==v&&(v=new g.a(O,j,_)),v).add(c),a}function j(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return N(e.resource,e.requestId).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var y=n(339),I=n(118),S=n(435);n.d(t,"d",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"c",(function(){return L})),n.d(t,"a",(function(){return N}));var k=1,C=8e3,T=3,A=1500,P=null;function E(e){P=e}function x(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=R(D(),e),t=t||Object(S.a)(),null!=n?[3,2]:[4,N(e,t)];case 1:n=r.sent(),r.label=2;case 2:return[2,null!=n?n.AccessToken:void 0]}}))}))}function L(e,t){t=t||Object(S.a)();var n=R(D(),e);if(n)return[n.AccessToken,void 0];if(Object(m.h)("auth-getAccessTokenQueueEnabled")){var r=Object(y.a)(e),i=void 0;return r?i=r:(i=w(e,t),Object(y.b)(e,i)),[void 0,i.then((function(t){return Object(y.c)(e),t.AccessToken})).catch((function(n){Object(y.c)(e),Object(I.h)(p,{category:"Promise_For_Token_Request_Failed",err:n?n.toString():"",message:n?n.message:"",stk:n?n.stack:"",resource:e,requestId:t})}))]}return[void 0,N(e,t).then((function(e){return e.AccessToken}))]}function N(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(m.h)("auth-getAccessTokenQueueEnabled")?[4,h(e,T,A,t)]:[3,2];case 1:return i=r.sent(),[3,4];case 2:return[4,b(e,T,t)];case 3:i=r.sent(),r.label=4;case 4:return null!=(n=i)&&0==n.TokenResultCode&&null!=n.AccessTokenExpiry&&(n.ExpiresIn&&n.ExpiresIn>0&&(n.AccessTokenExpiry=Object(a.a)(Date.now(),n.ExpiresIn).toISOString()),(o=new Date(n.AccessTokenExpiry).getTime()-Date.now()-C)>0&&D().put(e,n,o,(function(e,n){N(e,t).catch((function(n){Object(I.h)(p,{category:"Cache_Expired",err:n?n.toString():"",message:n?n.message:"",stk:n?n.stack:"",resource:e,requestId:t})}))}))),[2,n]}}))}))}function R(e,t){var n=e.get(t),r=void 0;(null==n?void 0:n.AccessTokenExpiry)&&n.AccessToken&&(Object(o.a)(new Date(n.AccessTokenExpiry),-k)>new Date(Date.now())&&(r=n));return r}function D(){return null==P&&(P=new i.Cache),P}},3961:function(e,t,n){"use strict";var r=n(25),i=n(0);function o(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(i.__assign)({__type:"GetWacInfoRequest:#Exchange"},n))),Object(r.a)("GetWacInfo",e,t)}function a(e,t,n,r,i){return void 0===n&&(n=!1),void 0===r&&(r=!1),o({request:{Url:e,IsEdit:r,ProviderType:t,ShouldGrantAccess:n}},i)}n.d(t,"a",(function(){return a}))},3993:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("previewAttachment",(function(e){return{context:e}}))},4064:function(e,t,n){"use strict";n.d(t,"j",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p}));var r=n(4),i=Object(r.action)("tryQueueGetWacInfo",(function(e){return{url:e}})),o=Object(r.action)("queueGetWacInfo",(function(e){return{url:e}})),a=Object(r.action)("processGetWacInfoQueue"),c=Object(r.action)("getWacInfoQueueShift"),u=Object(r.action)("onStartGetWacInfoOperation",(function(e){return{url:e}})),s=Object(r.action)("onFinishGetWacInfoOperation",(function(e){return{url:e}})),l=Object(r.action)("pushSupressedUrl",(function(e){return{url:e}})),d=Object(r.action)("onGetWacInfoSuccess",(function(e,t,n){return{url:e,wacUrlInfo:t,needRedeem:n}})),f=Object(r.action)("addGenericLinkClickListener",(function(e,t,n){return{element:e,isSafeLinkWrapped:t,isSafeLinkVerified:n}})),p=Object(r.action)("addOpenDocumentPreviewEventListener",(function(e,t,n,r,i,o,a){return{element:e,href:t,itemId:n,isSafeLinkWrapped:r,isSafeLinkVerified:i,isOfficeSPLink:o,sxsId:a}}))},4073:function(e){e.exports=JSON.parse('{"a":"L_a"}')},4074:function(e){e.exports=JSON.parse('{"a":"K_a"}')},4496:function(e,t,n){var r=n(6059),i=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4497:function(e,t,n){var r=n(6060),i=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4498:function(e){e.exports=JSON.parse('{"a":"P_a"}')},4499:function(e,t,n){var r=n(6070),i=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4787:function(e,t,n){"use strict";var r=n(23),i=n(4),o={activeGetWacInfoOperations:[],getWacInfoQueue:[],suppressedUrls:[],docLinkPreviewInfoMap:new r.ObservableMap},a=Object(i.createStore)("sharePointDocLinkPreview",o);t.a=a()},4855:function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(4),a=n(2),c=n(289);var u=n(450),s={am:"am-et","be-by":"be",cy:"cy-gb",en:"en-us",fil:"fil-ph","gd-gb":"gd","lo-la":"lo","mn-mn":"mn",no:"nn-no",or:"or-in","pa-in":"pa",prs:"prs-af",pt:"pt-br",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs","ug-cn":"ug",uz:"uz-latn-uz","zh-hant":"zh-tw","zh-hans":"zh-cn"};function l(){var e=Object(u.a)(Object(i.e)().currentLocale).locale.toLocaleLowerCase();return s[e]||e}function d(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(u){switch(u.label){case 0:return e=l(),t=["items-view","items-view-addon-graph","items-view-addon-sp","items-view-utilities","odsp-datasources","odsp-list-utilities","odsp-shared-sharing","odsp-utilities","utilities-custom-formatter","utilities-date-time","utilities-office-apps"],[4,Promise.all(t.map((function(t){return function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(c.resolve)(Object(a.v)(),"resources/"+e+"/locale/"+t+".json"),[4,fetch(n)];case 1:return[4,r.sent().json()];case 2:return[2,r.sent()]}}))}))}(t,e)})))];case 1:return n=u.sent(),window.ItemsViewStrings=n.reduce((function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),t)}),{}),f||(Object(o.orchestrator)(i.g,d),f=!0),[2]}}))}))}var f=!1;n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l}))},490:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},5056:function(e){e.exports=JSON.parse('{"a":"__a"}')},5057:function(e){e.exports=JSON.parse('{"a":"J_a"}')},5058:function(e){e.exports=JSON.parse('{"a":"M_a"}')},5059:function(e){e.exports=JSON.parse('{"a":"R_a"}')},5060:function(e){e.exports=JSON.parse('{"a":"Q_a"}')},528:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,i=!1,o=function(a,c){i?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return a(e)})).catch((function(e){t&&r>=t?c(e):setTimeout((function(){return o(a,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return o(e,t)}))},cancel:function(){return i=!0}}}}function i(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},5492:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=18e5,i=2,o="SP_LINK_CLICK_EVENT_LISTENER",a="SP_LINK_MOUSEUP_EVENT_LISTENER"},5523:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var r=n(0),i=n(924),o=n(115),a=n(4855),c=new o.c((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(a.b)()];case 1:return t.sent(),[4,Promise.all([n.e(1),n.e(5),n.e(6),n.e(8),n.e(554)]).then(n.bind(null,8291))];case 2:return e=t.sent(),Object(i.initializeIcons)(),[2,e]}}))}))})),u=new o.b(c,(function(e){return e.sharingDialog}))},576:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},6012:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(5492),i=n(4787);function o(e){return a(e).docLinkPreviewInfo||null}function a(e){var t=i.a.docLinkPreviewInfoMap.get(e);return t?t.time+r.c>Date.now()?{docLinkPreviewInfo:t}:{reason:"Expired"}:i.a.getWacInfoQueue.some((function(t){return t===e}))||i.a.activeGetWacInfoOperations.some((function(t){return t===e}))?{reason:"InQueue"}:i.a.suppressedUrls.some((function(t){return t===e}))?{reason:"FileTypeNotSupportedOrSuppressedAfterError"}:{reason:"Unknown"}}},6057:function(e,t,n){var r=n(6058),i=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},6058:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,".zlTOIqgXrUeoE4QgaYR88{vertical-align:middle;width:14px;height:14px;display:inline-block}",""]),t.locals={linkSpinner:"zlTOIqgXrUeoE4QgaYR88"}},6059:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,"._17WyMAb7kE3GVOOwb-TpZ2{width:380px}.iji84L-TYfQ1OzoQCLarU{font-size:12px;font-weight:400}html[dir=ltr] .kYi6jPW-Twz-7yNjFuas7 .ms-ContextualMenu-link{padding-left:40px}html[dir=rtl] .kYi6jPW-Twz-7yNjFuas7 .ms-ContextualMenu-link{padding-right:40px}",""]),t.locals={fixWidthContextMenu:"_17WyMAb7kE3GVOOwb-TpZ2",smallFontContextMenu:"iji84L-TYfQ1OzoQCLarU",conditionalPadding:"kYi6jPW-Twz-7yNjFuas7"}},6060:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'._1FXMYQgOMl3amdWxRszOtq{font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;max-width:340px;width:100%}html[dir] ._1FXMYQgOMl3amdWxRszOtq{background:transparent;padding:4px 0;margin:1px}html[dir=ltr] ._1FXMYQgOMl3amdWxRszOtq{text-align:left}html[dir=rtl] ._1FXMYQgOMl3amdWxRszOtq{text-align:right}._1FXMYQgOMl3amdWxRszOtq:focus{outline:dotted 1px}._2J6rsM7M0QVkdfFCwf00JE{cursor:pointer}html[dir] ._2J6rsM7M0QVkdfFCwf00JE:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}._3C9hg6ajHb65GB2Yn3bZfl{word-wrap:break-word;max-width:286px}html[dir=ltr] ._3C9hg6ajHb65GB2Yn3bZfl{padding:8px 16px 8px 0}html[dir=rtl] ._3C9hg6ajHb65GB2Yn3bZfl{padding:8px 0 8px 16px}._T68wDSYHk9rU_lDLi9YG{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;min-width:44px}._T68wDSYHk9rU_lDLi9YG,._3ocYJJXdgtwVydxjhLdwEm{display:-webkit-box;display:-ms-flexbox;display:flex}._3ocYJJXdgtwVydxjhLdwEm{width:24px}html[dir=ltr] ._3ocYJJXdgtwVydxjhLdwEm{left:10px}html[dir=rtl] ._3ocYJJXdgtwVydxjhLdwEm{right:10px}._1aMX_W4LfwQ1uTeRkbETcG{display:inline-block;height:32px;line-height:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;font-size:12px}html[dir] ._1aMX_W4LfwQ1uTeRkbETcG{text-align:center}html[dir=ltr] ._1aMX_W4LfwQ1uTeRkbETcG{right:8px}html[dir=rtl] ._1aMX_W4LfwQ1uTeRkbETcG{left:8px}._1aMX_W4LfwQ1uTeRkbETcG,._3ocYJJXdgtwVydxjhLdwEm,._2RFcp9Zl9UWOAAPCKGSCKd{position:absolute;top:50%}html[dir] ._1aMX_W4LfwQ1uTeRkbETcG,html[dir] ._3ocYJJXdgtwVydxjhLdwEm,html[dir] ._2RFcp9Zl9UWOAAPCKGSCKd{-webkit-transform:translateY(-50%);transform:translateY(-50%)}html[dir=ltr] .G28wWLVhUsHo2YnnrMEFD{padding-right:28px}html[dir=rtl] .G28wWLVhUsHo2YnnrMEFD{padding-left:28px}',""]),t.locals={menuItemContainer:"_1FXMYQgOMl3amdWxRszOtq",buttonStyles:"_2J6rsM7M0QVkdfFCwf00JE",text:"_3C9hg6ajHb65GB2Yn3bZfl",iconContainer:"_T68wDSYHk9rU_lDLi9YG",permissionIcon:"_3ocYJJXdgtwVydxjhLdwEm",chevronRight:"_1aMX_W4LfwQ1uTeRkbETcG",verticalCenter:"_2RFcp9Zl9UWOAAPCKGSCKd",paddingForChevron:"G28wWLVhUsHo2YnnrMEFD"}},6061:function(e){e.exports=JSON.parse('{"a":"I_a"}')},6062:function(e){e.exports=JSON.parse('{"a":"H_a"}')},6063:function(e){e.exports=JSON.parse('{"e":"U_a","a":"V_a","c":"W_a","f":"X_a","d":"Y_a","b":"Z_a"}')},6064:function(e){e.exports=JSON.parse('{"b":"N_a","a":"O_a"}')},6065:function(e){e.exports=JSON.parse('{"b":"S_a","a":"T_a"}')},6066:function(e,t,n){var r=n(6067),i=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},6067:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'._15uyY13ASl7ioBzQ_C4EWc{position:absolute;z-index:2;width:100%;height:calc(100% - 10px);opacity:.9;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;color:"[theme:themePrimary, default:#0078D4]";font-size:14px}html[dir] ._15uyY13ASl7ioBzQ_C4EWc{background-color:"[theme:white, default:#ffffff]"}._3d_DdC8WbZ8lVAv_uGMON8{color:#107c10}html[dir=ltr] ._3d_DdC8WbZ8lVAv_uGMON8{padding-right:4px}html[dir=rtl] ._3d_DdC8WbZ8lVAv_uGMON8{padding-left:4px}html[dir=ltr] ._2Atp1TsvFekBpdmnwjlUMU{padding-right:8px}html[dir=rtl] ._2Atp1TsvFekBpdmnwjlUMU{padding-left:8px}._3FqcARyIY48vWIbTdVE2SJ{opacity:0}html[dir] ._3FqcARyIY48vWIbTdVE2SJ{-webkit-transition:opacity 4s cubic-bezier(.95,.05,.5,.12);transition:opacity 4s cubic-bezier(.95,.05,.5,.12)}',""]),t.locals={overlay:"_15uyY13ASl7ioBzQ_C4EWc",check:"_3d_DdC8WbZ8lVAv_uGMON8",spinner:"_2Atp1TsvFekBpdmnwjlUMU",fadeOut:"_3FqcARyIY48vWIbTdVE2SJ"}},6068:function(e,t,n){var r=n(6069),i=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},6069:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'._1j7cMKJzK3hDG-6d1x8z6x{font-size:14px;color:"[theme:neutralSecondary, default:#666666]"}._1j7cMKJzK3hDG-6d1x8z6x.NCCd4mtRtnDhwXkQV3Z_P{color:#c50e2e}._1XTgRlvIFVAMWCwk3N1Mrd{font-size:12px;font-weight:400;color:"[theme:themePrimary, default:#0078D4]";cursor:pointer}html[dir] ._1XTgRlvIFVAMWCwk3N1Mrd{background:transparent}html[dir=ltr] ._1lAZM-j0_dTiprJU8qtsOC{padding-right:5px}html[dir=rtl] ._1lAZM-j0_dTiprJU8qtsOC{padding-left:5px}._2A5MU0_Ldq3YiUz9_7eSp0{position:relative;top:-1px}',""]),t.locals={sharingTipIcon:"_1j7cMKJzK3hDG-6d1x8z6x",error:"NCCd4mtRtnDhwXkQV3Z_P",actionButton:"_1XTgRlvIFVAMWCwk3N1Mrd",paddingRight:"_1lAZM-j0_dTiprJU8qtsOC",divider:"_2A5MU0_Ldq3YiUz9_7eSp0"}},6070:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'._3Yr2UU45BKqj8cd21wO--0,.MEvaZK33-uzHgSrR3sZ2B[owa-btf-l-cmp-only]{color:#c50e2e}._3iLgzr8un7L5GebClucrpV{display:inline-block}._3BQT8e_ffVCDX0mocATk3h{opacity:.3}html[dir] ._1qJHlPfY83WgqLBJTIZPj{border-radius:2px}html[dir] ._1qJHlPfY83WgqLBJTIZPj:focus,html[dir] ._1qJHlPfY83WgqLBJTIZPj:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._1Bl3Epd8DW0Ci3uZDqSnP5,._12rPxFFSJYfi0v4-eMstQ7,._2m59mwUb8f5uts16JkmmuW{color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._1Bl3Epd8DW0Ci3uZDqSnP5,html[dir] ._12rPxFFSJYfi0v4-eMstQ7,html[dir] ._2m59mwUb8f5uts16JkmmuW{border-width:1px;background-color:"[theme:themeLight, default:#C7E0F4]"!important;border-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._1Bl3Epd8DW0Ci3uZDqSnP5{border-style:dashed;background-color:"[theme:themeLighterAlt, default:#EFF6FC]"!important}html[dir] ._12rPxFFSJYfi0v4-eMstQ7{border-style:solid}._28V6s2qWpjnFBjP3O5_ZUO{font-size:14px;font-weight:400;position:relative;top:-1px;color:"[theme:themePrimary, default:#0078D4]";vertical-align:middle;text-decoration:underline;-webkit-text-decoration-color:"[theme:themeLighterAlt, default:#EFF6FC]";text-decoration-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir=ltr] ._28V6s2qWpjnFBjP3O5_ZUO{padding-right:4px;padding-left:3px}html[dir=rtl] ._28V6s2qWpjnFBjP3O5_ZUO{padding-left:4px;padding-right:3px}._7uvXE6H5Cmt5xolh9xVtj{vertical-align:middle;width:14px;height:14px;display:inline-block}',""]),t.locals={linkErrorColor:"#c50e2e",linkWithSharingIssue:"_3Yr2UU45BKqj8cd21wO--0",linkWithSharingIssueAttribute:"MEvaZK33-uzHgSrR3sZ2B",link:"_3iLgzr8un7L5GebClucrpV",attachingAsACopy:"_3BQT8e_ffVCDX0mocATk3h",none:"_1qJHlPfY83WgqLBJTIZPj",edit:"_1Bl3Epd8DW0Ci3uZDqSnP5",selected:"_12rPxFFSJYfi0v4-eMstQ7",withBorder:"_2m59mwUb8f5uts16JkmmuW",editLinkIcon:"_28V6s2qWpjnFBjP3O5_ZUO",linkSpinner:"_7uvXE6H5Cmt5xolh9xVtj"}},613:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},632:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25),i=n(613);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindItem",e,t)}},633:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},6462:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(254);function i(e,t,n,i,o){Object(r.o)("SharePointLinkClick",{newTabReason:e,isSafeLinkWrapped:t,isSafeLinkVerified:n,extraInfo:i,isOfficeSPLink:o})}},715:function(e,t,n){"use strict";n.r(t);var r=n(240),i=n(390);function o(e){Object(i.d)(new r.Cache),Object(i.b)(e.location.origin)}var a=n(0),c=n(58),u=n(107),s=n(341),l=n(118),d="OWA_GetDelegationAccessToken",f={};function p(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:t=encodeURIComponent(e.client_id+e.scope+e.requestId),n={},r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,b(e,window,t)];case 2:return n=r.sent(),[3,5];case 3:return r.sent(),n.TokenResultCode=2,[3,5];case 4:return function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",f[e]),t.document.body.removeChild(n),delete f[e])}(t,window),[7];case 5:return[2,n]}}))}))}function b(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(a.__generator)(this,(function(o){return r=function(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+c.stringify(t)}(e),t.document.getElementById(n)?[2,{TokenResultCode:2}]:((i=t.document.createElement("iframe")).src=r.toString(),i.style.display="none",i.id=n,t.document.body.appendChild(i),[2,new Promise((function(r,o){f[n]=function(n){var a={};try{i.contentWindow&&i.contentWindow.location.host==t.location.host&&(a=function(e,t){var n=c.parse(e),r={};n.access_token?(r.AccessToken=n.access_token,r.AccessTokenExpiry=Object(s.a)(Date.now(),parseInt(n.expires_in)).toISOString(),r.TokenResultCode=0):"login_required"==n.error||"interaction_required"==n.error||"consent_required"==n.error?(r.TokenResultCode=3,Object(l.h)(d+" MSA Failure Unauthorized",{error:n.error,param:e,requestId:t})):(r.TokenResultCode=2,Object(l.h)(d+" MSA Failure",{error:n.error,param:e,requestId:t}));return r}(i.contentWindow.location.hash.substring(1),e.requestId))}catch(t){Object(l.h)(d+" Hash Param Parsing Failure ",{err:t.toString(),message:t.message,stk:t.stack||"",scope:e.scope,uri:e.redirect_uri,requestId:e.requestId}),a.TokenResultCode=2,o(a)}r(a)},i.addEventListener("load",f[n],!1)}))])}))}))}var h,v=n(76),m=n(339),g=n(490),O=3,_=1500;function w(e){var t=this,n=null,r=null,i=new Promise((function(e,i){return Object(a.__awaiter)(t,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return n=e,r=i,[2]}))}))})),o={onFulfilled:n,onRejected:r,options:e};return(null==h&&(h=new g.a(O,j,_)),h).add(o),i}function j(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return p(e.options).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var y=n(98),I=n(435),S=null,k="OWA_GetDelegationAccessToken",C="https://login.live.com/oauth20_authorize.srf",T="/owa/auth/dt.aspx",A="292841";function P(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:n={scope:e,client_id:"",authorization_uri:"",redirect_uri:"",requestId:t||Object(I.a)()},r=void 0,i=void 0,a.label=1;case 1:return a.trys.push([1,7,,8]),Object(v.h)("auth-disableGetAuthenticationCall")?[4,E(N(n))]:[3,3];case 2:return r=a.sent(),[3,6];case 3:return[4,Object(u.a)()];case 4:return 0!=(i=a.sent()).ResultCode||null==i.ImplicitGrantAuthorizationUrl||""==i.ImplicitGrantAuthorizationUrl?(Object(l.h)(k+" ImplicitGrantAuthorizationUrl is empty or null ",{scope:e,correlationId:n.requestId}),[2,r]):(o=c.parse(i.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&o.redirect_uri?(n.client_id=o.client_id,n.authorization_uri=i.ImplicitGrantAuthorizationUrl.split("?")[0],n.redirect_uri=o.redirect_uri,[4,E(n)]):[3,6];case 5:r=a.sent(),a.label=6;case 6:return[2,r];case 7:return s=a.sent(),Object(l.h)(k+" GetDelegationToken Operation failed ",{err:s.toString(),message:s.message,stk:s.stack||"",scope:e,requestId:n.requestId}),[2,r];case 8:return[2]}}))}))}function E(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return Object(a.__generator)(this,(function(o){switch(o.label){case 0:return t=e.client_id+e.scope,(null==(n=function(e,t){var n=e.get(t),r=void 0;if(null==n?void 0:n.AccessTokenExpiry){new Date(n.AccessTokenExpiry)>new Date(Date.now())&&(r=n)}return r}(L(),t))?void 0:n.AccessToken)?[2,n.AccessToken]:[3,1];case 1:return Object(v.h)("auth-getDelegationTokenQueueEnabled")?(r=Object(m.a)(t),i=void 0,r?i=r:(i=w(e),Object(m.b)(t,i)),[2,i.then((function(e){return x(t,e),Object(m.c)(t),e.AccessToken})).catch((function(n){Object(m.c)(t),Object(l.h)(k,{category:"Promise_For_Token_Request_Failed",err:n?n.toString():"",message:n?n.message:"",scope:e.scope,requestId:e.requestId})}))]):[3,2];case 2:return[4,p(e)];case 3:return n=o.sent(),x(t,n),[2,0==n.TokenResultCode?n.AccessToken:void 0]}}))}))}function x(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&L().put(e,t,n)}}function L(){return null==S&&(S=new r.Cache),S}function N(e){return e.redirect_uri=Object(y.a)()+T,e.authorization_uri=C,e.client_id=A,e}var R=n(5),D=n(445);var F=!1;function M(){var e;F||(e=Object(D.a)("/owa"),Object(R.b)({baseUrl:e}),F=!0)}var U={NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",NoPreAuth:"AADSTS65001",UserAborted:"AADSTS65004",NotConsent:"AADSTS70011"};function B(e,t,n,r,i){n?e.acquireTokenPopup(t,null,n,i):e.acquireToken(t,(function(n,o){n&&n.indexOf(U.NoPreAuth)>=0&&r?e.acquireTokenPopup(t,null,null,i):i(n,o)}))}var q=n(115),W=new q.c((function(){return Promise.all([n.e(696),n.e(117)]).then(n.bind(null,15888))})),V=new q.a(W,(function(e){return e.createAdalAuthenticationContext}));var z=function(e,t,n,r,i){return function(o,a){o||!a?i(o,null):(e.getCachedUser(),B(e,t,n,r,i))}},H="adalIdTokenFrame";function G(e,t,n,r,i){e.config.displayCall=function(o){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(o),window.detectUserCachedCallback=z(e,t,n,r,i),function(e,t){e._addAdalFrame(H).src="about:blank",e._loadFrame(t+"&prompt=none",H)}(e,o)},e.login()}var J=n(26);function Y(e,t,n,r,i,o){var c,u;return Object(a.__awaiter)(this,void 0,void 0,(function(){var s,l,d,f;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return"https://login.microsoftonline.com/",[4,V.importAndExecute("https://login.microsoftonline.com/",e,t)];case 1:return s=a.sent(),l=Object(J.a)(),d=null===(c=l.SessionSettings)||void 0===c?void 0:c.UserPrincipalName,f=null===(u=l.SessionSettings)||void 0===u?void 0:u.UserEmailAddress,s._user={profile:{upn:d||f}},s.getCachedUser()?B(s,n,r,i,o):G(s,n,r,i,o),[2]}}))}))}var K=n(69);n.d(t,"registerTokenProvider",(function(){return o})),n.d(t,"getAccessTokenforResource",(function(){return i.b})),n.d(t,"getAccessTokenforResourceAsLazy",(function(){return i.c})),n.d(t,"getDelegationToken",(function(){return E})),n.d(t,"getDelegationTokenForOwa",(function(){return P})),n.d(t,"bootstrap",(function(){return M})),n.d(t,"getAccessTokenOnBehalfOfResource",(function(){return Y})),n.d(t,"AdalErrorCode",(function(){return U})),n.d(t,"setUserTokenCallback",(function(){return K.b}))},7326:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),i=n(3961),o=n(3622),a=n(76),c=n(980),u=n(4064),s=n(6012);function l(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,l,f,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,,9,10]),Object(u.f)(e),i=null,Object(a.h)("doc-SxS-jsApi-ODB-Links")?[4,Object(o.a)(0,e,!0,n,!0)]:[3,6];case 1:return(l=r.sent())?[3,2]:(Object(u.h)(e),[2,null]);case 2:return f=Object(c.b)(l.name),(p=Object(c.f)(f))!==c.a.Word&&p!==c.a.Excel&&p!==c.a.PowerPoint?[3,3]:(l.openWith.wac?i={wacUrl:l.openWith.wac.applicationUrl,jsApiInfo:{bootScriptUrl:l.openWith.wac.bootstrapperUrl,wopiSrcUrl:l.openWith.wac.wopiSrc,accessToken:l.openWith.wac.accessToken,accessTokenExpiry:l.openWith.wac.accessTokenExpiry,fileSize:l.size,fileGetUrl:l.openWith.wac.fileGetUrl,bundleInfo:l.officeBundle,fetchStartTime:l.fetchStartTime,responseStartTime:l.responseStartTime,openUrl:e,fileName:l.name,userId:l.openWith.wac.userId,clientThrottlingProtection:l.openWith.wac.clientThrottlingProtection,requestedCallThrottling:l.openWith.wac.requestedCallThrottling},readOnly:l.currentUserRole.readOnly}:Object(u.e)(e,null,!0),[3,5]);case 3:return[4,d(e)];case 4:i=r.sent(),r.label=5;case 5:return[3,8];case 6:return[4,d(e)];case 7:i=r.sent(),r.label=8;case 8:return i&&Object(u.e)(e,i),t?[2,Object(s.a)(e)]:[2,null];case 9:return Object(u.d)(e),[7];case 10:return[2]}}))}))}function d(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(i.a)(e,0)];case 1:if(9===(t=n.sent()).Status||6===t.Status||5===t.Status)Object(u.h)(e);else if(0===t.Status)return[2,{wacUrl:t.WacUrl,bootScriptUrl:t.BootScriptUrl,wopiSrcUrl:t.WopiSrcUrl,accessToken:t.AccessToken,deprecatedTokenAndParameters:t.Token}];return[2,null]}}))}))}},7399:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(115),i=(n(254),new r.c((function(){return n.e(358).then(n.bind(null,10099))}))),o=new r.a(i,(function(e){return e.loadItemAttachment})),a=new r.b(i,(function(e){return e.loadItemAttachmentFromServer}))},8308:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(4),o=n(4064),a=n(1844),c=n(5492),u=n(9146),s=n(7326),l=n(6012),d=n(6462),f=n(9147);Object(i.orchestrator)(o.b,(function(e){var t=e.element,n=e.href,i=e.itemId,p=e.isSafeLinkWrapped,b=e.isSafeLinkVerified,h=e.isOfficeSPLink,v=e.sxsId;Object(o.j)(n);var m=function(e){!function(e,t,n,i,o,c,u,p){var b=this,h=null;if(!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)){var v=Object(l.b)(n),m=v.docLinkPreviewInfo,g=v.reason;if((null==m?void 0:m.needRedeem)||"Expired"===g)return Object(a.a)((function(){return Object(r.__awaiter)(b,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(s.a)(n,!0,!0)];case 1:return e=a.sent(),t=(null==m?void 0:m.needRedeem)?"redeem":"retryAfterCacheExpire",Object(d.a)(null,i,o,t,c),[2,Object(r.__assign)(Object(r.__assign)({},e.wacUrlInfo),{extraInfo:t})]}}))}))}),t,u,p),void e.preventDefault();if(m)return Object(a.a)((function(){return Promise.resolve(m.wacUrlInfo)}),t,u,p),e.preventDefault(),void Object(d.a)(null,i,o,null,c);h=g}Object(f.a)(e,i,o,h)}(e,i,n,p,b,h,t.ownerDocument.defaultView,v)};t.addEventListener("click",m),t[c.a]=m;var g=function(e){Object(u.a)(e,p,b)};t.addEventListener("mouseup",g),t[c.b]=g}));n(9323);var p=n(2770),b=n(7399);Object(i.orchestrator)(p.h,(function(e){var t=e.itemAttachmentId,n=e.perfDatapoint;b.a.importAndExecute(t,n)}));var h=n(3993);Object(i.orchestrator)(h.a,(function(e){var t=e.context;p.d.importAndExecute(t)}));var v=n(3386),m=n(1156);Object(i.orchestrator)(v.l,(function(e){var t=e.wacUrlGetter,n=e.linkId,r=e.readOnly,i=e.targetWindow,o=e.sxsId;p.g.importAndExecute(t,null,p.a.ComposeDocLink,{method:p.b.CopyMailReadingPaneContainer},null,n,r,i,o)})),Object(i.orchestrator)(m.L,(function(e){var t=e.selectedLinkId,n=e.isSelectedLinkReadOnly;Object(v.k)(t,n)}));var g=n(2298);Object(i.orchestrator)(g.f,(function(e){var t=e.wacUrlGetter,n=e.itemId,r=e.targetWindow,i=e.sxsId;p.g.importAndExecute(t,n,p.a.ReadingPaneDocLink,{method:p.b.CopyMailReadingPaneContainer},null,null,null,r,i)}))},9146:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6462),i=1,o=2;function a(e,t,n){e.button===i?Object(r.a)("MouseMiddleButton",t,n):e.button===o&&Object(r.a)("MouseRightButton",t,n)}},9147:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(254),i=n(435),o=n(2422),a=n(6462);function c(e,t,n,c){var u,s,l=Date.now(),d=new r.a("ServiceGeneratedLinkClickHandler"),f="CT="+l+"&OR=OWA-"+(e?e.ctrlKey||1===e.button?"NTB":e.shiftKey?"NW":"NT":"NT")+"&CID="+Object(i.a)(),p=e.currentTarget,b=(s=new URL(p.href),["CID","OR","CT"].forEach((function(e){var t;(null===(t=s.searchParams)||void 0===t?void 0:t.get(e))&&s.searchParams.delete(e)})),s);if(t){var h=b.href,v=h.indexOf(o.c);if(-1===v)return;var m=encodeURIComponent(btoa(f));u=h.substr(0,v)+"&xdata="+m+o.c}else{var g=b.href.indexOf("?")>=0?"&":"?";u=b.href+g+f}d.end(),window.open(u),e.preventDefault(),Object(a.a)(c||(e.altKey?"AltKey":e.ctrlKey?"CtrlKey":e.metaKey?"MetaKey":e.shiftKey?"ShiftKey":"Default"),t,n)}},9323:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2770),i=n(115),o=new i.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(571)]).then(n.bind(null,11042))})),a=new i.a(o,(function(e){return e.insertSxSV2IntoDomIfNeeded}));r.c.register(a.importAndExecute);var c=Object(i.d)(o,(function(e){return e.ProjectionSxSV2}))},979:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){var t=r(e);return t?t.replace(".",""):null}function o(e){var t;return(null===(t=i(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}))},980:function(e,t,n){"use strict";var r=n(979),i=n(1342),o=n(10);function a(e){var t;return e>=1073741824?(e/=1073741824,t=Object(o.b)(i.b)):e>=1048576?(e/=1048576,t=Object(o.b)(i.d)):e>=1024?(e/=1024,t=Object(o.b)(i.c)):t=Object(o.b)(i.a),Object(o.c)(t,Math.round(e))}var c,u=n(1093),s=n(76),l=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function d(e){if(!Object(s.h)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&l.indexOf(t.toLowerCase())>=0}function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return c.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return c.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return c.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(c||(c={}));var p=n(1011);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return p.b})),n.d(t,"a",(function(){return c}))},994:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))}}]);
//# sourceMappingURL=owa.AttachmentPreviewSxSInitialize.js.map
self.scriptsLoaded['owa.AttachmentPreviewSxSInitialize.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();