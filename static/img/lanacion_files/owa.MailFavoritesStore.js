self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFavoritesStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[388],{1081:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0})},1088:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return d}));var r=n(1460),i=n(26),o=n(1081);function a(){return u(r.a.Bottom)}function c(){return u(r.a.Off)}function s(){return u(r.a.Right)}function u(e){var t=Object(o.a)();return null!==t.clientReadingPanePosition?t.clientReadingPanePosition===e:Object(i.a)().UserOptions.GlobalReadingPanePositionReact==e}function d(){var e=Object(i.a)().UserOptions.GlobalReadingPanePositionReact;return e==r.a.Off||e==r.a.Bottom}},1102:function(e,t,n){"use strict";var r=n(115),i=n(961);function o(){return a(Object(i.C)())}function a(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function c(){var e=Object(i.C)();return e&&2==e.tableQuery.type}function s(e){return!!e&&(2==e.type||u(e))}function u(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function d(e){return 2==e.type?e.folderId:u(e)?e.searchScope.groupId:null}function l(){var e=Object(i.C)();return e&&s(e.tableQuery)}n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return m})),n.d(t,"m",(function(){return p})),n.d(t,"l",(function(){return v})),n.d(t,"j",(function(){return O})),n.d(t,"i",(function(){return j})),n.d(t,"k",(function(){return g})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return l}));var f=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(455)]).then(n.bind(null,15767))})),b=new r.b(f,(function(e){return e.getGroupDisplayName})),m=new r.b(f,(function(e){return e.getGroupDisplayNameFromTableView})),p=new r.b(f,(function(e){return e.isPrivateUnjoinedGroup})),v=new r.b(f,(function(e){return e.isJoinedGroup})),O=new r.b(f,(function(e){return e.getRetentionPolicyTagsForGroup})),j=new r.b(f,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),g=new r.b(f,(function(e){return e.isGroupOwner}))},1121:function(e,t,n){"use strict";var r=n(1513),i=n(961);function o(){return Object(r.a)(Object(i.C)())}var a=n(1397),c=n(2325);function s(e){var t=Object(a.a)(e);return Object(c.a)(t)}n.d(t,"c",(function(){return r.a})),n.d(t,"d",(function(){return r.c})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}))},1140:function(e,t,n){"use strict";var r=n(4),i=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}}),o=i();function a(){return o.selectedNode}function c(){var e=a();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o}))},1152:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25),i=n(1340);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("GetPersona",e,t)}},1158:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,i=t%n;return(((e-=r)/n&(t-=i)/n)>>>0)*n+((r&i)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},1199:function(e,t,n){"use strict";n.d(t,"r",(function(){return d})),n.d(t,"u",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"o",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"m",(function(){return O})),n.d(t,"f",(function(){return j})),n.d(t,"q",(function(){return g})),n.d(t,"t",(function(){return h})),n.d(t,"s",(function(){return w})),n.d(t,"g",(function(){return I})),n.d(t,"j",(function(){return S})),n.d(t,"k",(function(){return y})),n.d(t,"n",(function(){return M})),n.d(t,"d",(function(){return F})),n.d(t,"c",(function(){return _})),n.d(t,"h",(function(){return R})),n.d(t,"l",(function(){return C})),n.d(t,"a",(function(){return L}));var r=n(0),i=n(118),o=n(961),a=n(977),c=n(4),s=n(1187),u=n(26),d=Object(c.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(E(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(c.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(E(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(c.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,i){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:i}})),b=Object(c.action)("SET_SELECTION_ON_ROW",(function(e,t,n){return{rowKey:e,tableViewId:t,shouldSelect:n}})),m=Object(c.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),p=Object(c.action)("SET_LIST_VIEW_EXPANSION_LOADING_STATE",(function(e){return{shouldBeExpanded:e}})),v=Object(c.action)("ITEM_PART_SELECTED",(function(e,t,n,r,i){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:i}})),O=Object(c.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),j=Object(c.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),g=Object(c.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r}})),h=Object(c.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),w=Object(c.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),I=Object(c.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),S=Object(c.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),y=Object(c.action)("RESET_SELECTION",(function(e){return{tableView:e}})),M=Object(c.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(i.c)(E(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),F=Object(c.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),_=Object(c.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),R=Object(c.action)("RESET_BUS_STOP_STATE_MAP"),C=Object(c.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}})),L=Object(c.action)("INIT_TABLE_SELECTION_ON_LOAD",(function(e){return{tableView:e}}));function E(e,t,n,i){return{name:function(e,t,n,i){return!(function(e){return e===a.b.MailListItemRichPreview||e===a.b.KeyboardShiftEnter||e===a.b.MailListItemBodyDoubleClick}(e)||Object(s.r)()&&!function(e){var t;return e===a.b.KeyboardEnter||e===a.b.MailListItemBody||e===a.b.RouteHandler||e===a.b.CommandBarArrows||e===a.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(u.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,i){if(Object(s.r)())return!1;if(e===a.b.KeyboardUpDown){var c=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==c&&1===t.selectedRowKeys.size){var u=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return i===o.d.Next?u===c+1||u===t.rowKeys.length-1&&c===t.rowKeys.length-1:u===c-1||0===u&&0===c}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,i))}(e,t,n,i)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},12112:function(e){e.exports=JSON.parse('{"a":"g_b"}')},1283:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(315);function i(e){return{headers:Object(r.f)(e,"GroupMailbox")}}},1305:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return i})),n.d(t,"z",(function(){return o})),n.d(t,"x",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"r",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"m",(function(){return v})),n.d(t,"d",(function(){return O})),n.d(t,"k",(function(){return j})),n.d(t,"w",(function(){return g})),n.d(t,"p",(function(){return h})),n.d(t,"y",(function(){return w})),n.d(t,"q",(function(){return I})),n.d(t,"u",(function(){return S})),n.d(t,"v",(function(){return y})),n.d(t,"n",(function(){return M})),n.d(t,"s",(function(){return F})),n.d(t,"t",(function(){return _})),n.d(t,"o",(function(){return R}));var r="multipart/signed",i="application/pkcs7-mime",o="application/x-pkcs7-mime",a=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",s="CLASSID",u="4",d="0800",l=57,f=78,b=16,m=11,p="IPM.Note.SMIME.MultipartSigned",v="smime-",O="image",j="OwaToSmime",g="SmimeToOwa",h="en-US",w=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],I="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/owasmime.msi",S="OwaSmimeEdgeExtension.appxbundle",y="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/OwaSmimeEdgeExtension.appxbundle",M="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/SmimeOutlookWebChrome.msi",F="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/SmimeOutlookWebChrome.msi",_="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",R="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},1337:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",(function(){return u})),n.d(r,"remove",(function(){return d})),n.d(r,"removeAll",(function(){return l})),n.d(r,"getCount",(function(){return f})),n.d(r,"getTombstonedReasons",(function(){return b})),n.d(r,"clearMapForFolder",(function(){return m})),n.d(r,"removeRowsFromTombstone",(function(){return p}));var i=n(0),o=n(4),a=Object(o.createStore)("tombstone",{folderTombstoneMap:{}}),c=(a(),n(254)),s=n(284),u=Object(s.action)("tombstoneOperations.add")((function(e,t,n){if(1!=t.tableQuery.type&&"spotlight"!==t.tableQuery.scenarioType){var r=t.serverFolderId,i=a().folderTombstoneMap;r in i||(i[r]={});var o=i[r];e.forEach((function(e){var t=o[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):o[e]=[3]:o[e]=[n]}))}})),d=Object(s.action)("tombstoneOperations.remove")((function(e,t,n){var r=a().folderTombstoneMap;if(t in r){var i=r[t],o=i[e],c=o?o.indexOf(n):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");o.splice(c,1),0==o.length&&delete i[e],0==Object.keys(i).length&&delete r[t]}})),l=Object(s.action)("tombstoneOperations.removeAll")((function(){a().folderTombstoneMap={},Object(c.p)("TnS_RemoveAllFromTombstone")})),f=function(e,t){var n=a().folderTombstoneMap;if(!(e in n))return 0;var r=0,i=n[e];return Object.values(i).forEach((function(e){e==t&&r++})),r},b=function(e,t){var n=a().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},m=Object(s.action)("tombstoneOperations.clearMapForFolder")((function(e){var t=a().folderTombstoneMap;t[e]&&(Object(c.p)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),p=Object(s.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){var n,r,o=a().folderTombstoneMap;if(t in o){var c=o[t];try{for(var s=Object(i.__values)(e),u=s.next();!u.done;u=s.next()){var d=u.value;d in c&&delete c[d]}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}0==Object.keys(c).length&&delete o[t]}}));t.a=r},1340:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetPersonaJsonRequest:#Exchange"},e)}},1341:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1283),i=n(106),o={};function a(e){var t=e.toLocaleLowerCase();if(!o[t]){var n={type:i.a.GroupMailbox,userIdentity:Object(i.e)().userIdentity,mailboxSmtpAddress:e,routingKey:Object(i.c)()+e,requestOptions:Object(r.a)(e)};o[t]=n}return o[t]}},1347:function(e,t,n){"use strict";var r=n(645),i=n(569),o=n(0);var a=n(646),c=n(245),s=n(75);function u(e,t,n,u,d,l,f){var b,m=Object(c.a)();if(u&&(m.RequestServerVersion=u),l){var p=(b={UserRoles:["MailboxSearch"]},Object(o.__assign)({__type:"ManagementRoleType:#Exchange"},b));m.ManagementRole=p}var v=e.map((function(e){return Object(i.a)({Id:e})}));return Object(a.a)({Header:m,Body:Object(r.a)({ItemShape:t,ItemIds:v,ShapeName:n,InternetMessageId:f})},d).then((function(e){var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items})).catch((function(e){return s.g.warn("GetItem:"+e.message),null}))}n.d(t,"a",(function(){return u}))},1378:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1390:function(e,t,n){"use strict";var r=new(n(610).a)(50);t.a=r},1393:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1930);function i(e){return e&&Object(r.b)(e.ItemClass)}},1397:function(e,t,n){"use strict";var r=n(4),i=n(106),o=n(962),a=n(23),c=Object(r.createStore)("mailboxInfoStore",new a.ObservableMap);function s(e,t){if(!e)return Object(i.e)();if(!c().has(e)){var n=Object(o.v)(e,t);u(e,n)}return c().get(e)}n.d(t,"a",(function(){return s}));var u=Object(r.mutatorAction)("addMailboxInfoToStore",(function(e,t){c().set(e,t)}))},1428:function(e,t,n){"use strict";var r=n(1584),i=n(76),o=n(999),a=n(602);function c(){return Object(i.h)("auth-cloudCache")&&(Object(o.b)()||Object(o.c)())&&Object(a.a)()||Object(r.a)()}n.d(t,"a",(function(){return c}))},1460:function(e,t,n){"use strict";var r;!function(e){e[e.Off=0]="Off",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom"}(r||(r={})),t.a=r},1466:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r="Success";function i(e){return e&&e.ResponseClass==r}},1468:function(e,t,n){"use strict";var r=n(23),i=n(4),o={folderTable:new r.ObservableMap,rootFolder:null},a=Object(i.createStore)("publicFolderFavoriteStore",o)();t.a=a},1494:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=1,i=16},1513:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(1397),i=n(106),o=n(962),a=n(1341),c=n(1102),s=n(2241);function u(e){return e?d(e.tableQuery):Object(i.e)()}function d(e,t){var n=Object(c.b)(e),r=null==e?void 0:e.folderId;return null!=n?Object(a.a)(n):l(r,t)}function l(e,t){return Object(o.H)(e)?Object(s.a)(e):Object(r.a)(e,t)}},1544:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Constant:#Exchange"},e)}},1545:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"RestrictionType:#Exchange"},e)}},1548:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(962),i=n(1140);function o(){var e=Object(i.c)(),t=null;return null==(t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id)?null:r.d.folderTable.get(t)}},1549:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("setShowListPane",(function(e){return{showListPane:e}}))},1550:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},1556:function(e,t,n){"use strict";var r=n(115),i=n(1956),o=n(2010),a=n(1957),c=n(1820),s=n(1958),u=n(1900),d=n(2011);function l(e){var t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function f(e){return!!e.RecurrenceId}n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return p})),n.d(t,"w",(function(){return v})),n.d(t,"d",(function(){return O})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"f",(function(){return w})),n.d(t,"e",(function(){return I})),n.d(t,"i",(function(){return S})),n.d(t,"j",(function(){return y})),n.d(t,"a",(function(){return M})),n.d(t,"c",(function(){return F})),n.d(t,"v",(function(){return _})),n.d(t,"u",(function(){return R})),n.d(t,"k",(function(){return i.a})),n.d(t,"x",(function(){return o.a})),n.d(t,"m",(function(){return a.a})),n.d(t,"q",(function(){return c.a})),n.d(t,"r",(function(){return s.a})),n.d(t,"l",(function(){return u.a})),n.d(t,"o",(function(){return d.a})),n.d(t,"p",(function(){return l})),n.d(t,"n",(function(){return f}));var b=new r.c((function(){return Promise.all([n.e(5),n.e(7),n.e(10),n.e(723),n.e(418)]).then(n.bind(null,15537))})),m=new r.a(b,(function(e){return e.addItemToCalendar})),p=new r.a(b,(function(e){return e.initializeMeetingRequestViewStateAction})),v=new r.a(b,(function(e){return e.removeCancelledMeetingFromCalendar})),O=Object(r.d)(b,(function(e){return e.MeetingMessageInfo})),j=(Object(r.d)(b,(function(e){return e.MeetingRequestActions})),Object(r.d)(b,(function(e){return e.MeetingCancellationAction})),Object(r.d)(b,(function(e){return e.MeetingActionButton})),Object(r.d)(b,(function(e){return e.MeetingDetailsTime})),Object(r.d)(b,(function(e){return e.MeetingDetailsLocation})),Object(r.d)(b,(function(e){return e.MeetingRequestInfo}))),g=Object(r.d)(b,(function(e){return e.MeetingRequestResponseEditor})),h=Object(r.d)(b,(function(e){return e.MeetingDetails})),w=Object(r.d)(b,(function(e){return e.MeetingRequestConflicts})),I=(Object(r.d)(b,(function(e){return e.EditEventLink})),Object(r.d)(b,(function(e){return e.MeetingMessageSummary}))),S=Object(r.d)(b,(function(e){return e.PreviewSummary})),y=Object(r.d)(b,(function(e){return e.SenderSummary})),M=Object(r.d)(b,(function(e){return e.CollapsedMeetingMessage})),F=Object(r.d)(b,(function(e){return e.MeetingIcon})),_=new r.a(b,(function(e){return e.logMeetingMessageActionForInvite})),R=new r.a(b,(function(e){return e.logMeetingMessageActionForEvent}))},15572:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(4),o=n(118),a=n(76),c=n(989),s=1e4,u={folderId:"",timeRemoved:null};function d(e){return!(!u.folderId||u.folderId!=e)&&(new Date).getTime()-u.timeRemoved.getTime()<s}var l=Object(i.action)("ADD_FAVORITE_FOLDER",(function(e,t){return Object(o.c)({name:Object(a.h)("tri-favorites-roaming")?"AddOutlookFavoriteFolder":"AddFavoriteFolder",customData:{actionSource:t,distinguishedFolderName:Object(c.a)(e),wasFolderUnfavoritedRecently:d(e)}},{folderIdToAdd:e,actionSource:t})})),f=n(4185),b=n(438),m=n(8020),p=n(8021);function v(e,t){var n=function(e,t){var n=Object(b.a)({Id:e.FolderId.Id,ChangeKey:e.FolderId.ChangeKey});return Object(m.a)({Folder:Object(f.a)({FolderId:n,DisplayName:e.DisplayName}),Operation:t?0:1})}(e,t);return Object(p.a)({request:n}).then((function(e){return e}))}var O=n(962),j=n(284),g=n(1003),h=n(1468),w=Object(j.action)("addFavoriteFolderV1")(Object(j.select)({favoritesFolderNodes:function(){return g.favoritesStore.favoritesFolderNodes},orderedFavoritesNodeIds:function(){return g.favoritesStore.orderedFavoritesNodeIds},folder:function(e,t){return 0==t?O.d.folderTable.get(e):h.a.folderTable.get(e)}})((function(e,t,n){if(void 0===t&&(t=0),n.favoritesFolderNodes.has(e))throw new Error("addFavoriteFolderV1: Cannot add duplicate folder to favorites.");n.orderedFavoritesNodeIds.push(e),n.favoritesFolderNodes.set(e,{id:e,type:t}),Object(g.updateFavoritesUserOption)(),v(n.folder,!0)}))),I=(Object(i.orchestrator)(l,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=e.folderIdToAdd,Object(a.h)("tri-favorites-roaming")?[4,g.lazyAddFavoriteFolderV2.import()]:[3,2];case 1:return n.sent()(t),[3,3];case 2:w(t),n.label=3;case 3:return[2]}}))}))})),Object(i.action)("REMOVE_FAVORITE_FOLDER",(function(e,t){return Object(o.c)({name:Object(a.h)("tri-favorites-roaming")?"RemoveFavoriteFolderV2":"RemoveFavoriteFolderV1",customData:{actionSource:t,distinguishedFolderName:Object(c.a)(e)}},{folderIdToRemove:e,actionSource:t})}))),S=Object(j.action)("removeFavoriteFolderV1")(Object(j.select)({favoritesFolderNodes:function(){return g.favoritesStore.favoritesFolderNodes},orderedFavoritesNodeIds:function(){return g.favoritesStore.orderedFavoritesNodeIds}})((function(e,t){if(!t.favoritesFolderNodes.has(e))throw new Error("removeFavoriteFolderV1: Cannot find the folder id in favorite folder list.");var n=0==g.favoritesStore.favoritesFolderNodes.get(e).type?O.d.folderTable.get(e):h.a.folderTable.get(e);t.orderedFavoritesNodeIds.splice(t.orderedFavoritesNodeIds.indexOf(e),1),t.favoritesFolderNodes.delete(e),Object(g.updateFavoritesUserOption)(),u={folderId:e,timeRemoved:new Date},v(n,!1)}))),y=(Object(i.orchestrator)(I,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=e.folderIdToRemove,Object(a.h)("tri-favorites-roaming")?[4,g.lazyRemoveFavoriteFolderV2.import()]:[3,2];case 1:return n.sent()(t),[3,3];case 2:S(t),n.label=3;case 3:return[2]}}))}))})),n(6498)),M=n(6662),F=n(4129),_=n(1269);Object(i.orchestrator)(g.onCategoryFavorited,(function(e){var t=e.categoryId;y.a(t),function(e){var t=Object(F.a)(e),n=Object(_.c)(t,!0);Object(M.d)(n,!1,(function(t,n,r,i){return function(e){y.b(e)}(e)}))}(t)}));Object(i.orchestrator)(g.onCategoryUnfavorited,(function(e){y.b(e.categoryId)}));var R=n(12112),C=n(8525),L=n(7862),E=n(8526),N=n(7863),V=n(10),T=n(2737);function A(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){return t=e?T.c.RemoveFavoritePersonaFailedNotification:T.c.AddFavoritePersonaFailedNotification,Object(T.g)(t,null),n={actionType:t,title:e?Object(V.b)(L.a):Object(V.b)(N.a),description:e?Object(V.b)(C.a):Object(V.b)(E.a),actionLink:Object(V.b)(R.a)},Object(T.f)(n),[2]}))}))}var P=n(75);function D(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){return t=e?Object(V.b)(L.a):Object(V.b)(N.a),P.g.warn(t),[2]}))}))}Object(i.orchestrator)(g.addFavoriteFailed,(function(e){var t=e.favoriteKind;"persona"===t?A(!1):"privatedistributionlist"===t&&D(!1)}));var x=n(3344),k=n(5254),U=(Object(i.orchestrator)(x.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.personas,n=t.map((function(e){return e.searchFolderId})).filter((function(e){return!!e})),[4,Object(k.d)(n)];case 1:return i=r.sent(),Object(O.U)(i,t),[2]}}))}))})),Object(i.orchestrator)(g.removeFavoriteFailed,(function(e){var t=e.favoriteKind,n=e.error;n&&404===n.statusCode||("persona"===t?A(!0):"privatedistributionlist"===t&&D(!0))})),Object(j.action)("markFavoritePersonaNodeAsAdded")(Object(j.select)({favoritesPersonaNodes:function(){return g.favoritesStore.favoritesPersonaNodes}})((function(e,t){var n=t.favoritesPersonaNodes.get(e);n&&(n.isJustAdded=!1)})))),B=n(8022),G=n(8348),K=n(435),q=n(254),z=n(1988),H=Object(o.d)("validateAndUpdateFavorite",z.a.ValidateAndUpdateFavorite)((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,a,c,s,u,d,l,f,b,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(g.getStore)(),n=t.favoritesPersonaNodes.get(e),i=Object(K.b)(e)?e:"",n.personaId?(o=Object(G.a)(n.mainEmailAddress,n.displayName,!1),[4,Object(B.a)(n.personaId)]):[3,5];case 1:return(m=r.sent())?(c=m,[3,4]):[3,2];case 2:return[4,o];case 3:c=r.sent(),r.label=4;case 4:return(a=c)?(s=a.DisplayName,u=W(a.EmailAddress),d=(a.EmailAddresses||[]).map(W),l=n.displayName!==s,f=n.mainEmailAddress!==u,p=n.allEmailAddresses,v=d,b=!(p&&v&&p.length===v.length&&p.every((function(e){return v.includes(e)}))),l||f||b?(Object(q.o)("ValidateAndUpdateFavorite: Change Detected",["ContactToUpdatedContact",i,l,f,b]),Q(n,s,u,d,a.PersonaId.Id),[2,!0]):[2,!1]):(Object(q.o)("ValidateAndUpdateFavorite: Change Detected",["ContactToRecipentCache",i]),Q(n,n.displayName,n.mainEmailAddress,n.allEmailAddresses),[2,!0]);case 5:return[4,Object(G.a)(n.mainEmailAddress,n.displayName,!1)];case 6:return(m=r.sent())?(Object(q.o)("ValidateAndUpdateFavorite: Change Detected",["RecipientCacheToContact",i]),Q(n,m.DisplayName,W(m.EmailAddress),m.EmailAddresses.map(W),m.PersonaId.Id),[2,!0]):[2,!1];case 7:return[2]}var p,v}))}))})),Q=Object(j.action)("updatePersona")((function(e,t,n,r,i){e.displayName=t||n,e.mainEmailAddress=n,e.allEmailAddresses=r,i?e.personaId=i:delete e.personaId}));function W(e){return e?e.RoutingType&&"EX"===e.RoutingType.toUpperCase()?e.OriginalDisplayName:e.EmailAddress||e.OriginalDisplayName:""}var X=n(7352),J=n(1140),Y=Object(j.action)("updateSelectedNodeWithNewPersona")((function(e){var t=Object(g.getStore)().favoritesPersonaNodes.get(e),n=Object(J.d)();n.selectedNode=Object(r.__assign)(Object(r.__assign)({},n.selectedNode),{displayName:t.displayName,mainEmailAddress:t.mainEmailAddress})})),$=n(8024),Z=Object(o.d)("onFavoritePersonaSelected",z.a.OnFavoritePersonaSelectedAction)(Object(j.select)({favoritesPersonaNodes:function(){return g.favoritesStore.favoritesPersonaNodes}})((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if((n=t.favoritesPersonaNodes.get(e)).isSyncUpdateDone)return[2];r.label=1;case 1:return r.trys.push([1,6,,7]),[4,H(n.id)];case 2:return(i=r.sent())&&Y(n.id),[4,Object(X.a)(n,"OnClick",i)];case 3:return(o=r.sent())&&setTimeout((function(){Object($.b)(n.id)}),$.a),i||o?[4,Object(g.updateFavoritesUserOption)()]:[3,5];case 4:r.sent(),r.label=5;case 5:return[3,7];case 6:return a=r.sent(),c="UpdatePersonaAndSearchFolderFailure",P.g.warn(c+": "+a),Object(q.o)(c,[a.toString()]),[3,7];case 7:return[2]}}))}))}))),ee=Object(o.d)("onFavoritePersonaUpdated",z.a.OnFavoritePersonaUpdatedAction)((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(g.getStore)().favoritesPersonaNodes.get(e),[4,H(t.id)];case 1:return n=r.sent(),[4,Object(X.a)(t,"OnFavoriteUpdate",n)];case 2:return i=r.sent(),n||i?[4,Object(g.updateFavoritesUserOption)()]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}));function te(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e.markedForDeletion?[4,Object(k.c)([e.searchFolderId],!0)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:return t=r.sent(),n=z.a.DeleteFolderFailure,i=n.name,o=n.customData,P.g.warn(i+": "+t),Object(q.o)(i,o(t.toString())),[3,4];case 4:return[2]}}))}))}var ne=n(2698),re=Object(o.d)("removeFavoritePersona",z.a.RemoveFavoritePersonaAction)((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,a,c,s,u,d,l,f,b,m;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:t=Object(g.getStore)(),n=t.favoritesPersonaNodes.get(e),i=void 0,o=!1,p.label=1;case 1:if(p.trys.push([1,9,,10]),!n)throw new Error("RemoveFavoritePersona - NodeId could not be found in the store");if(i=n.mainEmailAddress||n.personaId||n.id,Object(ne.a)(i))throw new Error("RemoveFavoritePersona - Favoriting is already in progress");return y.a(i),o=!0,(a=t.orderedFavoritesNodeIds.indexOf(e))>-1&&t.orderedFavoritesNodeIds.splice(a,1),t.favoritesPersonaNodes.delete(e),[4,Object(g.updateFavoritesUserOption)()];case 2:p.sent(),c=n.searchFolderId,p.label=3;case 3:return p.trys.push([3,7,,8]),c?(s=Object(J.c)()).id!==e?[3,4]:(s.markedForDeletion=!0,[3,6]):[3,6];case 4:return[4,Object(k.c)([c],!0)];case 5:p.sent(),p.label=6;case 6:return[3,8];case 7:return u=p.sent(),d=z.a.DeleteFolderFailure,b=d.name,l=d.customData,P.g.warn(b+": "+u),Object(q.o)(b,l(u.toString())),[3,8];case 8:return y.b(i),[3,10];case 9:throw f=p.sent(),o&&y.b(i),b="RemoveFavoritePersonaFailure",P.g.warn(b+": "+f),m=t.favoritesPersonaNodes.size,Object(q.o)(b,[f.toString(),e,m.toString()]),n&&!t.favoritesPersonaNodes.has(n.id)&&(t.orderedFavoritesNodeIds.push(n.id),t.favoritesPersonaNodes.set(n.id,n)),Object(r.__assign)({type:"RemoveFavoritePersonaError"},f);case 10:return[2]}}))}))}));function ie(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Object(a.h)("tri-favorites-roaming")?[4,g.lazyRemoveFavoritePersonaV2.import()]:[3,2];case 1:return n.sent()(e,t),[3,4];case 2:return[4,re(e,t)];case 3:return[2,n.sent()];case 4:return[2]}}))}))}var oe=Object(o.d)("RemoveFavoriteSearch",z.a.RemoveFavoriteSearch)((function(e,t){var n=Object(g.getStore)();if(!n.favoriteSearches.has(e))throw new Error("Cannot find the search query in favorite search list.");n.orderedFavoritesNodeIds.splice(n.orderedFavoritesNodeIds.indexOf(e),1),n.favoriteSearches.delete(e),Object(g.updateFavoritesUserOption)()})),ae=n(317),ce=n(285),se=n(26),ue=n(318),de=Object(j.action)("toggleFavoritesTreeExpansion")((function(){var e=Object(se.a)().UserOptions;e.IsFavoritesFolderTreeCollapsed=!e.IsFavoritesFolderTreeCollapsed,Object(ue.a)("OWA.UserOptions",[Object(ae.a)({DictionaryKey:Object(ce.a)({Type:"String",Value:["IsFavoritesFolderTreeCollapsed"]}),DictionaryValue:Object(ce.a)({Type:"Boolean",Value:[String(e.IsFavoritesFolderTreeCollapsed)]})})])})),le=n(8341),fe=n(8023),be=n(1852),me=Object(o.d)("initializeFavoritePersonas",z.a.InitializeFavoritePersonasAction)((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(k.e)()];case 1:return t=n.sent(),Object(be.getStore)().favoritePersonasRootFolderId=t,[4,pe(t,e)];case 2:return n.sent(),[2]}}))}))}));function pe(e,t){return Object(k.g)(t,e).then((function(e){e.forEach((function(e){Object(fe.a)(e)}))})).catch((function(e){var t="RetrievePersonaSearchFoldersFailed";P.g.warn(t+": "+e),Object(q.o)(t,[e.toString()])}))}n.d(t,"addFavoriteFolder",(function(){return l})),n.d(t,"removeFavoriteFolder",(function(){return I})),n.d(t,"addFavoriteFolderV1",(function(){return w})),n.d(t,"removeFavoriteFolderV1",(function(){return S})),n.d(t,"markFavoritePersonaNodeAsAdded",(function(){return U})),n.d(t,"onFavoritePersonaSelected",(function(){return Z})),n.d(t,"onFavoritePersonaUpdated",(function(){return ee})),n.d(t,"onSelectedPersonaNodeChanged",(function(){return te})),n.d(t,"removeFavoritePersona",(function(){return ie})),n.d(t,"handleToggleFavoritePersonaError",(function(){return A})),n.d(t,"removeFavoriteSearch",(function(){return oe})),n.d(t,"toggleFavoritesTreeExpansion",(function(){return de})),n.d(t,"addFavoritePersona",(function(){return le.a})),n.d(t,"initializeFavoritePersonas",(function(){return me})),n.d(t,"outlookFavoritePersonasLoaded",(function(){return x.a}))},1563:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FieldURIOrConstantType:#Exchange"},e)}},1584:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(76),i=n(94);function o(){return Object(r.h)("mail-oneView")&&Object(i.t)()}},1611:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="IPM.Note.SMIME"},1652:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1311),i=n(968);function o(e){return e&&(Object(r.a)(e,i.f)||Object(r.a)(e,i.a))}},1686:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(315);function i(e){var t=new Headers;return Object(r.g)(e,t),{headers:t}}},1697:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.createStore)("headerToastNotificationViewState",{notificationViewStates:[]})()},1698:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r="Calling",i="UnreadMessage",o="Summary"},1699:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1701:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1081);function i(){return Object(r.a)().showReadingPane}},1773:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"IsLessThanOrEqualTo:#Exchange"},e)}},1778:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetConversationItemsJsonRequest:#Exchange"},e)}},1782:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("onClientReadingPanePositionChange")},1818:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,t){return{itemIdToRemove:e,removeItemSource:t}}))},1820:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",(function(){return r}))},1900:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",(function(){return r}))},1914:function(e,t,n){"use strict";var r=n(115),i=n(961),o=n(1121),a=n(977),c=n(989),s=n(1611);var u=n(1393),d=n(284);function l(e,t){if(t.folderId&&"junkemail"==Object(c.a)(t.folderId))return!1;if(Object(u.a)(e))return!1;var n=a.w.items.get(e.ItemId.Id);return!(null==n||!n.shouldShowAttachmentPreviews)||!(!e.HasAttachments&&!e.HasProcessedSharepointLink)&&(p.importAndExecute(Object(o.d)(t),e.ConversationId,e.ItemId.Id),!0)}var f=Object(d.select)({listViewStore:function(){return i.T}})((function(e,t,n){var r,i,a,u=1==t.type,d=e.ConversationId,l=n.listViewStore.conversationItems.get(d.Id),f=e.HasProcessedSharepointLink;if(t.folderId&&"junkemail"==Object(c.a)(t.folderId))return!1;if((null==(r=e)?void 0:r.ItemClasses)&&r.ItemClasses.length>0&&r.ItemClasses.some((function(e){return 0===e.indexOf(s.a)})))return!1;if(u){if(l)return l.shouldShowAttachmentPreviews;i=a=!!e.HasAttachments}else{if(!e.HasAttachmentPreviews&&!f)return!1;l&&!f?(i=l.globalItemIds.length!=e.GlobalItemIds.length,a=l.shouldShowAttachmentPreviews):(i=!0,a=!0)}return i&&p.importAndExecute(Object(o.d)(t),e.ConversationId,null),a}));n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return l}));var b=new r.c((function(){return n.e(131).then(n.bind(null,15749))})),m=new r.a(b,(function(e){return e.getPreviews})),p=new r.a(b,(function(e){return e.add})),v=new r.a(b,(function(e){return e.getAttachmentsForConversationWell})),O=new r.a(b,(function(e){return e.removeAttachmentPreviewsForRow}))},1919:function(e,t,n){"use strict";var r=n(284),i=n(1697);t.a=Object(r.action)("removeNotification")((function(e){var t=i.a.notificationViewStates.indexOf(e);t>=0&&i.a.notificationViewStates.splice(t,1)}))},1930:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(1305),i=n(1611);function o(e){return e&&0===e.indexOf(r.e)}function a(e){return e&&0===e.indexOf(i.a)&&!o(e)}function c(e){return e&&0===e.indexOf(i.a)}function s(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1947:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"And:#Exchange"},e)}},1948:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.AsyncSendFailed=0]="AsyncSendFailed",e[e.AddFavoritePersonaFailedNotification=1]="AddFavoritePersonaFailedNotification",e[e.RemoveFavoritePersonaFailedNotification=2]="RemoveFavoritePersonaFailedNotification",e[e.PeopleHubNotification=3]="PeopleHubNotification",e[e.SkypeNotification=4]="SkypeNotification",e[e.SkypeForBusinessNotification=5]="SkypeForBusinessNotification"}(r||(r={}))},1951:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1088),i=n(1701);function o(){return Object(r.c)()&&Object(i.a)()}},1956:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("deleteMeetingMessage",(function(e,t){return{item:e,issueDeleteItemCall:t}}))},1957:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",(function(){return r}))},1958:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}n.d(t,"a",(function(){return r}))},1960:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindPeopleJsonRequest:#Exchange"},e)}},1983:function(e,t,n){"use strict";var r=n(4),i=n(23),o=n(962),a=n(2749),c=n(1140),s=(Object(r.mutator)(a.a,(function(e){var t=o.d.folderTable.get(e.folderId);t&&(e.isDeltaChange?(t.UnreadCount+=e.unreadCount,t.TotalCount+=e.totalCount):(t.UnreadCount=e.unreadCount,t.TotalCount=e.totalCount),t.pausedTotalCount&&Object(c.b)()===e.folderId&&(t.pausedTotalCount=t.TotalCount),t.UnreadCount=Math.max(t.UnreadCount,0),t.TotalCount=Math.max(t.TotalCount,0))})),{folderNodeViewStates:new i.ObservableMap({}),contextMenuState:null,folderTextFieldViewState:null,isDraggedOver:!1,withContextMenuFolderId:null,shouldShowMoveDialog:!1,moveToDestinationFolderId:null}),u=Object(r.createStore)("folderViewState",s)();t.a=u},2009:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2821),i=n(1983),o=n(1536),a=n(1025),c=n(961);function s(e){if(!i.a.folderNodeViewStates.has(e)){var t=c.c.getDefaultSortBy();Object(r.a)(e,{isExpanded:!1,sortColumn:t.sortColumn,sortOrder:t.sortDirection,drag:Object(o.a)(),drop:Object(a.a)()})}return i.a.folderNodeViewStates.get(e)}},2010:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(function(e,t){return{status:e,sxsId:t}}))},2011:function(e,t,n){"use strict";function r(e){var t=e;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}n.d(t,"a",(function(){return r}))},2059:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1136);function i(e){if(!Object(r.e)())return null;switch(e){case 4:return["#NewslettersPlus"];case 2:return["#Promotions"];case 3:return["#Social"];default:return[]}}},2104:function(e,t,n){"use strict";var r=n(26);function i(){var e=Object(r.a)().UserOptions;return e.IsFocusedInboxFeatureSupported&&e.IsFocusedInboxEnabled}n.d(t,"a",(function(){return i}))},2119:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SortResults:#Exchange"},e)}},2160:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1081);function i(){return Object(r.a)().showListPane}},2221:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2320),i=n(961),o=n(1572),a=n(2402);function c(e){if(Object(a.a)()){var t=Object(r.c)()[e];if(t){var n=Object(o.getSupportedSortColumns)(e),c=t.SortColumn,s=t.SortOrder;if(n.includes(c))return{sortColumn:c,sortDirection:s}}}return i.c.getDefaultSortBy()}},2222:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"PersonaResponseShape:#Exchange"},e)}},2224:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindPeopleRequest:#Exchange"},e)}},2241:function(e,t,n){"use strict";var r=n(961),i=n(962);function o(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(i.H)(e.tableQuery.folderId)}function a(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(i.H)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var c=n(4),s=n(106),u=n(1686),d=n(1468),l=n(23),f=Object(c.createStore)("publicFolderUtilsStore",new l.ObservableMap),b=n(94);function m(e){if(!f().has(e)){var t=d.a.folderTable.get(e),n=null!=t.ReplicaList?t.ReplicaList[0]:Object(b.i)().SessionSettings.DefaultPublicFolderMailbox,r={type:s.a.PublicMailbox,userIdentity:Object(s.e)().userIdentity,mailboxSmtpAddress:n,routingKey:Object(s.c)()+n,requestOptions:Object(u.a)(n)};p(e,r)}return f().get(e)}var p=Object(c.mutatorAction)("addPublicFolderMailboxInfoToStore",(function(e,t){f().set(e,t)}));n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return m}))},2249:function(e,t,n){"use strict";var r=n(0),i=n(284),o=n(1697),a=0;t.a=Object(i.action)("addNotification")((function(e){var t=Object(r.__assign)({id:a++},e);o.a.notificationViewStates.push(t)}))},2250:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(1948),i=n(1919),o={};function a(e,t){var n=r.a[e];o[n]||(o[n]=t)}function c(e){var t=o[r.a[e.actionType]];t&&t(e),Object(i.a)(e)}},2252:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ConversationRequestType:#Exchange"},e)}},2253:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetConversationItemsRequest:#Exchange"},e)}},2254:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25),i=n(1778);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("GetConversationItems",e,t)}},2255:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1442),i=n(961),o=n(298),a=n(978),c=n(2119),s=n(964);function u(e){var t,n,u=e.sortBy;switch(u.sortColumn){case 1:Object(r.l)(e)?t="ReceivedOrRenewTime":Object(s.a)("drafts")==e.folderId&&(t="ItemLastModifiedTime");break;case 3:n=!0,t=Object(o.a)({PropertyTag:"0x0042",PropertyType:"String"});break;case 7:t="Size";break;case 5:t="Importance";break;case 8:t="Subject";break;default:throw new Error("getMailItemSortByProperty: sort column not supported"+u.sortColumn)}var d=[];if(t){var l=t;n||(l=Object(a.a)({FieldURI:t})),d.push(Object(c.a)({Order:u.sortDirection,Path:l}))}var f=1==e.sortBy.sortColumn?e.sortBy.sortDirection:i.c.DESCENDING_SORT_DIR;return d.push(Object(c.a)({Order:f,Path:Object(a.a)({FieldURI:"DateTimeReceived"})})),d}},2302:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1442),i=n(961),o=n(978),a=n(2119);function c(e){var t,n=e.sortBy;switch(e.sortBy.sortColumn){case 1:Object(r.l)(e)&&(t="ConversationLastDeliveryOrRenewTime");break;case 3:t="ConversationUniqueSenders";break;case 7:t="ConversationSize";break;case 8:t="ConversationTopic";break;case 5:t="ConversationImportance";break;default:throw new Error("getConversationSortByProperty: sort column is not supported "+n.sortColumn)}var c=[];t&&c.push(Object(a.a)({Order:n.sortDirection,Path:Object(o.a)({FieldURI:t})}));var s=1==e.sortBy.sortColumn?e.sortBy.sortDirection:i.c.DESCENDING_SORT_DIR;return c.push(Object(a.a)({Order:s,Path:Object(o.a)({FieldURI:"ConversationLastDeliveryTime"})})),c}},2306:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25),i=n(1960);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindPeople",e,t)}},2320:function(e,t,n){"use strict";var r=n(0),i=n(2009),o=n(299),a=n(328),c=n(331),s=n(332),u=n(317),d=n(285),l=n(329),f=n(245),b="OWA.ViewStateConfiguration",m="root",p=1e4,v=null;function O(e){var t=e.ViewStateConfiguration.FolderViewState;if(t){for(var n=[],r=0;r<t.length;r++)n.push(t[r]);v||(v=setTimeout((function(){var e,t,r,i;v=null,e=b,t={Type:"String",Value:["FolderViewState"]},r={Type:"StringArray",Value:n},i=Object(a.a)({UserConfigurationName:Object(l.a)({Name:e,BaseFolderId:Object(o.a)({Id:m})}),Dictionary:[Object(u.a)({DictionaryKey:Object(d.a)(t),DictionaryValue:Object(d.a)(r)})]}),Object(c.a)({Header:Object(f.a)(),Body:Object(s.a)({UserConfiguration:i})}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}),p))}}var j=n(961),g=n(26),h=n(284),w=n(962),I=n(2448),S=n(989),y=n(977);function M(e){var t=Object(S.a)(e);return Object(I.a)(e)||Object(w.H)(e)?R.DateViewOnly:"drafts"==t||"junkemail"==t||"outbox"==t||"notes"==t?R.DateViewOnly:"deleteditems"==t||Object(y.m)(e)?R.DateView:R.ConversationView}function F(e){return"inbox"!=Object(S.a)(e)||Object(I.a)(e)?_.SearchRefinerScopeCurrentFolder:_.SearchRefinerScopeAll}var _,R,C=n(1187);function L(e){return JSON.parse(e,(function(e,t){return"SortOrder"!==e||1!==t&&0!==t?t:1===t?j.c.DESCENDING_SORT_DIR:j.c.ASCENDING_SORT_DIR}))}function E(){for(var e=Object(g.a)().ViewStateConfiguration.FolderViewState||[],t={},n=0;n<e.length;n++){var r=L(e[n]);t[r.FolderId.Id]=r}return t}function N(e){return JSON.stringify(e,(function(e,t){return"SortOrder"!==e||t!==j.c.DESCENDING_SORT_DIR&&t!==j.c.ASCENDING_SORT_DIR?t:t===j.c.DESCENDING_SORT_DIR?1:0}))}n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return R})),n.d(t,"c",(function(){return E})),n.d(t,"d",(function(){return V})),function(e){e[e.SearchRefinerScopeAll=0]="SearchRefinerScopeAll",e[e.SearchRefinerScopePrimaryMailbox=1]="SearchRefinerScopePrimaryMailbox",e[e.SearchRefinerScopeCurrentFolder=2]="SearchRefinerScopeCurrentFolder",e[e.SearchRefinerScopeCurrentFolderAndSubfolders=3]="SearchRefinerScopeCurrentFolderAndSubfolders"}(_||(_={})),function(e){e[e.ConversationView=1]="ConversationView",e[e.DateView=2]="DateView",e[e.DateViewOnly=3]="DateViewOnly",e[e.ItemGroupView=4]="ItemGroupView",e[e.BundledView=5]="BundledView"}(R||(R={}));var V=Object(h.action)("updateFolderViewState")((function(e){for(var t=Object(g.a)().ViewStateConfiguration.FolderViewState||[],n=!1,o=Object(i.a)(e),a=null,c=-1,s=0;s<t.length;s++){var u=L(t[s]);if(u.FolderId.Id===e){a=u,c=s;break}}var d=function(e,t,n){var i=n.sortOrder,o=n.sortColumn,a=n.isExpanded;if(t)return Object(r.__assign)(Object(r.__assign)({},t),{SortOrder:i,SortColumn:o,IsExpanded:a});var c=w.d.folderTable.get(e);return c?{FolderId:c.FolderId,View:M(c.FolderId.Id),Width:C.a,SortOrder:i,SortColumn:o,IsExpanded:a,ReadingPanePosition:Object(g.a)().UserOptions.GlobalReadingPanePositionReact,SearchScope:F(c.FolderId.Id)}:null}(e,a,o);d&&(-1!==c?(n=a!==d)&&(t[c]=N(d)):(n=!0,t.push(N(d))),n&&O(Object(g.a)()))}))},2325:function(e,t,n){"use strict";function r(e){return{mailboxType:e.type,userIdentity:e.userIdentity,mailboxSmtpAddress:e.mailboxSmtpAddress,routingKey:e.routingKey,mailboxGuid:e.mailboxGuid}}n.d(t,"a",(function(){return r}))},2402:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1445);function i(){var e=Object(r.a)();return e&&(e.MajorVersion>15||e.MinorVersion>20||e.MajorBuildNumber>=1807)}},2447:function(e,t,n){"use strict";var r=n(1269),i=n(1442),o=n(961),a=n(284);t.a=Object(a.action)("onLoadInitialRowsSucceeded")((function(e,t,n,a,c){2==e.tableQuery.type&&c&&(e.serverFolderId=c.Id),a&&(e.serverFolderId=a.Id);var s=Object(o.e)(e);Object(i.h)(t,e,n,s,e.isInitialLoadComplete,"MergeOnInitialRowsFetch"),e.currentLoadedIndex=Math.min(r.b,e.rowKeys.length)}))},2448:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(962),i=n(968);function o(e){return Object(r.D)(e,i.j)}},2580:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetFolderRequest:#Exchange"},e)}},2608:function(e,t,n){"use strict";var r=n(25),i=n(0);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"GetFolderJsonRequest:#Exchange"},n)),Object(r.a)("GetFolder",e,t)}n.d(t,"a",(function(){return o}))},2737:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"i",(function(){return f}));var r=n(115),i=n(2249);n.d(t,"f",(function(){return i.a}));var o=n(1948);n.d(t,"c",(function(){return o.a}));var a=n(2250);n.d(t,"g",(function(){return a.a}));var c=n(1698);n.d(t,"a",(function(){return c.a})),n.d(t,"b",(function(){return c.b})),n.d(t,"e",(function(){return c.c}));var s=n(1697);n.d(t,"h",(function(){return s.a}));var u=n(1919);n.d(t,"j",(function(){return u.a}));var d=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(438)]).then(n.bind(null,4666))})),l=Object(r.d)(d,(function(e){return e.NotificationToast})),f=new r.a(d,(function(e){return e.addNotification}))},2749:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("UPDATE_FOLDER_COUNTS",(function(e,t,n,r){return{unreadCount:e,totalCount:t,folderId:n,isDeltaChange:r}}))},2821:function(e,t,n){"use strict";var r=n(1983),i=n(284);t.a=Object(i.action)("setFolderViewState")((function(e,t){r.a.folderNodeViewStates.set(e,t)}))},2834:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ContextProperty:#Exchange"},e)}},2900:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},3137:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("EMPTY_FOLDER_STORE_UPDATE",(function(e,t,n,r){return{folder:e,clientLastSyncTime:t,deletedItemsFolderId:n,rowKeysToExclude:r}}))},3564:function(e,t,n){"use strict";var r=n(2302),i=n(2447),o=n(961),a=n(1121),c=n(1269),s=n(76),u=n(1808),d=n(1846),l=n(2059);function f(e,t,n){var f=e.tableQuery,b=f.viewFilter&&"All"!==f.viewFilter,m=o.c.getDefaultSortBy(),p=m.sortColumn,v=m.sortDirection,O=f.sortBy&&(f.sortBy.sortColumn!==p||f.sortBy.sortDirection!==v),j=Object(a.d)(f).requestOptions;j&&(j.datapoint={customData:{scenarioType:f.scenarioType,isPrefetch:t,isFilter:b,isSort:O,isRoamingFavoritesEnabled:Object(s.h)("tri-favorites-roaming")}});var g=Object(u.h)(e);return function(e,t,n,r){return e.then((function(e){var o=Promise.resolve(),a=e.findConversationResponseMessage,c="Success"==a.ResponseClass;if(c)Object(i.a)(t,a.Conversations,a.TotalConversationsInView,a.SearchFolderId,a.FolderId);else{var s=new Error("ResponseCode="+a.ResponseCode);s.fetchErrorType="ServerFailure",s.response=new Response(void 0,e.responseInit),o=Promise.reject(s)}return n(t,c,a.ResponseCode,r),o}),(function(e){var i,o=(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.status)||"";return n(t,!1,o,r),Promise.reject(e)}))}(Object(u.c)(Object(o.i)(f),0,c.a,f.viewFilter,Object(r.a)(f),f.focusedViewFilter,f.requestShapeName,f.shouldTryToUseSessionDataResponse,j,f.categoryName,Object(l.a)(f.inboxClassificationFilter),Object(d.a)(f.inboxClassificationFilter),Object(o.j)(e,!0),g,g),e,n,t)}var b=n(2255);var m=n(75),p=n(4);function v(e,t,n){switch(O(e),e.tableQuery.listViewType){case 0:return f(e,t,n);case 1:return function(e,t,n){var r=e.tableQuery;return Object(u.e)(Object(o.i)(r),0,c.a,r.viewFilter,Object(b.a)(r),r.focusedViewFilter,r.requestShapeName,r.shouldTryToUseSessionDataResponse,Object(a.d)(r,!0).requestOptions,r.categoryName,Object(l.a)(r.inboxClassificationFilter),Object(d.a)(r.inboxClassificationFilter),Object(o.j)(e,!0)).then((function(r){var o=Promise.resolve(),a="Success"==r.ResponseClass;if(a)Object(i.a)(e,r.RootFolder.Items,r.RootFolder.TotalItemsInView,r.SearchFolderId,null);else{var c=new Error("ResponseCode="+r.ResponseCode+", Stacktrace="+r.StackTrace);c.fetchErrorType="ServerFailure",o=Promise.reject(c)}return n(e,a,r.ResponseCode,t),o}),(function(r){var i,o=(null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.status)||"";return n(e,!1,o,t),Promise.reject(r)}))}(e,t,n);default:return m.g.warn("listViewType: "+e.tableQuery.listViewType+" is not supported."),Promise.resolve()}}n.d(t,"a",(function(){return v}));var O=Object(p.mutatorAction)("setTableViewLoading",(function(e){e.isLoading=!0,e.loadErrorStatus=0}))},3826:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("UPDATE_TABLE_CURRENT_LOADED_INDEX",(function(e,t){return{tableViewId:e,currentLoadedIndexToSet:t}}))},4129:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2072),i=n(443),o=n(961),a=n(964);function c(e){var t=Object(i.j)(e,Object(i.n)());return Object(r.a)(Object(a.a)("msgfolderroot"),Object(o.w)(null),"category",-1,"UserCategory",t)}},4299:function(e,t,n){"use strict";var r;!function(e){e[e.None=-1]="None",e[e.Categories=0]="Categories",e[e.ImportanceHigh=1]="ImportanceHigh",e[e.Attachment=2]="Attachment",e[e.MailListViewReplied=3]="MailListViewReplied",e[e.MailListViewForwarded=4]="MailListViewForwarded",e[e.MailListViewIRM=5]="MailListViewIRM",e[e.MailListViewIRMReplied=6]="MailListViewIRMReplied",e[e.MailListViewIRMForwarded=7]="MailListViewIRMForwarded",e[e.MailListViewVoiceMailItem=8]="MailListViewVoiceMailItem",e[e.MailListViewVoiceMailReplied=9]="MailListViewVoiceMailReplied",e[e.MailListViewVoiceMailForwarded=10]="MailListViewVoiceMailForwarded",e[e.MailListViewVoiceMailIRM=11]="MailListViewVoiceMailIRM",e[e.MailListViewFaxItem=12]="MailListViewFaxItem",e[e.MailListViewAppointmentItem=13]="MailListViewAppointmentItem",e[e.MailListViewAppointmentAccepted=14]="MailListViewAppointmentAccepted",e[e.MailListViewAppointmentDeclined=15]="MailListViewAppointmentDeclined",e[e.MailListViewAppointmentTentative=16]="MailListViewAppointmentTentative",e[e.MailListViewAppointmentCanceled=17]="MailListViewAppointmentCanceled",e[e.MailListViewContactItem=18]="MailListViewContactItem",e[e.MailListViewTaskItem=19]="MailListViewTaskItem",e[e.MailListViewTaskReocurItem=20]="MailListViewTaskReocurItem",e[e.MailListViewJournalItem=21]="MailListViewJournalItem",e[e.MailListViewPostItem=22]="MailListViewPostItem",e[e.MailListViewNoteItem=23]="MailListViewNoteItem",e[e.MailListViewDelivery=24]="MailListViewDelivery",e[e.MailListViewNonDelivery=25]="MailListViewNonDelivery",e[e.MailListViewApprovalRequest=26]="MailListViewApprovalRequest",e[e.MailListViewResponseApprove=27]="MailListViewResponseApprove",e[e.MailListViewResponseReject=28]="MailListViewResponseReject",e[e.MailListViewOutOfOffice=29]="MailListViewOutOfOffice",e[e.MailListViewReadReport=30]="MailListViewReadReport",e[e.MailListViewReminderMessage=31]="MailListViewReminderMessage",e[e.Smime=32]="Smime",e[e.TrustedSender=33]="TrustedSender",e[e.Charm=34]="Charm",e[e.ImportanceLow=35]="ImportanceLow",e[e.GlobalMentionedMe=36]="GlobalMentionedMe",e[e.Like=37]="Like",e[e.Snooze=38]="Snooze",e[e.ReadGlobalMentionedMe=39]="ReadGlobalMentionedMe",e[e.Link=40]="Link"}(r||(r={})),t.a=r},492:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},569:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemId:#Exchange"},e)}},610:function(e,t,n){"use strict";var r=n(0),i=n(284),o=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,t){var n,i;if(this.store)throw new Error("MruCache cannot be initialized twice.");this.store=e,this.deleteCallback=t;try{for(var o=Object(r.__values)(e.keys()),a=o.next();!a.done;a=o.next()){var c=a.value;this.mruList.push(c)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.add=function(e,t){var n=this;Object(i.action)("MruCache_add")((function(){n.store.set(e,t),n.mruList.indexOf(e)>=0?n.touch(e):(n.mruList.push(e),n.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var t=this.store.get(e);return t&&this.touch(e),t},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var t=this;Object(i.action)("MruCache_remove")((function(){if(t.store.has(e)&&!t.isReferenced(e))return t.removeItemAtIndex(t.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(i.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var t=this.mruList.indexOf(e);if(t<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(t,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var t=0;this.mruList.length>e&&t<this.mruList.length;){var n=this.mruList[t];this.isReferenced(n)?t++:this.removeItemAtIndex(t)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)},e.prototype.isReferenced=function(e){for(var t=0;t<this.references.length;t++){var n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1},e}();n.d(t,"a",(function(){return o}))},645:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetItemRequest:#Exchange"},e)}},646:function(e,t,n){"use strict";var r=n(25),i=n(0);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return o}))},6498:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(4),i=n(1535),o=Object(r.mutatorAction)("addToPendingFavoritesMap",(function(e){Object(i.b)().isFavoritingInProgress.set(e,!0)})),a=Object(r.mutatorAction)("removeFromPendingFavoritesMap",(function(e){Object(i.b)().isFavoritingInProgress.delete(e)}))},6662:function(e,t,n){"use strict";var r=n(115),i=n(1199),o=n(3137),a=n(4299),c=n(6680),s=n(13),u=n(487),d=n(8469);function l(e){switch(e){case a.a.ReadGlobalMentionedMe:return u(d.accountsRead,Object(s.getIconClassName)("Accounts"));case a.a.GlobalMentionedMe:return u(d.accounts,Object(s.getIconClassName)("Accounts"));case a.a.Attachment:return Object(s.getIconClassName)("Attach");case a.a.ImportanceLow:return Object(s.getIconClassName)("Down");case a.a.ImportanceHigh:return u(d.redDark,Object(s.getIconClassName)("Important"));case a.a.Like:return Object(s.getIconClassName)("Like");case a.a.Snooze:return u(d.snooze,Object(s.getIconClassName)("Clock"));case a.a.MailListViewReplied:return Object(s.getIconClassName)("Reply");case a.a.MailListViewForwarded:return Object(s.getIconClassName)("Forward");case a.a.MailListViewIRM:case a.a.MailListViewIRMReplied:case a.a.MailListViewIRMForwarded:return Object(s.getIconClassName)("Lock");case a.a.MailListViewVoiceMailItem:return Object(s.getIconClassName)("Memo");case a.a.MailListViewVoiceMailReplied:return Object(s.getIconClassName)("VoicemailReply");case a.a.MailListViewVoiceMailForwarded:return Object(s.getIconClassName)("VoicemailForward");case a.a.MailListViewVoiceMailIRM:return Object(s.getIconClassName)("VoicemailIRM");case a.a.MailListViewFaxItem:return Object(s.getIconClassName)("Fax");case a.a.MailListViewAppointmentItem:return Object(s.getIconClassName)("Event");case a.a.MailListViewAppointmentAccepted:return Object(s.getIconClassName)("EventAccepted");case a.a.MailListViewAppointmentDeclined:return Object(s.getIconClassName)("EventDeclined");case a.a.MailListViewAppointmentTentative:return Object(s.getIconClassName)("EventTentative");case a.a.MailListViewAppointmentCanceled:return Object(s.getIconClassName)("RemoveEvent");case a.a.MailListViewContactItem:return Object(s.getIconClassName)("ContactCard");case a.a.MailListViewTaskItem:return Object(s.getIconClassName)("CheckboxComposite");case a.a.MailListViewTaskReocurItem:return Object(s.getIconClassName)("RecurringTask");case a.a.MailListViewJournalItem:return Object(s.getIconClassName)("DietPlanNotebook");case a.a.MailListViewPostItem:return Object(s.getIconClassName)("NotePinned");case a.a.MailListViewNoteItem:return Object(s.getIconClassName)("QuickNote");case a.a.MailListViewDelivery:return Object(s.getIconClassName)("ReceiptForward");case a.a.MailListViewNonDelivery:case a.a.MailListViewApprovalRequest:case a.a.MailListViewResponseApprove:case a.a.MailListViewResponseReject:return Object(s.getIconClassName)("ReceiptReply");case a.a.MailListViewOutOfOffice:return Object(s.getIconClassName)("OutOfOffice");case a.a.MailListViewReadReport:return Object(s.getIconClassName)("ReceiptCheck");case a.a.MailListViewReminderMessage:return Object(s.getIconClassName)("Ringer");case a.a.Link:return Object(s.getIconClassName)("Link");default:throw new Error("No CSS class icon for the given property icon")}}var f=n(3564),b=(n(2447),n(3826)),m=n(961),p=n(4);Object(p.mutator)(b.a,(function(e){Object(m.F)().tableViews.get(e.tableViewId).currentLoadedIndex=e.currentLoadedIndexToSet}));n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return c.a})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return f.a}));var v=new r.c((function(){return n.e(871).then(n.bind(null,15852))}));Object(r.f)(i.f,v,(function(e){return e.mailListItemExpansionOrchestrators})),Object(r.f)(o.a,v,(function(e){return e.emptyFolderStoreUpdateOrchestrator}))},6680:function(e,t,n){"use strict";var r=n(4299);var i,o=((i={})["MailReplied".toString()]=r.a.MailListViewReplied,i["MailForwarded".toString()]=r.a.MailListViewForwarded,i["MailIrm".toString()]=r.a.MailListViewIRM,i["MailIrmReplied".toString()]=r.a.MailListViewIRMReplied,i["MailIrmForwarded".toString()]=r.a.MailListViewIRMForwarded,i);function a(){var e={};return e["MailReplied".toString()]=r.a.MailListViewVoiceMailReplied,e["MailForwarded".toString()]=r.a.MailListViewVoiceMailForwarded,e["Default".toString()]=r.a.MailListViewVoiceMailItem,e}function c(){var e={};return e["MailReplied".toString()]=r.a.MailListViewVoiceMailIRM,e["Default".toString()]=r.a.MailListViewVoiceMailIRM,e}var s=function(){var e={};e["ipm.note"]=o,e["ipm.note.irm"]=function(){var e={};return e["MailReplied".toString()]=r.a.MailListViewIRMReplied,e["MailForwarded".toString()]=r.a.MailListViewIRMForwarded,e["Default".toString()]=r.a.MailListViewIRM,e["MailIrmReplied".toString()]=r.a.MailListViewIRMReplied,e["MailIrmForwarded".toString()]=r.a.MailListViewIRMForwarded,e}(),e["ipm.note.microsoft.exchange.voice.um.ca"]=a(),e["ipm.note.microsoft.exchange.voice.um"]=a(),e["ipm.note.microsoft.voicemail.um.ca"]=a(),e["ipm.note.microsoft.voicemail.um"]=a(),e["ipm.note.rpmsg.microsoft.voicemail.um.ca"]=c(),e["ipm.note.rpmsg.microsoft.voicemail.um"]=c();var t={};return t["Default".toString()]=r.a.MailListViewFaxItem,e["ipm.note.microsoft.exchange.fax.ca"]=t,e["ipm.note.microsoft.exchange.fax.um.ca"]=t,e["ipm.note.microsoft.fax.ca"]=t,(t={})["Default".toString()]=r.a.MailListViewAppointmentItem,e["ipm.appointment"]=t,e["ipm.schedule.meeting.request"]=t,(t={})["AppointmentMeetCancel".toString()]=r.a.MailListViewAppointmentCanceled,t["Default".toString()]=r.a.MailListViewAppointmentCanceled,e["ipm.schedule.meeting.canceled"]=t,(t={})["Default".toString()]=r.a.MailListViewContactItem,e["ipm.contact"]=t,e["ipm.distlist"]=t,(t={})["TaskRecur".toString()]=r.a.MailListViewTaskReocurItem,t["TaskItem".toString()]=r.a.MailListViewTaskItem,t["TaskOwned".toString()]=r.a.MailListViewTaskItem,t["TaskDelegated".toString()]=r.a.MailListViewTaskItem,t["Default".toString()]=r.a.MailListViewTaskItem,e["ipm.task"]=t,(t={})["Default".toString()]=r.a.MailListViewJournalItem,e["ipm.activity"]=t,(t={})["Default".toString()]=r.a.MailListViewPostItem,e["ipm.post"]=t,(t={})["Default".toString()]=r.a.MailListViewNoteItem,e["ipm.stickynote"]=t,(t={})["Default".toString()]=r.a.MailListViewNonDelivery,e["report.ipm.note.ndr"]=t,e["report.ipm.ndr"]=t,e["report.ipm.note.mobile.sms.ndr"]=t,e["report.ipm.schedule.meeting.resp.neg.ndr"]=t,e["report.ipm.schedule.meeting.resp.pos.ndr"]=t,e["report.ipm.schedule.meeting.resp.tent.ndr"]=t,e["report.ipm.taskrequest.ndr"]=t,e["report.ipm.oof.ndr"]=t,e["report.report.ipm.note.ipnnrn.ndr"]=t,e["report.ipm.note.smime.ndr"]=t,e["report.ipm.note.smime.multipartsigned.ndr"]=t,(t={})["Default".toString()]=r.a.MailListViewDelivery,e["report.ipm.note.dr"]=t,e["report.ipm.dr"]=t,e["report.ipm.schedule.meeting.request.dr"]=t,e["report.ipm.note.smime.dr"]=t,e["report.ipm.note.smime.multipartsigned.dr"]=t,(t={})["Default".toString()]=r.a.MailListViewApprovalRequest,e["ipm.note.microsoft.approval.request"]=t,(t={})["Default".toString()]=r.a.MailListViewResponseApprove,e["ipm.note.microsoft.approval.reply.approve"]=t,(t={})["Default".toString()]=r.a.MailListViewResponseReject,e["ipm.note.microsoft.approval.reply.reject"]=t,(t={})["Default".toString()]=r.a.MailListViewOutOfOffice,e["ipm.note.rules.ooftemplate.microsoft"]=t,(t={})["Default".toString()]=r.a.MailListViewReadReport,e["report.ipm.note.ipnrn"]=t,(t={})["Default".toString()]=r.a.MailListViewReminderMessage,e["ipm.note.reminder.event"]=t,e}();var u=function(){var e={},t={};return t["AppointmentMeetYes".toString()]=r.a.MailListViewAppointmentAccepted,t["Default".toString()]=r.a.MailListViewAppointmentAccepted,e["ipm.schedule.meeting.resp.pos"]=t,(t={})["AppointmentMeetMaybe".toString()]=r.a.MailListViewAppointmentTentative,t["Default".toString()]=r.a.MailListViewAppointmentTentative,e["ipm.schedule.meeting.resp.tent"]=t,(t={})["AppointmentMeetNo".toString()]=r.a.MailListViewAppointmentDeclined,t["Default".toString()]=r.a.MailListViewAppointmentDeclined,e["ipm.schedule.meeting.resp.neg"]=t,e}();function d(e,t,n){var i=e[t];return(null==i?void 0:i[n])?i[n.toString()]:r.a.None}function l(e,t){var n=d(u,e,t);return n==r.a.None&&Object.keys(u).forEach((function(n){if(0==e.indexOf(n)&&n[t.toString()])return n[t.toString()]})),n}function f(e,t,n){if(n)switch(t){case"MailReplied":t="MailIrmReplied";break;case"MailForwarded":t="MailIrmForwarded";break;default:t="MailIrm"}var i=!1;if(e){var a=e.length;if(1==a)return function(e,t){if(t||(t="Default"),!e)return r.a.None;e=e.toLowerCase();var n=d(s,e,t);return n==r.a.None&&(n=d(s,e,"Default")),n===r.a.None&&(n=l(e,t)),n===r.a.None&&(n=l(e,"Default")),n}(e[0],t);for(var c=0;c<a;c++)if(-1==e[c].toLowerCase().indexOf("ipm.schedule.meeting")){i=!0;break}}return i?o[t?t.toString():null]:r.a.MailListViewAppointmentItem}n.d(t,"a",(function(){return f}))},7352:function(e,t,n){"use strict";var r=n(0),i=n(8023),o=n(1852),a=n(284),c=n(5254);t.a=Object(a.action)("synchronizeSearchFolder")((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,s,u,d,l,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=Object(o.getStore)(),(u=a.favoritePersonasRootFolderId)?[3,2]:[4,Object(c.e)()];case 1:u=r.sent(),r.label=2;case 2:return s=u,d={favoriteNodeId:e.id,displayName:e.displayName,allEmailAddresses:e.allEmailAddresses},[4,Object(c.h)(d,s,t,n)];case 3:return l=r.sent(),f=e.searchFolderId!==l.FolderId.Id,Object(i.a)(l),e.isSyncUpdateDone=!0,[2,f]}}))}))}))},7862:function(e){e.exports=JSON.parse('{"a":"e_b"}')},7863:function(e){e.exports=JSON.parse('{"a":"c_b"}')},8020:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"UpdateFavoriteFolderRequest:#Exchange"},e)}},8021:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25),i=n(8020);function o(e,t){return void 0===e.request||e.request.__type||(e.request=Object(i.a)(e.request)),Object(r.a)("UpdateFavoriteFolder",e,t)}},8022:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),i=n(1340),o=n(1152),a=n(245),c=n(1029),s=n(299);function u(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return[2,Object(o.a)(Object(i.a)({Header:Object(a.a)(),Body:{PersonaId:{Id:e},ParentFolderId:Object(c.a)({BaseFolderId:Object(s.a)({Id:"mycontacts"})})}})).then((function(e){if("Success"===e.Body.ResponseClass||"ErrorItemNotFound"===e.Body.ResponseCode)return e.Body.Persona;throw new Error("GetPersona failed ("+e.Body.ResponseCode+" "+e.Body.MessageText+")")}))]}))}))}},8023:function(e,t,n){"use strict";var r=n(0),i=n(1003),o=n(5254),a=n(962),c=n(284);t.a=Object(c.action)("setupFavoritePersona")((function(e){var t=Object(o.f)(e),n=Object(i.getStore)().favoritesPersonaNodes.get(t);if(n){var c=n.displayName,s=Object(r.__assign)(Object(r.__assign)({},e),{DisplayName:c});a.d.folderTable.set(e.FolderId.Id,s);var u=s.FolderId.Id;n.searchFolderId!==u&&(n.searchFolderId=u)}}))},8024:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(1003),i=n(284),o=3e4,a=Object(i.action)("markSearchFolderAsPopulated")((function(e){var t=Object(r.getStore)().favoritesPersonaNodes.get(e);t&&(t.isSearchFolderPopulated=!0)}))},8341:function(e,t,n){"use strict";var r=n(0),i=n(76),o=n(8022),a=n(8348),c=n(7352),s=n(1988),u=n(6498),d=n(254),l=n(1025),f=n(435),b=n(75),m=n(118),p=n(8024),v=n(1003),O=n(2698);function j(e,t,n,i){return e?function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){if(!e)throw new Error("No persona id was provided.");return[2,g(e,null,t,n,"personaId",(function(){return Object(o.a)(e)}))]}))}))}(e,n,i):function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){if(!e)throw new Error("No email address was provided.");return[2,g(null,e,t,n,"email",(function(){return Object(a.a)(e,t,!1)}))]}))}))}(t,n,i)}var g=Object(m.d)("AddFavoritePersona",s.a.AddFavoritePersonaAction)((function(e,t,n,i,o,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,s,m,j,g,w,I;return Object(r.__generator)(this,(function(S){switch(S.label){case 0:i=Object(v.getStore)(),o=t||e,s=!1,m=Object(f.a)(),S.label=1;case 1:if(S.trys.push([1,6,,7]),Object(O.a)(o))throw new Error("AddFavoritePersona - Favoriting is already in progress");if(u.a(o),s=!0,Object(v.isPersonaInFavorites)(e,t))throw new Error("AddFavoritePersona - Cannot add duplicate personas to favorites. Store already has persona before Persona resolution");return j=function(e,t,n){var r={id:e,type:1,displayName:t,mainEmailAddress:n,allEmailAddresses:n?[n]:[],searchFolderId:void 0,isSearchFolderPopulated:!1,isJustAdded:!0,isSyncUpdateDone:!0,dropViewState:Object(l.a)()},i=Object(v.getStore)();return i.favoritesPersonaNodes.set(e,r),i.orderedFavoritesNodeIds.push(e),r}(m,n,t),[4,h(n,t,a)];case 2:if((g=S.sent()).personaId&&Object(r.__spread)(i.favoritesPersonaNodes.values()).some((function(e){return e.personaId===g.personaId})))throw new Error("AddFavoritePersona - Cannot add duplicate personas to favorites. Store already has persona after Persona resolution.");return(w=function(e,t,n){(n.displayName||"")!==(t.displayName||"")&&Object(d.o)("AddFavoritePersona - DisplayName Mismatch");var i=Object(r.__assign)(Object(r.__assign)({},n),{displayName:t.displayName,mainEmailAddress:t.emailAddress,allEmailAddresses:t.emailAddresses,isJustAdded:!1});t.personaId&&(Object(d.o)("AddFavoritePersona - Contact found, storing personaId"),i.personaId=t.personaId);return Object(v.getStore)().favoritesPersonaNodes.set(e,i),i}(m,g,j)).mainEmailAddress?[4,Object(c.a)(w,"OnAdd").catch((function(e){throw new Error("AddFavoritePersona - synchronizeSearchFolder failed with error: "+(e||{}).toString())}))]:[3,4];case 3:S.sent(),S.label=4;case 4:return[4,Object(v.updateFavoritesUserOption)()];case 5:return S.sent(),setTimeout((function(){Object(p.b)(m)}),p.a),u.b(o),[2,w];case 6:throw I=S.sent(),function(e,t){var n=t.orderedFavoritesNodeIds.indexOf(e);n>-1&&t.orderedFavoritesNodeIds.splice(n,1);t.favoritesPersonaNodes.has(e)&&t.favoritesPersonaNodes.delete(e)}(m,i),s&&u.b(o),"AddFavoritePersonaFailure",b.g.warn("AddFavoritePersonaFailure: "+I),Object(d.o)("AddFavoritePersonaFailure",[I.toString()]),Object(r.__assign)({type:"AddFavoritePersonaError"},I);case 7:return[2]}}))}))}));function h(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,n().then((function(n){return n?{displayName:n.DisplayName||e,personaId:n.PersonaId.Id,emailAddress:n.EmailAddress&&w(n.EmailAddress),emailAddresses:n.EmailAddresses&&n.EmailAddresses.map(w)||[]}:{displayName:e,personaId:void 0,emailAddress:t,emailAddresses:[t]}})).catch((function(e){throw new Error("AddFavoritePersona - resolvePersona failed with error: "+(e||{}).toString())}))];case 1:return[2,r.sent()]}}))}))}function w(e){return e.RoutingType&&"EX"===e.RoutingType.toUpperCase()?e.OriginalDisplayName:e.EmailAddress||e.OriginalDisplayName}function I(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(i.h)("tri-favorites-roaming")?[4,v.lazyAddFavoritePersonaV2.import()]:[3,2];case 1:return r.sent()(t,n||t,o),[3,4];case 2:return[4,j(e,t,n,o)];case 3:return[2,r.sent()];case 4:return[2]}}))}))}n.d(t,"a",(function(){return I}))},8348:function(e,t,n){"use strict";var r=n(0),i=n(299),o=n(1960),a=n(2224),c=n(1045),s=n(2222),u=n(1029),d=n(2306),l=n(245),f=n(2834),b={BasePoint:"Beginning",Offset:0,MaxEntriesReturned:10},m={BaseShape:"Default"};function p(){return[Object(f.a)({Key:"AppName",Value:"OWA"})]}function v(e){return Object(a.a)({IndexedPageItemView:Object(c.a)(b),PersonaShape:Object(s.a)(m),QuerySources:["Mailbox","Directory"],QueryString:e,SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!0,Context:p()})}function O(e){return Object(a.a)({IndexedPageItemView:Object(c.a)(b),PersonaShape:Object(s.a)(m),QuerySources:["Mailbox"],QueryString:e,ParentFolderId:Object(u.a)({BaseFolderId:Object(i.a)({Id:"mycontacts"})}),Context:p()})}function j(e,t){if("Success"==e.ResponseClass)return{personas:e.ResultSet,requestId:e.TransactionId};throw new Error("FindPeople failed ("+e.ResponseCode+" "+e.MessageText+" "+t+")")}function g(e){return Object(d.a)(Object(o.a)({Header:Object(l.a)(),Body:O(e)})).then((function(e){return j(e.Body,!0)}))}var h=n(75),w=n(254),I=n(1988);function S(e,t,n){return n?function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,a,c,s,u;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return b=e,n=Object(d.a)(Object(o.a)({Header:Object(l.a)(),Body:v(b)})).then((function(e){return j(e.Body,!1)})),[4,g(e)];case 1:return(i=f.sent()).personas&&i.personas.length>0?(c=i,[3,4]):[3,2];case 2:return[4,n];case 3:c=f.sent(),f.label=4;case 4:if((a=c).personas&&a.personas.length>0)return(s=a.personas.filter((function(e){return e.DisplayName&&t&&e.DisplayName.toLocaleLowerCase()===t.toLocaleLowerCase()}))).length>0?[2,s[0]]:(u=a.personas[0]).DisplayName===e&&"OneOff"===u.EmailAddress.MailboxType?(Object(w.o)(I.a.OneOffAddressUsedForFavorite),[2,Object(r.__assign)(Object(r.__assign)({},u),{DisplayName:t})]):[2,u];throw h.g.warn("Cannot find persona by email: "+e),new Error("Persona not found (people: "+a.requestId+", contacts: "+i.requestId+", length: "+(e?e.length:"no email address")+")")}var b}))}))}(e,t):function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,g(e)];case 1:return(n=r.sent()).personas&&n.personas.length>0?(i=n.personas.filter((function(e){return e.DisplayName&&t&&e.DisplayName.toLocaleLowerCase()===t.toLocaleLowerCase()}))).length>0?[2,i[0]]:[2,n.personas[0]]:[2,null]}}))}))}(e,t)}n.d(t,"a",(function(){return S}))},8469:function(e,t,n){var r=n(8470),i=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},8470:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'._378AqQXt7Vn66ek8Mf4Fo5:before{color:"[theme:redDark, default:#a80000]"!important}._32S8K94lku5ujN8zmSd9ED:before{color:"[theme:green20, default:#0b6a0b]"!important}html[dir] ._32S8K94lku5ujN8zmSd9ED:before{margin-bottom:2px}._3Y1jo0XOp_HAd3rW6--a2L:before{color:"[theme:themePrimary, default:#0078D4]"!important}._3K512Ld4FHiESFMYdEMLkE:before{color:"[theme:themePrimary, default:#0078D4]"}',""]),t.locals={redDark:"_378AqQXt7Vn66ek8Mf4Fo5",snooze:"_32S8K94lku5ujN8zmSd9ED",accounts:"_3Y1jo0XOp_HAd3rW6--a2L",accountsRead:"_3K512Ld4FHiESFMYdEMLkE"}},8525:function(e){e.exports=JSON.parse('{"a":"f_b"}')},8526:function(e){e.exports=JSON.parse('{"a":"d_b"}')},977:function(e,t,n){"use strict";var r=n(115),i=n(982),o=n(1699),a=n(1378),c=n(1347),s="ChronologicalNewestOnBottom";function u(e,t){return e[t==s?0:e.length-1]}var d=n(106),l=n(2252),f=n(438),b=n(1778),m=n(2253),p=n(569),v=n(2254),O=n(245),j=n(964),g=["journal","outbox","syncissues"];function h(e){return"ChronologicalNewestOnBottom"==e?"DateOrderAscending":"DateOrderDescending"}function w(e){var t=[];return e||g.forEach((function(e){var n=Object(j.a)(e);n&&t.push(Object(f.a)({Id:n}))})),t}function I(e,t,n,r,i,o,a,c){void 0===a&&(a="Default");var s=Object(l.a)({ConversationId:Object(p.a)(e)});s.SyncState=o?"":n;var u=function(e,t,n,r,i,o){return Object(m.a)({Conversations:[e],ItemShape:t,ShapeName:"ItemPart",SortOrder:h(n),MaxItemsToReturn:r,Action:i,FoldersToIgnore:w(o),ReturnSubmittedItems:!0})}(s,t,i,r,a,function(e){var t=e.mailboxInfo;return t&&t.type==d.a.GroupMailbox}(e)),f=Object(O.a)();return f.RequestServerVersion="V2017_08_18",Object(v.a)(Object(b.a)({Header:f,Body:u}),c).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var S=n(492),y=n(978),M=n(1466);function F(e){return Object(c.a)([e],Object(S.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(y.a)({FieldURI:"TailoredXpEntities"}),Object(y.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(y.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(y.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then((function(e){return function(e){if(Object(M.a)(e[0])){var t=e[0].Items[0];return{TailoredXpEntities:t.TailoredXpEntities,TailoredXpCalendarEventIds:t.TailoredXpCalendarEventIds,TailoredXpEntitiesStatus:t.TailoredXpEntitiesStatus,EntityNamesMap:t.EntityNamesMap}}return{}}(e)}))}function _(e){return i.a.items.get(e)}var R=n(26);function C(e){var t=i.a.conversations.get(e);if(t){var n=Object(R.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==n}return!1}var L=n(1390),E=n(962),N=n(284),V=Object(N.select)({folderTable:function(){return E.d.folderTable}})((function(e,t){var n=t.folderTable.get(e);return!!n&&Object(E.Z)(n)})),T=n(968);function A(e,t){var n=E.d.folderTable.get(e);return!!n&&(Object(E.I)(n,T.d,t)||n.DistinguishedFolderId===T.b)}function P(e){return A(e)||function(e){var t=E.d.folderTable.get(e);return t&&t.distinguishedFolderId===T.d}(e)}var D=Object(N.select)({folderTable:function(){return E.d.folderTable}})((function(e,t,n){return Object(E.I)(e,t,n)})),x=n(1652),k=n(1311);function U(e){return e&&(Object(k.a)(e,T.g)||Object(k.a)(e,T.b))}function B(e){return e&&(D(e,T.f)||D(e,T.a))}var G=n(1548);function K(e,t){try{return q(e,t)}catch(e){return null}}function q(e,t){if(!e||!t)return null;var n=Object(E.n)().get(e).PermissionSet.Permissions.filter((function(e){return e.UserId.PrimarySmtpAddress===t}));return null==n?void 0:n[0]}var z=n(296),H="OneOff",Q="Unknown";function W(e,t,n){return!Object(z.a)()&&(n==H||n==Q)&&(null==e?void 0:e.indexOf(t))<0}var X=n(4),J=Object(X.mutatorAction)("setIsDraftQueuedForSubmission",(function(e,t){var n=Object(i.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)})),Y=n(76),$=n(298);function Z(e){Object(Y.h)("rp-omeRevocation")&&e.AdditionalProperties.push(Object($.a)({PropertyName:"x-ms-exchange-organization-ome-messagestate",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}))}n.d(t,"u",(function(){return te})),n.d(t,"w",(function(){return i.a})),n.d(t,"i",(function(){return i.b})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"g",(function(){return c.a})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return I})),n.d(t,"v",(function(){return F})),n.d(t,"x",(function(){return _})),n.d(t,"s",(function(){return C})),n.d(t,"d",(function(){return L.a})),n.d(t,"t",(function(){return V})),n.d(t,"o",(function(){return A})),n.d(t,"n",(function(){return P})),n.d(t,"p",(function(){return D})),n.d(t,"l",(function(){return x.a})),n.d(t,"m",(function(){return U})),n.d(t,"r",(function(){return B})),n.d(t,"h",(function(){return G.a})),n.d(t,"j",(function(){return K})),n.d(t,"k",(function(){return q})),n.d(t,"q",(function(){return W})),n.d(t,"y",(function(){return J})),n.d(t,"c",(function(){return Z}));var ee=new r.c((function(){return n.e(664).then(n.bind(null,15890))})),te=new r.a(ee,(function(e){return e.setTriageActionAnnouncement}))},982:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(23),i=n(4),o={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}},a=Object(i.createStore)("mail",o),c=a();t.a=c},999:function(e,t,n){"use strict";n.d(t,"l",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return v})),n.d(t,"f",(function(){return O})),n.d(t,"j",(function(){return j})),n.d(t,"k",(function(){return g})),n.d(t,"g",(function(){return h}));var r,i,o=n(3),a=n(60),c=n(26),s=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],u=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],d={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function l(){return Object(c.a)().SessionSettings.IsPremiumConsumerMailbox}function f(){return Object(c.a)().IsConsumerChild}function b(){return Object(c.a)().SessionSettings.IsShadowMailbox}function m(){return void 0!==i?i:i=function(){if(Object(o.d)("ormarket"))return Object(o.a)("ormarket");var e=Object(c.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return s.indexOf(n)>-1?n:d[n.split("-")[1]]||n}()}function p(e){return null!=e?e.toUpperCase().split("-"):[]}function v(e){return p(e)[1]||"US"}function O(){return Object(a.a)("ANON")}function j(){return Object(a.a)("MUID")}function g(){return!!Object(a.a)("TOptOut")}function h(){return r||(r=Object(o.a)("anjs")||"https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}}}]);
//# sourceMappingURL=owa.MailFavoritesStore.js.map
self.scriptsLoaded['owa.MailFavoritesStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFavoritesStore.js'] = (new Date()).getTime();