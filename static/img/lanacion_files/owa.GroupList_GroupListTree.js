self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.GroupList~GroupListTree.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[76],{1021:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(4),o=n(23),u=Object(r.createStore)("groupsStore",{groups:new o.ObservableMap})},1040:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1021);function o(t){var e=Object(r.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},1050:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(r||(r={})),e.a=r},1062:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(4),o=n(1104),u=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:o.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1067:function(t,e,n){"use strict";n(1314),n(1258);var r=n(1315);n.o(r,"getAccessTypeString")&&n.d(e,"getAccessTypeString",(function(){return r.getAccessTypeString})),n.o(r,"getAccessTypeTooltip")&&n.d(e,"getAccessTypeTooltip",(function(){return r.getAccessTypeTooltip})),n.o(r,"getGroupResource")&&n.d(e,"getGroupResource",(function(){return r.getGroupResource})),n.o(r,"getGroupResourceUrl")&&n.d(e,"getGroupResourceUrl",(function(){return r.getGroupResourceUrl})),n.o(r,"getGroupSiteStatus")&&n.d(e,"getGroupSiteStatus",(function(){return r.getGroupSiteStatus})),n.o(r,"getMembersButtonText")&&n.d(e,"getMembersButtonText",(function(){return r.getMembersButtonText})),n.o(r,"setGroupSiteStatus")&&n.d(e,"setGroupSiteStatus",(function(){return r.setGroupSiteStatus})),n.o(r,"updateGroupSiteAndDocumentUrl")&&n.d(e,"updateGroupSiteAndDocumentUrl",(function(){return r.updateGroupSiteAndDocumentUrl}));var o=n(1316);n.o(o,"getAccessTypeString")&&n.d(e,"getAccessTypeString",(function(){return o.getAccessTypeString})),n.o(o,"getAccessTypeTooltip")&&n.d(e,"getAccessTypeTooltip",(function(){return o.getAccessTypeTooltip})),n.o(o,"getGroupResource")&&n.d(e,"getGroupResource",(function(){return o.getGroupResource})),n.o(o,"getGroupResourceUrl")&&n.d(e,"getGroupResourceUrl",(function(){return o.getGroupResourceUrl})),n.o(o,"getGroupSiteStatus")&&n.d(e,"getGroupSiteStatus",(function(){return o.getGroupSiteStatus})),n.o(o,"getMembersButtonText")&&n.d(e,"getMembersButtonText",(function(){return o.getMembersButtonText})),n.o(o,"setGroupSiteStatus")&&n.d(e,"setGroupSiteStatus",(function(){return o.setGroupSiteStatus})),n.o(o,"updateGroupSiteAndDocumentUrl")&&n.d(e,"updateGroupSiteAndDocumentUrl",(function(){return o.updateGroupSiteAndDocumentUrl}));n(1104);var u=n(1021);n.d(e,"getGroupsStore",(function(){return u.a}));var i=n(1062);n.d(e,"getUnifiedGroupsSettingsStore",(function(){return i.a}));var c=n(1040);n.d(e,"getGroupDetails",(function(){return c.a}));var a=n(1317);n.d(e,"isGroupDetailsValid",(function(){return a.a}));var s=n(1124);n.d(e,"getGroupResource",(function(){return s.a})),n.d(e,"getGroupResourceUrl",(function(){return s.b}));var p=n(1318);n.d(e,"getCurrentGroupSmtpAddress",(function(){return p.a}));var d=n(1090);n.d(e,"getGroupSiteStatusStore",(function(){return d.a}));var f=n(1319);n.d(e,"updateGroupSiteAndDocumentUrl",(function(){return f.a}));var l=n(1232);n.d(e,"setGroupSiteStatus",(function(){return l.b}));var g=n(1320);n.d(e,"getGroupSiteStatus",(function(){return g.a}));var b=n(1321);n.d(e,"getGroupMailboxExternalId",(function(){return b.a}));n(1050),n(1228),n(1202),n(1233),n(1222);var S=n(1324);n.d(e,"getAccessTypeString",(function(){return S.a})),n.d(e,"getAccessTypeTooltip",(function(){return S.b})),n.d(e,"getMembersButtonText",(function(){return S.c}))},1090:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(4),o=n(23),u=Object(r.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new o.ObservableMap})},1104:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(r||(r={}))},1124:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u}));var r=n(1040),o=function(t,e){var n="string"==typeof t?Object(r.a)(t):t;if(!n||!n.GroupResources)return null;var o=n.GroupResources.filter((function(t){return t.Name===e}));return!o||o.length<1?null:o},u=function(t,e){var n=o(t,e);return n&&0!=n.length?n[0].Url:null}},1126:function(t,e,n){"use strict";var r,o,u,i,c,a,s,p,d,f,l,g,b,S,v;var h;n(10);function m(t,e){e,h=t}function O(){return h}n.d(e,"o",(function(){return r})),n.d(e,"n",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"g",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return p})),n.d(e,"l",(function(){return d})),n.d(e,"m",(function(){return f})),n.d(e,"q",(function(){return l})),n.d(e,"r",(function(){return g})),n.d(e,"h",(function(){return b})),n.d(e,"j",(function(){return S})),n.d(e,"e",(function(){return v})),n.d(e,"p",(function(){})),n.d(e,"k",(function(){return m})),n.d(e,"i",(function(){return O}))},1202:function(t,e,n){"use strict";var r=n(4),o=n(1323),u=Object(r.mutatorAction)("setJoinButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},1222:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1050),o=n(1323);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1228:function(t,e,n){"use strict";var r=n(4),o=n(1322),u=Object(r.mutatorAction)("setFollowButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},1232:function(t,e,n){"use strict";n.d(e,"b",(function(){return u}));var r=n(4),o=n(1090),u=Object(r.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(o.a)().groupSiteStatus.has(t)&&e==Object(o.a)().groupSiteStatus.get(t)||Object(o.a)().groupSiteStatus.set(t,e)}));e.a=u},1233:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1050),o=n(1322);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1258:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(76),o=n(1062),u=n(94);function i(){return(Object(r.h)("grp-shareable-crud")||Object(o.a)().isSensitivityLabelsEnabled)&&!Object(u.u)()}},1314:function(t,e,n){"use strict";var r=n(4),o=n(23);Object(r.createStore)("personaPhotoStore",{personaPhotoUrls:new o.ObservableMap})()},1315:function(t,e){},1316:function(t,e){},1317:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1021);function o(t){var e=Object(r.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}},1318:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1284),o=function(){return Object(r.a)().smtpAddress}},1319:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(4),o=n(1040),u=n(1124),i=Object(r.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,n,r){if(2==e){var i=Object(o.a)(t);Object(u.a)(i,"Site")[0].Url=n,Object(u.a)(i,"Files")[0].Url=r}}))},1320:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1090);function o(t){return t=t.toLocaleLowerCase(),Object(r.a)().groupSiteStatus.has(t)?Object(r.a)().groupSiteStatus.get(t):0}},1321:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1040),o=function(t){var e="string"==typeof t?Object(r.a)(t):t;return e?e.ExternalDirectoryObjectId:null}},1322:function(t,e,n){"use strict";var r=n(4),o=n(23);e.a=Object(r.createStore)("followButtonStore",{groupActionState:new o.ObservableMap})()},1323:function(t,e,n){"use strict";var r=n(4),o=n(23);e.a=Object(r.createStore)("joinButtonStore",{groupActionState:new o.ObservableMap})()},1324:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return d}));var r=n(1589),o=n(1590),u=n(1636),i=n(1591),c=n(1592),a=n(10);function s(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(a.b)(i.a);if(3===e)return Object(a.b)(c.a)}return""}function p(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(a.b)(u.b);if(3===e)return Object(a.b)(u.c)}return""}function d(t){var e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(a.c)(Object(a.b)(o.a),e.toString()):Object(a.c)(Object(a.b)(r.a),e.toString()):Object(a.b)(u.a)}},1589:function(t){t.exports=JSON.parse('{"a":"bXb"}')},1590:function(t){t.exports=JSON.parse('{"a":"aXb"}')},1591:function(t){t.exports=JSON.parse('{"a":"xXb"}')},1592:function(t){t.exports=JSON.parse('{"a":"wXb"}')},1636:function(t){t.exports=JSON.parse('{"b":"yXb","c":"zXb","a":"AXb"}')},3111:function(t,e,n){"use strict";var r=n(1514),o=n(4),u=Object(o.mutatorAction)("toggleIsShowingAllGroups",(function(){Object(r.b)().shouldShowAllGroups=!Object(r.b)().shouldShowAllGroups})),i=n(0),c=n(42),a=n(3732),s=n(10),p=n(4008),d=n(570),f=n(283),Droppable=n(1196),l=n(1067),g=n(1),b=n(1076),S=n(3656),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onContextMenu=function(t,n){var r=e.props,o=r.onContextMenu,u=r.groupId;if(o){t.stopPropagation(),t.preventDefault();var i=u.toLowerCase(),c=Object(l.getGroupsStore)().groups;if(c.has(i))o(t,c.get(i))}},e.onDrop=function(t){e.props.onListNodeDrop&&e.props.onListNodeDrop(t,e.props.groupId)},e}return Object(i.__extends)(e,t),e.prototype.shouldComponentUpdate=function(t,e){return!Object(f.e)(this.props,t)},e.prototype.render=function(){var t=Object(S.a)(this.props.groupId);return g.createElement(Droppable.b,{dropViewState:t.drop,onDrop:this.onDrop,canDrop:this.props.canDropOnListNode},g.createElement(p.a,{selectGroup:this.props.selectGroup,isSelected:this.props.isSelected,renderRightCharm:this.props.renderRightCharm,renderRightCharmHover:this.props.renderRightCharmHover,chevronProps:null,customIcon:null,displayName:this.props.displayName,groupId:this.props.groupId,isDroppedOver:t.drop.isDragOver,onContextMenu:this.onContextMenu,renderCustomTreeNodeDisplay:null,customData:this.props.customData,showHoverStateOnDroppedOver:t.drop.draggableItemType==b.a.MailListRow||t.drop.draggableItemType==b.a.MultiMailListMessageRows}))},e=Object(i.__decorate)([d.observer],e)}(g.Component),h=n(3371),m=n(993),O=n(254),G=n(1872),C=n(1025),j=Object(l.getGroupsStore)(),A=Object(r.b)(),D=Object(c.a)((function(t){var e,n,o,c=g.useRef(!1),p=function(e){return g.createElement(v,{selectGroup:t.selectGroup,isSelected:t.isSelected,renderRightCharm:t.renderRightCharm,renderRightCharmHover:t.renderRightCharmHover,displayName:e.DisplayName,groupId:e.SmtpAddress,key:e.SmtpAddress,onContextMenu:t.onChildNodeContextMenuOpened,customData:t.customData,onListNodeDrop:t.onListNodeDrop,canDropOnListNode:t.canDropOnListNode})},d=function(e){e.stopPropagation(),t.toggleGroupTreeExpansion()},f=function(e){var n=t.onRootNodeContextMenuOpened;n&&(e.stopPropagation(),e.preventDefault(),n(e))},l=function(e){return!(A.shouldShowAllGroups||!t.canDropOnListNode)&&t.canDropOnListNode(e)},b=function(t){c.current=!0,setTimeout((function(){c.current&&!Object(r.b)().shouldShowAllGroups&&y()}),1e3)},S=function(){c.current=!1},D=function(t){t.stopPropagation(),y()},y=function(){var e=A.myOrgGroups.length;Object(O.o)("GroupList_ToggleShouldShowAllGroups",{isShowMore:!A.shouldShowAllGroups,joinedGroupCount:e>=21?"21+":e}),t.onShowMoreEvent&&t.onShowMoreEvent(),u()},R=A.myOrgGroups,T={role:m.a.tree},M=t.isGroupsTreeCollapsed;return g.createElement("div",Object(i.__assign)({style:t.style,className:t.className},Object(m.b)(T)),function(e){var n={isExpanded:!e,onClick:d};return g.createElement(G.a,{chevronProps:n,depth:0,displayName:Object(s.b)(a.a),isRootNode:!0,key:"Groups_root",onClick:n.onClick,onContextMenu:f,renderRightCharm:t.renderRootNodeRightCharm,renderRightCharmHover:t.renderRootNodeRightCharmHover,setSize:t.setSize,positionInSet:t.positionInSet})}(M),function(t,e){var n=[];if(e)return n;if(A.shouldShowAllGroups){var r=[];t.forEach((function(t){var e=j.groups.get(t);r.push(e)})),r.sort((function(t,e){return t.basicInformation.DisplayName.localeCompare(e.basicInformation.DisplayName)})).forEach((function(t){n.push(p(t.basicInformation))}))}else t.slice(0,h.a).forEach((function(t){var e=j.groups.get(t);n.push(p(e.basicInformation))}));return n}(R,M),A.withContextMenuGroup&&(A.withContextMenuGroup.isRootNode?null===(e=t.renderRootNodeContextMenu)||void 0===e?void 0:e.call(t,A.withContextMenuGroup):null===(n=t.renderChildNodeContextMenu)||void 0===n?void 0:n.call(t,A.withContextMenuGroup)),R.length>h.a&&function(e){if(e)return null;var n=A.shouldShowAllGroups?Object(s.b)(a.b):Object(s.b)(a.c),r=Object(C.a)();return g.createElement(Droppable.b,{dropViewState:r,onDrop:N,canDrop:l,onDragOver:b,onDragLeave:S},g.createElement(G.a,{displayName:n,isCustomActionNode:!0,isRootNode:!1,key:"groupsCollapseExpandNode",onClick:D,onContextMenu:w,onMouseEnter:t.onMouseEnterShowMoreButton}))}(M),null===(o=t.renderGroupListCustomNodes)||void 0===o?void 0:o.call(t))}));function N(){}function w(t){t.stopPropagation(),t.preventDefault()}n.d(e,"c",(function(){return r.a})),n.d(e,"b",(function(){return r.b})),n.d(e,"a",(function(){return D}))},3371:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var r=5,o=100},3656:function(t,e,n){"use strict";var r=n(1514),o=n(1536),u=n(1025),i=n(4),c=Object(i.mutatorAction)("setGroupNodeViewStateMutator",(function(t,e){Object(r.b)().groupNodeViewStates.set(t,e)}));function a(t){return Object(r.b)().groupNodeViewStates.has(t)||c(t,{drag:Object(o.a)(),drop:Object(u.a)(),isDroppingMessage:!1}),Object(r.b)().groupNodeViewStates.get(t)}n.d(e,"a",(function(){return a}))},3732:function(t){t.exports=JSON.parse('{"a":"CZb","b":"DZb","c":"EZb"}')},7345:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c}));var r=n(115),o=new r.c((function(){return n.e(324).then(n.bind(null,10806))})),u=new r.b(o,(function(t){return t.addMarkAsReadDiagnostics})),i=new r.b(o,(function(t){return t.addUnreadCountNotificationDiagnostics})),c=new r.b(o,(function(t){return t.addUnreadCountSubscriptionDiagnostics}))},7783:function(t,e,n){"use strict";var r=n(7345),o=n(7971),u=n(1075),i=n(254),c=n(1003),a=n(76),s=n(3111),p=n(3371),d=n(4),f=n(1021),l=Object(d.mutatorAction)("UPDATE_GROUP_UNREAD_COUNT",(function(t,e){var n=Object(f.a)().groups.get(t.toLowerCase());n&&(n.unreadMessageCount=e)}));n.d(e,"b",(function(){return S})),n.d(e,"a",(function(){return v})),n.d(e,"c",(function(){return m}));var g={};function b(t){var e=t.id.replace("UnreadCountNotification_","");if(r.b.import().then((function(n){return n(e,t)})),"0"==t.EventType.toString()){var n=g[e];n&&(l(e.toLowerCase(),t.UnreadCount),n.firstNotificationReceived||(n.unreadCountDataPoint.end(),n.unreadCountDataPoint=null,n.firstNotificationReceived=!0))}}function S(){Object(a.h)("grp-unreadCountTop5AndFavorites")?s.c.myOrgGroups.filter((function(t,e){return e<p.a||Object(c.isGroupInFavorites)(t)})).forEach((function(t){h(t)})):v()}function v(){s.c.myOrgGroups.forEach((function(t){h(t)}))}function h(t){(function(t){return!g[t]})(t=t.toLowerCase())&&u.b.import().then((function(e){var n=Object(o.a)({NotificationType:"UnreadCountNotification",ChannelId:e(),MailboxId:t}),c={subscriptionId:O(t),requiresExplicitSubscribe:!0,subscriptionParameters:n};u.f.importAndExecute(c,b);var a={notificationSubscription:c,firstNotificationReceived:!1,unreadCountDataPoint:new i.a("UnreadCountNotification")};g[t]=a,r.c.import().then((function(e){return e(t,c,!1)}))}))}function m(t){t=t.toLowerCase();var e=g[t];if(e){var n=e.notificationSubscription;n&&(u.g.importAndExecute(n,b),delete g[t],r.c.import().then((function(e){return e(t,n,!0)})))}}function O(t){return"UnreadCountNotification_"+t}},7971:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.__assign)({__type:"SubscriptionParameters:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.GroupList~GroupListTree.js.map
self.scriptsLoaded['owa.GroupList~GroupListTree.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.GroupList~GroupListTree.js'] = (new Date()).getTime();