self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailModuleOrchestrator.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[406],{1097:function(e,n,t){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange"}(r||(r={}));var i=r,c=t(4),o=Object(c.createStore)("OwaLayout",{browserWidthBucket:null});function u(){var e=o().browserWidthBucket;return e||void 0}var a=Object(c.mutatorAction)("setBrowserWidthBucket",(function(e){o().browserWidthBucket=e})),s=t(2);var d=Object(c.action)("onAvailableWidthBucketChanged",(function(e,n){return{availableWidthBucket:e,source:n}})),f=!1;function l(e){window.addEventListener("resize",b),f=e,v(i.Init)}function b(){v(i.WindowResize)}function v(e){var n,t,r,c=(n=e!=i.Init,t=f,r=Object(s.i)(n),t&&(r>1900?r-=305:r>990&&(r-=165)),r>=1600?1600:r>=1400?1599:r>=1366?1399:r>=1301?1365:r>=1239?1300:r>=1200?1238:r>=1080?1199:r>=1e3?1079:r>=919?999:r>=900?918:r>=866?899:r>=769?865:r>=692?768:r>=686?691:r>=580?685:r>=555?579:r>=542?554:r>=500?541:r>=419?499:418);o().browserWidthBucket!=c&&(a(c),c<=418?O():h(),d(c,e))}function O(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function h(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}var j=t(49);function g(){return w()}function w(){return Object(j.k)()||Object(j.d)()}t.d(n,"a",(function(){return i})),t.d(n,"c",(function(){return u})),t.d(n,"f",(function(){return l})),t.d(n,"b",(function(){return O})),t.d(n,"e",(function(){return h})),t.d(n,"d",(function(){return g})),t.d(n,"g",(function(){return w})),t.d(n,"h",(function(){return d}))},1142:function(e,n,t){"use strict";var r=function(){function e(){this.eventDictionary={}}return e.prototype.on=function(e,n,t){return(this.eventDictionary[e]||(this.eventDictionary[e]=[])).push({callback:n,callbackThis:t}),this},e.prototype.emit=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];var r=(this.eventDictionary[e]||[]).slice();return r.forEach((function(e){return e.callback.apply(e.callbackThis,n)})),this},e.prototype.off=function(e,n){var t=this.eventDictionary[e];if(t){var r=t.filter((function(e){return e.callback!==n}));r.length?this.eventDictionary[e]=r:delete this.eventDictionary[e]}return this},e.prototype.once=function(e,n,t){var r=this,i=function(){for(var c=[],o=0;o<arguments.length;o++)c[o]=arguments[o];return r.off(e,i),n.apply(t,c)};return(this.eventDictionary[e]||(this.eventDictionary[e]=[])).push({callback:i,callbackThis:t}),this},e}();n.a=r},1428:function(e,n,t){"use strict";var r=t(1584),i=t(76),c=t(999),o=t(602);function u(){return Object(i.h)("auth-cloudCache")&&(Object(c.b)()||Object(c.c)())&&Object(o.a)()||Object(r.a)()}t.d(n,"a",(function(){return u}))},1518:function(e,n,t){"use strict";var r=t(115),i={sequentialIndex:"0",nonSequentialIndex:"-1"};t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return a})),t.d(n,"d",(function(){return i}));var c=new r.c((function(){return t.e(391).then(t.bind(null,15899))})),o=new r.a(c,(function(e){return e.registerComponent})),u=new r.a(c,(function(e){return e.resetFocus})),a=new r.a(c,(function(e){return e.setFocusToSynchronous}))},15676:function(e,n,t){"use strict";t.r(n);var r=t(1549),i=t(1550),c=t(284),o=t(961),u=t(1088),a=Object(c.action)("onReadingPanePositionOptionSaved")((function(){Object(r.a)(!0),Object(i.a)(!Object(u.c)()),o.T.rowInfoForVLV.clear()})),s=t(1187),d=t(1101),f=Object(c.action)("onReplyOrReplyAllOrForwardMessage")((function(){var e=Object(d.d)();!Object(u.c)()||e&&e.type!=d.a.Primary||(Object(s.A)(!0),Object(s.z)(!1))})),l=t(3242),b=Object(c.action)("onSelectMessageAd")((function(){Object(s.A)(!0),Object(s.z)(!Object(u.c)())})),v=t(2216),O=t(1518),h=t(1156);function j(e){if(Object(u.c)())switch(e){case h.c.MailList:Object(v.a)();break;case h.c.ReadingPane:case h.c.ConversationAttachmentWell:}O.b.importAndExecute()}Object(h.j)().eventManager.on(h.f.CloseEvent,j);var g=t(3739),w=t(4),p=(Object(w.orchestrator)(g.a,(function(e){3==e.event&&(Object(s.z)(!0),Object(s.A)(!Object(u.c)()))})),t(0)),m=t(115),k=t(1701),y=t(1186),A=Object(m.e)(s.x,"CLONE_CLIENT_READING_PANE_POSITION_CHANGE",(function(e){return Object(p.__awaiter)(void 0,void 0,void 0,(function(){var e,n,t,r,i;return Object(p.__generator)(this,(function(c){return e=Object(y.a)(),n=Object(u.c)(),t=!n||Object(k.a)()&&1==(null===(i=null==e?void 0:e.selectedRowKeys)||void 0===i?void 0:i.size),r=!n||!t,Object(s.A)(t),Object(s.z)(r),o.T.rowInfoForVLV.clear(),[2]}))}))})),R=t(3343),I=t(2218),C=t(2472),P=t(254),z=Object(m.e)(v.a,"closeImmersiveReadingPaneClone",(function(e){if(!Object(u.c)())throw new Error("closeImmersiveReadingPane should only be called with reading pane off");var n=Object(y.a)(),t=Object(C.b)(n.tableQuery);if("messageSuggestion"!==t){var r=e.source||"Unknown";Object(P.o)("Immersive_ReadingPaneClosed",[r,"mail"===t]);var i=Object(k.a)();if(Object(s.z)(!0),Object(s.A)(!1),i&&1==n.selectedRowKeys.size){var c=Object(p.__spread)(n.selectedRowKeys.keys())[0];I.h.importAndExecute(c,n)}}else Object(R.a)("CommandBar")}));t.d(n,"onReadingPanePositionOptionSaved",(function(){return a})),t.d(n,"onReplyOrReplyAllOrForwardMessage",(function(){return f})),t.d(n,"onSelectingFolder",(function(){return l.a})),t.d(n,"onSelectMessageAd",(function(){return b})),t.d(n,"onSxSPreviewPaneClose",(function(){return j})),t.d(n,"onClientReadingPanePositionChangeOrchestrator",(function(){return A})),t.d(n,"closeImmersiveReadingPaneOrchestrator",(function(){return z}))},1584:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(76),i=t(94);function c(){return Object(r.h)("mail-oneView")&&Object(i.t)()}},1701:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1081);function i(){return Object(r.a)().showReadingPane}},1703:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Initial=0]="Initial",e[e.Adaptive=1]="Adaptive",e[e.Show=2]="Show",e[e.Hide=3]="Hide",e[e.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},1729:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Blank=0]="Blank",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Custom=3]="Custom",e[e.Image=4]="Image",e[e.Wac=5]="Wac",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.Text=8]="Text",e[e.NativePdf=9]="NativePdf",e[e.PdfJs=10]="PdfJs",e[e.IFrame=11]="IFrame"}(r||(r={}))},1951:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(1088),i=t(1701);function c(){return Object(r.c)()&&Object(i.a)()}},2160:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1081);function i(){return Object(r.a)().showListPane}},2218:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"j",(function(){return u})),t.d(n,"k",(function(){return a})),t.d(n,"d",(function(){return s})),t.d(n,"c",(function(){return d})),t.d(n,"f",(function(){return f})),t.d(n,"b",(function(){return l})),t.d(n,"i",(function(){return b})),t.d(n,"e",(function(){return v})),t.d(n,"h",(function(){return O})),t.d(n,"g",(function(){return h}));var r=t(115),i=t(2575),c=new r.c((function(){return Promise.all([t.e(20),t.e(24),t.e(414)]).then(t.bind(null,5252))})),o=new r.a(c,(function(e){return e.clearAutoMarkAsReadTimer})),u=new r.a(c,(function(e){return e.setAutoMarkAsReadTimer})),a=new r.a(c,(function(e){return e.toggleRowReadState})),s=new r.b(c,(function(e){return e.markItemsAsReadBasedOnNodeIds})),d=new r.a(c,(function(e){return e.markItemAsReadFromReadingPane})),f=new r.a(c,(function(e){return e.onKeyboardMarkAsRead})),l=new r.a(c,(function(e){return e.markAsReadInTable})),b=new r.a(c,(function(e){return e.onSingleSelectionChanged})),v=new r.b(c,(function(e){return e.markReadOnTableViewChange})),O=new r.a(c,(function(e){return e.onReadingPaneClosed})),h=new r.a(c,(function(e){return e.onNavigateAwayViaUpDown}));Object(r.f)(i.b,c,(function(e){return e.onItemPartDeselectedOrchestrator}))},2575:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return c}));var r=t(4),i=Object(r.action)("CLOSE_DEEPLINK_READING_PANE"),c=Object(r.action)("ON_ITEM_PART_DESELECTED",(function(e,n){return{itemId:e,tableView:n}}))},3739:function(e,n,t){"use strict";var r=t(4),i=Object(r.action)("OnComposeLifecycleEvent",(function(e,n){return{viewState:e,event:n}}));n.a=i},999:function(e,n,t){"use strict";t.d(n,"l",(function(){return a})),t.d(n,"d",(function(){return s})),t.d(n,"b",(function(){return f})),t.d(n,"a",(function(){return l})),t.d(n,"c",(function(){return b})),t.d(n,"e",(function(){return v})),t.d(n,"i",(function(){return O})),t.d(n,"h",(function(){return h})),t.d(n,"f",(function(){return j})),t.d(n,"j",(function(){return g})),t.d(n,"k",(function(){return w})),t.d(n,"g",(function(){return p}));var r,i,c=t(3),o=t(60),u=t(26),a=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],s=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],d={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function f(){return Object(u.a)().SessionSettings.IsPremiumConsumerMailbox}function l(){return Object(u.a)().IsConsumerChild}function b(){return Object(u.a)().SessionSettings.IsShadowMailbox}function v(){return void 0!==i?i:i=function(){if(Object(c.d)("ormarket"))return Object(c.a)("ormarket");var e=Object(u.a)(),n=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return n?n.toLowerCase():"en-us";var t=e.AdMarket.toLowerCase();return a.indexOf(t)>-1?t:d[t.split("-")[1]]||t}()}function O(e){return null!=e?e.toUpperCase().split("-"):[]}function h(e){return O(e)[1]||"US"}function j(){return Object(o.a)("ANON")}function g(){return Object(o.a)("MUID")}function w(){return!!Object(o.a)("TOptOut")}function p(){return r||(r=Object(c.a)("anjs")||"https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}}}]);
//# sourceMappingURL=owa.MailModuleOrchestrator.js.map
self.scriptsLoaded['owa.MailModuleOrchestrator.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailModuleOrchestrator.js'] = (new Date()).getTime();