self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.918.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[918],{15603:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r(961),o=r(1608),i=r(986),c=r(1168),d=r(4),l=Object(d.mutatorAction)("removeSingleItemFromConversation",(function(e,t){var r,o,c=i.a.tableViews.get(t),d=Object(n.A)([e.itemConversationId.Id],c);try{for(var l=Object(a.__values)(d),s=l.next();!s.done;s=l.next()){u(s.value,e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}}));function u(e,t,r){var a=Object(o.a)(t.itemConversationId.Id),n=Object(c.a)(e,r),i=n.itemIds.indexOf(t.itemId);i>=0&&(n.itemIds.splice(i,1),t.isRead||n.unreadCount--),(i=a.globalItemIds.indexOf(t.itemId))>=0&&(a.globalItemIds.splice(i,1),t.isRead||a.globalUnreadCount--),(i=n.draftItemIds.indexOf(t.itemId))>=0&&n.draftItemIds.splice(i,1)}var s=r(5632),f=r(1337),b=r(1685),v=r(115),O=r(4127),j=Object(v.e)(b.a,"clone_deleteItemsStoreUpdate",(function(e){var t,r,o=e.itemContexts[0],i=Object(s.a)(null==o?void 0:o.mailboxInfo,e.parentFolderId,!0);try{for(var c=Object(a.__values)(i),d=c.next();!d.done;d=c.next()){var l=d.value;Object(n.L)(l)?I(e.itemContexts,l):1==l.tableQuery.listViewType&&m(e.itemContexts,l)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}}));function m(e,t){var r=e.map((function(e){return e.itemId})),a=Object(n.A)(r,t),o=a.filter((function(e){return t.rowKeys.indexOf(e)>=0}));0!=o.length&&(Object(O.a)(o,t),y(t,a))}function I(e,t){var r,o,i,c;try{for(var d=Object(a.__values)(e),u=d.next();!u.done;u=d.next()){var s=u.value,f=Object(n.A)([s.itemConversationId.Id],t);try{for(var b=(i=void 0,Object(a.__values)(f)),v=b.next();!v.done;v=b.next()){var j=v.value,m=Object(n.G)(j,t.id);m&&(1==m.itemIds.length&&m.itemIds[0]==s.itemId?(Object(O.a)([j],t),y(t,[j])):l(s,t.id))}}catch(e){i={error:e}}finally{try{v&&!v.done&&(c=b.return)&&c.call(b)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}}function y(e,t){0!==e.tableQuery.type&&2!==e.tableQuery.type||f.a.add(t,e,3)}var w=r(1871),h=r(2342),p=r(2749);function g(e,t,r){var a=t.id,o=Object(n.A)(e,t);if(0!=o.length){var i=function(e,t){for(var r=0,a=0,n=new Map,o=0;o<e.length;o++){var i=e[o],d=Object(c.a)(i,t);n.get(d.id)||(n.set(d.id,!0),r-=d.unreadCount,a-=d.itemIds.length)}return[r,a]}(o,a);Object(p.a)(i[0],i[1],t.serverFolderId,!0),0!=t.tableQuery.type&&2!=t.tableQuery.type||f.a.add(o,t,3),Object(h.a)(o,t,r)}}var C=Object(v.e)(w.a,"deleteConversationStoreUpdateClone",(function(e){g(e.conversationIds,e.tableView,e.actionType)})),V=r(2576),A=r(3651);var R=r(4e3),x=Object(v.e)(R.a,"deleteFolderStoreUpdateClone",(function(e){e.folderIds.forEach((function(e){!function(e){Object(V.a)(e,!1).forEach((function(e){return Object(A.d)(e.id)}))}(e)}))})),S=r(3135),T=r(3999),U=r(1833),k=r(284),Q=r(9174);var E=Object(k.select)({tableViews:function(){return n.T.tableViews}})((function(e,t,r,a,o){var i=o.tableViews.get(t);0===i.tableQuery.type&&(f.a.add(e,i,1),Object(Q.a)(e,i)),Object(n.y)(e,t).forEach((function(e){o.tableViews.forEach((function(o){o.tableQuery.folderId==i.tableQuery.folderId&&Object(n.A)([e],o).forEach((function(e){(a(e,o.id,r),0===o.tableQuery.type)&&(Object(n.V)(o,2),function(e,t,r,a,n){var o,i=Object(S.a)(a,r);if(i<0)throw new Error("Row being pinned / unpinnned must exist in the list");var c=n?0:i+1;return i<(o=Object(T.a)(e,t,r,c))&&o--,-1==o?(Object(h.a)([a],r,"Pin"),!1):(U.a.updateRowPosition(o,a,r),!0)}(n.b.getLastDeliveryOrRenewTimeStamp(e,o),n.b.getLastDeliveryTimeStamp(e,o),o,e,r)||o.id!=t||f.a.add([e],i,3))}))}))}))})),_=r(3587),F=r(1207),M=Object(v.e)(_.a,"clone_markConversationsAsPinnedStoreUpdate",(function(e){var t=e.rowKeys,r=e.tableViewId,a=e.shouldMarkAsPinned;E(t,r,a,K)}));function K(e,t,r){var a=Object(c.a)(e,t);if(a)if(r){var n=Object(F.d)();n&&(a.lastDeliveryOrRenewTimeStamp=n)}else a.lastDeliveryOrRenewTimeStamp=a.lastDeliveryTimeStamp}var P=r(3588),D=r(977),L=Object(v.e)(P.a,"clone_markItemsAsPinnedStoreUpdate",(function(e){var t=e.rowKeys,r=e.tableViewId,a=e.shouldMarkAsPinned;E(t,r,a,G)}));function G(e,t,r){var a=Object(n.H)(e,t);if(a){var o=D.w.items.get(a.clientId.Id);if(r){var i=Object(F.d)();i&&(o.ReceivedOrRenewTime=i)}else o.ReceivedOrRenewTime=o.DateTimeReceived}}var N=r(982),W=r(9191);var $=Object(k.action)("MarkItemsReadInListViewStore")(Object(k.select)({items:function(){return N.a.items},conversationItems:function(){return n.T.conversationItems}})((function(e,t,r,a){var o=r?-1*t.length:t.length,i=e.tableQuery.folderId;Object(W.a)(i)&&Object(p.a)(o,0,i,!0),0==e.tableQuery.listViewType&&t.forEach((function(e){var t=a.items.get(e);if(t){var o=t.ConversationId.Id;Object(s.a)(t.MailboxInfo,t.ParentFolderId.Id,!0).forEach((function(e){return function(e,t,r,a){var o=Object(n.A)([e],t),i=t.id;o.forEach((function(t){var n=Object(c.a)(t,i),o=a.get(e);n&&(r?(n.unreadCount--,o.globalUnreadCount--):(n.unreadCount++,o.globalUnreadCount++))}))}(o,e,r,a.conversationItems)}))}}))}))),H=r(2117),q=Object(v.e)(H.a,"clone_markItemsAsReadStoreUpdateOrchestrator",(function(e){var t=e.itemIds,r=e.isReadValue,a=e.isExplicit,o=e.tableViewId,i=n.T.tableViews.get(o);if(i){$(i,t,r);var c=[],d=Object(n.W)(i,r,a);1==i.tableQuery.listViewType?c=Object(n.A)(t,i):t.forEach((function(e){var t=D.w.items.get(e);if(t){var r=t.ConversationId.Id,a=Object(n.A)([r],i);a.forEach((function(e){var t=Object(n.G)(e,o);d&&0!=t.unreadCount||a.push(e)}))}})),0!=c.length&&(d?(f.a.add(c,i,3),Object(h.a)(c,i,"MarkAsRead")):f.a.add(c,i,2))}})),z=Object(k.action)("MarkConversationReadInListViewStore")(Object(k.select)({conversationItems:function(){return n.T.conversationItems}})((function(e,t,r,a,o){var i=0,c={};e.forEach((function(e){if(!(r.virtualSelectAllExclusionList.indexOf(e)>=0)){var a=Object(n.G)(e,r.id),d=B(a,t);a.unreadCount+=d;var l=a.id;o.conversationItems.get(l).globalUnreadCount+=d,c[l]||(c[l]=!0,i+=d),function(e,t,r){Object(V.a)(r.tableQuery.folderId,!1).forEach((function(a){if(a.id!==r.id){var o=Object(n.G)(e,a.id);if(o){var i=B(o,t);o.unreadCount+=i}}}))}(e,t,r)}})),a&&Object(p.a)(i,0,r.tableQuery.folderId,!0)})));function B(e,t){var r=e.unreadCount;return t?-1*r:e.itemIds.length-r}var J=r(2116),X=Object(v.e)(J.a,"clone_markConversationAsReadStoreUpdate",(function(e){var t=e.conversationIds,r=e.tableViewId,a=e.isReadValue,o=e.isExplicit,i=n.T.tableViews.get(r);if(i){var c=Object(n.A)(t,i);z(c,a,i,!0),Object(n.W)(i,a,o)?(f.a.add(c,i,3),Object(h.a)(c,i,"MarkAsRead")):f.a.add(c,i,2)}})),Y=r(1899),Z=Object(v.e)(Y.a,"markAllAsReadOrchestratorClone",(function(e){var t=e.tableView,r=e.markAsRead;if(t)switch(t.tableQuery.listViewType){case 0:z(t.rowKeys,r,t,!1);break;case 1:var a=Object(n.y)(t.rowKeys,t.id);$(t,a,r)}})),ee=r(1391),te=Object(k.select)({tableViews:function(){return i.a.tableViews}})(Object(k.action)("removeTableFromStore")((function(e,t){var r=t.tableViews,a=r.get(e);Object(ee.a)()!=e&&(U.a.clear(a,null),r.delete(e),0==Object(V.a)(a.tableQuery.folderId,!1).length&&f.a.clearMapForFolder(a.serverFolderId))}))),re=r(3825),ae=r(3827),ne=r(3828),oe=r(254),ie=Object(v.e)(re.a,"clone_updateCategoriesInView",(function(e){var t,r,o=Object(n.C)();if(o){var i=e.modifiedCategoryName,c=e.newCategoryName,d=[];try{for(var l=Object(a.__values)(o.rowKeys),u=l.next();!u.done;u=l.next()){var s=u.value,b=n.b.getCategories(s,o);(null==b?void 0:b.includes(i))&&d.push(s)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}if(Object(oe.o)("UpdateCategoriesInViewMail",[d.length]),d.length>0){var v=c?[c]:null;Object(n.L)(o)?Object(ae.a)(d,o.id,v,[i],!1):Object(ne.a)(Object(n.y)(d,o.id),v,[i],!1),f.a.add(d,o,0)}}}));r.d(t,"deleteItemsStoreUpdateOrchestrator",(function(){return j})),r.d(t,"deleteConversationStoreUpdateOrchestrator",(function(){return C})),r.d(t,"deleteFolderStoreUpdateOrchestrator",(function(){return x})),r.d(t,"markConversationsAsPinnedStoreUpdateOrchestrator",(function(){return M})),r.d(t,"markItemsAsPinnedStoreUpdateOrchestrator",(function(){return L})),r.d(t,"markItemsAsReadStoreUpdateOrchestrator",(function(){return q})),r.d(t,"markConversationsAsReadStoreUpdateOrchestrator",(function(){return X})),r.d(t,"markAllAsReadOrchestrator",(function(){return Z})),r.d(t,"removeTableFromStore",(function(){return te})),r.d(t,"updateCategoriesInViewOrchestrator",(function(){return ie}))},5632:function(e,t,r){"use strict";var a=r(2576),n=r(1102),o=r(961),i=r(284),c=Object(i.select)({tableViews:function(){return o.T.tableViews}})((function(e,t,r){var a=r.tableViews,o=[];return a.forEach((function(r){(Object(n.b)(r.tableQuery)==e||t&&1==r.tableQuery.type)&&o.push(r)})),o})),d=r(106);function l(e,t,r){return e&&e.type==d.a.GroupMailbox?c(e.mailboxSmtpAddress,r):Object(a.a)(t,r)}r.d(t,"a",(function(){return l}))},9174:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(1199),n=r(1378);function o(e,t){var r=e[e.length-1],o=t.rowKeys.indexOf(r);o<t.rowKeys.length-1?Object(a.r)(t,t.rowKeys[o+1],!1,n.a.RowRemoval):Object(a.j)(t,n.a.Reset)}},9191:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(962),n=r(968);function o(e){return Object(a.D)(e,n.c)||Object(a.D)(e,n.j)}}}]);
//# sourceMappingURL=owa.918.js.map
self.scriptsLoaded['owa.918.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.918.js'] = (new Date()).getTime();