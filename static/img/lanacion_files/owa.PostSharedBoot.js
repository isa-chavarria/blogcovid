self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.PostSharedBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[489],{2073:function(e,n,t){"use strict";var r=t(115),a=t(0),o=t(4),c=function(e,n,t){var r=null;return{init:function(c){var i;if(null!==r)throw new Error("Diagnostics store "+e+" was initialized multiple times");return r=Object(o.createStore)(e,n),t(r()),Object(a.__assign)(Object(a.__assign)({},c),((i={})[e]=r,i))},getIfInitialized:function(){return r?r():null}}};t.d(n,"c",(function(){return s})),t.d(n,"g",(function(){return u})),t.d(n,"f",(function(){return l})),t.d(n,"h",(function(){return d})),t.d(n,"a",(function(){return f})),t.d(n,"b",(function(){return h})),t.d(n,"d",(function(){return p})),t.d(n,"e",(function(){return c}));var i=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(240)]).then(t.bind(null,15590))})),s=Object(r.d)(i,(function(e){return e.DiagnosticsPanel})),u=new r.a(i,(function(e){return e.registerDiagnostics})),l=(new r.b(i,(function(e){return e.setSelectedPivot})),new r.b(i,(function(e){return e.getDiagnosticsLogState}))),d=new r.b(i,(function(e){return e.initializeDefaultDiagnostics})),f=Object(r.d)(i,(function(e){return e.DiagnosticsHost})),h=Object(r.d)(i,(function(e){return e.DiagnosticsInspector})),p=Object(r.d)(i,(function(e){return e.TwoColumnInspector}))},3785:function(e,n,t){"use strict";t.r(n);var r=t(76),a=t(0),o=t(2);function c(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,n,t;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:e=Object(o.v)()+"scripts/ThirdPartyNotices.txt",r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(e,{credentials:"same-origin"})];case 2:return[4,r.sent().text()];case 3:return n=r.sent(),t=document.createComment("\nTHIRD-PARTY SOFTWARE NOTICES\nThis file is based on or incorporates material from the projects listed below (Third Party Code). The original copyright notice and the license under which Microsoft received such Third Party Code, are set forth below. Such licenses and notices are provided for informational purposes only. Microsoft licenses the Third Party Code to you under the licensing terms for the Microsoft product. Microsoft reserves all other rights not expressly granted under this agreement, whether by implication, estoppel or otherwise.\n\nYou may find a copy of the Corresponding Source code, if and as required under the Third Party Code License, either bundled with the Microsoft product or at http://3rdpartysource.microsoft.com. If not bundled with the product, you may also obtain a copy of the source code for a period of one year after our last shipment of this product.\n\n=============\n\n"+n),document.head.appendChild(t),[3,5];case 4:return r.sent(),[3,5];case 5:return[2]}}))}))}var i=t(115),s=new i.c((function(){return Promise.all([t.e(706),t.e(238)]).then(t.bind(null,15853))})),u=new i.a(s,(function(e){return e.setupDevTools})),l=t(58),d=t(3),f=t(573),h=["bO","bR","sessionId"];var p=t(2073),b=t(1917),v=t(254),m=t(490);var O=t(121),g=t(8433),C={concurrency:3,delay:1,pulse:1},j="ttiConcurrency",w="ttiDelay",k="ttiPulse",y="ttiMonkey",I=45e3,T=6e4,R=-1,E=null,U=null,S=null,N=0,P=!1,M=R,_=R;function D(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,t,o,c,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:n=0,a.label=1;case 1:return n<e.length?(t=e[n],o="function"==typeof t?t:t.task,c="function"==typeof t||!("condition"in t)||t.condition,i="function"!=typeof t&&t.idle,c?Object(r.h)("fwk-tti-governor")?[3,2]:(o(),[3,4]):[3,4]):[3,5];case 2:return N++,[4,x(i)];case 3:a.sent().add(o),a.label=4;case 4:return++n,[3,1];case 5:return[2]}}))}))}function W(){P=!0,Object(r.h)("fwk-tti-governor-monkey")&&(_=V(y,Math.floor(Math.random()*N)))}function x(e){return e?(U||(U=A(Promise.race([g.a.importAndExecute(),Object(O.a)(I)]))),U):(E||(E=A()),E)}function A(e){var n=function(){S||(S={concurrency:V(j,C.concurrency),pulse:V(k,C.pulse),delay:V(w,C.delay)});return S}();return(e||Object(O.a)(n.delay)).then((function(){return e=n.concurrency,t=F,r=n.pulse,new m.a(e,t,r);var e,t,r}))}function V(e,n){var t=n;return Object(r.h)("fwk-devTools")&&(t=parseInt(Object(d.a)(e))||n),t}function F(e){return++M==_?setTimeout(e,T):e(),P&&M==N-1&&(Object(v.o)("ttiGovernEnd",Object(a.__assign)(Object(a.__assign)({},S),{monkey:_})),P=!1),Promise.resolve()}function L(e,n){return["branch","ring","version"].some((function(t){return!!Object(d.d)(t,e.location)&&(n.push(t+"="+Object(d.a)(t,e.location)),!0)})),n.join("&")}var H,z=t(75);!function(e){e[e.Normal=0]="Normal",e[e.CacheCorrupt=1]="CacheCorrupt",e[e.TooManyInstallError=2]="TooManyInstallError"}(H||(H={}));var B,q=H;!function(e){e[e.Install=0]="Install",e[e.UnInstall=1]="UnInstall"}(B||(B={}));var G,Y=B;!function(e){e[e.CacheProgress=0]="CacheProgress",e[e.Error=1]="Error"}(G||(G={}));var $,J=G;!function(e){e[e.Checking=0]="Checking",e[e.Downloading=1]="Downloading",e[e.Progress=2]="Progress",e[e.Error=3]="Error",e[e.Cached=4]="Cached",e[e.NoUpdate=5]="NoUpdate",e[e.Obsolete=6]="Obsolete",e[e.UpdateReady=7]="UpdateReady",e[e.Idle=8]="Idle",e[e.UnCached=9]="UnCached",e[e.CleanupError=10]="CleanupError",e[e.CleanupSuceeded=11]="CleanupSuceeded"}($||($={}));var K,Q,X=$,Z=((K={})[X.Error]="ER",K[X.Cached]="C",K[X.NoUpdate]="NU",K[X.Obsolete]="OB",K[X.UpdateReady]="UR",K);!function(e){e[e.CacheInstalled=0]="CacheInstalled",e[e.CacheFailed=1]="CacheFailed",e[e.CacheCleared=2]="CacheCleared"}(Q||(Q={}));var ee=Q,ne=t(9);function te(e,n){return e+"_"+n}var re="SWCacheErrorCount";function ae(e,n,t){var r=te(n.appName,re);0==t?Object(ne.c)(e,r):Object(ne.d)(e,r,""+t)}function oe(e,n){var t=parseInt(Object(ne.a)(e,te(n.appName,re)));return isNaN(t)?0:t}var ce="CacheVersion",ie="AttemptedCacheVersion";function se(e,n,t){if(t.cacheMessage&&(t.targetClient==n.appName||"global"==t.targetClient)){var r=t.cacheMessage;z.g.info("[SW Client] Cache Event: "+r.cacheEvent);var a=null;switch(r.cacheEvent){case X.Progress:n.resourcesCached++;break;case X.Error:a=ee.CacheFailed;break;case X.Cached:case X.NoUpdate:case X.UpdateReady:a=ee.CacheInstalled;break;case X.Obsolete:a=ee.CacheCleared;break;case X.CleanupError:n.cacheCleanupStatus=1;break;case X.CleanupSuceeded:n.cacheCleanupStatus=2,n.numberOfCachesCleaned=r.cachesCleaned?r.cachesCleaned.length:0}var o=r.cacheEvent==X.Obsolete;null!=a&&(function(e,n,t,r){switch(t){case ee.CacheInstalled:Object(ne.d)(e,te(n.appName,ce),r),ae(e,n,0);break;case ee.CacheFailed:Object(ne.d)(e,te(n.appName,ie),r),ae(e,n,oe(e,n)+1);break;case ee.CacheCleared:Object(ne.d)(e,te(n.appName,ce),null),Object(ne.d)(e,te(n.appName,ie),null),ae(e,n,0)}}(e,n,a,o?null:r.cacheVersion),function(e,n){Object(v.o)("SWCache",{ev:Z[n.cacheEvent],cv:n.cacheVersion,e:n.error,r:n.resource,st:n.status,stk:n.stack,rc:e.resourcesCached,ccs:e.cacheCleanupStatus,ncc:e.numberOfCachesCleaned,ch:e.cacheHealth,app:e.appName}),e.resourcesCached=0,e.cacheCleanupStatus=0,e.numberOfCachesCleaned=0}(n,r)),o&&n.cacheHealth>q.Normal&&(n.cacheHealth=q.Normal,pe())}}var ue=t(66),le=t(445),de=15,fe=null,he=null;function pe(){var e=Object(le.a)("/"+Object(ue.a)())+"/",n=""+e+fe.appName+"cache.manifest?"+L(window,["manifestVersion=2"]),t=Y.Install;fe.cacheHealth>q.Normal&&(t=Y.UnInstall);var a={source:fe.appName,action:t,bootResourcesOnly:!0,language:fe.userLanguage,darkMode:void 0!==fe.darkMode&&fe.darkMode,manifestUrl:n,proxyFetchAlways:Object(r.h)("fwk-sw-proxyFetchAlways"),rootUrl:e};fe.serviceWorkerRegistration.active.postMessage(a)}function be(e){if(e.data){var n=e.data;n.messageType==J.CacheProgress?se(he,fe,n):n.messageType==J.Error&&function(e){null!=e.error&&z.d("[SW Client] ServiceWorker Unhandled Exception",e.error)}(n)}}var ve=t(49),me=t(26),Oe="activated",ge=null,Ce=null,je=null,we=null;function ke(e,n,t){Ce=(je=e).navigator.serviceWorker,we=n;var a,o,c,i="/mail/sw.js",s=[];Object(r.h)("fwk-sw-proxyFetchAlways")&&(a=Object(ve.a)(),o=a.browser,c=a.browserVersion,("Chrome"==o||"Edge Anaheim"==o)&&c&&c.length>0)&&s.push("fa=1"),(Object(r.h)("fwk-sw-v2")||Object(d.d)("swV2"))&&s.push("swVersion=2");var u=L(e,s);return u&&(i+="?"+u),t.addCustomData({url:i}),Ce.register(i,{scope:"/"}).then((function(){return Ce.ready.then(ye)}))}function ye(e){return z.g.info("[SW Client] ready fired, state: "+e.active.state),(ge=e).active?Ie():new Promise((function(e){Ce.oncontrollerchange=function(){Ie(),e()}}))}function Ie(){return ge.active.state==Oe?Te():new Promise((function(e){ge.active.onstatechange=function(){ge.active.state==Oe&&(ge.active.onstatechange=null,Te(),e())}}))}function Te(){var e,n,t=Object(me.a)();return e={serviceWorkerContainer:Ce,serviceWorkerRegistration:ge,appName:we,userLanguage:t.SessionSettings.UserLanguage,darkMode:t.UserOptions.IsDarkModeTheme},n=je,fe||((fe=e).serviceWorkerContainer.onmessage=be,oe(window,fe)>de&&(fe.cacheHealth=q.TooManyInstallError)),he=n,pe(),Promise.resolve()}function Re(e,n){var t;return Object(a.__awaiter)(this,void 0,void 0,(function(){var o,c,i,s,u;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:if(o=new v.a("RegisterServiceWorker"),!(c=null===(t=e.navigator)||void 0===t?void 0:t.serviceWorker))return[3,7];if(i=function(){var e,n=Object(ve.a)().browser;Object(r.h)("fwk-prefetch-code-off")?e="Error_PrefetchDisabled":"Chrome"==n||"Edge Anaheim"==n?Object(r.h)("fwk-prefetch-code-off-chromium")&&!Object(ve.n)([77])&&(e="Error_ChromeMinVersion"):"Edge"==n?Object(ve.n)([17,17134])||(e="EdgeMinVersion"):"Safari"==n?Object(ve.n)([11,1])||(e="SafariMinVersion"):"Firefox"!=n&&(e="UnsupportedBrowser:"+n);return e}())return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,ke(e,n,o)];case 2:return a.sent(),[3,4];case 3:return u=a.sent(),s=u,[3,4];case 4:return[3,6];case 5:c.getRegistrations&&c.getRegistrations().then((function(e){for(var n=0;n<e.length;++n)e[n].unregister()})),a.label=6;case 6:return[3,8];case 7:i="SWNotAvailable",a.label=8;case 8:return o.addCustomData([i||"success"]),s?o.endWithError("ClientError",s):i?o.endWithError("ServerError"):o.end(),[2]}}))}))}function Ee(e,n,t){D({condition:!!((null===window||void 0===window?void 0:window.location)&&window.history),task:function(){return function(e,n){for(var t=Object(d.b)(e),r=!1,a=0;a<h.length;a++){var o=h[a];t[o]&&(delete t[o],r=!0)}if(r){var c=Object(l.stringify)(t);c&&(c="?"+c);var i=""+Object(f.m)()+e.pathname+c+e.hash;n.replaceState(null,null,i)}}(window.location,window.history)}},b.a,(function(){return v.i.importAndExecute(e)}),{condition:Object(r.h)("fwk-devTools"),task:function(){u.importAndExecute(),p.h.import().then((function(e){e()}))}},{task:function(){return Re(window,n)},idle:!0,condition:n&&(!t||Object(r.h)(t))},{idle:!0,task:c})}t.d(n,"setupSharedPostBoot",(function(){return Ee})),t.d(n,"govern",(function(){return D})),t.d(n,"enableGovernReport",(function(){return W}))},425:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(24),a=t(22),o=t(98);function c(e){var n=Object(r.a)(),t=Object(o.a)()+Object(a.a)("/owa")+"/",c=n.search&&n.search.length>0;t+=c?n.search:"?";for(var i=Object.keys(e),s=c,u=0;u<i.length;u++)s?t+="&":s=!0,t+=i[u]+"="+e[i[u]];return t}},445:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(62);function a(e){return Object(r.a)(e,[r.c])}},490:function(e,n,t){"use strict";var r=function(){function e(e,n,t){this.maxParallelTasks=e,this.taskCallback=n,this.taskDelay=t,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();t.d(n,"a",(function(){return r}))},573:function(e,n,t){"use strict";var r=t(445),a=(t(602),t(22)),o=t(62);function c(e){return Object(o.a)(e,[o.b])}var i=t(27),s=t(66);function u(e){return Object(i.b)(Object(i.c)(Object(i.a)(Object(s.a)()||"",e)))}var l,d,f,h=t(425);function p(e,n){var t=-1!==e.indexOf("?");return(e+=t?"&":"?")+Object.keys(n).map((function(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])})).join("&")}function b(){return l||(l=Object(a.a)("/calendar")+"/"),l}function v(){return d||(d=Object(a.a)("/mail")+"/"),d}function m(){return f||(f=Object(a.a)("/files")+"/"),f}var O,g,C,j=t(617);function w(e){return O&&g===e||(g=e,O=e?Object(a.a)("/people/group/owner")+"/":Object(a.a)("/people/group/member")+"/"),O}function k(){return C||(C=Object(a.a)("/people/group/deleted")+"/"),C}var y=t(26);function I(){var e=Object(y.a)().UserOptions;return(null==e?void 0:e.ReactOptinSettings)&&e.ReactOptinSettings.CalendarEnabled||!1}function T(e){if(I())return b()+"deeplink/compose/"+encodeURIComponent(e);var n={viewmodel:"IComposeCalendarItemViewModelFactory",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(h.a)(n)}function R(e){return window.location.origin+b()+"showPeek/item/"+encodeURIComponent(e)}function E(e){if(I())return b()+"item/"+encodeURIComponent(e);var n={viewmodel:"ICalendarItemDetailsViewModelFactory",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(h.a)(n)}var U=t(0),S=t(289),N=t(593),P=t(24),M=t(58),_=Object(N.a)().split("/").slice(1).join("/")+"deeplink/",D=["hostApp","isanonymous","cspoff","frameName","opxInstanceId"];function W(e,n,t,r){var a=Object(P.a)().search;if(t&&((r=r||{}).minus=""),r){var o=Object(M.parse)((a||"").substr(1));Object.keys(o).forEach((function(e){D.includes(e)&&delete o[e]})),Object.keys(r).forEach((function(e){return o[e]=r[e]})),a="?"+function(e){return Object.entries(e).map((function(e){var n=Object(U.__read)(e,2),t=n[0],r=n[1];return r?encodeURIComponent(t)+"="+encodeURIComponent(r):encodeURIComponent(t)})).join("&")}(o)}var c={pathname:"/"+e+"/"+_+n,search:a};return S.format(c)}var x,A=t(146),V="https://to-do.microsoft.com";function F(){var e,n,t=Object(y.a)(),r=t.UserOptions,a=null===(e=t.SessionSettings)||void 0===e?void 0:e.UserPrincipalName,o=V;return(null===(n=null==r?void 0:r.ReactOptinSettings)||void 0===n?void 0:n.TasksRedirectUrl)&&(o=r.ReactOptinSettings.TasksRedirectUrl,a&&(o=p(r.ReactOptinSettings.TasksRedirectUrl,{auth_upn:a}))),o}function L(){return x||(x=Object(a.a)("/spaces")+"/"),x}var H=t(98);t.d(n,"j",(function(){return r.a})),t.d(n,"s",(function(){return a.a})),t.d(n,"f",(function(){return c})),t.d(n,"l",(function(){return u})),t.d(n,"w",(function(){return i.a})),t.d(n,"a",(function(){return i.b})),t.d(n,"o",(function(){return h.a})),t.d(n,"u",(function(){return p})),t.d(n,"e",(function(){return b})),t.d(n,"k",(function(){return v})),t.d(n,"g",(function(){return m})),t.d(n,"p",(function(){return j.a})),t.d(n,"i",(function(){return w})),t.d(n,"h",(function(){return k})),t.d(n,"b",(function(){return T})),t.d(n,"c",(function(){return R})),t.d(n,"d",(function(){return E})),t.d(n,"q",(function(){return W})),t.d(n,"v",(function(){return A.a})),t.d(n,"t",(function(){return F})),t.d(n,"n",(function(){return L})),t.d(n,"m",(function(){return H.a})),t.d(n,"r",(function(){return s.a}))},602:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(24),a=t(66);function o(){var e,n=null===(e=Object(r.a)())||void 0===e?void 0:e.pathname;if(n){var t=n.split("/"+Object(a.a)()+"/")[1];if(t){var o=t.split("/")[0];if(o&&!isNaN(parseInt(o)))return!0}}return!1}},617:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r,a=t(22);function o(){return r||(r=Object(a.a)("/people")+"/"),r}},8433:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(115),a=new r.c((function(){return t.e(607).then(t.bind(null,10371))})),o=new r.a(a,(function(e){return e.tti}))}}]);
//# sourceMappingURL=owa.PostSharedBoot.js.map
self.scriptsLoaded['owa.PostSharedBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.PostSharedBoot.js'] = (new Date()).getTime();