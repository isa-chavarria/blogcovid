self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ActionableMessageMail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[114],{1032:function(e,t,n){"use strict";var r,a=function(e,t){if(this.AddinCommands=t,!this.AddinCommands)throw new Error("AddinCommands cannot be null while constructing an addin");this.DisplayName=e.DisplayName,this.IconUrl=e.IconUrl,this.HighResolutionIconUrl=e.HighResolutionIconUrl,this.Id=e.Id},i=n(0),o=n(6403),c=n(314),s=function(){function e(t,n,r,a){var c,s;if(this.control=t,this.tabInfo=n,this.groupInfo=r,this.extension=a,o.b(t)){var d=t;this.subCommands=[];try{for(var u=Object(i.__values)(d.MenuItems),l=u.next();!l.done;l=u.next()){var f=l.value;this.subCommands.push(new e(f,n,r,a))}}catch(e){c={error:e}}finally{try{l&&!l.done&&(s=u.return)&&s.call(u)}finally{if(c)throw c.error}}}}return Object.defineProperty(e.prototype,"isActionable",{get:function(){return!!this.control.Action},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMenu",{get:function(){return!!this.control.MenuItems},enumerable:!1,configurable:!0}),e.prototype.get_EntryPoint=function(){return o.c(this.control)?this.control.Action.SourceLocation:o.a(this.control)?this.extension.ExtensionPointCollection.FunctionFile:(Object(c.a)(this.control),"")},e.prototype.get_Id=function(){return this.extension.Id+this.control.Id},e.prototype.get_Label=function(){return this.control.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_Size16Icon=function(){return this.control&&this.control.Icon?this.control.Icon.Size16Url:null},e.prototype.getControl=function(){return this.control},e}(),d=function(){function e(e,t){this.detectedEntity=e,this.extension=t}return e.prototype.get_EntryPoint=function(){return this.detectedEntity.SourceLocation},e.prototype.get_Id=function(){return this.extension.Id},e.prototype.get_Label=function(){return this.detectedEntity.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_ActivationRule=function(){return this.detectedEntity.Rule},e.prototype.get_Size16Icon=function(){return this.extension.IconUrl},e.prototype.getControl=function(){return null},e}();!function(e){e[e.TimedOut=-1]="TimedOut",e[e.Success=0]="Success",e[e.FunctionNotFound=11101]="FunctionNotFound",e[e.NavigatedBeforeCompleted=13001]="NavigatedBeforeCompleted",e[e.PreinstalledConsented=13002]="PreinstalledConsented",e[e.Unknown=13003]="Unknown"}(r||(r={}));var u=r,l=n(4),f=n(1060),g=Object(l.mutatorAction)("setAutoRunAddinCommandWaitingQueue",(function(e,t){var n=Object(f.a)().autoRunAddinCommandWaitingQueue;n.has(t)||n.set(t,new Array),n.get(t).push(e)})),b=Object(l.mutatorAction)("destroyAutoRunAddinCommandFromWaitingQueue",(function(e,t){var n=Object(f.a)().autoRunAddinCommandWaitingQueue;if(n.has(e)){for(var r=n.get(e),a=0;a<r.length;a++)if(r[a].addinCommand===t){r.splice(a,1);break}0===r.length&&n.delete(e)}})),p=n(284),m=n(23),h="DeferrablePromise timed out",v=function(){function e(e){var t=this;this.internalPromise=new Promise((function(n,r){t.internalResolve=n,t.internalReject=r,t.timeout=setTimeout((function(){r(new Error(h)),t.isRejected=!0}),e)}))}return e.prototype.then=function(e,t){return this.internalPromise.then(e,t)},e.prototype.catch=function(e){return this.internalPromise.catch(e)},e.prototype.resolve=function(e){this.isFullfilled&&this.isRejected||(this.internalResolve(e),this.isFullfilled=!0,clearTimeout(this.timeout))},e.prototype.reject=function(e){this.isFullfilled&&this.isRejected||(this.internalReject(e),this.isRejected=!0,clearTimeout(this.timeout))},e}(),C=33e4,O={};var y=Object(p.action)("setUilessExtendedAddinCommand")((function(e,t,n){var r=function(e){var t=new v(C);return O[e]=t,t.catch((function(e){return e.message===h?{status:u.TimedOut}:{status:u.Unknown}}))}(e),a=Object(f.a)().runningUILessExtendedAddinCommands;return a.has(n)||a.set(n,new m.ObservableMap),a.get(n).set(e,t),r})),A=n(1107),I=function(){function e(e,t,n,r){this.event=e,this.control=t,this.extension=n,this.mode=r}return e.prototype.getLaunchEventType=function(){return this.event},e.prototype.getControl=function(){return this.control},e.prototype.get_EntryPoint=function(){switch(this.mode){case A.a.LaunchEvent:return this.extension.ExtensionPointCollection.LaunchEvent.SourceLocation;default:return null}},e.prototype.get_Label=function(){return this.control.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_Id=function(){return this.extension.Id},e.prototype.get_Size16Icon=function(){return this.extension.IconUrl},e}(),j=function(e,t){var n=Object(f.a)().blockedAddinCommands;return!!n.has(e)&&n.get(e).has(t)};function x(e){return Object(f.a)().HostItems.has(e)}var S=Object(l.mutatorAction)("setBlockedAddinCommand",(function(e,t){var n=Object(f.a)().blockedAddinCommands;n.has(t)||n.set(t,new Set),n.get(t).add(e)})),M=n(254),w=n(2),E=function(e,t){e.forEach((function(e){var n=e.addinCommand;!j(t,n)&&L(n,t)&&(e.addinCommandTelemetry.setQueuePushTime(),g(e,t))}))},T=function(e){D(e).forEach((function(t){var n=t.addinCommand,r=n.get_Id();!j(e,n)&&R(r,e)&&(t.addinCommandTelemetry.setQueuePopTime(),k(t,e),b(e,n))}))},k=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:n=e.addinCommand,r=0,i.label=1;case 1:return r<3?(a=e.controlId,[4,y(a,e,t)]):[3,4];case 2:if(i.sent().status===u.Success||!x(t))return[2];2==r&&Object(M.o)("AddinExecutionBlocked",{id:n.extension.Id,controlId:a,owa_1:Object(w.f)(),owa_2:Object(oe.c)(t)}),i.label=3;case 3:return r++,[3,1];case 4:return S(n,t),b(t,n),T(t),[2]}}))}))},D=function(e){var t=Object(f.a)().autoRunAddinCommandWaitingQueue.get(e);return t||[]},R=function(e,t){return!P(e,t)&&(!F(t)&&!_())},P=function(e,t){var n=Object(f.a)().runningUILessExtendedAddinCommands,r=!1;return!!n.has(t)&&(n.get(t).forEach((function(t){var n=t.addinCommand;N(n)&&n.get_Id()===e&&(r=!0)})),r)},_=function(){var e=Object(f.a)().runningUILessExtendedAddinCommands,t=0;return e.forEach((function(e){e.forEach((function(e){var n=e.addinCommand;N(n)&&(t+=1)}))})),t>=20},F=function(e){var t=Object(f.a)().runningUILessExtendedAddinCommands,n=0;return t.has(e)&&t.get(e).forEach((function(e){var t=e.addinCommand;N(t)&&(n+=1)})),n>=5},L=function(e,t){for(var n=D(t),r=0;r<n.length;r++){var a=n[r].addinCommand,i=e.getLaunchEventType()===a.getLaunchEventType(),o=e.get_Id()===a.get_Id();if(i&&o)return!1}return!0},N=function(e){return e instanceof I},U=n(2033),B=function(){function e(){}return e.prototype.CreateAddinCommand=function(e,t,n,r){return new s(e,t,n,r)},e.prototype.CreateContextualAddinCommand=function(e,t){return new d(e,t)},e.prototype.CreateEventAddinCommand=function(e,t){switch(e.Type){case 1:return new s({Id:"ItemSend",Action:e},null,null,t)}return null},e.prototype.CreateAutoRunAddinCommand=function(e,t,n){var r;switch(e.Type){case 1:r="OnNewMessageCompose";break;case 2:r="OnNewAppointmentOrganizer";break;default:return null}var a={Id:r,Action:e};return new I(e.Type,a,t,n)},e}();function H(e,t){switch(t){case A.a.MeetingRequest:return e.MessageReadCommandSurface;case A.a.AppointmentAttendee:return e.AppointmentAttendeeCommandSurface;case A.a.AppointmentOrganizer:return e.AppointmentOrganizerCommandSurface;case A.a.DetectedEntity:return e.DetectedEntity;case A.a.MessageCompose:return e.MessageComposeCommandSurface;case A.a.MessageRead:return e.MessageReadCommandSurface;case A.a.LaunchEvent:return e.LaunchEvent;case A.a.TrapOnSendEvent:default:return null}}var z=function(){function e(e){var t=this;this.addinCommandFactory=e,this.GetAutoRunAddinCommands=function(e,n,r){if(!e)return null;var a={};return e.LaunchEvents.forEach((function(e){a[e.Type.toString()]=t.addinCommandFactory.CreateAutoRunAddinCommand(e,n,r)})),new m.ObservableMap(a)}}return e.prototype.CreateAddinIfEntryPointSupported=function(e,t){var n;return(n=t==A.a.TrapOnSendEvent?this.GetEventsAddinCommands(e.ExtensionPointCollection.Events,e):t==A.a.DetectedEntity?this.GetContextualAddinCommand(H(e.ExtensionPointCollection,t),e):t==A.a.LaunchEvent?this.GetAutoRunAddinCommands(H(e.ExtensionPointCollection,t),e,t):this.GetAddinCommands(H(e.ExtensionPointCollection,t),e))?new a(e,n):null},e.prototype.GetAddinCommands=function(e,t){var n=this;if(!e)return null;var r={};return e.Tabs.forEach((function(e){e.Groups.forEach((function(a){a.Controls.forEach((function(i){r[i.Id]=n.addinCommandFactory.CreateAddinCommand(i,e,a,t)}))}))})),new m.ObservableMap(r)},e.prototype.GetContextualAddinCommand=function(e,t){if(!e)return null;var n={};return n[t.Id]=this.addinCommandFactory.CreateContextualAddinCommand(e,t),new m.ObservableMap(n)},e.prototype.GetEventsAddinCommands=function(e,t){var n=this;if(!e)return null;var r={};return e.forEach((function(e){r[e.Type]=n.addinCommandFactory.CreateEventAddinCommand(e,t)})),new m.ObservableMap(r)},e}(),q=Object(l.mutatorAction)("closeAllAutoRunCommandsforHostItemIndex",(function(e){Object(f.a)().autoRunAddinCommandWaitingQueue.delete(e)}));var G=n(1478);function W(){return{regExMatches:{},matchedKnownEntityTypes:[],filteredEntityMatches:{}}}var J=Object(p.action)("destroyExtensibilityHostItem")((function(e){G.a.HostItems.delete(e)}));function V(e){return!!e&&!!e.SupportsSharedFolders}function Q(e){return e.filter((function(e){return V(function(e){var t=Object(i.__spread)(e.AddinCommands.values());if(0==t.length)return null;return t[0].extension.ExtensionPointCollection}(e))}))}function Y(e){return e.filter((function(e){return V(e.extension.ExtensionPointCollection)}))}function K(e){return V(e.extension.ExtensionPointCollection)}function Z(e){var t=Object(f.a)();return t.runningContextualAddinCommand&&t.runningContextualAddinCommand.controlId===e?t.runningContextualAddinCommand:null}function X(e,t){var n;return null===(n=Object(f.a)().taskPanes.get(t))||void 0===n?void 0:n.get(e)}function $(e){var t,n,r,a,o=Object(f.a)().taskPanes;try{for(var c=Object(i.__values)(o.values()),s=c.next();!s.done;s=c.next()){var d=s.value;try{for(var u=(r=void 0,Object(i.__values)(d.values())),l=u.next();!l.done;l=u.next()){var g=l.value;if(g.controlId===e)return g}}catch(e){r={error:e}}finally{try{l&&!l.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return null}function ee(e){var t,n,r,a,o=Object(f.a)().taskPanes;try{for(var c=Object(i.__values)(o.values()),s=c.next();!s.done;s=c.next()){var d=s.value;try{for(var u=(r=void 0,Object(i.__values)(d)),l=u.next();!l.done;l=u.next()){var g=Object(i.__read)(l.value,2),b=g[0];if(g[1].controlId===e)return b}}catch(e){r={error:e}}finally{try{l&&!l.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return null}var te=n(1497);function ne(e){var t=$(e);if(t)return t.addinCommand;var n=Z(e);return n?n.addinCommand:Object(te.a)(e)}var re=function(e){var t=Object(f.a)().EnabledAddinCommands;return t?t.getAutoRunAddinsByLaunchEventType(e).map((function(t){return t.AddinCommands.get(e.toString())})):[]};function ae(e){var t=Object(f.a)().activeDialog;return t&&e===t.controlId?5:$(e)?2:Z(e)?1:Object(te.a)(e)?3:4}function ie(e){var t=Object(f.a)(),n=function(e,t){var n=t.taskPanes.get(e);if(!n)return[];return Object(i.__spread)(n.values()).map((function(e){return e.controlId}))}(e,t),r=function(e,t){var n=t.runningUILessExtendedAddinCommands;if(n.has(e))return Object(i.__spread)(n.get(e).keys());return[]}(e,t),a=function(e,t){var n=t.runningContextualAddinCommand;if(n&&n.hostItemIndex===e)return[t.runningContextualAddinCommand.controlId];return[]}(e,t);return Object(i.__spread)(n,r,a)}var oe=n(1422);function ce(){return G.a.Context}function se(e){var t=ne(e);return t&&t.extension.Id}function de(e){return G.a.HostItems.get(e)}function ue(e){var t=$(e);if(t)return t.hostItemIndex;var n=Z(e);return n?n.hostItemIndex:Object(te.c)(e)}function le(e){return ne(e).extension.WebApplicationResource}var fe=n(2032);function ge(e){Object(fe.a)()?e():Object(m.when)(fe.a,e)}function be(){return G.a.ExtensibilityStateIsDirty}var pe=n(435);function me(){return Object(pe.a)()}var he=Object(p.action)("terminateContextualCallout")((function(){var e=Object(f.a)();e.runningContextualAddinCommand=null,e.contextualCalloutState.contextualAnchor=null,e.contextualCalloutState.activeContextualAddinCommands=[],e.contextualCalloutState.selectedTerms=[]})),ve=Object(p.action)("initializeContextualCallout")((function(e,t,n){var r=Object(f.a)();r.runningContextualAddinCommand&&he();var a=de(t),o=new m.ObservableMap,c=r.contextualCalloutState;c.selectedTerms=[],e.forEach((function(e){var t=a.contextualTerms.get(e).slice();t&&t.length>0&&(c.selectedTerms.push(e),t.forEach((function(e){o.set(e.get_Id(),e)})))})),c.contextualAnchor=n,c.activeContextualAddinCommands=Object(i.__spread)(o.values()),c.hostItemIndex=t})),Ce=Object(p.action)("initializeExtensibilityHostItem")((function(e){G.a.HostItems.has(e)||G.a.HostItems.set(e,{contextualTerms:null,contextualEvaluationResults:null})})),Oe=n(4731);function ye(){return!!G.a.activeDialog}var Ae=Object(l.mutatorAction)("setActiveDialog",(function(e){Object(f.a)().activeDialog=e})),Ie=Object(p.action)("setEnabledAddinCommands")((function(e){G.a.EnabledAddinCommands=e})),je=n(76),xe=n(94),Se=Object(p.action)("setExtensibilityContext")((function(e){var t;if(null==e?void 0:e.Extensions){for(var n=Object(xe.i)(),r=null===(t=null==n?void 0:n.UserOptions)||void 0===t?void 0:t.WebSuggestedRepliesEnabledForUser,a=-1,i=0;i<e.Extensions.length;i++){var o=e.Extensions[i];"599e5de2-d41c-442a-bdb4-92eafa18a0dc"===o.Id&&null==o.ExtensionPointCollection.DetectedEntity&&(o.ExtensionPointCollection.DetectedEntity=o.ExtensionPointCollection.CustomPane,o.ExtensionPointCollection.DetectedEntity.Label=o.DisplayName),r&&"bc13b9d0-5ba2-446a-956b-c583bdc94d5e"===o.Id&&Object(je.h)("mc-smartReplyWithCustomMeeting")&&(a=i)}a>=0&&e.Extensions.splice(a,1)}G.a.Context=e})),Me=Object(p.action)("setExtensibilityStateIsDirty")((function(e){G.a.ExtensibilityStateIsDirty=e})),we=Object(p.action)("setContextualAddinCommand")((function(e,t,n){Object(f.a)().runningContextualAddinCommand=function(e,t,n){return{controlId:e,addinCommand:t,hostItemIndex:n}}(e,n,t)})),Ee=Object(l.mutatorAction)("setTaskPaneAddinCommand",(function(e,t,n,r,a,i){var o=Object(f.a)().taskPanes,c=function(e,t,n,r,a,i){return{controlId:e,addinCommand:t,hostItemIndex:n,mode:r,errorType:a||0,initializationContext:i}}(e,n,t,a,null,i);o.has(t)||o.set(t,new m.ObservableMap),o.get(t).set(r,c)})),Te=n(1719),ke=Object(l.mutatorAction)("destroyBlockedAddinCommandsList",(function(e){Object(f.a)().blockedAddinCommands.delete(e)})),De=Object(l.mutatorAction)("terminateTaskPaneAddin",(function(e,t){var n=Object(f.a)().taskPanes;n.has(t)&&(n.get(t).delete(e),0===n.get(t).size&&n.delete(t))})),Re=Object(l.mutatorAction)("terminatePersistantTaskPaneAddinWithAppId",(function(e){var t,n,r,a,o=Object(f.a)().taskPanes;try{for(var c=Object(i.__values)(o),s=c.next();!s.done;s=c.next()){var d=Object(i.__read)(s.value,2),u=d[0],l=d[1].get("Persistent");(null===(a=null===(r=null==l?void 0:l.addinCommand)||void 0===r?void 0:r.extension)||void 0===a?void 0:a.Id)===e&&(o.get(u).delete("Persistent"),0===o.get(u).size&&o.delete(u))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}})),Pe=Object(p.action)("terminateUiLessExtendedAddinCommand")((function(e,t,n,r){!function(e,t){O[e]&&(O[e].resolve(t),delete O[e])}(e,{status:n,allowEvent:null==r?void 0:r.allowEvent});var a=Object(f.a)().runningUILessExtendedAddinCommands;a.has(t)&&(a.get(t).delete(e),0===a.get(t).size&&a.delete(t))})),_e=Object(l.mutatorAction)("toggleTaskPaneType",(function(e,t){var n=X(e,t);if(n){var r=Object(f.a)().taskPanes;r.has(t)&&(r.get(t).delete(e),r.get(t).set(function(e){return"Persistent"===e?"NonPersistent":"Persistent"}(e),n))}})),Fe=Object(p.action)("updateConsentState")((function(e,t,n){ne(t).extension.ConsentState=Number(n)})),Le=Object(p.select)({hostItem:function(e,t,n){return G.a.HostItems.get(e)}})(Object(p.action)("updateContextualEvaluation")((function(e,t,n,r){var a=r.hostItem;a&&(a.contextualTerms=t,a.contextualEvaluationResults=n)}))),Ne=Object(p.action)("updateEntityExtractionResult")((function(e,t){e.EntityExtractionResult=t})),Ue=Object(p.action)("updateExtensionSettings")((function(e,t,n){ne(t).extension.Settings=n})),Be=Object(l.mutatorAction)("updatePersistentTaskPaneHostItem",(function(e,t){var n=Object(f.a)().taskPanes;if(n.has(e)){var r=X("Persistent",e);r.hostItemIndex=t,r.errorType=0,n.get(e).delete("Persistent"),0===n.get(e).size&&n.delete(e),n.has(t)||n.set(t,new m.ObservableMap),n.get(t).set("Persistent",r)}})),He=Object(p.action)("setCompliance")((function(e){var t=JSON.parse(e);t&&t.hasOwnProperty("IsMinor")&&(G.a.compliance.isMinor=t.IsMinor)}));n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"J",(function(){return N})),n.d(t,"e",(function(){return E})),n.d(t,"P",(function(){return T})),n.d(t,"y",(function(){return U.b})),n.d(t,"b",(function(){return B})),n.d(t,"c",(function(){return z})),n.d(t,"g",(function(){return q})),n.d(t,"k",(function(){return G.a})),n.d(t,"h",(function(){return W})),n.d(t,"j",(function(){return J})),n.d(t,"m",(function(){return Q})),n.d(t,"f",(function(){return K})),n.d(t,"l",(function(){return Y})),n.d(t,"n",(function(){return ne})),n.d(t,"p",(function(){return re})),n.d(t,"r",(function(){return ae})),n.d(t,"o",(function(){return ie})),n.d(t,"A",(function(){return X})),n.d(t,"B",(function(){return $})),n.d(t,"C",(function(){return ee})),n.d(t,"z",(function(){return oe.c})),n.d(t,"q",(function(){return oe.a})),n.d(t,"s",(function(){return ce})),n.d(t,"t",(function(){return f.a})),n.d(t,"u",(function(){return se})),n.d(t,"v",(function(){return de})),n.d(t,"w",(function(){return ue})),n.d(t,"E",(function(){return le})),n.d(t,"K",(function(){return fe.a})),n.d(t,"jb",(function(){return ge})),n.d(t,"L",(function(){return be})),n.d(t,"x",(function(){return me})),n.d(t,"F",(function(){return ve})),n.d(t,"G",(function(){return Ce})),n.d(t,"I",(function(){return te.d})),n.d(t,"O",(function(){return te.e})),n.d(t,"D",(function(){return te.b})),n.d(t,"N",(function(){return Oe.a})),n.d(t,"H",(function(){return ye})),n.d(t,"M",(function(){return x})),n.d(t,"Q",(function(){return Ae})),n.d(t,"T",(function(){return Ie})),n.d(t,"U",(function(){return Se})),n.d(t,"V",(function(){return Me})),n.d(t,"S",(function(){return we})),n.d(t,"W",(function(){return Ee})),n.d(t,"X",(function(){return y})),n.d(t,"Y",(function(){return Te.a})),n.d(t,"i",(function(){return ke})),n.d(t,"Z",(function(){return he})),n.d(t,"bb",(function(){return De})),n.d(t,"ab",(function(){return Re})),n.d(t,"cb",(function(){return Pe})),n.d(t,"db",(function(){return _e})),n.d(t,"eb",(function(){return Fe})),n.d(t,"fb",(function(){return Le})),n.d(t,"gb",(function(){return Ne})),n.d(t,"hb",(function(){return Ue})),n.d(t,"ib",(function(){return Be})),n.d(t,"R",(function(){return He}))},10837:function(e,t,n){"use strict";var r;!function(e){e[e.LoadStart=0]="LoadStart",e[e.AutoInvokeActionStart=1]="AutoInvokeActionStart",e[e.AutoInvokeActionEnd=2]="AutoInvokeActionEnd",e[e.CardRenderStart=3]="CardRenderStart",e[e.CardRenderEnd=4]="CardRenderEnd",e[e.ThemeLoadTotalStart=5]="ThemeLoadTotalStart",e[e.ThemeLoadTotalEnd=6]="ThemeLoadTotalEnd",e[e.ThemeDefinitionsLoadStart=7]="ThemeDefinitionsLoadStart",e[e.ThemeDefinitionsLoadEnd=8]="ThemeDefinitionsLoadEnd",e[e.ThemeResolveStart=9]="ThemeResolveStart",e[e.ThemeResolveEnd=10]="ThemeResolveEnd",e[e.CardCreateStart=11]="CardCreateStart",e[e.CardCreateEnd=12]="CardCreateEnd",e[e.CardLibraryRenderStart=13]="CardLibraryRenderStart",e[e.CardLibraryRenderEnd=14]="CardLibraryRenderEnd",e[e.PrepareCardStart=15]="PrepareCardStart",e[e.PrepareCardEnd=16]="PrepareCardEnd"}(r||(r={})),t.a=r},10838:function(e,t,n){var r=n(14364),a=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1100:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(4),a=n(23),i=Object(r.createStore)("lightningState",{unseenItems:new a.ObservableMap,lightedCount:0,lastShownId:null}),o=i()},1238:function(e,t,n){"use strict";var r=n(0),a=n(42),i=n(1268),o=n(1),c=n.n(o);function s(e,t){var n=function(t,n){return c.a.createElement(d,Object(r.__assign)({},t),c.a.createElement(e,Object(r.__assign)({},t)))};return n.displayName=e.displayName,t?c.a.forwardRef(n):n}var d=Object(a.a)((function(e){var t=e.lid,n=e.when,r=e.series,a=e.children;return c.a.useEffect((function(){return Object(i.b)(t,n,r),function(){i.c.importAndExecute(t)}}),[]),a&&l(t)?c.a.createElement(c.a.Fragment,null,a):null}));function u(e,t){i.c.importAndExecute(e,t)}function l(e){if(i.d.unseenItems){var t=i.d.unseenItems.get(e);if(null==t?void 0:t.visible)return!0}return!1}n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return i.a}))},1249:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1),a={};function i(e){var t;null===(t=a[e.type])||void 0===t||t.forEach((function(t){return t(e)}))}function o(e){var t;return a[e]=null!==(t=a[e])&&void 0!==t?t:new Map}function c(e,t,n){var a=r.useRef();r.useEffect((function(){return function(e,t,n){var r=o(e);0===r.size&&window.addEventListener(e,i),r.set(t,n)}(e,a,t),function(){return function(e,t){var n=o(e);n.delete(t),0===n.size&&window.removeEventListener(e,i)}(e,a)}}),n)}},1268:function(e,t,n){"use strict";var r=n(115),a=n(1100),i=n(75),o=n(0),c=n(3),s=n(23),d=n(4),u=Object(d.mutatorAction)("initializeLightning",(function(e){var t,n;if(i.g.info("initialize lightning store"),Object(a.a)().lastShownId=null,Object(a.a)().lightedCount=0,Object(a.a)().unseenItems=new s.ObservableMap,e)try{for(var r=Object(o.__values)(e),c=r.next();!c.done;c=r.next()){var d=c.value;Object(a.a)().unseenItems.set(d.identity,d)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}));var l=n(288),f="ows/v1.0/lightning/items/unseen";function g(){return i.g.info("initialize lightning from server"),Object(l.b)(f).then((function(e){var t=e.map(b);u(t)}))}function b(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var p,m=n(26),h=n(76),v="lightning",C="UnseenLightening";function O(){var e,t,n;if(!p){var r=Object(c.a)(v);if(r)p=function(e){i.g.info("initialize lightning from override query parameter");var t=e.split(",").map((function(e){return{identity:e,visible:!1}}));return u(t),Promise.resolve()}(r);else{var a=Object(m.a)().PrimeSettings;if(Object(h.h)("lightning-initFromSD")&&a&&a.Items)try{for(var s=Object(o.__values)(a.Items),d=s.next();!d.done;d=s.next()){var l=d.value;if(l.Id===C&&l.Value){n=l.Value,i.g.info("initialize lightning from session data"),u(n.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),p=Promise.resolve();break}}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}p||(p=g())}}return p}var y=n(1843),A=Object(d.action)("lightup",(function(e){return{id:e}})),I=A;Object(d.mutator)(A,(function(e){i.g.info("lightup - id:"+e.id),Object(a.a)().lastShownId=e.id,Object(a.a)().lightedCount++;var t=Object(a.a)().unseenItems.get(e.id);t&&(t.visible=!0)})),Object(d.orchestrator)(A,(function(e){Object(y.a)("LIGHTUP",e.id)}));var j,x=n(573);function S(e,t){(i.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+t+", lightedCount:"+Object(a.a)().lightedCount+", lastShown:"+Object(a.a)().lastShownId),Object(x.v)())?i.g.info("lightning is disabled for deeplink"):Object(a.a)().unseenItems.has(e)&&(!Object(a.a)().lastShownId||function(e,t){var n=!1,r=Object(a.a)().lastShownId;if(r&&t&&!function(){var e=Object(a.a)(),t=e.lastShownId,n=e.unseenItems;return t&&n.has(t)&&n.get(t).visible}()){var i=t.indexOf(r),o=t.indexOf(e);i>=0&&i+1==o&&(n=!0)}return n}(e,t)||function(e){var t=Object(a.a)().unseenItems.get(e);return!!t&&t.category==j.UIFeatureDiscovery}(e)||function(e){var t=Object(a.a)().unseenItems.get(e);return!!t&&t.category==j.Compliance}(e))&&I(e)}function M(e,t,n){i.g.info("beginLightning - id:"+e),t((function(){O().then((function(){return S(e,n)})).catch((function(t){i.g.warn("something is wrong, lightning id:"+e+", reason:"+t)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(j||(j={}));var w=n(1277);n.d(t,"c",(function(){return T})),n.d(t,"d",(function(){return a.b})),n.d(t,"b",(function(){return M})),n.d(t,"a",(function(){return w.a}));var E=new r.c((function(){return n.e(367).then(n.bind(null,15844))})),T=new r.a(E,(function(e){return e.endLightningImp}))},1277:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.EnterpriseOptInFRE="24",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.ShortenEventsDurationSetting="70"}(r||(r={}))},14357:function(e){e.exports=JSON.parse('{"a":"Xad"}')},14358:function(e){e.exports=JSON.parse('{"a":"abd","b":"bbd","c":"cbd","d":"dbd"}')},14359:function(e){e.exports=JSON.parse('{"b":"fbd","a":"gbd","c":"hbd"}')},14360:function(e){e.exports=JSON.parse('{"a":"ebd"}')},14361:function(e){e.exports=JSON.parse('{"d":"Yad","c":"Zad","a":"_ad","b":"$ad"}')},14362:function(e,t,n){var r=n(14363),a=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},14363:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'._2pRM5MH2wQSL6KJYv7DZjH{width:calc(100% - 25px);position:absolute;height:calc(100% - 64px)}html[dir=ltr] ._2pRM5MH2wQSL6KJYv7DZjH{margin-left:-20px;margin-right:-35px}html[dir=rtl] ._2pRM5MH2wQSL6KJYv7DZjH{margin-right:-20px;margin-left:-35px}._36_sivvBA_3QDLOOHcFq0k{width:100%;height:100%}html[dir] ._36_sivvBA_3QDLOOHcFq0k{border-width:0}._3CW7BF2coKNui2HaKAh3Zw{font-size:21px;font-weight:100;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={opayFlexPaneContainer:"_2pRM5MH2wQSL6KJYv7DZjH",opayAppIFrameStyle:"_36_sivvBA_3QDLOOHcFq0k",flexPaneHeader:"_3CW7BF2coKNui2HaKAh3Zw"}},14364:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,"html[dir] ._3uEvU5UAdRqP1z24N4hRkz{margin-top:12px}html[dir=ltr] ._3uEvU5UAdRqP1z24N4hRkz{margin-left:52px}html[dir=rtl] ._3uEvU5UAdRqP1z24N4hRkz{margin-right:52px}.cmC6MemIKYrJJ77Z_ZD4n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._3FcySUHYRo6OeOulzvvAzX{-ms-flex-item-align:center;align-self:center;height:16px;line-height:16px}html[dir] ._3FcySUHYRo6OeOulzvvAzX{margin-top:8px}._3FcySUHYRo6OeOulzvvAzX ._36SOH4LiYsn62sG0PC93OB{font-size:8px}",""]),t.locals={container:"_3uEvU5UAdRqP1z24N4hRkz",cardArea:"cmC6MemIKYrJJ77Z_ZD4n",bodyToggleButton:"_3FcySUHYRo6OeOulzvvAzX",icon:"_36SOH4LiYsn62sG0PC93OB"}},15531:function(e,t,n){"use strict";n.r(t);var r,a=n(5624),i=n(75),o=n(0),c=n(1689),s=function(e){function t(t){var n=e.call(this)||this;return n.preserveBody=t,n}return Object(o.__extends)(t,e),t.prototype.internalPrepareForExecution=function(t){var n=this.body;e.prototype.internalPrepareForExecution.call(this,t),this.preserveBody&&(this.body=n)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(c.HttpAction),d=n(14357),u="Action.Http",l="HttpPOST",f="Action.Submit";!function(e){e.None="none",e.ConnnectorMessage="connectorMessage",e.ExplicitMessageCard="explicitMessageCard",e.RecommendationCard="recommendationCard",e.AddInRecommendationCard="addInRecommendationCard",e.CardHighlight="cardHighlight",e.AdaptiveCard="adaptiveCard",e.ListViewExtractedAction="listViewExtractedAction"}(r||(r={}));var g=n(65),b=n(2),p=n(26),m="WAC_Outlook_React";function h(e,t,n,a,i,c){var s,d=0,u=Object(p.a)(),l=u.UserOptions.MailboxTimeZoneOffset;l&&l.length>0&&l[0].OffsetRanges&&l[0].OffsetRanges.length>0&&(d=l[0].OffsetRanges[0].Offset,s=l[0].TimeZoneId);var f=u.SessionSettings.UserCulture,h={clientType:m,eventName:e,culture:f,uiCulture:f,mailboxType:n?"Group":"User",correlationVector:i||Object(g.b)(),clientVersion:Object(b.l)(),externalDirectoryUserGuid:u.SessionSettings.ExternalDirectoryUserGuid,externalDirectoryTenantGuid:u.SessionSettings.ExternalDirectoryTenantGuid,timeZone:{type:"Windows",id:s,offsetInMinutes:d},originator:t.card.originator,providerAccountUniqueId:t.providerAccountUniqueId,messageType:t.isAdaptiveCard?r.AdaptiveCard.toString():r.ExplicitMessageCard.toString(),messageCardExtensionContext:t.messageCardExtensionContext,messageCardContext:t.card.messageCardContext,genericInfo:c};if(a){var v=function(e,t){var n={};e&&(n.senderAddress=e.senderAddress,n.isGroupEscalationMessage=e.isGroupEscalationMessage,t?(n.threadId=e.conversationId,n.conversationId=n.conversationId,n.postId=e.itemId,n.messageId=n.itemId):(n.messageId=e.itemId,n.conversationId=e.conversationId));return n}(a,n);h=Object(o.__assign)(Object(o.__assign)({},h),v)}return h}var v,C,O=n(4);!function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(v||(v={})),function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(C||(C={}));var y={cache:{data:null,state:C.Empty,time:null},requestState:v.UnResolved},A=Object(O.createStore)("amClientConfigurationStore",y)(),I=function(){var e,t,n=null;return(null===(t=null===(e=A.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)&&(n=A.cache.data.clientTimeouts.default),n},j=n(254),x=n(106),S=n(2875),M=n(10),w=n(9820),E=n(9821),T=n(37),k="30d2f5e2-6e6f-43b0-a2bd-c9d87a5cd6fd",D="Action.",R=function(e,t,n,r,a){var i=e["@id"]?e["@id"]:e.id,s={"@type":"HttpPOST",name:e.title,target:e.url,body:e.body,"@id":i,hideCardOnInvoke:e.hideCardOnInvoke,isPrimaryAction:!!e.isPrimary&&e.isPrimary};e.headers&&e.headers.length>0&&(s.headers=e.headers);var d=Object(p.a)(),l=[];if(t)for(var f=0;f<t.length;f++){var g=t[f],b=new c.ValidationResults;if(g.internalValidateProperties(b),b.failures.length>0)return Promise.resolve({success:!1,displayMessage:b.failures[0].errors[0].message});if(g){var m=void 0;m=g instanceof c.DateInput?{id:g.id,value:g.value,usertimezone:d.UserOptions.TimeZone}:{id:g.id,value:g.value},l.push(m)}}var v,C={type:u,url:e.url,body:e.body,method:e.method,id:e.id?e.id:k,headers:e.headers},O=d.SessionSettings.UserCulture,y=h(P(e,a),n,r.mailboxInfo.type===x.a.GroupMailbox,r);return y.actionId=i,y.actionType=e.getJsonTypeName(),n.isAdaptiveCard?v={httpAction:C,inputParameters:l,connectorSenderGuid:n.connectorSenderGuid,SmtpAddressesSerialized:n.smtpAddressesSerialized,adaptiveCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:y,adaptiveCardHash:n.cardHash,senderAddress:r.senderAddress}:(s=Object(o.__assign)(Object(o.__assign)({},e.originalJsonPayload),s),v={inputParameters:l,connectorSenderGuid:n.connectorSenderGuid,potentialAction:JSON.stringify(s),SmtpAddressesSerialized:n.smtpAddressesSerialized,messageCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:y,tenantObjectId:d.SessionSettings.ExternalDirectoryTenantGuid,messageCardHash:n.cardHash,senderAddress:r.senderAddress,culture:O,uiCulture:O}),F(_(r,O,n.isAdaptiveCard),JSON.stringify(v),"HttpAction",null,B(n),a)},P=function(e,t){return t?"AutoInvokeActionClicked":e.parent&&"InlineAdaptiveCard"===e.parent.constructor.name?"ActionCardHttpPostActionClicked":"SingleClickHttpPostActionClicked"},_=function(e,t,n){var r=e.mailboxInfo.type===x.a.UserMailbox?"userid":e.mailboxInfo.mailboxSmtpAddress,a=e.odataItemId,i=e.odataConversationId;switch(e.mailboxInfo.type){case x.a.UserMailbox:return n?Object(M.c)("/actions/{0}/messages/{1}/adaptiveCard/executeAction?culture={2}",r,a,t):Object(M.c)("/actions/{0}/messages/{1}/executeAction?culture={2}",r,a,t);case x.a.GroupMailbox:case x.a.TeamsMailbox:return n?Object(M.c)("/actions/{0}/threads/{1}/posts/{2}/adaptiveCard/executeAction?culture={3}",r,i,a,t):Object(M.c)("/actions/{0}/threads/{1}/posts/{2}/executeAction?culture={3}",r,i,a,t);case x.a.PublicMailbox:case x.a.SharedMailbox:case x.a.ArchiveMailbox:return null}},F=function(e,t,n,r,a,c){return void 0===c&&(c=!1),Object(o.__awaiter)(void 0,void 0,void 0,(function(){var s,u,l,f;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:s=r||Object(g.b)(),u={correlationVector:s,cardCorrelationId:a,requestType:n},o.label=1;case 1:return o.trys.push([1,5,,6]),[4,Object(S.a)()];case 2:return(l=o.sent())?[3,4]:(i.g.warn("[ActionableMessageDebug] makePostRequest: Unable to get the client Auth token possibly AAD token"),[4,Object(S.b)()]);case 3:l=o.sent(),o.label=4;case 4:if(!l)throw new Error("Token is empty: "+l);return[3,6];case 5:return f=o.sent(),i.g.warn("[ActionableMessageDebug] makePostRequest: Error while getting token, error: "+f),Object(j.m)("ActionableMessageConnectorsPostRequestErrorGettingToken",void 0,void 0,f,u,{isCore:!0}),[2,{success:!1,displayMessage:Object(M.b)(d.a)}];case 6:return[4,L(e,l,t,c,s,u)];case 7:return[2,o.sent()]}}))}))},L=function(e,t,n,r,a,i){return new Promise((function(o){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&o(N(200===c.status,c.responseText))},c.ontimeout=function(){o({success:!1,displayMessage:Object(M.b)(d.a)}),Object(j.m)("ActionableMessageConnectorsPostRequestTimeout",void 0,void 0,void 0,i,{isCore:!0})},c.open("POST",e,!0),c.timeout=function(e){var t=e?6e3:1e4,n=I();return e&&(null==n?void 0:n.AutoInvokedActionTimeoutInMsec)?t=n.AutoInvokedActionTimeoutInMsec:!e&&(null==n?void 0:n.HttpActionTimeoutInMsec)&&(t=n.HttpActionTimeoutInMsec),t}(r),c.setRequestHeader("MS-CV",a),c.setRequestHeader("X-OWA-CANARY",Object(T.a)()),c.setRequestHeader("Authorization","Bearer "+t),c.send(n)}))},N=function(e,t){try{var n=JSON.parse(t),r=!!e&&U(n.status);return{success:r,displayMessage:n.displayMessage?n.displayMessage:r?Object(M.b)(E.a):Object(M.b)(w.a),performedAt:n.performedAt,newCardPayload:n.refreshCardSerialized,newCardSignature:n.refreshCardSignature,removeCard:n.removeCard,showOriginalCard:n.showOriginalCard,hideCard:n.hideCard}}catch(e){return{success:!1,displayMessage:Object(M.b)(w.a)}}},U=function(e){return e&&"completed"===e.toLowerCase()},B=function(e){try{return e.card.messageCardContext.correlationId}catch(e){return""}};var H=n(7);function z(e){return 0===Object.keys(e).length}function q(e){var t=[],n=e.previousCardCheckpoints&&!z(e.previousCardCheckpoints)?e.previousCardCheckpoints:e.currentCardCheckpoints,r=null;e.previousCardCheckpoints&&!z(e.previousCardCheckpoints)&&(r=e.currentCardCheckpoints);var a=Object(H.w)(n.cardCreateEnd,n.cardCreateStart);t.ICPT=a;var i=Object(H.w)(n.cardRenderEnd,n.cardRenderStart);t.ICRT=i;var o=Object(H.w)(n.themeLoadTotalEnd,n.themeLoadTotalStart);t.ICTT=o;var c=n.totalFetchTime;t.ICFT=c;var s=Object(H.w)(n.cardLibraryRenderEnd,n.cardLibraryRenderStart);t.ICHT=s;var d=Object(H.w)(n.prepareCardEnd,n.prepareCardStart);if(t.IPPT=d,r){var u=Object(H.w)(r.cardCreateEnd,r.cardCreateStart);t.FCPT=u;var l=Object(H.w)(r.cardRenderEnd,r.cardRenderStart);t.FCRT=l;var f=Object(H.w)(r.themeLoadTotalEnd,r.themeLoadTotalStart);if(t.FCTT=f,r.totalFetchTime){var g=r.totalFetchTime;t.FCFT=g}var b=Object(H.w)(r.cardLibraryRenderEnd,r.cardLibraryRenderStart);t.FCHT=b;var p=Object(H.w)(r.prepareCardEnd,r.prepareCardStart);t.FPPT=p}if(e.autoInvokeActionStart&&e.autoInvokeActionEnd){var m=Object(H.w)(e.autoInvokeActionEnd,e.autoInvokeActionStart);t.AIT=m}var h=Object(H.w)(r?r.cardRenderEnd:n.cardRenderEnd,e.loadStart);return t.TCRT=h,function(e){var t="[";return Object.keys(e).forEach((function(n,r){0!==r&&(t+=", "),t+='"'+n+'": "'+e[n]+'"'})),t+="]"}(t)}var G="/actions/{0}/clientTelemetry/",W="mailboxId";function J(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return n=t?Object(M.c)(G,t):Object(M.c)(G,W),[4,F(n,JSON.stringify(e),"Telemetry",e.correlationVector)];case 1:return r.sent(),[2]}}))}))}function V(e){var t=new s(!0);return t.method="POST",t.body=e.body,t.title=e.name,t.originalJsonPayload=e,e.headers&&e.headers.length>0&&(t.headers=[],e.headers.forEach((function(e){t.headers.push(new c.HttpHeader(e.name,e.value))}))),t.url=e.target,t["@id"]=e["@id"],t.hideCardOnInvoke=e.hideCardOnInvoke,t}var Q=n(76),Y=n(296);var K=n(9),Z=function(){return!!Object(K.b)(window)&&!!Object(K.a)(window,"ActionableMessages.ClientConfiguration")},X=function(){return A.cache.state!==C.Empty},$=function(){var e=Date.now()-A.cache.time;return A.cache.state===C.Success&&e>=432e6||A.cache.state===C.Error&&e>=864e5},ee=Object(O.mutatorAction)("updateRequestState",(function(e){A.requestState=e})),te=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),e="/actions/v1.0/"+Object(x.d)()+"/clientConfigs/WAC_Outlook_React?clientVersion="+Object(b.l)()+"&clientColorScheme=default&$expand=providerConfigs",[4,Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return e=new Headers,[4,Object(S.a)()];case 1:return t=n.sent(),e.set("Authorization",function(e){return"Bearer "+e}(t)),e.set("MS-CV",Object(g.b)()),[2,e]}}))}))];case 1:return t=a.sent(),n=new Request(e,{method:"GET",headers:t}),[4,fetch(n)];case 2:return(r=a.sent()).ok?[4,r.json()]:[3,4];case 3:return[2,a.sent()];case 4:throw r;case 5:return[3,7];case 6:throw a.sent();case 7:return[2]}}))}))},ne=Object(O.mutatorAction)("setClientConfiguration",(function(e){A.cache=e})),re=function(e,t){return{data:e,state:t,time:Date.now()}},ae=Object(O.action)("loadClientConfiguration");Object(O.orchestrator)(ae,(function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:ee(v.InProgress),e=null,n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,te()];case 2:return t=n.sent(),e=re(t,C.Success),[3,5];case 3:return n.sent(),e=re(null,C.Error),[3,5];case 4:return ne(e),function(e){if(Object(K.b)(window))try{Object(K.d)(window,"ActionableMessages.ClientConfiguration",JSON.stringify(e))}catch(e){i.g.info("[ActionableMessageDebug] owa-actionable-message-connectors loadClientConfiguration setClientConfigurationInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}}(e),ee(v.Resolved),[7];case 5:return[2]}}))}))}));var ie=ae,oe=function(){A.requestState!==v.InProgress&&ie()},ce=function(){return Z()?JSON.parse(Object(K.a)(window,"ActionableMessages.ClientConfiguration")):null},se=function(){return A.cache.state},de=function(){return X()?($()&&oe(),se()===C.Success):Z()?(ne(ce()),ee(v.Resolved),$()&&oe(),se()===C.Success):(oe(),!1)},ue=function(){return A.cache},le=function(){var e,t,n=!1;if(de()){var r=ue();(null===(t=null===(e=null==r?void 0:r.data)||void 0===e?void 0:e.organizationConfigs)||void 0===t?void 0:t.SmtpActionableMessagesEnabled)&&(n=!0)}return n},fe=function(e,t){var n,r,a=!1;try{for(var i=Object(o.__values)(e),c=i.next();!c.done;c=i.next()){if(c.value.originator===t){a=!0;break}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},ge=function(e,t){var n,r,a=!1;if(de()){var i=ue();!t&&(null===(n=null==i?void 0:i.data)||void 0===n?void 0:n.providerConfigs)?a=fe(i.data.providerConfigs,e):t&&(null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.providerConfigsDarkMode)&&(a=fe(i.data.providerConfigsDarkMode,e))}return a},be="data:",pe="blob:";function me(e,t){var n=e.querySelectorAll('img:not([src^="cid:"])');if(n)for(var r=0;r<n.length;r++)0!==n[r].src.indexOf(be)&&0!==n[r].src.indexOf(pe)&&he(n[r],t.mailboxSmtpAddress)}function he(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(S.b)()];case 1:return r.sent(),e.src="/actions/"+t+"/th?u="+encodeURIComponent(e.src),[3,3];case 2:return n=r.sent(),i.g.warn("[ActionableMessageDebug] fixSrcForExternalImage: Error setting src value. Exception: "+n.message),[3,3];case 3:return[2]}}))}))}var ve="20000101001",Ce=window.location.origin+"/actions/theme";function Oe(e){return void 0===e&&(e="default"),Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,i,c;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,Object(S.b)()];case 1:t=o.sent(),n=function(e,t){var n={},r=Object(b.l)()?Object(b.l)():ve;return r=r.replace(/[^\d]/g,""),n.method="GET",n.headers=new Headers,n.headers.set("X-ClientType","owa"),n.headers.set("X-ClientVersion","16."+r.substr(0,4)+"."+r.substr(4,4)+"."+r.substr(8)),n.headers.set("X-ClientColorScheme",t),n.headers.set("Authorization","Bearer "+e),n}(t,e),r=void 0,o.label=2;case 2:return o.trys.push([2,7,,8]),[4,fetch(Ce,n)];case 3:return(a=o.sent())&&200==a.status?(i=ye,[4,a.text()]):[3,5];case 4:return[2,i.apply(void 0,[o.sent()])];case 5:r=a?a.status+"-"+a.statusText:"No response",o.label=6;case 6:return[3,8];case 7:return c=o.sent(),r=c.message,[3,8];case 8:throw r}}))}))}function ye(e){var t={};try{var n=JSON.parse(e).connectors;Object.keys(n).forEach((function(e){var r={themeConfigUrl:n[e],hostConfig:null,stylesheetUrl:null,isResolved:!1};t[e]=r}))}catch(e){i.g.warn("[ActionableMessageDebug] downloadThemeDefinition: error parsing response: "+e)}return t}var Ae={logTelemetry:function(e){var t,n=e.mailboxInfo,r=e.eventName,a=e.cardDetails,o=e.messageContext,c=e.correlationVector,s=e.elementDetails,d=e.actionContext,u=e.perfCheckpoints,l=n.type===x.a.GroupMailbox;if(u)try{t=q(u)}catch(e){i.g.warn("[ActionableMessageDebug] logTelemetry: exception when calculating genericInfo datapoint: "+e.message)}var f=h(r,a,l,o,c,t);return f.connectorSenderGuid=a.connectorSenderGuid,d&&(f.actionContext=d),s&&0===s.type.indexOf(D)&&(f.actionId=s.id?s.id:k,f.actionType=s.type),Object(j.o)("AdaptiveCardLogger-"+r,{CorrelationVector:c}),J(f,l?n.mailboxSmtpAddress:null),i.g.info("[logTelemetry] Log telemetry triggered"),f.correlationVector}},Ie={registerActions:function(){c.AdaptiveCard.actionTypeRegistry.unregisterType(f),c.AdaptiveCard.actionTypeRegistry.registerType(u,(function(){return new s(!1)}))},executeAction:function(e,t,n,r,a,o,c){return e instanceof s&&(R(e,n,t,a,c).then((function(e){i.g.info("[ActionableMessageDebug] onExecuteAction: executeHttpAction response: "+e),r(e)})),!0)},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"HttpPOST":return V(e)}return null},processAutoInvokeAction:function(e,t){if(e.type===u||e["@type"]===l){var n=void 0;return t.isAdaptiveCard?((n=new s(!1)).parse(e),n.hideCardOnInvoke=e.hideCardOnInvoke):n=V(e),n}return null},registerHostCapabilities:function(e){Object(Q.h)("rp-actionableMessages-aad-token")&&!Object(Y.a)()&&(e.AADAuthentication="*")}},je="CardLinkInteraction";function xe(e,t,n,r){i.g.info("[logAdaptiveCardLinkInteraction] Log event captured for link interaction on an adaptive card");var o=Object(a.d)(n);n.card&&o?Ae.logTelemetry({mailboxInfo:t,cardDetails:n,eventName:je+"_"+o,messageContext:r}):i.g.warn("[ActionableMessageDebug] logAdaptiveCardLinkInteraction: Cannot log link interaction - message card context is undefined")}var Se="00000000-0000-0000-0000-000000000000",Me="Highlight_";function we(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,c,s,d,u,l,f;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:try{t=JSON.parse(e)}catch(t){throw new Error("[ActionableMessageCard] parseCardProperty: unable to parse card data: "+e)}return n={connectorSenderGuid:t.ConnectorSenderGuid?t.ConnectorSenderGuid:Se,smtpAddressesSerialized:t.SmtpAddressesSerialized,providerAccountUniqueId:t.ProviderAccountUniqueId,messageCardExtensionContext:t.MessageCardExtensionContext},r=[],t.AdaptiveCardSerialized?(s=(c=r).push,[4,a.e.import().then((function(e){return e(n,t.AdaptiveCardSerialized,t.AdaptiveCardSignature,!0)}))]):[3,2];case 1:return s.apply(c,[o.sent()]),[3,5];case 2:return t.MessageCardSerialized?(u=(d=r).push,[4,a.e.import().then((function(e){return e(n,t.MessageCardSerialized,t.MessageCardSignature,!1)}))]):[3,4];case 3:return u.apply(d,[o.sent()]),[3,5];case 4:return i.g.info("[ActionableMessageCard] parseCardProperty: No serialized card present"),[2,[]];case 5:return f=(l=r).concat,[4,Ee(t,n)];case 6:return[2,f.apply(l,[o.sent()])]}}))}))}function Ee(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(o.__generator)(this,(function(c){switch(c.label){case 0:return n=[],[4,Promise.all(Object.keys(e).map((function(c){return Object(o.__awaiter)(r,void 0,void 0,(function(){var r,s,d,u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(!e.hasOwnProperty(c)||0!==c.indexOf(Me))return[3,4];r=e[c],o.label=1;case 1:return o.trys.push([1,3,,4]),s=JSON.parse(r),[4,a.e.import().then((function(e){return e(t,s.card,null)}))];case 2:return(d=o.sent()).isContextual=!0,d.key=s.id,d.highlightTerm=s.text,n.push(d),[3,4];case 3:return u=o.sent(),i.g.warn("[ActionableMessageDebug] RenderCard: unable to render hightlight card: "+u.message),[3,4];case 4:return[2]}}))}))})))];case 1:return c.sent(),[2,n]}}))}))}var Te=n(1347),ke=n(1466),De=n(2830),Re=n(492),Pe=n(424),_e="IOpenTypedFacet.Com.Microsoft.Graph.MessageCard",Fe="E550B918-9859-47B9-8095-97E4E72F1926";function Le(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,c;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),t=Object(Re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(Pe.a)(Fe,_e,"String")]}),[4,Object(Te.a)([e.ItemId.Id],t,null)];case 1:return n=o.sent(),Object(ke.a)(n[0])?(r=n[0],a=r.Items[0],(c=Object(De.a)(a,null,_e))?[4,we(c)]:[3,3]):[3,3];case 2:return[2,o.sent()];case 3:return[3,5];case 4:return o.sent(),[3,5];case 5:return i.g.info("[loadCardDetailsForItem] extendedProperty could not be retrieved"),[2,null]}}))}))}function Ne(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return e.adaptiveCardDetails?[2,e.adaptiveCardDetails]:[4,Le(e)];case 1:return[2,t.sent()||[]]}}))}))}var Ue=n(42),Be=Object(O.mutatorAction)("addCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails&&e.adaptiveCardDetails.length>0?i.g.info("[ActionableMessageDebug] addCardDetailsOnItem - item already has a card details"+e.adaptiveCardDetails):e.adaptiveCardDetails=t})),He=Object(O.mutatorAction)("updateCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails=t})),ze=Object(O.mutatorAction)("SET_SHOW_BODY_WITH_MESSAGE_CARD",(function(e,t){e?e.showBodyWithMessageCard=t:i.g.warn("[ActionableMessageDebug] setShowBodyWithMessageCard: viewState undefined")})),qe=Object(O.action)("showCardLoading",(function(e,t){return{viewState:e,showCardLoading:t}})),Ge=(Object(O.mutator)(qe,(function(e){e.viewState.showCardLoading=e.showCardLoading})),n(1692)),We=n(980),Je=n(9372),Ve=/url\("(.*)"\)/g,Qe=new Je.a(5,5e3),Ye=function(e,t,n){var r=e.querySelectorAll('img[src^="cid:"]');if(r)for(var a=0;a<r.length;a++)Ke(r[a],t,n);var i=e.querySelectorAll("div[style*='background-image: url(\"cid:']");if(i)for(a=0;a<i.length;a++)Xe(i[a],t,n)},Ke=function(e,t,n){if(e.src&&0===e.src.indexOf("cid:")){e.classList.add("ac-hidden");var r=$e(e.src,t,n);if(r){e.onload=function(t){e.classList.remove("ac-hidden"),Qe.processNextRequest()},e.onerror=function(t){e.classList.remove("ac-hidden"),Qe.processNextRequest()},Qe.registerCallback((function(t){t||(e.src=r)}))}}},Ze=function(){Qe.clearQueue()},Xe=function(e,t,n){var r=e.style.backgroundImage,a=Ve.exec(r);if(a&&a.length>1&&a[1]){var i=$e(a[1],t,n);i&&(e.style.backgroundImage=Object(M.c)('url("{0}")',i))}},$e=function(e,t,n){if(!t.Attachments)return null;for(var r,a=et(e.substring("cid:".length)),c=0;c<t.Attachments.length;c++){var s=t.Attachments[c];if(a===et(s.Name)||a===et(s.ContentId)){r=s.AttachmentId;break}}if(!r)return i.g.warn("[ActionableMessageDebug] fixSrcForImage: attachment id not found for cid: "+a),null;var d=Object(Ge.b)(Object(o.__assign)(Object(o.__assign)({},r),{mailboxInfo:n}),1);return d||(i.g.warn("[ActionableMessageDebug] fixSrcForImage: could not create attachment url for image with cid: "+a+" and attachment id: "+r),null)},et=function(e){if(Object(We.g)(e)){var t=Object(We.b)(e);return e.substring(0,e.length-t.length)}return e},tt=n(8057),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayAppointmentForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(c.Action),rt="Action.InvokeAddInCommand",at="Action.PinAddInCommand",it="Action.DisplayReplyAllForm",ot="Action.DisplayAppointmentForm",ct="Action.DisplayMessageForm",st="Action.StartBotConversation",dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getJsonTypeName=function(){return ct},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(c.Action),ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayReplyAllForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(c.Action),lt=function(e){function t(){var t=e.call(this)||this;return t.addinId="",t.desktopCommandId="",t.initializationContext="",t}return Object(o.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.addinId=t.addInId?t.addInId:t.addinid,this.desktopCommandId=t.desktopCommandId?t.desktopCommandId:t.desktopcommandid,this.initializationContext=t.initializationContext?JSON.stringify(t.initializationContext):JSON.stringify(t.initializationcontext)},t.prototype.getJsonTypeName=function(){return rt},t}(c.Action),ft=function(e){function t(){var t=e.call(this)||this;return t.productId="",t.newPinnedStatus=!1,t}return Object(o.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.productId=t.productId,this.newPinnedStatus=t.newPinnedStatus},t.prototype.getJsonTypeName=function(){return at},t}(c.Action),gt=function(e){function t(){var t=e.call(this)||this;return t.botId="",t.initialMessage="",t.botName="",t}return Object(o.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.botId=t.botId,this.botName=t.botName,this.initialMessage=t.initialMessage},t.prototype.getJsonTypeName=function(){return st},t}(c.Action),bt=n(1066),pt=n(1107),mt=n(975),ht=n(9799),vt=n(1332),Ct=n(3620),Ot=n(6674),yt=n(973),At=n(1032),It="MessageCardInvokeAddinCommandClicked",jt="MessageCardPinAddinCommandClicked",xt="DisplayAppointmentFormClicked",St="DisplayMessageFormClicked",Mt="actionContext";var wt={registerActions:function(){c.AdaptiveCard.actionTypeRegistry.registerType(rt,(function(){return new lt})),c.AdaptiveCard.actionTypeRegistry.registerType(at,(function(){return new ft})),c.AdaptiveCard.actionTypeRegistry.registerType(it,(function(){return new ut})),c.AdaptiveCard.actionTypeRegistry.registerType(ot,(function(){return new nt})),c.AdaptiveCard.actionTypeRegistry.registerType(ct,(function(){return new dt})),Object(Q.h)("mc-botConversation")&&c.AdaptiveCard.actionTypeRegistry.registerType(st,(function(){return new gt}))},executeAction:function(e,t,n,r,a,s,d){var u={id:e.id,type:e.getJsonTypeName()},l={mailboxInfo:a.mailboxInfo,cardDetails:t,elementDetails:u,messageContext:a,actionContext:e[Mt],eventName:void 0};if(e instanceof ut){i.g.info("[ActionableMessageDebug] onExecuteAction: reply all with: "+e.title);var f=yt.HtmlSanitizer.sanitizeHtml(e.title);vt.o.importAndExecute({referenceItemId:{Id:a.itemId,mailboxInfo:a.mailboxInfo},isReplyAll:!0,useFullCompose:!1,actionSource:"Link",instrumentationContexts:null,conversationId:a.conversationId,body:f})}else if(e instanceof nt){i.g.info("[ActionableMessageDebug] onExecuteAction: display appointment form for itemId: "+e.itemId),l.eventName=xt,s.logTelemetry(l);var g="/calendar/item/"+encodeURIComponent(e.itemId);window.open(g,"_blank")}else if(e instanceof dt)i.g.info("[AdaptiveCard] DisplayMessageFormAction executed"),l.eventName=St,s.logTelemetry(l),Object(Ct.a)(e.itemId);else if(e instanceof ft&&Object(Q.h)("addin-pinThroughAM")){i.g.info("[AdaptiveCard] PinAddinCommandAction executed"),l.eventName=jt,s.logTelemetry(l),function(e){var t,n,r=Object(At.s)().Extensions;try{for(var a=Object(o.__values)(r),i=a.next();!i.done;i=a.next()){var c=i.value;if(c.Id===e.productId){var s={readMode:null!=c.ExtensionPointCollection.MessageReadCommandSurface,composeMode:null!=c.ExtensionPointCollection.MessageComposeCommandSurface,calendarMode:null!=c.ExtensionPointCollection.AppointmentOrganizerCommandSurface&&null!=c.ExtensionPointCollection.AppointmentAttendeeCommandSurface};mt.h.importAndExecute(e.productId.toLowerCase(),e.newPinnedStatus,s);break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}(e)}else if(e instanceof lt){i.g.info("[AdaptiveCard] InvokeAddinCommandAction executed"),l.eventName=It,s.logTelemetry(l);var b=e,p=Object(bt.o)(a.itemId);bt.w.import().then((function(e){e(p,b.addinId.toLowerCase(),b.desktopCommandId,pt.a.MessageRead,b.initializationContext)}))}else if(e instanceof gt){var m=e,h=m.botId,v=m.botName,C=function(e){if(null==e?void 0:e.$data)return e.$data;return}(t.card);i.g.info("[ActionableMessageDebug] StartBotConversation executed with message: "+h),ht.a.import().then((function(e){return e(a.mailboxInfo,{friendlyBotName:v,botId:h,botData:C,connectorSenderGuid:t.connectorSenderGuid,smtpAddressSerialized:t.smtpAddressesSerialized},"help")})),s.logTelemetry(l)}else{if(!(e instanceof c.OpenUrlAction))return!1;if("mailto:"===(g=new URL(e.url)).protocol.toLowerCase()){var O=Object(Ot.a)(g.href).composeInitProps;vt.m.importAndExecute(O,2)}}return!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"].toLowerCase()){case"displayreplyallform":return n=e,(r=new ut).title=n.name,r.htmlBody=n.htmlBody,r;case"invokeaddincommand":return function(e){var t=new lt;return t.title=e.name,t.addinId=e.addInId,t.desktopCommandId=e.desktopCommandId,t.initializationContext=JSON.stringify(e.initializationContext),t}(e);case"pinaddincommand":return function(e){var t=new ft;return t.title=e.name,t.productId=e.productId,t.newPinnedStatus=e.newPinnedStatus,t}(e)}var n,r;return null},processAutoInvokeAction:function(e,t){if(Object(Q.h)("mc-botConversation")&&e.type===st){var n=new gt;return n.parse(e),n}return null},registerHostCapabilities:null},Et=n(14358),Tt=n(14359),kt=n(14360),Dt=n(342);var Rt,Pt=n(1),_t=n(14361),Ft=n(4363),Lt=n(95),Nt=n(1238),Ut=n(2838),Bt="ActionableMessageTeachingUI",Ht=""+Bt,zt={CLICK:Ht+"_BtnClicked",GOTITCUSTOM:Ht+"_GotItClicked",LEARN:Ht+"_LearnMoreClicked",TRIGGERED:Ht+"_Triggered",DISMISSED:{BTNSCT:Ht+"_DismisByAction",UNMNT:Ht+"_DismissByUnmount"},SCOPE:{MOUNTED:Ht+"_Mounted",UNMNTED:Ht+"_Unmounted"},DISABLED:Ht+"_FlightDisabled",RENDERED:Ht+"_Rendered"},qt={Transaction:"https://support.office.com/en-us/article/pay-bills-and-invoices-in-outlook-using-microsoft-pay-1196e7e6-c096-44f1-a18a-9df3af832a48"};function Gt(e,t){Object(j.o)(e,t),J(Object(o.__assign)({eventName:e,clientVersion:t.owaVersion,clientType:"WAC_Outlook_React"},t),null)}function Wt(e){if(e)try{i.g.info("[ActionableMessageTeachingUI] Corelation telemetry trace function called"),function(e){Rt=Rt||{correlationVector:"",adaptiveCardCorrelationId:"",owaVersion:"",messageId:"",lightningAction:"",tuiType:""},Object(Ut.a)(Rt,e)}(e)}catch(e){i.g.warn("[ActionableMessageDebug] teachingUITrace: Failed complete the logging of the telemetry - "+e.message)}return Rt&&(Rt.correlationVector=Rt?Object(g.b)():void 0),Rt}var Jt=Object(Nt.c)(Object(Ue.a)((function(e){e=Object(o.__assign)({hasSmallIcon:!0,hasSmallHeadline:!0,hasCloseIcon:!0,isWide:!0},e);var t=Object(o.__read)(Pt.useState(!0),2),n=t[0],r=t[1];Pt.useEffect((function(){return i.g.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble DidMount"),Gt("TeachingBubble_"+zt.SCOPE.MOUNTED,Wt()),function(){i.g.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble WillUnmountMount"),Gt("TeachingBubble_"+zt.SCOPE.UNMNTED,Wt())}}),[]);var a=function(t){void 0===t&&(t="Primary"),"Secondary"==t?(i.g.info("[ActionableMessageTeachingUI:TeachingBubble] teacing bubble dismissed by user interaction"),Gt("TeachingBubble_"+zt.CLICK,Wt({lightningAction:t}))):(i.g.info("[ActionableMessageTeachingUI:TeachingBubble] teaching bubble passively dismissed"),Gt("TeachingBubble_"+zt.DISMISSED.UNMNT,Wt({lightningAction:t}))),Object(Nt.d)(e.lid,t),r(!1)};return n&&(i.g.info("[ActionableMessageTeachingUI:TeachingBubble] Using TeachingBubble for ActionableMessageTeachingUI"),Gt("TeachingBubble_"+zt.RENDERED,Wt())),n&&Pt.createElement(Ft.a,Object(o.__assign)({calloutProps:{beakWidth:15,directionalHint:Lt.DirectionalHint.leftCenter,minPagePadding:50},targetElement:e.target(),primaryButtonProps:Object(o.__assign)(Object(o.__assign)({},e.gotItBtn),{onClick:function(){Gt("TeachingBubble_"+zt.GOTITCUSTOM,Wt({lightningAction:"Secondary"})),a("Secondary")}}),secondaryButtonProps:Object(o.__assign)(Object(o.__assign)({},e.learnMoreBtn),{onClick:function(){Gt("TeachingBubble_"+zt.LEARN,Wt({lightningAction:"Secondary"})),window.open(e.learnMoreBtnUri,"_blank"),a("Secondary")}}),onDismiss:function(){return e.onClose||a("Primary")}},e,{target:void 0}),e.bodyText)}))),Vt=n(2267),Qt=(n(289),Object(Ue.a)((function(e){Pt.useEffect((function(){var t;t={adaptiveCardCorrelationId:e.acCorrelationId,messageId:e.messageId,tuiType:e.actionType},Ht=Bt+"_",Wt({adaptiveCardCorrelationId:t.adaptiveCardCorrelationId,messageId:t.messageId,owaVersion:Object(b.l)(),lightningAction:"",tuiType:t.tuiType})}),[]);var t;return"Transaction"==e.actionType&&Pt.createElement(Jt,{target:e.target,when:function(e){Gt(zt.TRIGGERED,Wt()),e()},gotItBtn:(t="TeachingBubble",{buttonType:Vt.a.primary,children:Object(M.b)(_t.a),onClick:t}),learnMoreBtn:Yt("TeachingBubble"),learnMoreBtnUri:qt[e.actionType]||void 0,headline:Object(M.b)(_t.d),bodyText:Object(M.b)(_t.c),hasSmallHeadline:!0,lid:Nt.b.ActionableMessageTeachingUiTeachingBubblePolicy})})));function Yt(e){return{buttonType:Vt.a.normal,children:Object(M.b)(_t.b),onClick:e}}var Kt=n(6566),Zt=n(9822),Xt=(Object(O.mutator)(Zt.a,(function(e){Kt.a.cards.set(e.cardId,{autoInvokeActionAlreadyRan:!1})})),Object(O.mutator)(Zt.b,(function(e){Kt.a.cards.delete(e.cardId)})),Object(O.mutator)(Zt.c,(function(e){var t=Kt.a.cards.get(e.cardId);t?t.autoInvokeActionAlreadyRan=e.autoInvokeActionAlreadyRan:i.g.warn("[ActionableMessageDebug] setAutoInvokeActionAlreadyRanMutator: card is undefined for cardId "+e.cardId)})),n(115)),$t={XeroOpay:"Transaction"};function en(e){var t,n,r,a=void 0;if(i.g.info("[getCardTypeFromCardDetails] Fetching the card type"),null===(t=e.card)||void 0===t?void 0:t.messageCardContext){var o=e.card.messageCardContext;n=o.oamAppName,(r=$t[n])||i.g.warn("[ActionableMessageDebug] getCardType: Unable to fetch cardType for OamAppName "+n),a=r||"Unknown"}else i.g.warn("[ActionableMessageDebug] getCardTypeFromCardDetails: Cannot extract the context of an invalid CardDetails object");return a}var tn=n(10837);var nn=function(){function e(e,t,n,r){this.perfCheckpoints={currentCardCheckpoints:{},previousCardCheckpoints:{}},this.telemetryProvider=e,this.mailboxInfo=t,this.messageContext=n,this.perfData=r}return e.prototype.stampPerfCheckpoint=function(e,t){!function(e,t,n){var r=n||Object(H.Rb)();switch(t){case tn.a.LoadStart:e.loadStart=r;break;case tn.a.AutoInvokeActionStart:e.autoInvokeActionStart=r;break;case tn.a.AutoInvokeActionEnd:e.autoInvokeActionEnd=r;break;case tn.a.CardRenderStart:e.currentCardCheckpoints.cardRenderStart=r;break;case tn.a.CardRenderEnd:e.currentCardCheckpoints.cardRenderEnd=r;break;case tn.a.ThemeLoadTotalStart:e.currentCardCheckpoints.themeLoadTotalStart=r;break;case tn.a.ThemeLoadTotalEnd:e.currentCardCheckpoints.themeLoadTotalEnd=r;break;case tn.a.ThemeDefinitionsLoadStart:e.currentCardCheckpoints.themeDefinitionsLoadStart=r;break;case tn.a.ThemeDefinitionsLoadEnd:e.currentCardCheckpoints.themeDefinitionsLoadEnd=r;break;case tn.a.ThemeResolveStart:e.currentCardCheckpoints.themeResolveStart=r;break;case tn.a.ThemeResolveEnd:e.currentCardCheckpoints.themeResolveEnd=r;break;case tn.a.CardCreateStart:e.currentCardCheckpoints.cardCreateStart=r;break;case tn.a.CardCreateEnd:e.currentCardCheckpoints.cardCreateEnd=r;break;case tn.a.CardLibraryRenderStart:e.currentCardCheckpoints.cardLibraryRenderStart=r;break;case tn.a.CardLibraryRenderEnd:e.currentCardCheckpoints.cardLibraryRenderEnd=r;break;case tn.a.PrepareCardStart:e.currentCardCheckpoints.prepareCardStart=r;break;case tn.a.PrepareCardEnd:e.currentCardCheckpoints.prepareCardEnd=r;break;default:i.g.info("Actionable Message Card: markPerfCheckpointMutator called with unespected PerfMarker")}}(this.perfCheckpoints,e,t)},e.prototype.logTelemetryProvider=function(e,t,n,r,a){var i=this.getTelemetryDetailsForEvent(e,t,n,r,a);this.telemetryProvider.logTelemetry(i)},e.prototype.setTotalFetchTimeForCard=function(){this.perfCheckpoints&&this.perfCheckpoints.currentCardCheckpoints&&(this.perfCheckpoints.currentCardCheckpoints.totalFetchTime=Object(H.w)(this.perfData.fetchEndTime,this.perfData.fetchStartTime))},e.prototype.getTelemetryDetailsForEvent=function(e,t,n,r,a){return{mailboxInfo:this.mailboxInfo,messageContext:this.messageContext,cardDetails:e,eventName:t,actionContext:n,elementDetails:r,correlationVector:a,perfCheckpoints:this.perfCheckpoints}},e.prototype.updatePerfCheckpointsBeforeUpdatingAutoInvokeResponse=function(){this.perfCheckpoints&&(this.perfCheckpoints.previousCardCheckpoints=this.perfCheckpoints.currentCardCheckpoints,this.perfCheckpoints.currentCardCheckpoints={})},e}();n(435);var rn=new Xt.c((function(){return Promise.all([n.e(6),n.e(8),n.e(21),n.e(694),n.e(113)]).then(n.bind(null,15558))})),an=Object(Xt.d)(rn,(function(e){return e.ActionableMessageCardWrapper})),on=(new Xt.b(rn,(function(e){return e.parseCardFromStringOrObject})),"TransactionCardDisabled"),cn="messageCardContext";function sn(e,t,n,r,i){var o=e.card;if(o&&o.hasOwnProperty(cn)){if(!o.messageCardContext)return!1;var c=Object(a.d)(e)===a.b.XeroOpay&&n;return c&&i.logTelemetry({mailboxInfo:t,messageContext:r,eventName:on,cardDetails:e}),c}return!1}var dn="Action.Transaction",un=n(1643),ln=n(165),fn=n(14362),gn={PPE:"https://interactive-ppe.outlook.com/ux/app",PROD:"https://interactive.outlook.com/ux/app",DEV:"https://opay-dev-wc-svc.cloudapp.net/ux/app"},bn=function(e){function t(){var t=e.call(this)||this;return t.environment="prod",t.triggerContext=null,t.intent="",t.merchantId="",t.displayId="",t}return Object(o.__extends)(t,e),t.prototype.getJsonTypeName=function(){return dn},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,t.initializationContext?(this.intent=t.initializationContext.intent,this.merchantId=t.initializationContext.merchantId,this.displayId=t.initializationContext.displayId,this.productContext=t.initializationContext.productContext,this.environment=t.initializationContext.environment):(this.intent=t.intent,this.merchantId=t.merchantId,this.displayId=t.displayId,this.productContext=t.productContext,this.environment=t.environment),this.triggerContext={MerchantId:this.merchantId,DisplayId:this.displayId,CorrelationId:Object(g.b)(),Culture:Object(p.a)().SessionSettings.UserCulture,Market:Object(un.g)(),Environment:this.environment},ln.set("DefaultAnchorMailbox",ln.get("DefaultAnchorMailbox"),{path:"/actions/"}),Object(Q.h)("ring-dogfood")&&ln.set("DefaultAnchorMailbox",ln.get("DefaultAnchorMailbox"),{path:"/opay/"})},t.prototype.execute=function(){e.prototype.execute.call(this),this.triggerContext.CorrelationId=Object(g.b)()},t.prototype.getIFrameElement=function(){var e=Object(Q.h)("rp-opay-modelb-endpoint")?window.location.origin+"/opay":this.getSvcEndpoint(),t=encodeURIComponent(JSON.stringify(this.productContext)),n=e+"/?triggerContext="+encodeURIComponent(JSON.stringify(this.triggerContext))+"&productContext="+t;return Pt.createElement("div",{className:fn.opayFlexPaneContainer},Pt.createElement("iframe",{id:"opay_iframe",className:fn.opayAppIFrameStyle,src:n}))},t.prototype.getSvcEndpoint=function(){return this.environment?0===this.environment.indexOf("dev")?gn.DEV:"ppe"===this.environment.toLowerCase()?gn.PPE:gn.PROD:gn.PROD},t}(c.Action),pn={shouldShowModalFlexPane:!1,modalFlexPaneContent:void 0},mn=Object(O.createStore)("OPayPanel",pn)(),hn=Object(O.mutatorAction)("SHOW_OPAY_PANEL",(function(e){mn.shouldShowModalFlexPane=!0,mn.modalFlexPaneContent=e})),vn="TransactionActionEvent",Cn="actionContext";var On={registerActions:function(){c.AdaptiveCard.actionTypeRegistry.registerType(dn,(function(){return new bn}))},executeAction:function(e,t,n,r,a,o,c){if(!(e instanceof bn))return!1;i.g.info("[ActionableMessageDebug] Transaction executed");var s=e,d={id:s.id,type:s.getJsonTypeName()};return o.logTelemetry({mailboxInfo:a.mailboxInfo,cardDetails:t,elementDetails:d,eventName:vn,actionContext:e[Cn],messageContext:a,correlationVector:s.triggerContext.CorrelationId}),hn(s.getIFrameElement()),!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"Transaction":return n=e,(r=new bn).parse(n),r.title=n.name,r}var n,r;return null},registerHostCapabilities:function(e){e.Transaction="*",e["Transaction.MSA"]="*"}},yn=n(2548),An=n(923),In=n(269),jn=n(1249),xn=Object(O.mutatorAction)("HIDE_OPAY_PANEL",(function(){mn.shouldShowModalFlexPane=!1,mn.modalFlexPaneContent=void 0})),Sn=Object(Ue.a)((function(e){return Object(jn.a)("message",(function(t){var n=t.origin.toLowerCase();if(Object.keys(gn).some((function(e){return 0!==gn[e].indexOf(n)}))){var r=null;try{r=JSON.parse(t.data)}catch(e){i.g.warn("Unable to parse post message data: "+t.data)}if(r){var a=r.action;if(a)switch(a){case"close":xn();break;case"token":Object(S.a)().then((function(t){var r=document.querySelector("#opay_iframe");r&&r.contentWindow.postMessage(JSON.stringify({action:"token",token:t,messageContext:{messageId:e.odataItemId,smtpAddressesSerialized:e.smtpAddressesSerialized},result:"Success"}),n)})).catch((function(){window.postMessage(JSON.stringify({action:"token",result:"Failed"}),n)}))}}}})),Pt.createElement(An.a,{key:"modalFlexPane",onDismiss:function(){xn()},isOpen:mn.shouldShowModalFlexPane,type:In.a.smallFixedFar,closeButtonAriaLabel:Object(M.b)(yn.a)},mn.modalFlexPaneContent)})),Mn=n(1770),wn="62242e1d-c39a-4f8a-a66e-1d39c0a336b0";function En(e){return!Object(Q.h)(Mn.b)&&e===wn}var Tn={ComponentDidMount:"11",ComponentWillUnMount:"12",ComponentDidUpdate:"13",FetchInProgress:"14",CardDetailsPresent:"15",FetchInitiated:"16",NotUpdatingCardDetailsAsItAlreadyPresent:"17",FetchSuccess:"18",CardId:"19",ItemId:"110",FetchError:"111",FetchException:"112",RenderCard:"113",NoCard:"114",ShowMessage:"115",UpdateOnItem:"116",UpdateLoadingState:"117",FinishLoading:"118",Render:"119"},kn=n(10838),Dn=Object(Ue.a)((function(e){var t,n,r=this,a=e.actionableMessageLoggingHandler;Pt.useEffect((function(){return a.log(Tn.ComponentDidMount),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper mount"),function(){Ze(),a.log(Tn.ComponentWillUnMount),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper unmount")}}),[]),Pt.useEffect((function(){a.log(Tn.ComponentDidUpdate),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper update"),C()})),Pt.useEffect((function(){return l.current=setTimeout((function(){i.g.info("[ActionableMessageDebug] ActionableMessageContent card load timed out"),Object(j.o)("actionableMessageContentLoadTimeout"),f.current=!0,T(!0)}),4e3),function(){return clearTimeout(l.current)}}),[]);var c=Pt.useRef(Object(tt.a)(e.item)),s=Pt.useRef({loadStartTime:Object(H.Rb)()}),d=Pt.useRef([]),u=Pt.useRef(),l=Pt.useRef(),f=Pt.useRef(),g=Object(o.__read)(Pt.useState(!1),2),b=g[0],p=g[1],m=Object(o.__read)(Pt.useState(null),2),h=m[0],v=m[1],C=function(){return Object(o.__awaiter)(r,void 0,void 0,(function(){var t,n,r,c,d,l,f,g,b;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(u.current)return a.log(Tn.FetchInProgress),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetch already in process. Aborting this attempt"),[2];if(t=e.item,s.current.fetchStartTime=Object(H.Rb)(),(n=t.adaptiveCardDetails)&&n.length>0)return a.log(Tn.CardDetailsPresent+":"+(null===(f=n[0].cardId)||void 0===f?void 0:f.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties already had cardDetails on the item. cardId: "+n[0].cardId),s.current.fetchEndTime=Object(H.Rb)(),[2];r=new j.a("MCActionableCardGetProperty"),o.label=1;case 1:return o.trys.push([1,3,4,5]),u.current=!0,a.log(Tn.FetchInitiated),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetching cardDetails from the server"),[4,Ne(t)];case 2:return c=o.sent(),(d=t.adaptiveCardDetails)&&d.length>0?(a.log(Tn.NotUpdatingCardDetailsAsItAlreadyPresent+":"+(null===(g=d[0].cardId)||void 0===g?void 0:g.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties not updating the details as its already present"+c[0].cardId)):c&&c.length>0?(r.end(),s.current.fetchEndTime=Object(H.Rb)(),a.log(Tn.FetchSuccess),a.log(Tn.CardId+":"+(null===(b=c[0].cardId)||void 0===b?void 0:b.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties got card details from the server. cardId: "+c[0].cardId),Be(t,c)):(a.log(Tn.FetchError),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),T(!0),r.endWithError("ServerError")),[3,5];case 3:return l=o.sent(),a.log(Tn.FetchException),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),i.g.warn("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties: exception during getCardDetails: "+l.message),T(!0),r.endWithError("ClientError"),[3,5];case 4:return u.current=!1,[7];case 5:return[2]}}))}))},O=function(e){return e.filter((function(e){return!e.isContextual}))},y=function(t){var n,r=O(t),o={onUndo:function(){return t=e.darkModeContentHandler,n=e.undoDarkMode,void(t&&n&&(i.g.info("ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(d.current),d.current=[]));var t,n},onApply:function(t){return function(t){var n=e.undoDarkMode,r=e.darkModeContentHandler;if(t&&r&&!n)if(i.g.info("ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),r.cssSelector){r.handler(t),d.current.push(t);var a=t.querySelectorAll(r.cssSelector);if(a)for(var o=0;o<a.length;o++){var c=a.item(o);r.handler(c),d.current.push(c)}}else i.g.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")}(t)}},u=new nn(Ae,e.item.MailboxInfo,c.current,s.current);return r&&1===r.length&&function(t){var n,r=!0,a=null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.originator;return a||(a=null==t?void 0:t.connectorSenderGuid),a&&(r=!ge(a,e.isDarkMode)),r}(r[0])?(a.log(Tn.RenderCard+":"+(null===(n=r[0].cardId)||void 0===n?void 0:n.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails. cardId: "+r[0].cardId),Pt.createElement("div",{className:kn.container},Pt.createElement(an,{key:r[0].cardId,cardDetails:r[0],showMessageBodyCallback:A,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[wt,Ie,On],adjustCardElementBeforeRenderCallback:S,onCardRendered:w,downloadThemeCallback:Oe,onCardDetailsUpdated:I,actionableMessageContentHandler:o,actionableMessageCardStrings:{cardDefinitionsStrings:{format:M.c,actionInProgressMessage:Object(M.b)(Et.a),defaultPlaceholderTextInput:Object(M.b)(Et.b),warningMessageForInvalidInput:Object(M.b)(Et.c),warningMessageForMissingRequiredInput:Object(M.b)(Et.d),warningMessageForInputNumberNotNumeric:Object(M.b)(Tt.c),warningMessageForInputNumberLessThanMax:Object(M.b)(Tt.a),warningMessageForInputNumberMoreThanMin:Object(M.b)(Tt.b),warningMessageForRequiredField:Object(M.b)(kt.a)},dateStrings:Object(Dt.a)()},telemetryHandler:u,loggingHandler:a}))):(a.log(Tn.NoCard),i.g.info("Did not find expected number of cards on the message"),A(!0),Pt.createElement("div",null))},A=function(t){a.log(Tn.ShowMessage),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper setShowMessageBody: "+t),ze(e.viewState,t),t&&qe(e.viewState,!1),T(t)},I=function(t){a.log(Tn.UpdateOnItem),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper updateCardOnItem"),He(e.item,t)},x=function(){var t=e.item.adaptiveCardDetails;if(t&&t.length>0){var n=t[0].card.messageCardContext;return n?{acCorrelationId:n.correlationId,actionType:en(t[0]),messageId:e.item.ItemId.Id,target:function(){return h}}:{acCorrelationId:"",actionType:void 0,messageId:null,target:function(){return h}}}return null},S=function(t){i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper fixInlineImages"),me(t,e.item.MailboxInfo),Ye(t,e.item,e.item.MailboxInfo)},w=function(t){a.log(Tn.UpdateLoadingState),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper  onCardRendered. Updating loading state"),h!==t&&(p(!0),v(t),T(!1)),e.viewState.showCardLoading&&qe(e.viewState,!1)},E=function(e){return(null==e?void 0:e.actionType)&&null!=e.target?(i.g.info("[ActionableMessageCard] TeachingUI triggered"),Pt.createElement(Qt,Object(o.__assign)({},e))):null},T=function(t){a.log(Tn.FinishLoading),i.g.info("[ActionableMessageDebug] Finish Loading - forceShowMessageBody:"+t),l.current&&(clearTimeout(l.current),l.current=null);var n=e.viewState;qe(n,!1),t&&ze(n,!0)},k=e.item.adaptiveCardDetails;a.log(Tn.Render),a.log(Tn.CardId+":"+((null==k?void 0:k[0])?null===(n=null===(t=k[0])||void 0===t?void 0:t.cardId)||void 0===n?void 0:n.slice(0,8):" ")),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper render. itemId: "+e.item.ItemId.Id+". CardDetails: "+((null==k?void 0:k[0])?k[0].cardId:"undefined"));var D=k&&k.length>0,R=D&&En(k[0].connectorSenderGuid);return D?R||0!==function(t){var n=O(t);return n=n.filter((function(t){return sn(t,e.item.MailboxInfo,Object(Q.h)("rp-acDisableTransactionCard"),c.current,Ae)}))}(k).length?(T(!0),null):function(e){return f.current&&T(!0),!f.current&&Pt.createElement(Pt.Fragment,null,Pt.createElement("div",{className:kn.cardArea},y(e)),Pt.createElement(Sn,{odataItemId:c.current.odataItemId,smtpAddressesSerialized:e[0].smtpAddressesSerialized}),b&&E(e?x():null))}(k):null})),Rn=n(10838),Pn=Object(Ue.a)((function(e){var t,n,r=this,c=e.actionableMessageLoggingHandler;Pt.useEffect((function(){return c.log(Tn.ComponentDidMount),i.g.info("[ActionableMessageDebug] ActionableMessageContent mount"),function(){Ze(),c.log(Tn.ComponentWillUnMount),i.g.info("[ActionableMessageDebug] ActionableMessageContent unmount")}}),[]),Pt.useEffect((function(){c.log(Tn.ComponentDidUpdate),i.g.info("[ActionableMessageDebug] ActionableMessageContent update"),A()})),Pt.useEffect((function(){return b.current=setTimeout((function(){i.g.info("[ActionableMessageDebug] ActionableMessageContent card load timed out"),Object(j.o)("actionableMessageContentLoadTimeout"),p.current=!0,D(!0)}),4e3),function(){return clearTimeout(b.current)}}),[]);var s=Pt.useRef(Object(tt.a)(e.item)),d=Pt.useRef(Object(H.Rb)()),u=Pt.useRef(),l=Pt.useRef(),f=Pt.useRef([]),g=Pt.useRef(),b=Pt.useRef(),p=Pt.useRef(),m=Object(o.__read)(Pt.useState(!1),2),h=m[0],v=m[1],C=Object(o.__read)(Pt.useState(null),2),O=C[0],y=C[1],A=function(){return Object(o.__awaiter)(r,void 0,void 0,(function(){var t,n,r,a,s,d,f,b,p;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(g.current)return c.log(Tn.FetchInProgress),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties fetch already in process. Aborting this attempt"),[2];if(t=e.item,u.current=Object(H.Rb)(),(n=t.adaptiveCardDetails)&&n.length>0)return c.log(Tn.CardDetailsPresent+":"+(null===(f=n[0].cardId)||void 0===f?void 0:f.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties already had cardDetails on the item. cardId: "+n[0].cardId),l.current=Object(H.Rb)(),[2];r=new j.a("MCActionableCardGetProperty"),o.label=1;case 1:return o.trys.push([1,3,4,5]),g.current=!0,c.log(Tn.FetchInitiated),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties fetching cardDetails from the server"),[4,Ne(t)];case 2:return a=o.sent(),(s=t.adaptiveCardDetails)&&s.length>0?(c.log(Tn.NotUpdatingCardDetailsAsItAlreadyPresent+":"+(null===(b=s[0].cardId)||void 0===b?void 0:b.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties not updating the details as its already present"+a[0].cardId)):a&&a.length>0?(r.end(),l.current=Object(H.Rb)(),c.log(Tn.FetchSuccess),c.log(Tn.CardId+":"+(null===(p=a[0].cardId)||void 0===p?void 0:p.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties got card details from the server. cardId: "+a[0].cardId),Be(t,a)):(c.log(Tn.FetchError),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),D(!0),r.endWithError("ServerError")),[3,5];case 3:return d=o.sent(),c.log(Tn.FetchException),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties error getting card details from the server"),i.g.warn("[ActionableMessageDebug] ActionableMessageContent getCardProperties: exception during getCardDetails: "+d.message),D(!0),r.endWithError("ClientError"),[3,5];case 4:return g.current=!1,[7];case 5:return[2]}}))}))},I=function(e){return e.filter((function(e){return!e.isContextual}))},x=function(t){var n,r=I(t),o={onUndo:function(){return t=e.darkModeContentHandler,n=e.undoDarkMode,void(t&&n&&(i.g.info("ActionableMessageContent: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(f.current),f.current=[]));var t,n},onApply:function(t){return function(t){var n=e.undoDarkMode,r=e.darkModeContentHandler;if(t&&r&&!n)if(i.g.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),r.cssSelector){r.handler(t),f.current.push(t);var a=t.querySelectorAll(r.cssSelector);if(a)for(var o=0;o<a.length;o++){var c=a.item(o);r.handler(c),f.current.push(c)}}else i.g.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")}(t)}};return r&&1===r.length&&function(t){var n,r=!0,a=null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.originator;return a||(a=null==t?void 0:t.connectorSenderGuid),a&&(r=!ge(a,e.isDarkMode)),r}(r[0])?(c.log(Tn.RenderCard+":"+(null===(n=r[0].cardId)||void 0===n?void 0:n.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageContent renderCardFromDetails. cardId: "+r[0].cardId),Pt.createElement("div",{className:Rn.container},Pt.createElement(a.a,{key:r[0].cardId,cardDetails:r[0],mailboxInfo:e.item.MailboxInfo,messageContext:s.current,showMessageBodyCallback:S,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[wt,Ie,On],telemetryProvider:Ae,loggingHandler:c,adjustCardElementBeforeRenderCallback:E,onCardRendered:T,downloadThemeCallback:Oe,onCardDetailsUpdated:M,perfData:{loadStartTime:d.current,fetchStartTime:u.current,fetchEndTime:l.current},actionableMessageContentHandler:o}))):(c.log(Tn.NoCard),i.g.info("Did not find expected number of cards on the message"),S(!0),Pt.createElement("div",null))},S=function(t){c.log(Tn.ShowMessage),i.g.info("[ActionableMessageDebug] ActionableMessageContent setShowMessageBody: "+t),ze(e.viewState,t),t&&qe(e.viewState,!1),D(t)},M=function(t){c.log(Tn.UpdateOnItem),i.g.info("[ActionableMessageDebug] ActionableMessageContent updateCardOnItem"),He(e.item,t)},w=function(){var t=e.item.adaptiveCardDetails;if(t&&t.length>0){var n=t[0].card.messageCardContext;return n?{acCorrelationId:n.correlationId,actionType:Object(a.d)(t[0]),messageId:e.item.ItemId.Id,target:function(){return O}}:{acCorrelationId:"",actionType:void 0,messageId:null,target:function(){return O}}}return null},E=function(t){i.g.info("[ActionableMessageDebug] ActionableMessageContent fixInlineImages"),me(t,e.item.MailboxInfo),Ye(t,e.item,e.item.MailboxInfo)},T=function(t){c.log(Tn.UpdateLoadingState),i.g.info("[ActionableMessageDebug] ActionableMessageContent onCardRendered. Updating loading state"),O!==t&&(v(!0),y(t),D(!1)),e.viewState.showCardLoading&&qe(e.viewState,!1)},k=function(e){return(null==e?void 0:e.actionType)&&null!=e.target?(i.g.info("[ActionableMessageDebug] TeachingUI triggered"),Pt.createElement(Qt,Object(o.__assign)({},e))):null},D=function(t){c.log(Tn.FinishLoading),i.g.info("[ActionableMessageDebug] Finish Loading - forceShowMessageBody:"+t),b.current&&(clearTimeout(b.current),b.current=null);var n=e.viewState;qe(n,!1),t&&ze(n,!0)},R=e.item.adaptiveCardDetails;c.log(Tn.Render+":"+((null==R?void 0:R[0])?null===(n=null===(t=R[0])||void 0===t?void 0:t.cardId)||void 0===n?void 0:n.slice(0,8):" ")),i.g.info("[ActionableMessageDebug] ActionableMessageContent render. itemId: "+e.item.ItemId.Id+". CardDetails: "+((null==R?void 0:R[0])?R[0].cardId:"undefined"));var P=R&&R.length>0,_=P&&En(R[0].connectorSenderGuid);return P?_||0!==function(t){var n=I(t);return n=n.filter((function(t){return sn(t,e.item.MailboxInfo,Object(Q.h)("rp-acDisableTransactionCard"),s.current,Ae)}))}(R).length?(D(!0),null):function(e){return p.current&&D(!0),!p.current&&Pt.createElement(Pt.Fragment,null,Pt.createElement("div",{className:Rn.cardArea},x(e)),Pt.createElement(Sn,{odataItemId:s.current.odataItemId,smtpAddressesSerialized:e[0].smtpAddressesSerialized}),h&&k(e?w():null))}(R):null}));n.d(t,"logAdaptiveCardLinkInteraction",(function(){return xe})),n.d(t,"getCardDetails",(function(){return Ne})),n.d(t,"ActionableMessageMailWrapper",(function(){return Dn})),n.d(t,"ActionableMessageContent",(function(){return Pn})),n.d(t,"doesActionableMessageEnabled",(function(){return le}))},1643:function(e,t,n){"use strict";var r=n(999),a=["AT","BE","BG","CH","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HR","HU","IE","IS","IT","LI","LT","LU","LV","MT","NL","NO","PL","PT","RO","SE","SI","SK"];function i(){var e=Object(r.h)(Object(r.e)());return a.indexOf(e)>=0}var o=n(76);function c(){var e;return(Object(o.h)("fwk-gdprAdsV3Tcf")||Object(o.h)("fwk-gdprAdsV3-freString1")||Object(o.h)("fwk-gdprAdsV3-freString2")||Object(o.h)("fwk-gdprAdsV3-freString3")||Object(o.h)("fwk-gdprAdsV3-freString4")||Object(o.h)("fwk-gdprAdsV3-freString5")||Object(o.h)("fwk-gdprAdsV3-freString6"))&&(e=!0),e}var s,d={};function u(e,t){return void 0===t&&(t=!0),d[e]&&s&&-1!=s.indexOf(e)||(d[e]=new Promise((function(n,r){var a=window.document.createElement("script");a.src=e,a.type="text/javascript",t&&(a.crossOrigin="anonymous"),a.onload=function(){s?s.push(e):s=[e],n()},a.onerror=function(){r("OnError "+e)},window.document.head.appendChild(a)}))),d[e]}var l,f,g,b,p=n(94),m=n(26),h=["en-us","en-gb","en-ca","en-au"];function v(){if(!l){var e=Object(r.e)();l=Object(o.h)("fwk-nativeAds-bingOneClickOtherInboxOnly")&&h.indexOf(e)>-1?0:2}return l}function C(e){return O(e)?!Object(o.h)("fwk-nativeAds-honorEasyOtherOffKillSwitch")&&8&Object(m.a)().ViewStateConfiguration.FocusedInboxBitFlags||!Object(o.h)("fwk-ads-exp2-RuntimeBypass")&&("DisplayOffNativeInbox"==b||"DisplayOnNativeInbox"==b)?2:1:0}function O(e){return void 0!==f?f:(f=!1,Object(p.u)()?(g=Object(r.e)(),Object(o.h)("fwk-nativeAds-bingOneClickOtherInboxOnly")||Object(o.h)("fwk-nativeAds-prebidOneClickOtherInboxOnly")||Object(o.h)("fwk-nativeAds-appNexusOneClickOtherInboxOnly")?Object(r.b)()?f:Object(r.c)()?f:Object(r.a)()?f:r.d.indexOf(g)>-1?f:y()?f:f=!0:f):f)}function y(){return b=Object(m.a)().UserOptions.ConsumerAdsExperimentMode,!(Object(o.h)("fwk-ads-exp2-RuntimeBypass")||"DisplayOffNativeOff"!=b&&"DisplayOnNativeOff"!=b)}n.d(t,"q",(function(){return i})),n.d(t,"r",(function(){return c})),n.d(t,"s",(function(){return u})),n.d(t,"e",(function(){return y})),n.d(t,"m",(function(){return O})),n.d(t,"o",(function(){return v})),n.d(t,"n",(function(){return C})),n.d(t,"a",(function(){return h})),n.d(t,"f",(function(){return r.d})),n.d(t,"g",(function(){return r.e})),n.d(t,"h",(function(){return r.f})),n.d(t,"j",(function(){return r.h})),n.d(t,"k",(function(){return r.i})),n.d(t,"l",(function(){return r.j})),n.d(t,"p",(function(){return r.k})),n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"t",(function(){return r.l})),n.d(t,"i",(function(){return r.g}))},1770:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r="cal-txp-invoice",a="cal-txp-serviceReservationAdaptive"},1843:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(118),a=n(1277);function i(e,t){Object.keys(a.a).some((function(n){return a.a[n]==t&&(Object(r.h)(e,{key:n,id:t},{isCore:!0}),!0)}))}},2548:function(e){e.exports=JSON.parse('{"a":"QQb"}')},264:function(e){e.exports=JSON.parse('{"k":"sBa","h":"tBa","m":"uBa","j":"vBa","l":"wBa","i":"xBa","d":"yBa","b":"zBa","f":"ABa","g":"BBa","e":"CBa","a":"DBa","c":"EBa","n":"FBa","r":"GBa","q":"HBa","o":"IBa","p":"JBa"}')},342:function(e,t,n){"use strict";var r=n(636),a=n(637),i=n(638),o=n(639),c=n(640),s=n(641),d=n(642),u=n(618),l=n(619),f=n(620),g=n(621),b=n(622),p=n(623),m=n(624),h=n(625),v=n(626),C=n(627),O=n(628),y=n(629),A=n(264),I=n(674),j=n(654),x=n(655),S=n(656),M=n(657),w=n(658),E=n(659),T=n(660),k=n(661),D=n(662),R=n(663),P=n(664),_=n(665),F=n(10),L=n(23),N=function(){return U.get()},U=Object(L.computed)((function(){return{months:[Object(F.b)(y.a),Object(F.b)(O.a),Object(F.b)(C.a),Object(F.b)(v.a),Object(F.b)(h.a),Object(F.b)(m.a),Object(F.b)(p.a),Object(F.b)(b.a),Object(F.b)(g.a),Object(F.b)(f.a),Object(F.b)(l.a),Object(F.b)(u.a)],shortMonths:[Object(F.b)(_.a),Object(F.b)(P.a),Object(F.b)(R.a),Object(F.b)(D.a),Object(F.b)(k.a),Object(F.b)(T.a),Object(F.b)(E.a),Object(F.b)(w.a),Object(F.b)(M.a),Object(F.b)(S.a),Object(F.b)(x.a),Object(F.b)(j.a)],days:[Object(F.b)(d.a),Object(F.b)(s.a),Object(F.b)(c.a),Object(F.b)(o.a),Object(F.b)(i.a),Object(F.b)(a.a),Object(F.b)(r.a)],shortDays:[Object(F.b)(A.d),Object(F.b)(A.b),Object(F.b)(A.f),Object(F.b)(A.g),Object(F.b)(A.e),Object(F.b)(A.a),Object(F.b)(A.c)],goToToday:Object(F.b)(I.a),prevMonthAriaLabel:Object(F.b)(A.k),nextMonthAriaLabel:Object(F.b)(A.h),prevYearAriaLabel:Object(F.b)(A.m),nextYearAriaLabel:Object(F.b)(A.j),prevYearRangeAriaLabel:Object(F.b)(A.l),nextYearRangeAriaLabel:Object(F.b)(A.i),monthPickerHeaderAriaLabel:Object(F.b)(A.n),yearPickerHeaderAriaLabel:Object(F.b)(A.r),weekNumberFormatString:Object(F.b)(A.q),selectedDateFormatString:Object(F.b)(A.o),todayDateFormatString:Object(F.b)(A.p)}})),B=n(94),H=function(e,t){return e?e.tz:t||Object(B.q)()},z=n(7),q=function(e,t){return Object(z.Rb)(e,t.getFullYear(),t.getMonth(),t.getDate())};n.d(t,"a",(function(){return N})),n.d(t,"c",(function(){return H})),n.d(t,"b",(function(){return q}))},3620:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(76),i=n(1409),o=n(975),c=n(491);function s(e,t,n,s){var d=Object(c.e)(n,e,null,t),u=Object(r.__assign)(Object(r.__assign)({},s),{includeFluidOnPopout:Object(o.d)(o.a.Bohemia).bohemiaEnabled&&Object(a.h)("cmp-prague")&&Object(i.a)()});Object(c.c)("mail",d,u,{resizable:!0})}},4731:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1032);function a(e,t){var n=Object(r.n)(t);return!!n&&n.get_Id()===e+"ItemSend"}},5546:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(7524),a=n(23),i=[{id:"ja7lKjj2NnQ.cwA.Krg.hfkh3ftaMUOb57AnI3gEJw-TZrkxQd1glDepIPKj6yo",tokenType:r.a.ConnectorsLTI},{id:"hXP0lB4sF4E.ihaAU12Q9puBSDe5dMnr8RITJalvWkCqiQadGVOHmIc",tokenType:r.a.AAD}],o=Object(a.computed)((function(){var e=new a.ObservableMap;return i.forEach((function(t){e.set(t.id,t)})),e}))},6403:function(e,t,n){"use strict";function r(e){var t=e&&e.Action;return t&&!!t.SourceLocation}function a(e){var t=e&&e.Action;return t&&!!t.FunctionName}function i(e){return!!e&&!!e.MenuItems}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},6566:function(e,t,n){"use strict";var r=n(23),a=n(4),i={themeStore:{loadStatus:0,themeMapping:{}},cards:new r.ObservableMap},o=Object(a.createStore)("ActionableMessageV2",i);t.a=o()},674:function(e){e.exports=JSON.parse('{"a":"rBa"}')},7524:function(e,t,n){"use strict";var r;!function(e){e.NoAuth="NoAuth",e.ConnectorsLTI="ConnectorsLTI",e.AAD="AAD"}(r||(r={})),t.a=r},9372:function(e,t,n){"use strict";var r=n(75),a=function(){function e(e,t){var n=this;void 0===e&&(e=5),void 0===t&&(t=5e3),this.throttleCallbacks=[],this.activeRequests=0,this.processedRequests=0,this.lastProcessedRequests=0,this.watchDogTimer=null,this.clearQueue=function(){n.throttleCallbacks.length=0,n.activeRequests=0},this.maxConcurrentRequests=e,this.watchDogTimerInterval=t}return e.prototype.watchDogAction=function(){this.throttleCallbacks.length>0?this.processedRequests===this.lastProcessedRequests?(this.activeRequests=0,this.traceInfo("Watch dog is processing the queue."),this.processNextRequest()):(this.traceInfo("Watch dog is watching."),this.lastProcessedRequests=this.processedRequests):(window.clearInterval(this.watchDogTimer),this.watchDogTimer=null,this.traceInfo("Stop watch dog."))},e.prototype.traceInfo=function(e){r.g.info("ThrottleRequests:active="+this.activeRequests+";throttled="+this.throttleCallbacks.length+";processed="+this.processedRequests+";lastProcessed="+this.lastProcessedRequests+";info="+e)},e.prototype.processNextRequest=function(){(this.processedRequests++,0===this.throttleCallbacks.length)?(this.activeRequests>0&&this.activeRequests--,this.traceInfo("Queue is empty.")):(this.throttleCallbacks.shift()(!1),this.traceInfo("Process next."))},e.prototype.registerCallback=function(e){var t=this;if(null==e)throw new Error("A null callback is registered to Throttle Thumbnails queue.");this.activeRequests<this.maxConcurrentRequests?(e(!1),this.activeRequests++,this.processedRequests++,this.traceInfo("Process now.")):(e(!0),this.throttleCallbacks.push(e),this.traceInfo("Pushes to queue."),this.watchDogTimer||(this.watchDogTimer=window.setInterval((function(){t.watchDogAction()}),this.watchDogTimerInterval),this.traceInfo("Start watch dog.")))},e.prototype.unregisterCallback=function(e){var t=this.throttleCallbacks.indexOf(e);this.throttleCallbacks.splice(t,1),this.activeRequests=0,this.traceInfo("unregisterComponent:"+t)},e}();t.a=a},9799:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(115),a=(n(5546),new r.c((function(){return Promise.all([n.e(6),n.e(31),n.e(59),n.e(87),n.e(451)]).then(n.bind(null,11035))}))),i=new r.b(a,(function(e){return e.openBotConversation})),o=new r.b(a,(function(e){return e.openCortanaConversation}));new r.a(a,(function(e){return e.setEditorInterface}))},9820:function(e){e.exports=JSON.parse('{"a":"e9c"}')},9821:function(e){e.exports=JSON.parse('{"a":"f9c"}')},9822:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n(4),a=Object(r.action)("addCard",(function(e){return{cardId:e}})),i=Object(r.action)("removeCard",(function(e){return{cardId:e}})),o=Object(r.action)("setAutoInvokeActionAlreadyRan",(function(e,t){return{cardId:e,autoInvokeActionAlreadyRan:t}}))},999:function(e,t,n){"use strict";n.d(t,"l",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return C})),n.d(t,"g",(function(){return O}));var r,a,i=n(3),o=n(60),c=n(26),s=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],d=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],u={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function l(){return Object(c.a)().SessionSettings.IsPremiumConsumerMailbox}function f(){return Object(c.a)().IsConsumerChild}function g(){return Object(c.a)().SessionSettings.IsShadowMailbox}function b(){return void 0!==a?a:a=function(){if(Object(i.d)("ormarket"))return Object(i.a)("ormarket");var e=Object(c.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return s.indexOf(n)>-1?n:u[n.split("-")[1]]||n}()}function p(e){return null!=e?e.toUpperCase().split("-"):[]}function m(e){return p(e)[1]||"US"}function h(){return Object(o.a)("ANON")}function v(){return Object(o.a)("MUID")}function C(){return!!Object(o.a)("TOptOut")}function O(){return r||(r=Object(i.a)("anjs")||"https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}}}]);
//# sourceMappingURL=owa.ActionableMessageMail.js.map
self.scriptsLoaded['owa.ActionableMessageMail.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ActionableMessageMail.js'] = (new Date()).getTime();