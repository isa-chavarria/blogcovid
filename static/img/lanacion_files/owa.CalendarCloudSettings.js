self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.CalendarCloudSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[174],{1100:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a}));var r=t(4),o=t(23),i=Object(r.createStore)("lightningState",{unseenItems:new o.ObservableMap,lightedCount:0,lastShownId:null}),a=i()},1238:function(e,n,t){"use strict";var r=t(0),o=t(42),i=t(1268),a=t(1),u=t.n(a);function c(e,n){var t=function(n,t){return u.a.createElement(l,Object(r.__assign)({},n),u.a.createElement(e,Object(r.__assign)({},n)))};return t.displayName=e.displayName,n?u.a.forwardRef(t):t}var l=Object(o.a)((function(e){var n=e.lid,t=e.when,r=e.series,o=e.children;return u.a.useEffect((function(){return Object(i.b)(n,t,r),function(){i.c.importAndExecute(n)}}),[]),o&&d(n)?u.a.createElement(u.a.Fragment,null,o):null}));function s(e,n){i.c.importAndExecute(e,n)}function d(e){if(i.d.unseenItems){var n=i.d.unseenItems.get(e);if(null==n?void 0:n.visible)return!0}return!1}t.d(n,"c",(function(){return c})),t.d(n,"a",(function(){return l})),t.d(n,"d",(function(){return s})),t.d(n,"e",(function(){return d})),t.d(n,"b",(function(){return i.a}))},1268:function(e,n,t){"use strict";var r=t(115),o=t(1100),i=t(75),a=t(0),u=t(3),c=t(23),l=t(4),s=Object(l.mutatorAction)("initializeLightning",(function(e){var n,t;if(i.g.info("initialize lightning store"),Object(o.a)().lastShownId=null,Object(o.a)().lightedCount=0,Object(o.a)().unseenItems=new c.ObservableMap,e)try{for(var r=Object(a.__values)(e),u=r.next();!u.done;u=r.next()){var l=u.value;Object(o.a)().unseenItems.set(l.identity,l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}}));var d=t(288),f="ows/v1.0/lightning/items/unseen";function b(){return i.g.info("initialize lightning from server"),Object(d.b)(f).then((function(e){var n=e.map(v);s(n)}))}function v(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var g,O=t(26),h=t(76),E="lightning",m="UnseenLightening";function j(){var e,n,t;if(!g){var r=Object(u.a)(E);if(r)g=function(e){i.g.info("initialize lightning from override query parameter");var n=e.split(",").map((function(e){return{identity:e,visible:!1}}));return s(n),Promise.resolve()}(r);else{var o=Object(O.a)().PrimeSettings;if(Object(h.h)("lightning-initFromSD")&&o&&o.Items)try{for(var c=Object(a.__values)(o.Items),l=c.next();!l.done;l=c.next()){var d=l.value;if(d.Id===m&&d.Value){t=d.Value,i.g.info("initialize lightning from session data"),s(t.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),g=Promise.resolve();break}}}catch(n){e={error:n}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}g||(g=b())}}return g}var p=t(1843),y=Object(l.action)("lightup",(function(e){return{id:e}})),S=y;Object(l.mutator)(y,(function(e){i.g.info("lightup - id:"+e.id),Object(o.a)().lastShownId=e.id,Object(o.a)().lightedCount++;var n=Object(o.a)().unseenItems.get(e.id);n&&(n.visible=!0)})),Object(l.orchestrator)(y,(function(e){Object(p.a)("LIGHTUP",e.id)}));var C,w=t(573);function I(e,n){(i.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+n+", lightedCount:"+Object(o.a)().lightedCount+", lastShown:"+Object(o.a)().lastShownId),Object(w.v)())?i.g.info("lightning is disabled for deeplink"):Object(o.a)().unseenItems.has(e)&&(!Object(o.a)().lastShownId||function(e,n){var t=!1,r=Object(o.a)().lastShownId;if(r&&n&&!function(){var e=Object(o.a)(),n=e.lastShownId,t=e.unseenItems;return n&&t.has(n)&&t.get(n).visible}()){var i=n.indexOf(r),a=n.indexOf(e);i>=0&&i+1==a&&(t=!0)}return t}(e,n)||function(e){var n=Object(o.a)().unseenItems.get(e);return!!n&&n.category==C.UIFeatureDiscovery}(e)||function(e){var n=Object(o.a)().unseenItems.get(e);return!!n&&n.category==C.Compliance}(e))&&S(e)}function R(e,n,t){i.g.info("beginLightning - id:"+e),n((function(){j().then((function(){return I(e,t)})).catch((function(n){i.g.warn("something is wrong, lightning id:"+e+", reason:"+n)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(C||(C={}));var B=t(1277);t.d(n,"c",(function(){return D})),t.d(n,"d",(function(){return o.b})),t.d(n,"b",(function(){return R})),t.d(n,"a",(function(){return B.a}));var F=new r.c((function(){return t.e(367).then(t.bind(null,15844))})),D=new r.a(F,(function(e){return e.endLightningImp}))},1277:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.EnterpriseOptInFRE="24",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.ShortenEventsDurationSetting="70"}(r||(r={}))},15588:function(e,n,t){"use strict";t.r(n);var r,o,i,a,u=t(670),c=t(290),l=t(4),s=(Object(l.mutator)(u.f,(function(e){Object(c.a)().shouldEventsEndEarly=e.shouldEventsEndEarly})),Object(l.mutator)(u.e,(function(e){Object(c.a)().shortenEventScope=e.shortenEventScope})),Object(l.mutator)(u.c,(function(e){Object(c.a)().endShortEventsBy=e.endShortEventsBy})),Object(l.mutator)(u.b,(function(e){Object(c.a)().endLongEventsBy=e.endLongEventsBy})),Object(l.mutator)(u.a,(function(e){Object(c.a)().enableOnlineMeetingsByDefault=e.enableOnlineMeetingsByDefault})),Object(l.mutator)(u.d,(function(e){Object(c.a)().isOnlineMeetingsByDefaultSynced=e.isOnlineMeetingsByDefaultSynced})),t(0)),d=Object(l.action)("initCalendarCloudSettings"),f=Object(l.action)("saveCalendarCloudSettings",(function(e){return{calendarCloudSettings:e}})),b="/ows/beta/OutlookCloudSettings/settings/";!function(e){e.ShouldEventsEndEarly="Should_Event_End_Early",e.ShortenEventScope="shorten_event_scope",e.EndShortEventsBy="End_Short_meetings_by",e.EndLongEventsBy="End_long_meetings_by",e.EnableOnlineMeetingsByDefault="onlinemeetings_enabledbydefault"}(r||(r={})),function(e){e.Bool="Bool",e.Int="Int",e.String="String"}(o||(o={})),function(e){e.Global="global",e.Account="account"}(i||(i={})),function(e){e.RoamingSetting="roamingsetting"}(a||(a={}));var v=t(377);var g=t(288);function O(){var e,n=Object.values(r).join(),t=(e=n,""+b+i.Global+"?settingname="+e);return Object(g.b)(t).then((function(e){return e?(e.forEach((function(e){if(e.name&&e.value)switch(e.name.toLowerCase()){case r.ShouldEventsEndEarly.toLowerCase():n="true"===e.value.toLowerCase();break;case r.ShortenEventScope.toLowerCase():t=function(e){switch(e.toLowerCase()){case v.a.EndEarly.toLowerCase():return v.a.EndEarly;case v.a.StartLate.toLowerCase():return v.a.StartLate;case v.a.None.toLowerCase():return v.a.None}return null}(e.value);break;case r.EndShortEventsBy.toLowerCase():o=+e.value;break;case r.EndLongEventsBy.toLowerCase():i=+e.value;break;case r.EnableOnlineMeetingsByDefault.toLowerCase():a="true"===e.value.toLowerCase()}})),null==n&&null==t&&null==o&&null==i&&null==a?null:{shouldEventsEndEarly:n,shortenEventScope:t,endShortEventsBy:o,endLongEventsBy:i,enableOnlineMeetingsByDefault:a}):null;var n,t,o,i,a}))}var h=t(644),E=t(76),m=t(1268),j=t(1238);function p(e){e()}var y=t(500),S=t(643);function C(){if(Object(E.h)("cal-mf-shouldEventsEndEarlySetting")&&Object(E.h)("cal-mf-shouldEventsEndEarlyFREDialog")&&!Object(E.h)("cal-mf-shortenEventsDuration")&&!Object(y.a)()||Object(E.h)("cal-mf-shortenEventsDuration")&&!Object(S.a)()){var e=Object(E.h)("cal-mf-shortenEventsDuration")?j.b.ShortenEventsDurationSetting:j.b.SpeedyMeetingsEndEarlySetting;Object(m.b)(e,w)}}function w(e){e()}var I=t(682);function R(e){var n=function(e){var n=[];null!=e.shouldEventsEndEarly&&n.push({name:r.ShouldEventsEndEarly,value:e.shouldEventsEndEarly,type:o.Bool,scope:i.Global});null!=e.shortenEventScope&&n.push({name:r.ShortenEventScope,value:e.shortenEventScope,type:o.String,scope:i.Global});null!=e.endShortEventsBy&&n.push({name:r.EndShortEventsBy,value:e.endShortEventsBy,type:o.Int,scope:i.Global});null!=e.endLongEventsBy&&n.push({name:r.EndLongEventsBy,value:e.endLongEventsBy,type:o.Int,scope:i.Global});null!=e.enableOnlineMeetingsByDefault&&n.push({name:r.EnableOnlineMeetingsByDefault,value:e.enableOnlineMeetingsByDefault,type:o.Bool,scope:i.Global});return n.length>0?n:null}(e);return n?Object(g.c)(b+i.Global,n,void 0,!0):null}Object(l.orchestrator)(d,(function(){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return(t=Object(c.a)())&&null!=t.shouldEventsEndEarly&&null!=t.shortenEventScope&&null!=t.endShortEventsBy&&null!=t.endLongEventsBy&&null!=t.enableOnlineMeetingsByDefault?[2]:[4,O()];case 1:return(e=n.sent())?(Object(u.h)(e),Object(u.d)(e.enableOnlineMeetingsByDefault),Object(I.a)()&&Object(u.g)(),Object(E.h)("cal-mf-enableDefaultOnlineMeetingSetting")&&!Object(h.a)()&&Object(m.b)(j.b.DefaultOnlineMeetingSetting,p),C(),[2]):[2]}var t}))}))})),Object(l.orchestrator)(u.h,(function(e){var n=e.calendarCloudSettings;null!=n.shouldEventsEndEarly&&Object(u.f)(n.shouldEventsEndEarly),null!=n.shortenEventScope&&Object(u.e)(n.shortenEventScope),null!=n.endShortEventsBy&&Object(u.c)(n.endShortEventsBy),null!=n.endLongEventsBy&&Object(u.b)(n.endLongEventsBy),null!=n.enableOnlineMeetingsByDefault&&Object(u.a)(n.enableOnlineMeetingsByDefault)})),Object(l.orchestrator)(f,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return(n=e.calendarCloudSettings)?(Object(u.h)(n),[4,R(n)]):[2];case 1:return t.sent(),[2]}}))}))}));var B=t(254),F=t(94);Object(l.orchestrator)(u.g,(function(){var e={enableOnlineMeetingsByDefault:Object(F.d)()};f(e),Object(u.d)(!0),Object(B.o)("SyncOnlineMeetingsOCSWithMailboxConfig")})),t.d(n,"initCalendarCloudSettings",(function(){return d})),t.d(n,"saveCalendarCloudSettings",(function(){return f}))},1843:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(118),o=t(1277);function i(e,n){Object.keys(o.a).some((function(t){return o.a[t]==n&&(Object(r.h)(e,{key:t,id:n},{isCore:!0}),!0)}))}},425:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(24),o=t(22),i=t(98);function a(e){var n=Object(r.a)(),t=Object(i.a)()+Object(o.a)("/owa")+"/",a=n.search&&n.search.length>0;t+=a?n.search:"?";for(var u=Object.keys(e),c=a,l=0;l<u.length;l++)c?t+="&":c=!0,t+=u[l]+"="+e[u[l]];return t}},573:function(e,n,t){"use strict";var r=t(445),o=(t(602),t(22)),i=t(62);function a(e){return Object(i.a)(e,[i.b])}var u=t(27),c=t(66);function l(e){return Object(u.b)(Object(u.c)(Object(u.a)(Object(c.a)()||"",e)))}var s,d,f,b=t(425);function v(e,n){var t=-1!==e.indexOf("?");return(e+=t?"&":"?")+Object.keys(n).map((function(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])})).join("&")}function g(){return s||(s=Object(o.a)("/calendar")+"/"),s}function O(){return d||(d=Object(o.a)("/mail")+"/"),d}function h(){return f||(f=Object(o.a)("/files")+"/"),f}var E,m,j,p=t(617);function y(e){return E&&m===e||(m=e,E=e?Object(o.a)("/people/group/owner")+"/":Object(o.a)("/people/group/member")+"/"),E}function S(){return j||(j=Object(o.a)("/people/group/deleted")+"/"),j}var C=t(26);function w(){var e=Object(C.a)().UserOptions;return(null==e?void 0:e.ReactOptinSettings)&&e.ReactOptinSettings.CalendarEnabled||!1}function I(e){if(w())return g()+"deeplink/compose/"+encodeURIComponent(e);var n={viewmodel:"IComposeCalendarItemViewModelFactory",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(b.a)(n)}function R(e){return window.location.origin+g()+"showPeek/item/"+encodeURIComponent(e)}function B(e){if(w())return g()+"item/"+encodeURIComponent(e);var n={viewmodel:"ICalendarItemDetailsViewModelFactory",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(b.a)(n)}var F=t(0),D=t(289),U=t(593),M=t(24),L=t(58),_=Object(U.a)().split("/").slice(1).join("/")+"deeplink/",P=["hostApp","isanonymous","cspoff","frameName","opxInstanceId"];function k(e,n,t,r){var o=Object(M.a)().search;if(t&&((r=r||{}).minus=""),r){var i=Object(L.parse)((o||"").substr(1));Object.keys(i).forEach((function(e){P.includes(e)&&delete i[e]})),Object.keys(r).forEach((function(e){return i[e]=r[e]})),o="?"+function(e){return Object.entries(e).map((function(e){var n=Object(F.__read)(e,2),t=n[0],r=n[1];return r?encodeURIComponent(t)+"="+encodeURIComponent(r):encodeURIComponent(t)})).join("&")}(i)}var a={pathname:"/"+e+"/"+_+n,search:o};return D.format(a)}var x,T=t(146),G="https://to-do.microsoft.com";function N(){var e,n,t=Object(C.a)(),r=t.UserOptions,o=null===(e=t.SessionSettings)||void 0===e?void 0:e.UserPrincipalName,i=G;return(null===(n=null==r?void 0:r.ReactOptinSettings)||void 0===n?void 0:n.TasksRedirectUrl)&&(i=r.ReactOptinSettings.TasksRedirectUrl,o&&(i=v(r.ReactOptinSettings.TasksRedirectUrl,{auth_upn:o}))),i}function A(){return x||(x=Object(o.a)("/spaces")+"/"),x}var V=t(98);t.d(n,"j",(function(){return r.a})),t.d(n,"s",(function(){return o.a})),t.d(n,"f",(function(){return a})),t.d(n,"l",(function(){return l})),t.d(n,"w",(function(){return u.a})),t.d(n,"a",(function(){return u.b})),t.d(n,"o",(function(){return b.a})),t.d(n,"u",(function(){return v})),t.d(n,"e",(function(){return g})),t.d(n,"k",(function(){return O})),t.d(n,"g",(function(){return h})),t.d(n,"p",(function(){return p.a})),t.d(n,"i",(function(){return y})),t.d(n,"h",(function(){return S})),t.d(n,"b",(function(){return I})),t.d(n,"c",(function(){return R})),t.d(n,"d",(function(){return B})),t.d(n,"q",(function(){return k})),t.d(n,"v",(function(){return T.a})),t.d(n,"t",(function(){return N})),t.d(n,"n",(function(){return A})),t.d(n,"m",(function(){return V.a})),t.d(n,"r",(function(){return c.a}))},602:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(24),o=t(66);function i(){var e,n=null===(e=Object(r.a)())||void 0===e?void 0:e.pathname;if(n){var t=n.split("/"+Object(o.a)()+"/")[1];if(t){var i=t.split("/")[0];if(i&&!isNaN(parseInt(i)))return!0}}return!1}},617:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r,o=t(22);function i(){return r||(r=Object(o.a)("/people")+"/"),r}}}]);
//# sourceMappingURL=owa.CalendarCloudSettings.js.map
self.scriptsLoaded['owa.CalendarCloudSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.CalendarCloudSettings.js'] = (new Date()).getTime();