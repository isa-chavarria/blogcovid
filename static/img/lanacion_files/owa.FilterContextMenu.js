self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FilterContextMenu.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[284],{10418:function(e,t,n){var r=n(12394),i=n(109);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},11059:function(e,t,n){"use strict";n.r(t);var r=n(42),i=n(12392),o=n(9280),c=n(10),a=n(12393),u=n(7362);function s(e){switch(e){case 1:return Object(c.b)(a.a);case 3:return Object(c.b)(a.b);case 7:return Object(c.b)(a.d);case 5:return Object(c.b)(a.c);case 8:return Object(c.b)(u.a);default:throw new Error("Sort not implemented")}}var l=n(8473),d=n(6785),f=n(6953),b=n(314),m=n(75);function p(e){switch(e){case"All":return Object(c.b)(o.a);case"Unread":return Object(c.b)(d.a);case"Flagged":return Object(c.b)(l.a);case"ToOrCcMe":return Object(c.b)(o.e);case"HasAttachment":return Object(c.b)(f.a);case"Mentioned":return Object(c.b)(o.d);case"TaskActive":case"TaskOverdue":case"TaskCompleted":case"DeprecatedSuggestions":case"DeprecatedSuggestionsRespond":case"DeprecatedSuggestionsDelete":case"DeprecatedNoClutter":case"DeprecatedClutter":case"SystemCategory":case"UserCategory":case"Pinned":case"Focused":case"Locked":case"Hashtag":case"Liked":return m.d("Filter not implemented"),"";default:return Object(b.a)(e)}}var g=n(5695),h=n(961),w=n(1),x=n(232),S=n(565),C=n(95),O=n(7385),j=n(999),y=n(2819),v=n(989),D=n(10418),I=Object(r.a)((function(e){var t=w.useMemo((function(){return h.T.tableViews.get(e.tableViewId)}),[e.tableViewId]),n=function(){var e=Object(h.E)(t),n=e.sortDirection==h.c.ASCENDING_SORT_DIR,r=e.sortColumn,o=h.c.getSupportedSortColumns(t.tableQuery.folderId),u=[],l=[];o.forEach((function(t){var n=r==t;l.push({key:t.toString(),name:s(t),data:{sortOrder:n?e.sortDirection:h.c.getDefaultSortDirectionForSortColumn(t),sortColumn:t},onClick:a,canCheck:!0,isChecked:n})})),u.push({key:"sortBySection",itemType:x.a.Section,sectionProps:{bottomDivider:!0,title:Object(c.b)(i.j),items:l}});var d=function(e){switch(e){case 1:return{ascendingString:Object(c.b)(i.g),descendingString:Object(c.b)(i.f)};case 3:case 8:return{ascendingString:Object(c.b)(i.a),descendingString:Object(c.b)(i.b)};case 7:return{ascendingString:Object(c.b)(i.h),descendingString:Object(c.b)(i.d)};case 5:return{ascendingString:Object(c.b)(i.e),descendingString:Object(c.b)(i.c)};default:throw new Error("Sort not implemented")}}(r),f=d.ascendingString,b=d.descendingString,m=[{key:"ascending",name:f,data:{sortOrder:"Ascending",sortColumn:r},onClick:a,canCheck:!0,isChecked:n},{key:"descending",name:b,data:{sortOrder:"Descending",sortColumn:r},onClick:a,canCheck:!0,isChecked:!n}];return u.push({key:"sortOrderSection",itemType:x.a.Section,sectionProps:{bottomDivider:!0,title:Object(c.b)(i.k),items:m}}),u},r=function(t){return{key:t.toString(),name:p(t),data:t,canCheck:!0,isChecked:e.currentViewFilter==t,onClick:u}},a=function(t,n){e.dismissContextMenu(),g.e.importAndExecute(n.data.sortColumn,n.data.sortOrder,e.tableViewId,e.filterMenuSource)},u=function(t,n){e.dismissContextMenu();var r=n.data;"Important"===r?g.c.importAndExecute(e.filterMenuSource):g.d.importAndExecute(r,e.filterMenuSource)},l=e.dismissContextMenu,d=e.contextMenuTargetElement,f=function(){var a=e.supportedViewFilters.filter((function(e){return!(Object(j.c)()&&("Mentioned"===e||"ToOrCcMe"===e))})).map((function(e){return r(e)}));if(Object(y.a)()&&t.tableQuery.folderId&&"inbox"==Object(v.a)(t.tableQuery.folderId)){var s=y.d.tryImportForRender(),l=(null==s?void 0:s())||0;a.push({key:"importantFilter",name:Object(c.b)(o.b),canCheck:!0,data:"Important",onClick:u,secondaryText:l>0?l.toString():null,itemProps:{styles:{secondaryText:D.secondaryText}}})}if(1!=t.tableQuery.type){a.push({key:"divider",name:"-"});var d=h.T.tableViews.get(e.tableViewId).tableQuery.folderId;a.push({key:"sortBy",name:Object(c.b)(i.i),items:n()});var f=O.a.tryImportForRender();if(f){var b=f(d,e.dismissContextMenu,"filterMenu");b&&(a.push({key:"divider",name:"-"}),a.push(b))}}return a}();return w.createElement(S.a,{shouldFocusOnMount:!0,target:d,directionalHint:C.DirectionalHint.bottomRightEdge,onDismiss:l,items:f})}));var k=n(0),M=n(306),E=n(1518),F=n(284),N=n(4),Q=Object(N.createStore)("mailListFilterView",{filterContextMenuDisplayState:!1}),V=Q(),P=Object(F.action)("showFilterDropDownContextMenu")((function(){Q().filterContextMenuDisplayState=!0})),T=Object(F.action)("hideFilterDropDownContextMenu")((function(){Q().filterContextMenuDisplayState=!1})),H=n(2433);Object(N.mutator)(H.e,(function(e){Q().filterContextMenuDisplayState=!0}));var _=n(993),A=n(487),R=n(10418),K=Object(r.a)((function(e){var t=w.useRef(),n=Object(h.K)(h.T.tableViews.get(e.tableViewId)),r="spotlight"===h.T.tableViews.get(e.tableViewId).tableQuery.scenarioType,i="All"==n&&!r,a=function(t){t.stopPropagation();var n=V.filterContextMenuDisplayState;r?g.b.importAndExecute(e.filterMenuSource):i?n?L():P():g.d.importAndExecute("All",e.filterMenuSource)},u=A(e.containerClassName,e.isInboxWithPivots&&R.filterPivots,V.filterContextMenuDisplayState?R.filterAllOpened:R.filterAll),s={role:_.a.button},l=w.useMemo((function(){return i?Object(c.b)(o.c):r?Object(c.b)(o.b):p(n)}),[e.tableViewId]);return w.createElement("div",Object(k.__assign)({ref:function(e){return t.current=e},className:u,onClick:a,onKeyDown:function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),a(e))}},Object(_.b)(s),{tabIndex:0}),w.createElement("div",{className:R.filterContents},l,w.createElement(M.a,{className:R.icon,iconName:i?"ChevronDownMed":"Cancel"})),V.filterContextMenuDisplayState&&w.createElement(I,{currentViewFilter:n,supportedViewFilters:e.supportedViewFilters,dismissContextMenu:L,contextMenuTargetElement:t.current,filterMenuSource:e.filterMenuSource,tableViewId:e.tableViewId}))}));function L(){T(),E.b.importAndExecute()}n.d(t,"MailFilterContextMenu",(function(){return I})),n.d(t,"MailListFilterMenu",(function(){return K}))},12392:function(e){e.exports=JSON.parse('{"i":"Nfc","j":"Ofc","k":"Pfc","a":"Qfc","b":"Rfc","g":"Sfc","f":"Tfc","d":"Ufc","h":"Vfc","c":"Wfc","e":"Xfc"}')},12393:function(e){e.exports=JSON.parse('{"a":"Jfc","b":"Kfc","d":"Lfc","c":"Mfc"}')},12394:function(e,t,n){(t=e.exports=n(108)(!1)).push([e.i,'._2HxQ4wKES5wjvIgnjfLcQK,._3HGhEMHDY2i8us0auVPsuI{cursor:pointer;font-size:14px;font-weight:400;color:"[theme:themePrimary, default:#0078D4]";font-weight:600;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;height:32px}html[dir] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir] ._3HGhEMHDY2i8us0auVPsuI{padding:0 8px;border-radius:2px;margin-top:5px}html[dir=ltr] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir=ltr] ._3HGhEMHDY2i8us0auVPsuI{margin-left:auto;margin-right:-8px}html[dir=rtl] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir=rtl] ._3HGhEMHDY2i8us0auVPsuI{margin-right:auto;margin-left:-8px}html[dir] ._2HxQ4wKES5wjvIgnjfLcQK:hover,html[dir] ._3HGhEMHDY2i8us0auVPsuI{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] .SNcGPM0gk8ayZzwzROpZX{margin-bottom:8px}html[dir] ._3lIR1LfENBYPLTyCDNhq5k{margin-top:6px}._2oQ9sQfC-vORW35CueNgmA{font-weight:400;font-size:10px;color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._2oQ9sQfC-vORW35CueNgmA{padding-left:4px}html[dir=rtl] ._2oQ9sQfC-vORW35CueNgmA{padding-right:4px}.QCFDYNlgEXFDrarlbtyNf{color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] .QCFDYNlgEXFDrarlbtyNf{margin-right:3px}html[dir=rtl] .QCFDYNlgEXFDrarlbtyNf{margin-left:3px}',""]),t.locals={filterAll:"_2HxQ4wKES5wjvIgnjfLcQK",filterAllOpened:"_3HGhEMHDY2i8us0auVPsuI",filterPivots:"SNcGPM0gk8ayZzwzROpZX",filterContents:"_3lIR1LfENBYPLTyCDNhq5k",icon:"_2oQ9sQfC-vORW35CueNgmA",secondaryText:"QCFDYNlgEXFDrarlbtyNf"}},1518:function(e,t,n){"use strict";var r=n(115),i={sequentialIndex:"0",nonSequentialIndex:"-1"};n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return i}));var o=new r.c((function(){return n.e(391).then(n.bind(null,15899))})),c=new r.a(o,(function(e){return e.registerComponent})),a=new r.a(o,(function(e){return e.resetFocus})),u=new r.a(o,(function(e){return e.setFocusToSynchronous}))},2748:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1022),i=n(76);function o(){return Object(i.h)("tri-spotlight2")&&!Object(r.a)(2048)}},2819:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return b}));var r=n(115),i=n(2820);n.d(t,"b",(function(){return i.a}));var o=n(2748);n.d(t,"a",(function(){return o.a}));var c=new r.c((function(){return Promise.all([n.e(4),n.e(20),n.e(51),n.e(565)]).then(n.bind(null,5600))})),a=new r.a(c,(function(e){return e.initializeSpotlight})),u=new r.b(c,(function(e){return e.getSpotlightRollupData})),s=new r.b(c,(function(e){return e.getUnacknowledgedSpotlightCount})),l=new r.a(c,(function(e){return e.onSpotlightDismissedFromLV})),d=new r.a(c,(function(e){return e.onSpotlightRollupDismissed})),f=new r.a(c,(function(e){return e.loadImportantTable})),b=new r.a(c,(function(e){return e.logSpotlightItemClicked}))},2820:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2899);function i(e){var t=e.itemId,n=e.conversationId,i=e.rowKey;return Object(r.a)().spotlightItems.some((function(e){return t&&e.itemId===t||n&&e.conversationId===n||i&&e.rowKey===i}))}},2899:function(e,t,n){"use strict";var r=n(435),i=n(4),o={spotlightItems:[],rollupDismissed:!1,logicalId:Object(r.a)()},c=Object(i.createStore)("spotlightStore",o);t.a=c},5695:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(115),i=new r.c((function(){return Promise.all([n.e(51),n.e(42),n.e(94),n.e(389)]).then(n.bind(null,11062))})),o=new r.a(i,(function(e){return e.selectFilter})),c=new r.a(i,(function(e){return e.selectSort})),a=new r.a(i,(function(e){return e.togglePauseInbox})),u=new r.a(i,(function(e){return e.clearFilter})),s=new r.a(i,(function(e){return e.loadSpotlightFilter})),l=new r.a(i,(function(e){return e.clearSpotlightFilter}))},6785:function(e){e.exports=JSON.parse('{"a":"E6b"}')},6953:function(e){e.exports=JSON.parse('{"a":"F7b"}')},7362:function(e){e.exports=JSON.parse('{"a":"vja"}')},7385:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(115),i=new r.c((function(){return n.e(471).then(n.bind(null,10155))})),o=new r.b(i,(function(e){return e.getPauseInboxContextMenuItem}))},8473:function(e){e.exports=JSON.parse('{"a":"Dfc"}')},9280:function(e){e.exports=JSON.parse('{"c":"Efc","a":"Ffc","e":"Gfc","d":"Hfc","b":"Ifc"}')}}]);
//# sourceMappingURL=owa.FilterContextMenu.js.map
self.scriptsLoaded['owa.FilterContextMenu.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FilterContextMenu.js'] = (new Date()).getTime();